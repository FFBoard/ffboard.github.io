"use strict";(self.webpackChunkpages=self.webpackChunkpages||[]).push([[995],{4041:(C,D,n)=>{n.d(D,{C:()=>o});var h=n(6814),s=n(9212);let o=(()=>{var l;class m{}return(l=m).\u0275fac=function(_){return new(_||l)},l.\u0275mod=s.oAB({type:l}),l.\u0275inj=s.cJS({imports:[h.ez]}),m})()},9010:(C,D,n)=>{n.d(D,{b:()=>o});var h=n(8863),s=n(9212);let o=(()=>{var l;class m{transform(_,M=2){return(0,h.t)(_,M)}}return(l=m).\u0275fac=function(_){return new(_||l)},l.\u0275pipe=s.Yjl({name:"formatBytes",type:l,pure:!0}),m})()},8863:(C,D,n)=>{n.d(D,{t:()=>s});var h=n(2641);function s(o,l=2){if(!+o)return"0 Bytes";let m=!1;o<0&&(m=!0,o=Math.abs(o));const _=l<0?0:l,P=Math.floor(Math.log(o)/Math.log(1024));return"".concat(m?"-":"").concat((0,h.o)(parseFloat((o/Math.pow(1024,P)).toFixed(_)))," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][P])}},5172:(C,D,n)=>{n.d(D,{In:()=>h,Ky:()=>m,VC:()=>s,c5:()=>l,gG:()=>o});var h=function(t){return t.FILE_SHOW_LINKS="fileLinks",t.FILE_EDIT="fileEdit",t.DELETE="delete",t.RENAME="rename",t.MOVE="move",t}(h||{}),s=function(t){return t.FILE="file",t.FOLDER="folder",t}(s||{}),o=function(t){return t.FILENAME="filename",t.SIZE="size",t.TIME="time",t.EXTENSION="ext",t}(o||{}),l=function(t){return t.GRID="grid",t.LIST="list",t}(l||{}),m=function(t){return t.W_768_I_1="(max-width: 767.98px)",t.W_933_I_2="(min-width: 768px) and (max-width: 933.98px)",t.W_960_I_3="(min-width: 934px) and (max-width: 959.98px)",t.W_1226_I_2="(min-width: 960px) and (max-width: 1225.98px)",t.W_1540_I_3="(min-width: 1226px) and (max-width: 1539.98px)",t.W_1854_I_4="(min-width: 1540px) and (max-width: 1853.98px)",t.W_2168_I_5="(min-width: 1854px) and (max-width: 2167.98px)",t.W_2482_I_6="(min-width: 2168px) and (max-width: 2481.98px)",t.W_2796_I_7="(min-width: 2482px) and (max-width: 2795.98px)",t.W_3110_I_8="(min-width: 2796px) and (max-width: 3109.98px)",t.W_3424_I_9="(min-width: 3110px) and (max-width: 3423.98px)",t.W_3738_I_10="(min-width: 3424px)",t}(m||{})},1990:(C,D,n)=>{n.d(D,{JJ:()=>l,b3:()=>m,p$:()=>_,ql:()=>o,uJ:()=>t,vV:()=>s});var h=n(5172);const s={lastPath:[],layout:{asc:!0,orderBy:h.gG.FILENAME,type:h.c5.GRID},uploader:{checkImage:{time:0,active:!0},showLinkModal:!1}},o="https://upload.forumfree.net/api/",l=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-.\s])*$/,m=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-\s])*$/,t={invalidLength:!1,alreadyUsed:!1,invalidStartOrEnd:!1,invalidCharacter:!1},_=2147483648},5983:(C,D,n)=>{n.d(D,{B:()=>t});var h=n(5172),s=n(9300),o=n(1410),l=n(9212),m=n(6779);let t=(()=>{var _;class M{constructor(u,c){this.globalsService=u,this.loginAsService=c,this.cache={},this.userStorage={},this.profileSubscription=this.globalsService.profileObservable.subscribe(e=>{this.profileFfuid=null==e?void 0:e.user.ffuid})}get ffuid(){var u;return(null===(u=this.loginAsService.profile)||void 0===u?void 0:u.ffuid)||this.profileFfuid}getFileLimits(){return this.fileLimits}setFileLimits(u){this.fileLimits=u}getUserStorage(){return this.ffuid?this.userStorage[this.ffuid]:void 0}setUserStorage(u){this.ffuid&&(this.userStorage[this.ffuid]=u)}deleteUserStorage(){this.ffuid&&delete this.userStorage[this.ffuid]}getItem(u){const c=this.createKey(u);if((0,s.o8)(this.cache,c))return this.cache[c]}setItem(u,c){this.cache[this.createKey(u)]=c}removeItem(u){const c=this.createKey(u);if((0,s.o8)(this.cache,c)){if(this.cache[c].folders.length)for(const e of this.cache[c].folders)this.removeItem([...u,e.name]);return delete this.cache[c],!0}return!1}getEntities(u,c){const e={},r=this.createKey(u);if(!(0,s.o8)(this.cache,r))return e;for(const U of c){const S=(U.type===h.VC.FILE?this.cache[r].files:this.cache[r].folders).find(y=>y.name===U.name);S&&(e[S.name]=S)}return e}addEntities(u,c,e=h.VC.FILE){const r=this.createKey(u);return!!(0,s.o8)(this.cache,r)&&(Array.isArray(c)||(c=[c]),e===h.VC.FILE?this.cache[r].files.unshift(...c):this.cache[r].folders.unshift(...c),!0)}removeEntities(u,c,e=h.VC.FILE){if(Array.isArray(c)||(c=[c]),e===h.VC.FOLDER)for(const y of c)this.removeItem([...u,y]);const r=this.createKey(u);if(!(0,s.o8)(this.cache,r))return[];const U=e===h.VC.FILE?"files":"folders",S=[];for(const y of c){const A=this.cache[r][U].findIndex(x=>x.name===y);A>-1&&(this.cache[r][U].splice(A,1),S.push(y))}return S}refactorFolderContent(u,c){const e=this.createKey(u);if(!(0,s.o8)(this.cache,e))return!1;c.endsWith("/")||(c+="/");for(const r of this.cache[e].folders)r.url=c+r.name;for(const r of this.cache[e].files)r.url=r.embedUrl=c+r.name,r.time=Date.now();return!0}createKey(u){return"".concat(this.ffuid,"/").concat(u.join("/"))}ngOnDestroy(){this.profileSubscription.unsubscribe()}}return(_=M).\u0275fac=function(u){return new(u||_)(l.LFG(o.d),l.LFG(m.D))},_.\u0275prov=l.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),M})()},5571:(C,D,n)=>{n.d(D,{He:()=>t,gZ:()=>M,jt:()=>l,oT:()=>s,pf:()=>m,t3:()=>_,vJ:()=>P,wm:()=>h,xj:()=>o});const h="\nquery UploadEntitiesListToken($target: String!, $targetUserId: String) {\n    uploadEntitiesListToken(target: $target, targetUserId: $targetUserId)\n}",s="\nquery UploadEntitiesHostToken($target: String!, $targetUserId: String, $allowReplace: Boolean) {\n    uploadEntitiesHostToken(target: $target, targetUserId: $targetUserId, allowReplace: $allowReplace)\n}",o="\nquery UploadEntitiesCreateDirectoryToken($target: String!, $targetUserId: String) {\n    uploadEntitiesCreateDirectoryToken(target: $target, targetUserId: $targetUserId)\n}",l="\nquery UploadEntitiesMoveToken($source: String!, $target: String!, $targetUserId: String) {\n    uploadEntitiesMoveToken(source: $source, target: $target, targetUserId: $targetUserId)\n}",m="\nquery UploadEntitiesDeleteToken($target: String!, $targetUserId: String) {\n    uploadEntitiesDeleteToken(target: $target, targetUserId: $targetUserId)\n}",t="\nquery UploadHistoryAvailableDateRange {\n    uploadHistoryAvailableDateRange {\n        start\n        end\n    }\n}",_="\nquery UploadEntitiesSizeToken($allowCompute: Boolean, $targetUserId: String) {\n    uploadEntitiesSizeToken(allowCompute: $allowCompute, targetUserId: $targetUserId)\n}",M="\nquery UploadEntitiesLimitsToken($targetUserId: String) {\n    uploadEntitiesLimitsToken(targetUserId: $targetUserId)\n}",P="\nsubscription UploadEntities {\n    uploadEntities {\n        eventMessage\n        eventType\n        user {\n            avatar\n            host\n            id\n            nickname\n        }\n    }\n}"},446:(C,D,n)=>{n.d(D,{p:()=>M});var h=n(9300),s=n(7165),o=n(463),l=n(1990),m=n(2986),t=n(9212),_=n(6779);let M=(()=>{var P;class u{constructor(e,r,U){this.preferencesService=e,this.urlQueryParamsService=r,this.loginAsService=U;const S=this.urlQueryParamsService.getAndDeleteParam(s.RT.UPLOAD_PATH);S&&(this.lastFolderPath=S.split("/").filter(y=>y.length>0))}get preferences(){return this.preferencesService.getItem(s.Ye.UPLOAD)||l.vV}set preferences(e){this.preferencesService.setItem(s.Ye.UPLOAD,e)}get lastFolderPath(){return this.loginAsService.isActive?[]:(this.preferences.lastPath||l.vV.lastPath).filter(e=>e.length>0)}set lastFolderPath(e){if(this.loginAsService.isActive)return;const r=this.preferences;r.lastPath=e,this.preferences=r}get layoutOptions(){const e=l.vV.layout,r=this.preferences.layout;return r&&0===Object.keys(e).filter(U=>!(0,h.o8)(r,U)).length?r:e}set layoutOptions(e){const r=this.preferences;r.layout=e,this.preferences=r}get uploader(){const e=this.preferences.uploader||l.vV.uploader;return!e.checkImage.active&&Date.now()-e.checkImage.time>6048e5&&(e.checkImage.active=!0,this.uploader=e),(0,h.o8)(e,"showLinkModal")||(e.showLinkModal=!1),e}set uploader(e){const r=this.preferences;r.uploader=e,this.preferences=r}}return(P=u).\u0275fac=function(e){return new(e||P)(t.LFG(o.y),t.LFG(m.J),t.LFG(_.D))},P.\u0275prov=t.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),u})()},658:(C,D,n)=>{n.d(D,{C:()=>S});var h=n(1413),s=n(5861),o=n(9300),l=n(4036),m=n(5172),t=n(9054),_=n(5571),M=n(5983),P=n(1990),u=n(446),c=n(4004),e=n(9212),r=n(9862),U=n(6779);let S=(()=>{var y;class A{constructor(p,d,f,I,v){this.graphqlService=p,this.uploadCacheService=d,this.uploadPreferencesService=f,this.http=I,this.loginAsService=v}get cache(){return this.uploadCacheService}get preferences(){return this.uploadPreferencesService}setGqlIdHeader(){this.graphqlService.safeSetGlobalHeader(o._3.UUID,(0,c.Z)())}removeGqlIdHeader(){this.graphqlService.removeGlobalHeader(o._3.UUID)}getGqlIdHeader(){return this.graphqlService.getGlobalHeader(o._3.UUID)||""}getFileLimits(){var p=this;return(0,s.Z)(function*(){const d=p.cache.getFileLimits();if(d)return d;const f=(yield p.graphqlService.query({query:_.gZ,variables:p.loginAsService.prepareGqlPayload()})).data.uploadEntitiesLimitsToken,v=(yield p.sendRequest(f)).map(R=>({ext:R.extension,maxSize:R.size}));return p.cache.setFileLimits(v),v})()}getUserStorage(p=!1){var d=this;return(0,s.Z)(function*(){return p?yield d.requestUserStorage(!0):d.cache.getUserStorage()||(yield d.requestUserStorage())})()}flushUserStorage(){this.cache.deleteUserStorage()}requestUserStorage(p=!1){var d=this;return(0,s.Z)(function*(){const f=(yield d.graphqlService.query({query:_.t3,variables:d.loginAsService.prepareGqlPayload({allowCompute:p||void 0})})).data.uploadEntitiesSizeToken,I=yield d.sendRequest(f),v={used:I.used,max:I.limit,exceeded:I.exceeded};return d.cache.setUserStorage(v),v})()}getFileList(p){var d=this;return(0,s.Z)(function*(){const f=d.uploadCacheService.getItem(p);if(f)return f;const I=(yield d.graphqlService.query({query:_.wm,variables:d.loginAsService.prepareGqlPayload({target:p.join("/")})})).data.uploadEntitiesListToken,v=yield d.sendRequest(I),i={files:v.files.map(a=>{const g=(0,t.Tb)(a.url);return(0,h.Z)((0,h.Z)({},a),{time:1e3*a.time,filename:g.filename,ext:g.ext,isImage:(0,t.Or)(g.ext),embedUrl:"".concat(a.url,"?t=").concat(a.time),type:m.VC.FILE})}),folders:v.folders.map(a=>(0,h.Z)((0,h.Z)({},a),{},{type:m.VC.FOLDER}))};return d.uploadCacheService.setItem(p,i),i})()}createDirectory(p){var d=this;return(0,s.Z)(function*(){const f=(yield d.graphqlService.mutate({mutation:_.xj,variables:d.loginAsService.prepareGqlPayload({target:p.join("/")})})).data.uploadEntitiesCreateDirectoryToken;return yield d.sendRequest(f)})()}moveRenameEntity(p,d,f,I){var v=this;return(0,s.Z)(function*(){I||(I=f);const R=(yield v.graphqlService.mutate({mutation:_.jt,variables:v.loginAsService.prepareGqlPayload({source:(p.length?"".concat(p.join("/"),"/"):"")+f,target:(d.length?"".concat(d.join("/"),"/"):"")+I})})).data.uploadEntitiesMoveToken,i=yield v.sendRequest(R);return(0,h.Z)((0,h.Z)({},i),{},{time:1e3*i.time})})()}deleteEntity(p,d){var f=this;return(0,s.Z)(function*(){const I=(yield f.graphqlService.mutate({mutation:_.pf,variables:f.loginAsService.prepareGqlPayload({target:(p.length?"".concat(p.join("/"),"/"):"")+d})})).data.uploadEntitiesDeleteToken;return yield f.sendRequest(I),!0})()}getHostToken(p,d,f){var I=this;return(0,s.Z)(function*(){var v;return(null===(v=(yield I.graphqlService.query({query:_.oT,variables:I.loginAsService.prepareGqlPayload({allowReplace:f,target:(p.length?"".concat(p.join("/"),"/"):"")+d})})).data)||void 0===v?void 0:v.uploadEntitiesHostToken)||void 0})()}sendRequest(p){var d=this;return(0,s.Z)(function*(){return(yield(0,l.z)(d.http.post(P.ql,JSON.stringify({payload:p}),{headers:{"Content-Type":"application/json"}}))).success})()}subscribeForChanges(p){var d=this;return(0,s.Z)(function*(){return yield d.graphqlService.subscribe({query:_.vJ,variables:d.loginAsService.prepareGqlPayload()},f=>{var I;if(null===(I=f.data)||void 0===I||!I.uploadEntities)return;const v=JSON.parse(f.data.uploadEntities.eventMessage);!v.payload.customHeaders||!(0,o.o8)(v.payload.customHeaders,o._3.UUID)||v.payload.customHeaders[o._3.UUID]===d.getGqlIdHeader()||p({type:f.data.uploadEntities.eventType,message:v})})})()}}return(y=A).\u0275fac=function(p){return new(p||y)(e.LFG(o.Jk),e.LFG(M.B),e.LFG(u.p),e.LFG(r.eN),e.LFG(U.D))},y.\u0275prov=e.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),A})()},9054:(C,D,n)=>{n.d(D,{$H:()=>p,JN:()=>r,LZ:()=>S,Lv:()=>P,Or:()=>x,Tb:()=>_,g0:()=>R,g8:()=>v,jL:()=>A,kl:()=>m,lY:()=>u,ok:()=>f,rQ:()=>I,rc:()=>d,zO:()=>M});var h=n(1413),s=n(5861),o=n(5172),l=n(1990);function m(i){return t.apply(this,arguments)}function t(){return t=(0,s.Z)(function*(i){return new Promise((a,g)=>{const E=new FileReader;E.onload=function(){var L=(0,s.Z)(function*(O){if(O.target&&O.target.result){const T=new Uint8Array(O.target.result),F=yield crypto.subtle.digest("SHA-256",T),B=Array.from(new Uint8Array(F)).map($=>$.toString(16).padStart(2,"0")).join("");a(B)}else g(new Error("Failed to read file."))});return function(O){return L.apply(this,arguments)}}(),E.onerror=L=>{g(L)},E.readAsArrayBuffer(i)})}),t.apply(this,arguments)}function _(i){let a=i;if(i.indexOf("/")>-1){const O=i.split("/");a=O[O.length-1]}const g=a.replace(/\?.*$/,"").split("."),E=g.length>1?g[g.length-1].toLowerCase():"",L=decodeURIComponent(g.slice(0,-1).join("."));return{ext:E,filename:L,name:E?"".concat(L,".").concat(E):""}}function M(i,a={}){const g=_(i),E=Date.now();return(0,h.Z)({name:g.name,size:0,time:E,url:i,ext:g.ext,filename:g.filename,isImage:x(g.ext),embedUrl:"".concat(i,"?t=").concat(E),type:o.VC.FILE},a)}function P(i){let a=i;a.endsWith("/")&&(a=a.slice(0,-1));const g=a.split("/");return{name:decodeURIComponent(g[g.length-1])}}function u(i){return{name:P(i).name,url:i,type:o.VC.FOLDER}}function c(i){return e.apply(this,arguments)}function e(){return(e=(0,s.Z)(function*(i){const a=new FileReader,g=new Promise(E=>a.addEventListener("load",()=>E(a.result)));return a.readAsDataURL(i),g})).apply(this,arguments)}function r(i){return U.apply(this,arguments)}function U(){return(U=(0,s.Z)(function*(i){const a=new DataView(yield i.arrayBuffer());if(2303741511===a.getUint32(0)&&218765834===a.getUint32(4)){if(-1===[4,6].indexOf(a.getUint8(25)))return!1;const E=Object.assign(new Image,{src:yield c(i)});yield new Promise(T=>E.addEventListener("load",()=>T(!0)));const L=Object.assign(document.createElement("canvas"),{width:E.width,height:E.height}).getContext("2d");if(!L)return!1;L.imageSmoothingEnabled=!1,L.drawImage(E,0,0);const O=null==L?void 0:L.getImageData(0,0,E.width,E.height);if(O)for(let T=0;T<O.data.length;T+=4)if(O.data[T+3]<255)return!0}return!1})).apply(this,arguments)}function S(i){return y.apply(this,arguments)}function y(){return(y=(0,s.Z)(function*(i){const a=Object.assign(new Image,{src:yield c(i)});return yield new Promise(g=>a.addEventListener("load",()=>g(!0))),a})).apply(this,arguments)}function A(i){return i.map(a=>({name:a.name,ext:a.ext,type:o.VC.FILE,url:a.url,embedUrl:a.embedUrl,isImage:a.isImage}))}function x(i,a=[]){return["png","apng","jpeg","jpg","jpe","gif","svg","webp"].includes(i)&&!a.includes(i)}function p(i){return x(i,["gif","svg"])}function d(i,a,g,E=[],L=""){const O=(0,h.Z)({},l.uJ),T=i.trim();O.invalidLength=0===T.length;const F=(T+L).replace(/\s{2,}/g," ");return O.alreadyUsed=a!==T&&E.includes(F),O.invalidStartOrEnd=/(^(\s|\.))|((\s|\.)$)/.test(i),O.invalidCharacter=!(g===o.VC.FILE?l.JJ.test(i):l.b3.test(i)),O}function f(i,a){return i.join("/")===a.join("/")}function I(i){const a=[],g=[];for(const E of i)E.type===o.VC.FILE?a.push(E):g.push(E);return{[o.VC.FILE]:a,[o.VC.FOLDER]:g}}function v(i,a){return a.find(g=>-1!==g.ext.indexOf(i))}function R(i,a,g){return a=a||_(i.name),{file:{name:i.name,size:i.size,time:0,url:"",ext:a.ext,filename:a.filename,isImage:x(a.ext),embedUrl:"",type:o.VC.FILE},metadata:g,progress:0,completed:!1}}},4004:(C,D,n)=>{n.d(D,{Z:()=>c});const s={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let o;const l=new Uint8Array(16);function m(){if(!o&&(o=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!o))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(l)}const t=[];for(let e=0;e<256;++e)t.push((e+256).toString(16).slice(1));const c=function u(e,r,U){if(s.randomUUID&&!r&&!e)return s.randomUUID();const S=(e=e||{}).random||(e.rng||m)();if(S[6]=15&S[6]|64,S[8]=63&S[8]|128,r){U=U||0;for(let y=0;y<16;++y)r[U+y]=S[y];return r}return function _(e,r=0){return t[e[r+0]]+t[e[r+1]]+t[e[r+2]]+t[e[r+3]]+"-"+t[e[r+4]]+t[e[r+5]]+"-"+t[e[r+6]]+t[e[r+7]]+"-"+t[e[r+8]]+t[e[r+9]]+"-"+t[e[r+10]]+t[e[r+11]]+t[e[r+12]]+t[e[r+13]]+t[e[r+14]]+t[e[r+15]]}(S)}}}]);