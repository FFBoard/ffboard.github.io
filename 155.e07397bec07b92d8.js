"use strict";(self.webpackChunkpages=self.webpackChunkpages||[]).push([[155],{2155:(le,v,a)=>{a.r(v),a.d(v,{UploadWidgetModule:()=>ne});var E=a(4190),T=a(4243),p=a(6814),x=a(578),_=a(8726),f=a(9515),S=a(529),b=a(469),e=a(9212);let M=(()=>{var n;class s{}return(n=s).\u0275fac=function(l){return new(l||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[T.r,p.ez,x.q,_.lQ,f.aw.forChild(),S.M,b.n]}),s})();var u=a(5861);const P=[{size:0,selected:!0,text:"Default"},{size:800,selected:!1,text:""},{size:600,selected:!1,text:""},{size:400,selected:!1,text:""},{size:200,selected:!1,text:""},{size:100,selected:!1,text:""}].map(n=>(n.size&&(n.text="".concat(n.size,"px")),n));var A=a(1410),g=a(4020),h=a(148),L=a(9093),Z=a(2721),y=a(3845),D=a(4887),I=a(5487),C=a(658),O=a(7165),J=a(9344),k=a(5851),R=a(4733);let U=(()=>{var n;class s{constructor(){this.selected=!1,this.value="",this.text="",this.classes=["p-2"],this.clickEvent=new e.vpe}}return(n=s).\u0275fac=function(l){return new(l||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-collapse-button"]],inputs:{selected:"selected",value:"value",text:"text",classes:"classes"},outputs:{clickEvent:"clickEvent"},decls:1,vars:4,consts:[["role","button",1,"rounded","text-reset","m-1","d-block",3,"ngClass","innerHTML","click"]],template:function(l,t){1&l&&(e.TgZ(0,"a",0),e.NdJ("click",function(){return t.clickEvent.emit(t.value)}),e.qZA()),2&l&&(e.ekj("selected",t.selected),e.Q6J("ngClass",t.classes)("innerHTML",t.text,e.oJD))},dependencies:[p.mk],styles:["a[_ngcontent-%COMP%]{transition:background-color .2s;-webkit-user-select:none;-moz-user-select:none;user-select:none}a.selected[_ngcontent-%COMP%]{background-color:#dae0ff}"]}),s})();var B=a(9473),z=a(4228);const W=n=>({url:n});function N(n,s){if(1&n&&(e.TgZ(0,"div",4)(1,"p",5),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"p",6),e.ALo(5,"translate"),e.qZA()),2&n){const o=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"ROUTES.WIDGETS.UPLOAD.NO_FOLDER")," "),e.xp6(2),e.Q6J("innerHTML",e.xi3(5,4,"ROUTES.WIDGETS.UPLOAD.CREATE_FOLDER",e.VKq(7,W,o.fileManagerUrl)),e.oJD)}}function Q(n,s){1&n&&(e.TgZ(0,"li"),e._UZ(1,"app-loader",10),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(),e.Q6J("onlyMessage",!0)("message",e.lcZ(2,2,"ROUTES.WIDGETS.UPLOAD.LOADING_FOLDERS")))}const G=()=>["fst-italic","p-1"];function w(n,s){if(1&n){const o=e.EpF();e.TgZ(0,"li")(1,"app-collapse-button",13),e.NdJ("clickEvent",function(t){e.CHM(o);const i=e.oxw(3);return e.KtG(i.folderClickEvent(t))}),e.ALo(2,"translate"),e.qZA()()}2&n&&(e.xp6(),e.Q6J("text",e.lcZ(2,2,"SHARED.BACK"))("classes",e.DdM(4,G)))}const H=()=>["p-1"];function j(n,s){if(1&n){const o=e.EpF();e.TgZ(0,"li")(1,"app-collapse-button",14),e.NdJ("clickEvent",function(t){e.CHM(o);const i=e.oxw(3);return e.KtG(i.folderClickEvent(t))}),e.qZA()()}if(2&n){const o=s.$implicit;e.xp6(),e.Q6J("classes",e.DdM(3,H))("text",o.name)("value",o.name)}}function $(n,s){if(1&n&&e.YNc(0,w,3,5,"li",11)(1,j,2,4,"li",12),2&n){const o=e.oxw(2);e.Q6J("ngIf",o.depth),e.xp6(),e.Q6J("ngForOf",o.folders)}}function Y(n,s){if(1&n&&(e.TgZ(0,"ul",7),e.YNc(1,Q,3,4,"li",8)(2,$,2,2,"ng-template",null,9,e.W1O),e.qZA()),2&n){const o=e.MAs(3),l=e.oxw();e.xp6(),e.Q6J("ngIf",l.loading)("ngIfElse",o)}}let K=(()=>{var n;class s{constructor(l){this.uploadService=l,this.currentFolderPath=[],this.firstOpened=!1,this.fileManagerUrl="",this.clickEvent=new e.vpe,this.loading=!0,this.folders=[],this.depth=0}ngOnInit(){this.depth=this.currentFolderPath.length}ngOnChanges(l){var t=this;return(0,u.Z)(function*(){l.firstOpened&&!l.firstOpened.firstChange&&t.firstOpened&&(yield t.getFolders(t.currentFolderPath,!0))})()}folderClickEvent(l){var t=this;return(0,u.Z)(function*(){const i=l.length?[...t.currentFolderPath,l]:t.currentFolderPath.slice(0,-1);t.clickEvent.emit(i),yield t.getFolders(i)})()}getFolders(l,t=!1){var i=this;return(0,u.Z)(function*(){i.loading&&!t||(i.loading=!0,i.depth=l.length,i.folders=(yield i.uploadService.getFileList(l)).folders.sort((r,d)=>r.name.localeCompare(d.name)),i.loading=!1)})()}}return(n=s).\u0275fac=function(l){return new(l||n)(e.Y36(C.C))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-folder-list"]],inputs:{currentFolderPath:"currentFolderPath",firstOpened:"firstOpened",fileManagerUrl:"fileManagerUrl"},outputs:{clickEvent:"clickEvent"},features:[e.TTD],decls:8,vars:9,consts:[[1,"small","text-center","mt-3","mb-2","text-muted"],[1,"text-break","text-primary",3,"innerText"],["class","alert alert-primary mb-2 p-2",4,"ngIf","ngIfElse"],["list",""],[1,"alert","alert-primary","mb-2","p-2"],[1,"text-center","fw-bold","mb-0"],[1,"text-center","small","mb-0",3,"innerHTML"],[1,"list-unstyled","mb-0","d-flex","flex-wrap","small","justify-content-center","folder-list"],[4,"ngIf","ngIfElse"],["content",""],[1,"d-block",3,"onlyMessage","message"],[4,"ngIf"],[4,"ngFor","ngForOf"],["value","",1,"d-block",3,"text","classes","clickEvent"],[1,"d-block",3,"classes","text","value","clickEvent"]],template:function(l,t){if(1&l&&(e.TgZ(0,"div",0),e._uU(1),e.ALo(2,"translate"),e._UZ(3,"em",1),e.ALo(4,"arrayJoin"),e.qZA(),e.YNc(5,N,6,9,"div",2)(6,Y,4,2,"ng-template",null,3,e.W1O)),2&l){const i=e.MAs(7);e.xp6(),e.hij(" ",e.lcZ(2,4,"ROUTES.WIDGETS.UPLOAD.CURRENT_PATH")," "),e.xp6(2),e.Q6J("innerText",t.currentFolderPath.length?e.xi3(4,6,t.currentFolderPath,"/"):"root"),e.xp6(2),e.Q6J("ngIf",0===t.folders.length&&0===t.depth&&!t.loading)("ngIfElse",i)}},dependencies:[p.sg,p.O5,B.R,U,z.J,f.X$],styles:[".folder-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{height:37px;display:flex;align-items:center}"]}),s})();function X(n,s){if(1&n){const o=e.EpF();e.TgZ(0,"li")(1,"app-collapse-button",16),e.NdJ("clickEvent",function(t){e.CHM(o);const i=e.oxw();return e.KtG(i.selectDimension(t))}),e.qZA()()}if(2&n){const o=s.$implicit;e.xp6(),e.Q6J("text",o.text)("selected",o.selected)("value",o.size)}}function V(n,s){if(1&n&&e._UZ(0,"app-upload-no-storage-advice",17),2&n){const o=e.oxw();e.Q6J("storageToFree",o.userStorage.used-o.userStorage.max)("compact",!0)("adviceUrl",o.fileManagerUrl)}}const q=(n,s)=>({"touch-device":n,uploading:s}),F=n=>({expanded:n});let ee=(()=>{var n;class s{constructor(l,t,i,r,d,c){var m;this.uploadService=l,this.uploadObservablesService=t,this.uploaderService=i,this.loadingBarService=r,this.postMessageService=d,this.globalsService=c,this.touchDevice=g.b1,this.isSizeCollapsed=!0,this.isSizeButtonExpanded=!1,this.isFolderCollapsed=!0,this.isFolderButtonExpanded=!1,this.isFolderButtonFirstClicked=!0,this.dimensions=P,this.currentFolderPath=[],this.isUploading=!1,g.II&&this.loadingBarService.useRef("http").disable(),this.fileManagerUrl="".concat(Z.y1).concat(O.B2.UPLOAD,"?").concat(O.RT.PROFILE,"=").concat(null===(m=this.globalsService.credentials)||void 0===m?void 0:m.site.short)}ngOnInit(){var l=this;return(0,u.Z)(function*(){l.uploadService.setGqlIdHeader(),l.currentFolderPath=l.uploadService.preferences.lastFolderPath,l.uploadingSubscription=l.uploadObservablesService.uploadingFileQueueObservable.subscribe(t=>{l.isUploading=t.length>0}),l.uploadingErrorSubscription=l.uploadObservablesService.uploadingFileErrorObservable.subscribe(t=>{l.postMessageService.send(h.l.UPLOAD_ERROR,{filename:t.file.name,error:y.S.UPLOAD_FAILED})}),l.userStorage=yield l.uploadService.getUserStorage()})()}toggleCollapse(l,t,i){if(i)return void l.toggle();const r=t.hidden.subscribe(()=>{r.unsubscribe(),l.toggle()});t.toggle()}selectDimension(l){for(const i of this.dimensions)i.selected=i.size===l;const t=this.uploaderService.uploaderOptions;l?(t.compress=!0,t.imageDimensions={width:l}):delete t.imageDimensions,this.uploaderService.uploaderOptions=t}setFolderPath(l){this.currentFolderPath=[...l],this.postMessageService.send(h.l.UPLOAD_NAVIGATION,{paths:l}),g.II||(this.uploadService.preferences.lastFolderPath=[...l])}closeAllCollapse(){this.isFolderCollapsed=this.isSizeCollapsed=!0}uploadedEvent(l){g.II||(this.uploadService.cache.removeItem(l.destPath),this.uploadObservablesService.pushUploadedFile(l.list))}ngOnDestroy(){var l,t;null===(l=this.uploadingSubscription)||void 0===l||l.unsubscribe(),null===(t=this.uploadingErrorSubscription)||void 0===t||t.unsubscribe(),this.uploadService.removeGqlIdHeader()}}return(n=s).\u0275fac=function(l){return new(l||n)(e.Y36(C.C),e.Y36(I.r),e.Y36(D.q),e.Y36(J.dL),e.Y36(L.F),e.Y36(A.d))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-upload-widget"]],decls:30,vars:40,consts:[[1,"flex-grow-1","rounded-0","position-relative","w-cont","mw-100","d-flex","flex-column",3,"ngClass"],[1,"d-flex","buttons","align-items-stretch","justify-content-center","overflow-hidden","small"],["target","_blank",3,"href"],[1,"long"],[1,"short"],[1,"border-start","border-end",3,"ngClass","click"],[3,"ngClass","click"],[1,"c-collapse","position-absolute","w-100","bg-white","border-bottom",3,"ngbCollapse","ngbCollapseChange","shown","hidden"],["sizeCollapse","ngbCollapse"],[1,"px-2","py-1","border-top","c-content"],[1,"list-unstyled","mb-0","d-flex","flex-wrap","small","justify-content-center"],[4,"ngFor","ngForOf"],["folderCollapse","ngbCollapse"],[1,"d-block",3,"currentFolderPath","firstOpened","fileManagerUrl","clickEvent"],[1,"d-flex","align-items-stretch","flex-grow-1",3,"loading","isWidget","currentFolderPath","disabled","disabledLoading","click","fileUploadedEvent"],[3,"storageToFree","compact","adviceUrl",4,"ngIf"],[3,"text","selected","value","clickEvent"],[3,"storageToFree","compact","adviceUrl"]],template:function(l,t){if(1&l){const i=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"a",2)(3,"span",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"span",4),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"div",5),e.NdJ("click",function(){e.CHM(i);const d=e.MAs(20),c=e.MAs(25);return e.KtG(t.toggleCollapse(d,c,t.isFolderCollapsed))}),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",6),e.NdJ("click",function(){e.CHM(i);const d=e.MAs(25),c=e.MAs(20);return t.isFolderButtonFirstClicked=!1,e.KtG(t.toggleCollapse(d,c,t.isSizeCollapsed))}),e.TgZ(13,"span",3),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"span",4),e._uU(17),e.ALo(18,"translate"),e.qZA()()(),e.TgZ(19,"div",7,8),e.NdJ("ngbCollapseChange",function(d){return t.isSizeCollapsed=d})("shown",function(){return t.isSizeButtonExpanded=!0})("hidden",function(){return t.isSizeButtonExpanded=!1}),e.TgZ(21,"div",9)(22,"ul",10),e.YNc(23,X,2,3,"li",11),e.qZA()()(),e.TgZ(24,"div",7,12),e.NdJ("ngbCollapseChange",function(d){return t.isFolderCollapsed=d})("shown",function(){return t.isFolderButtonExpanded=!0})("hidden",function(){return t.isFolderButtonExpanded=!1}),e.TgZ(26,"div",9)(27,"app-folder-list",13),e.NdJ("clickEvent",function(d){return t.setFolderPath(d)}),e.qZA()()(),e.TgZ(28,"app-uploader",14),e.NdJ("click",function(){return t.closeAllCollapse()})("fileUploadedEvent",function(d){return t.uploadedEvent(d)}),e.qZA(),e.YNc(29,V,1,3,"app-upload-no-storage-advice",15),e.qZA()}2&l&&(e.Q6J("ngClass",e.WLB(33,q,t.touchDevice,t.isUploading)),e.xp6(2),e.Q6J("href",t.fileManagerUrl,e.LSH),e.xp6(2),e.Oqu(e.lcZ(5,23,"ROUTES.WIDGETS.UPLOAD.FILE_MANAGER.LONG")),e.xp6(3),e.Oqu(e.lcZ(8,25,"ROUTES.WIDGETS.UPLOAD.FILE_MANAGER.SHORT")),e.xp6(2),e.Q6J("ngClass",e.VKq(36,F,!t.isSizeCollapsed||t.isSizeButtonExpanded)),e.uIk("aria-expanded",!t.isSizeCollapsed),e.xp6(),e.hij(" ",e.lcZ(11,27,"ROUTES.WIDGETS.UPLOAD.SIZE")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(38,F,!t.isFolderCollapsed||t.isFolderButtonExpanded)),e.uIk("aria-expanded",!t.isFolderCollapsed),e.xp6(2),e.Oqu(e.lcZ(15,29,"ROUTES.WIDGETS.UPLOAD.SELECT_FOLDER.LONG")),e.xp6(3),e.Oqu(e.lcZ(18,31,"ROUTES.WIDGETS.UPLOAD.SELECT_FOLDER.SHORT")),e.xp6(2),e.Q6J("ngbCollapse",t.isSizeCollapsed),e.xp6(4),e.Q6J("ngForOf",t.dimensions),e.xp6(),e.Q6J("ngbCollapse",t.isFolderCollapsed),e.xp6(3),e.Q6J("currentFolderPath",t.currentFolderPath)("firstOpened",!t.isFolderButtonFirstClicked)("fileManagerUrl",t.fileManagerUrl),e.xp6(),e.Q6J("loading",!1)("isWidget",!0)("currentFolderPath",t.currentFolderPath)("disabled",(null==t.userStorage?null:t.userStorage.exceeded)||!1)("disabledLoading",!t.userStorage),e.xp6(),e.Q6J("ngIf",t.userStorage&&t.userStorage.exceeded))},dependencies:[p.mk,p.sg,p.O5,_._D,k.B,R.P,U,K,f.X$],styles:["[_nghost-%COMP%]{display:flex;align-items:stretch;justify-content:center;background:#fff;flex-grow:1}.uploading[_ngcontent-%COMP%], .uploading[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{pointer-events:none!important}.buttons[_ngcontent-%COMP%]{height:40px}.buttons[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1 1 0;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:color .2s;color:var(--bs-gray-600)}.buttons[_ngcontent-%COMP%]   .expanded[_ngcontent-%COMP%]{background:#fff;z-index:2;color:inherit}.w-cont[_ngcontent-%COMP%]:not(.touch-device)   .buttons[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:hover{color:inherit}.c-collapse[_ngcontent-%COMP%]{top:39px;left:0;z-index:1;max-height:calc(100% - 50px)}.c-collapse.collapsing[_ngcontent-%COMP%], .c-collapse.show[_ngcontent-%COMP%]{display:flex;flex-direction:column}.c-collapse[_ngcontent-%COMP%]:not(.collapsing)   .c-content[_ngcontent-%COMP%]{overflow-y:auto}.c-collapse.collapsing[_ngcontent-%COMP%]   .c-content[_ngcontent-%COMP%]{overflow:hidden}.long[_ngcontent-%COMP%]{display:none}@media (min-width: 400px){.short[_ngcontent-%COMP%]{display:none}.long[_ngcontent-%COMP%]{display:inline}}"]}),s})();const te=[{path:"",component:(()=>{var n;class s{}return(n=s).\u0275fac=function(l){return new(l||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(l,t){1&l&&e._UZ(0,"app-upload-widget")},dependencies:[ee],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex-grow:1}"]}),s})()}];let ne=(()=>{var n;class s{}return(n=s).\u0275fac=function(l){return new(l||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[E.Bz.forChild(te),M]}),s})()}}]);