"use strict";(self.webpackChunkpages=self.webpackChunkpages||[]).push([[995],{4041:(R,D,n)=>{n.d(D,{C:()=>u});var h=n(6814),s=n(9212);let u=(()=>{var _;class f{}return(_=f).\u0275fac=function(p){return new(p||_)},_.\u0275mod=s.oAB({type:_}),_.\u0275inj=s.cJS({imports:[h.ez]}),f})()},9010:(R,D,n)=>{n.d(D,{b:()=>u});var h=n(8863),s=n(9212);let u=(()=>{var _;class f{transform(p,M=2){return(0,h.t)(p,M)}}return(_=f).\u0275fac=function(p){return new(p||_)},_.\u0275pipe=s.Yjl({name:"formatBytes",type:_,pure:!0}),f})()},8863:(R,D,n)=>{n.d(D,{t:()=>s});var h=n(2641);function s(u,_=2){if(!+u)return"0 Bytes";let f=!1;u<0&&(f=!0,u=Math.abs(u));const p=_<0?0:_,P=Math.floor(Math.log(u)/Math.log(1024));return"".concat(f?"-":"").concat((0,h.o)(parseFloat((u/Math.pow(1024,P)).toFixed(p)))," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][P])}},5172:(R,D,n)=>{n.d(D,{In:()=>h,Ky:()=>f,VC:()=>s,c5:()=>_,gG:()=>u});var h=function(t){return t.FILE_SHOW_LINKS="fileLinks",t.FILE_EDIT="fileEdit",t.DELETE="delete",t.RENAME="rename",t.MOVE="move",t}(h||{}),s=function(t){return t.FILE="file",t.FOLDER="folder",t}(s||{}),u=function(t){return t.FILENAME="filename",t.SIZE="size",t.TIME="time",t.EXTENSION="ext",t}(u||{}),_=function(t){return t.GRID="grid",t.LIST="list",t}(_||{}),f=function(t){return t.W_768_I_1="(max-width: 767.98px)",t.W_933_I_2="(min-width: 768px) and (max-width: 933.98px)",t.W_960_I_3="(min-width: 934px) and (max-width: 959.98px)",t.W_1226_I_2="(min-width: 960px) and (max-width: 1225.98px)",t.W_1540_I_3="(min-width: 1226px) and (max-width: 1539.98px)",t.W_1854_I_4="(min-width: 1540px) and (max-width: 1853.98px)",t.W_2168_I_5="(min-width: 1854px) and (max-width: 2167.98px)",t.W_2482_I_6="(min-width: 2168px) and (max-width: 2481.98px)",t.W_2796_I_7="(min-width: 2482px) and (max-width: 2795.98px)",t.W_3110_I_8="(min-width: 2796px) and (max-width: 3109.98px)",t.W_3424_I_9="(min-width: 3110px) and (max-width: 3423.98px)",t.W_3738_I_10="(min-width: 3424px)",t}(f||{})},1990:(R,D,n)=>{n.d(D,{JJ:()=>u,b3:()=>_,p$:()=>t,uJ:()=>f,vV:()=>s});var h=n(5172);const s={lastPath:[],layout:{asc:!0,orderBy:h.gG.FILENAME,type:h.c5.GRID},uploader:{checkImage:{time:0,active:!0},showLinkModal:!1}},u=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-.\s])*$/,_=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-\s])*$/,f={invalidLength:!1,alreadyUsed:!1,invalidStartOrEnd:!1,invalidCharacter:!1},t=2147483648},5983:(R,D,n)=>{n.d(D,{B:()=>t});var h=n(5172),s=n(2721),u=n(1410),_=n(9212),f=n(6779);let t=(()=>{var p;class M{constructor(c,o){this.globalsService=c,this.loginAsService=o,this.cache={},this.userStorage={},this.profileSubscription=this.globalsService.profileObservable.subscribe(e=>{this.profileFfuid=null==e?void 0:e.user.ffuid})}get ffuid(){var c;return(null===(c=this.loginAsService.profile)||void 0===c?void 0:c.ffuid)||this.profileFfuid}getFileLimits(){return this.fileLimits}setFileLimits(c){this.fileLimits=c}getUserStorage(){return this.ffuid?this.userStorage[this.ffuid]:void 0}setUserStorage(c){this.ffuid&&(this.userStorage[this.ffuid]=c)}deleteUserStorage(){this.ffuid&&delete this.userStorage[this.ffuid]}getItem(c){const o=this.createKey(c);if((0,s.o8)(this.cache,o))return this.cache[o]}setItem(c,o){this.cache[this.createKey(c)]=o}removeItem(c){const o=this.createKey(c);if((0,s.o8)(this.cache,o)){if(this.cache[o].folders.length)for(const e of this.cache[o].folders)this.removeItem([...c,e.name]);return delete this.cache[o],!0}return!1}getEntities(c,o){const e={},r=this.createKey(c);if(!(0,s.o8)(this.cache,r))return e;for(const U of o){const E=(U.type===h.VC.FILE?this.cache[r].files:this.cache[r].folders).find(S=>S.name===U.name);E&&(e[E.name]=E)}return e}addEntities(c,o,e=h.VC.FILE){const r=this.createKey(c);return!!(0,s.o8)(this.cache,r)&&(Array.isArray(o)||(o=[o]),e===h.VC.FILE?this.cache[r].files.unshift(...o):this.cache[r].folders.unshift(...o),!0)}removeEntities(c,o,e=h.VC.FILE){if(Array.isArray(o)||(o=[o]),e===h.VC.FOLDER)for(const S of o)this.removeItem([...c,S]);const r=this.createKey(c);if(!(0,s.o8)(this.cache,r))return[];const U=e===h.VC.FILE?"files":"folders",E=[];for(const S of o){const A=this.cache[r][U].findIndex(l=>l.name===S);A>-1&&(this.cache[r][U].splice(A,1),E.push(S))}return E}refactorFolderContent(c,o){const e=this.createKey(c);if(!(0,s.o8)(this.cache,e))return!1;o.endsWith("/")||(o+="/");for(const r of this.cache[e].folders)r.url=o+r.name;for(const r of this.cache[e].files)r.url=r.embedUrl=o+r.name,r.time=Date.now();return!0}createKey(c){return"".concat(this.ffuid,"/").concat(c.join("/"))}ngOnDestroy(){this.profileSubscription.unsubscribe()}}return(p=M).\u0275fac=function(c){return new(c||p)(_.LFG(u.d),_.LFG(f.D))},p.\u0275prov=_.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),M})()},5571:(R,D,n)=>{n.d(D,{He:()=>t,Jd:()=>o,Jv:()=>P,gZ:()=>M,jt:()=>_,oT:()=>s,pf:()=>f,t3:()=>p,vJ:()=>e,wm:()=>h,wo:()=>c,xj:()=>u});const h="\nquery UploadEntitiesListToken($target: String!, $targetUserId: String) {\n    uploadEntitiesListToken(target: $target, targetUserId: $targetUserId)\n}",s="\nquery UploadEntitiesHostToken($target: String!, $targetUserId: String, $allowReplace: Boolean) {\n    uploadEntitiesHostToken(target: $target, targetUserId: $targetUserId, allowReplace: $allowReplace)\n}",u="\nquery UploadEntitiesCreateDirectoryToken($target: String!, $targetUserId: String) {\n    uploadEntitiesCreateDirectoryToken(target: $target, targetUserId: $targetUserId)\n}",_="\nquery UploadEntitiesMoveToken($source: String!, $target: String!, $targetUserId: String) {\n    uploadEntitiesMoveToken(source: $source, target: $target, targetUserId: $targetUserId)\n}",f="\nquery UploadEntitiesDeleteToken($target: String!, $targetUserId: String) {\n    uploadEntitiesDeleteToken(target: $target, targetUserId: $targetUserId)\n}",t="\nquery UploadHistoryAvailableDateRange {\n    uploadHistoryAvailableDateRange {\n        start\n        end\n    }\n}",p="\nquery UploadEntitiesSizeToken($allowCompute: Boolean, $targetUserId: String) {\n    uploadEntitiesSizeToken(allowCompute: $allowCompute, targetUserId: $targetUserId)\n}",M="\nquery UploadEntitiesLimitsToken($targetUserId: String) {\n    uploadEntitiesLimitsToken(targetUserId: $targetUserId)\n}",P="\nquery UploadRemoteList {\n  uploadRemoteList {\n    address\n    id\n    lastUpdate\n    name\n  }\n}",c="\nmutation UploadRemoteUpsert($name: String, $address: String, $uploadRemoteUpsertId: String) {\n  uploadRemoteUpsert(name: $name, address: $address, id: $uploadRemoteUpsertId)\n}",o="\nmutation UploadRemoteDelete($uploadRemoteDeleteId: String!) {\n  uploadRemoteDelete(id: $uploadRemoteDeleteId)\n}",e="\nsubscription UploadEntities {\n    uploadEntities {\n        eventMessage\n        eventType\n        user {\n            avatar\n            host\n            id\n            nickname\n        }\n    }\n}"},446:(R,D,n)=>{n.d(D,{p:()=>M});var h=n(2721),s=n(7165),u=n(463),_=n(1990),f=n(2986),t=n(9212),p=n(6779);let M=(()=>{var P;class c{constructor(e,r,U){this.preferencesService=e,this.urlQueryParamsService=r,this.loginAsService=U;const E=this.urlQueryParamsService.getAndDeleteParam(s.RT.UPLOAD_PATH);E&&(this.lastFolderPath=E.split("/").filter(S=>S.length>0))}get preferences(){return this.preferencesService.getItem(s.Ye.UPLOAD)||_.vV}set preferences(e){this.preferencesService.setItem(s.Ye.UPLOAD,e)}get lastFolderPath(){return this.loginAsService.isActive?[]:(this.preferences.lastPath||_.vV.lastPath).filter(e=>e.length>0)}set lastFolderPath(e){if(this.loginAsService.isActive)return;const r=this.preferences;r.lastPath=e,this.preferences=r}get layoutOptions(){const e=_.vV.layout,r=this.preferences.layout;return r&&0===Object.keys(e).filter(U=>!(0,h.o8)(r,U)).length?r:e}set layoutOptions(e){const r=this.preferences;r.layout=e,this.preferences=r}get uploader(){const e=this.preferences.uploader||_.vV.uploader;return!e.checkImage.active&&Date.now()-e.checkImage.time>6048e5&&(e.checkImage.active=!0,this.uploader=e),(0,h.o8)(e,"showLinkModal")||(e.showLinkModal=!1),e}set uploader(e){const r=this.preferences;r.uploader=e,this.preferences=r}}return(P=c).\u0275fac=function(e){return new(e||P)(t.LFG(u.y),t.LFG(f.J),t.LFG(p.D))},P.\u0275prov=t.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),c})()},658:(R,D,n)=>{n.d(D,{C:()=>U});var h=n(1413),s=n(5861),u=n(2721),_=n(4036),f=n(5172),t=n(9054),p=n(5571),M=n(5983),P=n(446),c=n(4004),o=n(9212),e=n(9862),r=n(6779);let U=(()=>{var E;class S{constructor(l,d,g,v,y){this.graphqlService=l,this.uploadCacheService=d,this.uploadPreferencesService=g,this.http=v,this.loginAsService=y}get currentUploadEndpoint(){return"https://upload.forumfree.net/api/"}get cache(){return this.uploadCacheService}get preferences(){return this.uploadPreferencesService}setGqlIdHeader(){this.graphqlService.safeSetGlobalHeader(u._3.UUID,(0,c.Z)())}removeGqlIdHeader(){this.graphqlService.removeGlobalHeader(u._3.UUID)}getGqlIdHeader(){return this.graphqlService.getGlobalHeader(u._3.UUID)||""}getFileLimits(){var l=this;return(0,s.Z)(function*(){const d=l.cache.getFileLimits();if(d)return d;const g=(yield l.graphqlService.query({query:p.gZ,variables:l.loginAsService.prepareGqlPayload()})).data.uploadEntitiesLimitsToken,y=(yield l.sendRequest(g)).map(C=>({ext:C.extension,maxSize:C.size}));return l.cache.setFileLimits(y),y})()}getUserStorage(l=!1){var d=this;return(0,s.Z)(function*(){return l?yield d.requestUserStorage(!0):d.cache.getUserStorage()||(yield d.requestUserStorage())})()}flushUserStorage(){this.cache.deleteUserStorage()}requestUserStorage(l=!1){var d=this;return(0,s.Z)(function*(){const g=(yield d.graphqlService.query({query:p.t3,variables:d.loginAsService.prepareGqlPayload({allowCompute:l||void 0})})).data.uploadEntitiesSizeToken,v=yield d.sendRequest(g),y={used:v.used,max:v.limit,exceeded:v.exceeded};return d.cache.setUserStorage(y),y})()}getFileList(l){var d=this;return(0,s.Z)(function*(){const g=d.uploadCacheService.getItem(l);if(g)return g;const v=(yield d.graphqlService.query({query:p.wm,variables:d.loginAsService.prepareGqlPayload({target:l.join("/")})})).data.uploadEntitiesListToken,y=yield d.sendRequest(v),x={files:y.files.map(a=>{const i=(0,t.Tb)(a.url);return(0,h.Z)((0,h.Z)({},a),{time:1e3*a.time,filename:i.filename,ext:i.ext,isImage:(0,t.Or)(i.ext),embedUrl:"".concat(a.url,"?t=").concat(a.time),type:f.VC.FILE})}),folders:y.folders.map(a=>(0,h.Z)((0,h.Z)({},a),{},{type:f.VC.FOLDER}))};return d.uploadCacheService.setItem(l,x),x})()}createDirectory(l){var d=this;return(0,s.Z)(function*(){const g=(yield d.graphqlService.mutate({mutation:p.xj,variables:d.loginAsService.prepareGqlPayload({target:l.join("/")})})).data.uploadEntitiesCreateDirectoryToken;return yield d.sendRequest(g)})()}moveRenameEntity(l,d,g,v){var y=this;return(0,s.Z)(function*(){v||(v=g);const C=(yield y.graphqlService.mutate({mutation:p.jt,variables:y.loginAsService.prepareGqlPayload({source:(l.length?"".concat(l.join("/"),"/"):"")+g,target:(d.length?"".concat(d.join("/"),"/"):"")+v})})).data.uploadEntitiesMoveToken,x=yield y.sendRequest(C);return(0,h.Z)((0,h.Z)({},x),{},{time:1e3*x.time})})()}deleteEntity(l,d){var g=this;return(0,s.Z)(function*(){const v=(yield g.graphqlService.mutate({mutation:p.pf,variables:g.loginAsService.prepareGqlPayload({target:(l.length?"".concat(l.join("/"),"/"):"")+d})})).data.uploadEntitiesDeleteToken;return yield g.sendRequest(v),!0})()}getHostToken(l,d,g){var v=this;return(0,s.Z)(function*(){var y;return(null===(y=(yield v.graphqlService.query({query:p.oT,variables:v.loginAsService.prepareGqlPayload({allowReplace:g,target:(l.length?"".concat(l.join("/"),"/"):"")+d})})).data)||void 0===y?void 0:y.uploadEntitiesHostToken)||void 0})()}getRemotes(){var l=this;return(0,s.Z)(function*(){return(yield l.graphqlService.query({query:p.Jv})).data.uploadRemoteList})()}upsertRemote(l,d,g){var v=this;return(0,s.Z)(function*(){return(yield v.graphqlService.query({query:p.wo,variables:v.loginAsService.prepareGqlPayload({id:g,address:d,name:l})})).data.uploadRemoteUpsert})()}deleteRemote(l){var d=this;return(0,s.Z)(function*(){return(yield d.graphqlService.query({query:p.Jd,variables:d.loginAsService.prepareGqlPayload({id:l})})).data.uploadRemoteDelete})()}sendRequest(l){var d=this;return(0,s.Z)(function*(){return(yield(0,_.z)(d.http.post(d.currentUploadEndpoint,JSON.stringify({payload:l}),{headers:{"Content-Type":"application/json"}}))).success})()}subscribeForChanges(l){var d=this;return(0,s.Z)(function*(){return yield d.graphqlService.subscribe({query:p.vJ,variables:d.loginAsService.prepareGqlPayload()},g=>{var v;if(null===(v=g.data)||void 0===v||!v.uploadEntities)return;const y=JSON.parse(g.data.uploadEntities.eventMessage);!y.payload.customHeaders||!(0,u.o8)(y.payload.customHeaders,u._3.UUID)||y.payload.customHeaders[u._3.UUID]===d.getGqlIdHeader()||l({type:g.data.uploadEntities.eventType,message:y})})})()}}return(E=S).\u0275fac=function(l){return new(l||E)(o.LFG(u.Jk),o.LFG(M.B),o.LFG(P.p),o.LFG(e.eN),o.LFG(r.D))},E.\u0275prov=o.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),S})()},9054:(R,D,n)=>{n.d(D,{$H:()=>d,JN:()=>r,LZ:()=>E,Lv:()=>P,Or:()=>l,Tb:()=>p,g0:()=>x,g8:()=>C,jL:()=>A,kl:()=>f,lY:()=>c,ok:()=>v,rQ:()=>y,rc:()=>g,zO:()=>M});var h=n(1413),s=n(5861),u=n(5172),_=n(1990);function f(a){return t.apply(this,arguments)}function t(){return t=(0,s.Z)(function*(a){return new Promise((i,m)=>{const I=new FileReader;I.onload=function(){var L=(0,s.Z)(function*(O){if(O.target&&O.target.result){const T=new Uint8Array(O.target.result),F=yield crypto.subtle.digest("SHA-256",T),$=Array.from(new Uint8Array(F)).map(B=>B.toString(16).padStart(2,"0")).join("");i($)}else m(new Error("Failed to read file."))});return function(O){return L.apply(this,arguments)}}(),I.onerror=L=>{m(L)},I.readAsArrayBuffer(a)})}),t.apply(this,arguments)}function p(a){let i=a;if(a.indexOf("/")>-1){const O=a.split("/");i=O[O.length-1]}const m=i.replace(/\?.*$/,"").split("."),I=m.length>1?m[m.length-1].toLowerCase():"",L=decodeURIComponent(m.slice(0,-1).join("."));return{ext:I,filename:L,name:I?"".concat(L,".").concat(I):""}}function M(a,i={}){const m=p(a),I=Date.now();return(0,h.Z)({name:m.name,size:0,time:I,url:a,ext:m.ext,filename:m.filename,isImage:l(m.ext),embedUrl:"".concat(a,"?t=").concat(I),type:u.VC.FILE},i)}function P(a){let i=a;i.endsWith("/")&&(i=i.slice(0,-1));const m=i.split("/");return{name:decodeURIComponent(m[m.length-1])}}function c(a){return{name:P(a).name,url:a,type:u.VC.FOLDER}}function o(a){return e.apply(this,arguments)}function e(){return(e=(0,s.Z)(function*(a){const i=new FileReader,m=new Promise(I=>i.addEventListener("load",()=>I(i.result)));return i.readAsDataURL(a),m})).apply(this,arguments)}function r(a){return U.apply(this,arguments)}function U(){return(U=(0,s.Z)(function*(a){const i=new DataView(yield a.arrayBuffer());if(2303741511===i.getUint32(0)&&218765834===i.getUint32(4)){if(-1===[4,6].indexOf(i.getUint8(25)))return!1;const I=Object.assign(new Image,{src:yield o(a)});yield new Promise(T=>I.addEventListener("load",()=>T(!0)));const L=Object.assign(document.createElement("canvas"),{width:I.width,height:I.height}).getContext("2d");if(!L)return!1;L.imageSmoothingEnabled=!1,L.drawImage(I,0,0);const O=null==L?void 0:L.getImageData(0,0,I.width,I.height);if(O)for(let T=0;T<O.data.length;T+=4)if(O.data[T+3]<255)return!0}return!1})).apply(this,arguments)}function E(a){return S.apply(this,arguments)}function S(){return(S=(0,s.Z)(function*(a){const i=Object.assign(new Image,{src:yield o(a)});return yield new Promise(m=>i.addEventListener("load",()=>m(!0))),i})).apply(this,arguments)}function A(a){return a.map(i=>({name:i.name,ext:i.ext,type:u.VC.FILE,url:i.url,embedUrl:i.embedUrl,isImage:i.isImage}))}function l(a,i=[]){return["png","apng","jpeg","jpg","jpe","gif","svg","webp"].includes(a)&&!i.includes(a)}function d(a){return l(a,["gif","svg"])}function g(a,i,m,I=[],L=""){const O=(0,h.Z)({},_.uJ),T=a.trim();O.invalidLength=0===T.length;const F=(T+L).replace(/\s{2,}/g," ");return O.alreadyUsed=i!==T&&I.includes(F),O.invalidStartOrEnd=/(^(\s|\.))|((\s|\.)$)/.test(a),O.invalidCharacter=!(m===u.VC.FILE?_.JJ.test(a):_.b3.test(a)),O}function v(a,i){return a.join("/")===i.join("/")}function y(a){const i=[],m=[];for(const I of a)I.type===u.VC.FILE?i.push(I):m.push(I);return{[u.VC.FILE]:i,[u.VC.FOLDER]:m}}function C(a,i){return i.find(m=>-1!==m.ext.indexOf(a))}function x(a,i,m){return i=i||p(a.name),{file:{name:a.name,size:a.size,time:0,url:"",ext:i.ext,filename:i.filename,isImage:l(i.ext),embedUrl:"",type:u.VC.FILE},metadata:m,progress:0,completed:!1}}},4004:(R,D,n)=>{n.d(D,{Z:()=>o});const s={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let u;const _=new Uint8Array(16);function f(){if(!u&&(u=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!u))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return u(_)}const t=[];for(let e=0;e<256;++e)t.push((e+256).toString(16).slice(1));const o=function c(e,r,U){if(s.randomUUID&&!r&&!e)return s.randomUUID();const E=(e=e||{}).random||(e.rng||f)();if(E[6]=15&E[6]|64,E[8]=63&E[8]|128,r){U=U||0;for(let S=0;S<16;++S)r[U+S]=E[S];return r}return function p(e,r=0){return t[e[r+0]]+t[e[r+1]]+t[e[r+2]]+t[e[r+3]]+"-"+t[e[r+4]]+t[e[r+5]]+"-"+t[e[r+6]]+t[e[r+7]]+"-"+t[e[r+8]]+t[e[r+9]]+"-"+t[e[r+10]]+t[e[r+11]]+t[e[r+12]]+t[e[r+13]]+t[e[r+14]]+t[e[r+15]]}(E)}}}]);