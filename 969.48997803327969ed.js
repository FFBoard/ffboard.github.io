(self.webpackChunkboard=self.webpackChunkboard||[]).push([[969],{9969:(V,F,t)=>{"use strict";t.d(F,{R:()=>f});class f{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(e){Object.keys(e).filter(x=>x in this).forEach(x=>this[x]=e[x]),this.validateOptions()}setOptionsFromChanges(e){Object.keys(e).filter(x=>x in this).forEach(x=>this[x]=e[x].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}},2020:(V,F,t)=>{"use strict";t.d(F,{y:()=>s});var f=t(5861);var C=t(4650);let s=(()=>{class g{constructor(){this.autoRotateSupported=function e(){return new Promise(g=>{const U=new Image;U.onload=()=>{g(1===U.width&&2===U.height)},U.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(i,O){return new Promise((c,M)=>{const l=new FileReader;l.onload=m=>{this.loadImage(m.target.result,i.type,O).then(c).catch(M)},l.readAsDataURL(i)})}loadImage(i,O,c){return this.isValidImageType(O)?this.loadBase64Image(i,c):Promise.reject(new Error("Invalid image type"))}isValidImageType(i){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(i)}loadImageFromURL(i,O){return new Promise((c,M)=>{const l=new Image;l.onerror=()=>M,l.onload=()=>{const m=document.createElement("canvas"),D=m.getContext("2d");m.width=l.width,m.height=l.height,D?.drawImage(l,0,0),this.loadBase64Image(m.toDataURL(),O).then(c)},l.crossOrigin="anonymous",l.src=i})}loadBase64Image(i,O){return new Promise((c,M)=>{const l=new Image;l.onload=()=>c({originalImage:l,originalBase64:i}),l.onerror=M,l.src=i}).then(c=>this.transformImageBase64(c,O))}transformImageBase64(i,O){var c=this;return(0,f.Z)(function*(){const M=yield c.autoRotateSupported,l=yield function x(g){switch("string"==typeof g&&(g=function L(g){const U=new DataView(function d(g){g=g.replace(/^data\:([^\;]+)\;base64,/gim,"");const U=atob(g),i=U.length,O=new Uint8Array(i);for(let c=0;c<i;c++)O[c]=U.charCodeAt(c);return O.buffer}(g));if(65496!==U.getUint16(0,!1))return-2;const i=U.byteLength;let O=2;for(;O<i;){if(U.getUint16(O+2,!1)<=8)return-1;const c=U.getUint16(O,!1);if(O+=2,65505==c){if(1165519206!==U.getUint32(O+=2,!1))return-1;const M=18761==U.getUint16(O+=6,!1);O+=U.getUint32(O+4,M);const l=U.getUint16(O,M);O+=2;for(let m=0;m<l;m++)if(274==U.getUint16(O+12*m,M))return U.getUint16(O+12*m+8,M)}else{if(65280!=(65280&c))break;O+=U.getUint16(O,!1)}}return-1}(g)),g){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(M?-1:i.originalBase64);return i.originalImage&&i.originalImage.complete?c.transformLoadedImage({original:{base64:i.originalBase64,image:i.originalImage,size:{width:i.originalImage.naturalWidth,height:i.originalImage.naturalHeight}},exifTransform:l},O):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(i,O){var c=this;return(0,f.Z)(function*(){const M=O.canvasRotation+i.exifTransform.rotate,l={width:i.original.image.naturalWidth,height:i.original.image.naturalHeight};if(0===M&&!i.exifTransform.flip&&!O.containWithinAspectRatio)return{original:{base64:i.original.base64,image:i.original.image,size:{...l}},transformed:{base64:i.original.base64,image:i.original.image,size:{...l}},exifTransform:i.exifTransform};const m=c.getTransformedSize(l,i.exifTransform,O),D=document.createElement("canvas");D.width=m.width,D.height=m.height;const W=D.getContext("2d");W?.setTransform(i.exifTransform.flip?-1:1,0,0,1,D.width/2,D.height/2),W?.rotate(Math.PI*(M/2)),W?.drawImage(i.original.image,-l.width/2,-l.height/2);const _=D.toDataURL(),v=yield c.loadImageFromBase64(_);return{original:{base64:i.original.base64,image:i.original.image,size:{...l}},transformed:{base64:_,image:v,size:{width:v.width,height:v.height}},exifTransform:i.exifTransform}})()}loadImageFromBase64(i){return new Promise((O,c)=>{const M=new Image;M.onload=()=>O(M),M.onerror=c,M.src=i})}getTransformedSize(i,O,c){const M=c.canvasRotation+O.rotate;if(c.containWithinAspectRatio){if(M%2){const m=i.height/c.aspectRatio;return{width:Math.max(i.height,i.width*c.aspectRatio),height:Math.max(i.width,m)}}{const m=i.width/c.aspectRatio;return{width:Math.max(i.width,i.height*c.aspectRatio),height:Math.max(i.height,m)}}}return M%2?{height:i.width,width:i.height}:{width:i.width,height:i.height}}}return g.\u0275fac=function(i){return new(i||g)},g.\u0275prov=C.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},8896:(V,F,t)=>{"use strict";function f(w){const e=w.split(","),x=e[0].replace("data:","").replace(";base64",""),L=atob(e[1]),d=new ArrayBuffer(L.length),C=new Uint8Array(d);for(let s=0;s<L.length;s+=1)C[s]=L.charCodeAt(s);return new Blob([d],{type:x})}t.d(F,{L:()=>f})},8694:(V,F,t)=>{"use strict";t.d(F,{r:()=>e});var f=t(6895),w=t(4650);let e=(()=>{class x{}return x.\u0275fac=function(d){return new(d||x)},x.\u0275mod=w.oAB({type:x}),x.\u0275inj=w.cJS({imports:[f.ez]}),x})()},8212:(V,F,t)=>{"use strict";t.d(F,{J:()=>w});var f=t(4650);let w=(()=>{class e{transform(L,d){return L.join(d)}}return e.\u0275fac=function(L){return new(L||e)},e.\u0275pipe=f.Yjl({name:"arrayJoin",type:e,pure:!0}),e})()},575:(V,F,t)=>{"use strict";t.d(F,{In:()=>f,Ky:()=>L,VC:()=>w,c5:()=>x,gG:()=>e});var f=(()=>{return(d=f||(f={})).FILE_SHOW_LINKS="fileLinks",d.FILE_EDIT="fileEdit",d.DELETE="delete",d.RENAME="rename",d.MOVE="move",f;var d})(),w=(()=>{return(d=w||(w={})).FILE="file",d.FOLDER="folder",w;var d})(),e=(()=>{return(d=e||(e={})).FILENAME="filename",d.SIZE="size",d.TIME="time",d.EXTENSION="ext",e;var d})(),x=(()=>{return(d=x||(x={})).GRID="grid",d.LIST="list",x;var d})(),L=(()=>{return(d=L||(L={})).W_768_I_1="(max-width: 767.98px)",d.W_933_I_2="(min-width: 768px) and (max-width: 933.98px)",d.W_960_I_3="(min-width: 934px) and (max-width: 959.98px)",d.W_1226_I_2="(min-width: 960px) and (max-width: 1225.98px)",d.W_1540_I_3="(min-width: 1226px) and (max-width: 1539.98px)",d.W_1854_I_4="(min-width: 1540px) and (max-width: 1853.98px)",d.W_2168_I_5="(min-width: 1854px) and (max-width: 2167.98px)",d.W_2482_I_6="(min-width: 2168px) and (max-width: 2481.98px)",d.W_2796_I_7="(min-width: 2482px) and (max-width: 2795.98px)",d.W_3110_I_8="(min-width: 2796px) and (max-width: 3109.98px)",d.W_3424_I_9="(min-width: 3110px) and (max-width: 3423.98px)",d.W_3738_I_10="(min-width: 3424px)",L;var d})()},6986:(V,F,t)=>{"use strict";t.d(F,{C7:()=>x,Mi:()=>L,O8:()=>w,er:()=>d,p0:()=>e,xt:()=>C});var f=t(575);const w=[{ext:["png","apng"],maxSize:15},{ext:["jpeg","jpg","jpe"],maxSize:10},{ext:["gif"],maxSize:15},{ext:["bmp"],maxSize:10},{ext:["webp","webm"],maxSize:10},{ext:["psd","xcf"],maxSize:150},{ext:["svg"],maxSize:30}].map(s=>(s.maxSize*=1048576,s)),e={lastPath:[],layout:{asc:!0,orderBy:f.gG.FILENAME,type:f.c5.GRID},uploader:{checkImage:{time:0,active:!0},showLinkModal:!1}},x="https://upload.forumfree.net/api/",L=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-.\s])*$/,d=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-\s])*$/,C={invalidLength:!1,alreadyUsed:!1,invalidStartOrEnd:!1,invalidCharacter:!1}},8375:(V,F,t)=>{"use strict";t.d(F,{B:()=>K});var f=t(5861),w=t(1309),e=t(4650),x=t(4968),L=t(3905),d=t(3848),C=t(1460),s=t(4323),g=t(6986),U=t(575),i=t(7693),O=t(7320),c=t(146),M=t(3612),l=t(6378),m=t(6895),D=t(433),W=t(4029),_=t(8279),v=t(3450),I=t(8212);const k=["fileInput"];function E(h,P){1&h&&(e.O4$(),e.TgZ(0,"svg",23),e._UZ(1,"path",24)(2,"path",25),e.qZA())}const A=function(){return["text-primary"]};function R(h,P){1&h&&e._UZ(0,"app-logo",26),2&h&&e.Q6J("svgClass",e.DdM(2,A))("responsive",!1)}function b(h,P){1&h&&(e.TgZ(0,"span"),e._uU(1,"Trascina i file da caricare oppure c"),e.qZA())}function Q(h,P){1&h&&(e.TgZ(0,"span"),e._uU(1,"C"),e.qZA())}function G(h,P){if(1&h&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2,"I file verranno caricati nella cartella "),e.qZA(),e._UZ(3,"em",27),e.ALo(4,"arrayJoin"),e.BQk()),2&h){const a=e.oxw(2);e.xp6(3),e.Q6J("innerText",a.currentFolderPath.length?e.xi3(4,1,a.currentFolderPath,"/"):"root")}}function J(h,P){if(1&h&&(e._UZ(0,"div",32),e.ALo(1,"arrayJoin"),e.ALo(2,"slice")),2&h){const a=e.oxw(3);e.Q6J("innerText",e.xi3(1,1,e.Dn7(2,4,a.currentFolderPath,0,-1),"/"))}}function X(h,P){if(1&h&&(e.TgZ(0,"div",28)(1,"div",29),e._uU(2,"Cartella:"),e.qZA(),e.YNc(3,J,3,8,"div",30),e._UZ(4,"div",31),e.ALo(5,"arrayJoin"),e.ALo(6,"slice"),e.qZA()),2&h){const a=e.oxw(2);e.xp6(3),e.Q6J("ngIf",a.currentFolderPath.length>1),e.xp6(1),e.Q6J("innerText",(a.currentFolderPath.length>1?"/":"")+(a.currentFolderPath.length?e.xi3(5,2,e.xi3(6,5,a.currentFolderPath,a.currentFolderPath.length-1),"/"):"root"))}}const ee=function(){return{bottom:0,left:0}};function ae(h,P){if(1&h){const a=e.EpF();e.ynx(0),e.TgZ(1,"a",33),e.NdJ("click",function(){e.CHM(a);const n=e.oxw(2);return e.KtG(n.openInfoModal.emit())}),e._uU(2,"Informazioni"),e.qZA(),e.TgZ(3,"div",34),e.NdJ("click",function(){e.CHM(a),e.oxw(2);const n=e.MAs(7);return e.KtG(n.open())}),e._uU(4,"settings"),e.qZA(),e.BQk()}2&h&&(e.xp6(1),e.Q6J("ngStyle",e.DdM(1,ee)))}const y=function(h,P,a){return{"cursor-pointer":h,"p-4":P,"py-3 mt-1":a}},r=function(h,P){return{"fw-bold fs-lg":h,small:P}},o=function(h,P,a){return{"my-2":h,"mb-2":P,"mw-100":a}};function u(h,P){if(1&h){const a=e.EpF();e.ynx(0),e.TgZ(1,"div",15,16),e.NdJ("dragenter",function(){e.CHM(a);const n=e.MAs(2),j=e.oxw();return e.KtG(j.setDragOverEvent(n))})("drop",function(n){e.CHM(a);const j=e.oxw();return e.KtG(j.handleDropEvent(n))})("click",function(){e.CHM(a),e.oxw();const n=e.MAs(2);return e.KtG(n.click())}),e.YNc(3,E,3,0,"svg",17),e.YNc(4,R,1,3,"ng-template",null,18,e.W1O),e.TgZ(6,"div",19),e.YNc(7,b,2,0,"span",20),e.YNc(8,Q,2,0,"span",20),e.TgZ(9,"span"),e._uU(10,"licca per scegliere da memoria"),e.qZA()(),e.TgZ(11,"div",21),e.YNc(12,G,5,4,"ng-container",3),e.YNc(13,X,7,8,"ng-template",null,22,e.W1O),e.qZA()(),e.YNc(15,ae,5,2,"ng-container",20),e.BQk()}if(2&h){const a=e.MAs(5),p=e.MAs(14),n=e.oxw();e.xp6(1),e.Q6J("ngClass",e.kEZ(10,y,!n.loading,!n.isWidget,n.isWidget)),e.xp6(2),e.Q6J("ngIf",!n.isWidget)("ngIfElse",a),e.xp6(3),e.Q6J("ngClass",e.WLB(14,r,!n.isWidget,n.isWidget)),e.xp6(1),e.Q6J("ngIf",!n.touchDevice),e.xp6(1),e.Q6J("ngIf",n.touchDevice),e.xp6(3),e.Q6J("ngClass",e.kEZ(17,o,!n.isWidget&&!n.touchDevice,!n.isWidget&&n.touchDevice,n.isWidget)),e.xp6(1),e.Q6J("ngIf",!n.isWidget)("ngIfElse",p),e.xp6(3),e.Q6J("ngIf",!n.isWidget)}}const B=function(h,P){return{"p-4":h,"pt-2 pb-3":P}};function S(h,P){if(1&h&&(e.TgZ(0,"div",35),e.O4$(),e.TgZ(1,"svg",36),e._UZ(2,"path",37),e.qZA(),e.kcU(),e._UZ(3,"app-loader",38),e.TgZ(4,"div",39),e._uU(5,"Attendi il completamento dell'upload per caricare altre immagini."),e.qZA()()),2&h){const a=e.oxw();e.Q6J("ngClass",e.WLB(3,B,!a.isWidget,a.isWidget)),e.xp6(3),e.Q6J("onlyMessage",!0)("message",a.loadingMessage)}}const H=function(h,P){return{uploading:h,widget:P}};let K=(()=>{class h{constructor(a,p,n,j,T,$,z){this.postMessageService=a,this.uploadService=p,this.uploadObservablesService=n,this.uploaderService=j,this.toastService=T,this.renderer=$,this.ngZone=z,this.loading=!0,this.currentFolderPath=[],this.isWidget=!1,this.fileUploadedEvent=new e.vpe,this.openInfoModal=new e.vpe,this.isUploading=!1,this.loadingMessage="Controllo dei file in corso",this.touchDevice=C.eX,this.dragOverEvent=!1,this.options=this.uploaderService.uploaderOptions;const te=this.uploadService.preferences.uploader;te.checkImage.active||(this.options.compress=!1),te.showLinkModal&&(this.options.openLinkModalAfterUpload=!0),this.uploaderService.uploaderOptions=this.options}ngOnInit(){this.handleClipboardPasteEvent(),this.handleExternalUpload()}handleClipboardPasteEvent(){var a=this;this.clipboardPasteEventSubscription=(0,x.R)(document.body,"paste").subscribe(function(){var p=(0,f.Z)(function*(n){if(!a.canUpload)return;const j=Array.from((n.clipboardData||n.originalEvent.clipboardData).items);let T=[];for(const $ of j)if(0===$.type.indexOf("image")){const z=$.getAsFile();z&&T.push(z)}T.length>0?yield a.preUpload(T):a.reset()});return function(n){return p.apply(this,arguments)}}())}handleExternalUpload(){var a=this;this.startExternalUploadSubscription=this.uploadObservablesService.startUploadObservable.subscribe(function(){var p=(0,f.Z)(function*(n){if(n){if(!a.canUpload)return;yield a.preUpload([n.file],n.options)}else a.fileInputRef.nativeElement.click()});return function(n){return p.apply(this,arguments)}}())}handleSelectionEvent(a){var p=this;return(0,f.Z)(function*(){if(!p.canUpload)return;const n=a.target;if(n.files&&n.files.length){const j=Array.from(n.files);return n.value="",p.preUpload(j)}p.reset()})()}handleDropEvent(a){var p=this;return(0,f.Z)(function*(){if(a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),!p.canUpload)return;const n=a.dataTransfer?.files?Array.from(a.dataTransfer.files):[];if(n.length)return p.preUpload(n);p.reset()})()}saveOptions(a=!0){this.uploaderService.uploaderOptions=this.options,a&&this.savePreferences()}savePreferences(){this.uploadService.preferences.uploader={checkImage:{active:this.options.compress,time:Date.now()},showLinkModal:this.options.openLinkModalAfterUpload}}setDragOverEvent(a){this.dragOverEvent||(this.dragOverEvent=!0,this.ngZone.runOutsideAngular(()=>{this.renderer.listen(a,"dragover",p=>{p.preventDefault()})}))}get canUpload(){return!this.loading&&!this.isUploading&&(this.isUploading=!0,this.dragOverEvent=!1,!0)}reset(){this.isUploading=!1,this.loadingMessage="Controllo dei file da caricare",this.postMessageService.send(s.l.UPLOAD_END,{}),this.options.allowOverwrite=!1,this.saveOptions(!1)}preUpload(a,p){var n=this;return(0,f.Z)(function*(){const j=[...n.currentFolderPath];let T=[],$=[],z=[],te=[];p?p.allowOverwrite=p.allowOverwrite||!1:(p=n.uploaderService.uploaderOptions).allowOverwrite=!1;for(let Z=0;Z<a.length;Z++){let N=p.compress?yield n.uploaderService.compressFileIfNeeded(a[Z],p.imageDimensions):a[Z];if(N=yield n.uploaderService.orientFileIfNeeded(N),N){const ne=(0,d.Tb)(N.name),ie=g.O8.find(Y=>-1!==Y.ext.indexOf(ne.ext));if(!ie){z.push(N);continue}if(N.size>ie.maxSize){te.push(N);continue}T.push({file:{name:N.name,size:N.size,time:0,url:"",ext:ne.ext,filename:ne.filename,isImage:(0,d.Or)(ne.ext),embedUrl:""},progress:0,completed:!1}),$.push(N)}}if((z.length||te.length)&&(n.toastService.show({content:n.createToastMessage(z,te),level:w.m.ERROR}),[["UNSUPPORTED",z],["OVERSIZED",te]].forEach(Z=>{Z[1].forEach(N=>{n.postMessageService.send(s.l.UPLOAD_ERROR,{filename:N.name,error:Z[0]})})})),0===$.length)return void n.reset();const oe=`Caricamento file {{fileNumber}} di ${$.length} in corso`;n.uploadObservablesService.pushUploadingFileQueue(T);for(let Z=0;Z<$.length;++Z){n.loadingMessage="Creazione del pacchetto da inviare";const N=yield n.uploadService.getHostToken(j,$[Z].name);T[Z].progress+=20,n.loadingMessage=oe.replace("{{fileNumber}}",`${Z+1}`),yield(0,L.z)(n.uploaderService.upload($[Z],T[Z],N,p.allowOverwrite))}n.uploadObservablesService.pushUploadingFileQueue([]);const re=T.filter(Z=>!Z.error).map(Z=>Z.file);re.length>0&&(n.fileUploadedEvent.emit({fileList:re,rewrite:p.allowOverwrite,paths:j}),n.postMessageService.send(s.l.UPLOAD_SUCCESS,{fileList:re.map(Z=>({filename:Z.name,isImage:Z.isImage,url:Z.url}))}),p.openLinkModalAfterUpload&&n.uploadObservablesService.pushAction({name:U.In.FILE_SHOW_LINKS,payload:{entities:(0,d.jL)(re)}})),n.reset()})()}createToastMessage(a,p){let n=[];return a.length&&n.push(a.length>1?`I file <strong>${a.map(j=>j.name).join(", ")}</strong> hanno un formato non supportato!`:`Il file <strong>${a[0].name}</strong> ha un formato non supportato!`),p.length&&n.push(p.length>1?`I file <strong>${p.map(j=>j.name).join(", ")}</strong> sono troppo pesanti!`:`Il file <strong>${p[0].name}</strong> \xe8 troppo pesante!`),n.join("<br><br>")}ngOnDestroy(){this.startExternalUploadSubscription?.unsubscribe(),this.clipboardPasteEventSubscription.unsubscribe(),this.uploaderService.clearPendingRequests()}}return h.\u0275fac=function(a){return new(a||h)(e.Y36(i.F),e.Y36(O.C),e.Y36(c.r),e.Y36(M.q),e.Y36(l.k),e.Y36(e.Qsj),e.Y36(e.R0b))},h.\u0275cmp=e.Xpm({type:h,selectors:[["app-uploader"]],viewQuery:function(a,p){if(1&a&&e.Gf(k,5),2&a){let n;e.iGM(n=e.CRH())&&(p.fileInputRef=n.first)}},inputs:{loading:"loading",currentFolderPath:"currentFolderPath",isWidget:"isWidget"},outputs:{fileUploadedEvent:"fileUploadedEvent",openInfoModal:"openInfoModal"},decls:30,vars:10,consts:[[1,"uploader","rounded","h-100","position-relative",3,"ngClass"],["type","file",1,"d-none",3,"multiple","disabled","change"],["fileInput",""],[4,"ngIf","ngIfElse"],["uploading",""],["title","Opzioni di caricamento"],["optionsModal",""],[1,"mb-1"],[1,"mb-3"],[1,"mb-1","list-unstyled"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","speed-upload",1,"form-check-input",3,"ngModel","ngModelChange"],["for","speed-upload",1,"form-check-label","me-auto"],["type","checkbox","role","switch","id","show-link-modal",1,"form-check-input",3,"ngModel","ngModelChange"],["for","show-link-modal",1,"form-check-label","me-auto"],[1,"rounded","upload-area",3,"ngClass","dragenter","drop","click"],["uploadArea",""],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16",4,"ngIf","ngIfElse"],["appLogo",""],[1,"description","text-center",3,"ngClass"],[4,"ngIf"],[1,"small","text-center",3,"ngClass"],["widgetFolder",""],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16"],["fill-rule","evenodd","d","M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"],["d","M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"],["svgSize","xl","subtext","Upload",1,"d-block","mb-3","py-1",3,"svgClass","responsive"],[1,"text-break",3,"innerText"],[1,"d-flex","min-w-0"],[1,"me-1"],["class","fst-italic text-truncate mw-100",3,"innerText",4,"ngIf"],[1,"fst-italic","text-nowrap",3,"innerText"],[1,"fst-italic","text-truncate","mw-100",3,"innerText"],[1,"fs-xs","fst-italic","d-block","px-2","py-1","text-reset","cursor-pointer","position-absolute",3,"ngStyle","click"],[1,"material-icons-outlined","d-block","cursor-pointer","fs-xl","position-absolute","options-icon",3,"click"],[1,"p-4","rounded",3,"ngClass"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","viewBox","0 0 16 16",1,"overflow-visible"],["d","M 4.406 3.342 A 5.53 5.53 0 0 1 8 2 c 2.69 0 4.923 2 5.166 4.579 C 14.758 6.804 16 8.137 16 9.773 C 16 11.569 14.502 13 12.687 13 H 3.781 C 1.708 13 0 11.366 0 9.318 c 0 -1.763 1.266 -3.223 2.942 -3.593 c 0.143 -0.863 0.698 -1.723 1.464 -2.383 z",1,"cloud"],[3,"onlyMessage","message"],[1,"small","text-center"]],template:function(a,p){if(1&a&&(e.TgZ(0,"div",0)(1,"input",1,2),e.NdJ("change",function(j){return p.handleSelectionEvent(j)}),e.qZA(),e.YNc(3,u,16,21,"ng-container",3),e.YNc(4,S,6,6,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(6,"app-modal",5,6)(8,"p",7),e._uU(9,"Tramite questo modal \xe8 possibile gestire le opzioni di caricamento al momento disponibili:"),e.qZA(),e.TgZ(10,"ul",8)(11,"li")(12,"em"),e._uU(13,"caricamento veloce"),e.qZA(),e._uU(14,": abilitando questa opzione, l'immagine da caricare verr\xe0 adattata per terminare l'operazione di upload nel minor tempo possibile. "),e.qZA(),e.TgZ(15,"li")(16,"em"),e._uU(17,"mostra link dopo l'upload"),e.qZA(),e._uU(18,": abilitando questa opzione, una volta terminato il caricamento verr\xe0 aperto il modal contenente i link utili dei file caricati. "),e.qZA()(),e.TgZ(19,"ul",9)(20,"li")(21,"div",10)(22,"input",11),e.NdJ("ngModelChange",function(j){return p.options.compress=j})("ngModelChange",function(){return p.saveOptions()}),e.qZA(),e.TgZ(23,"label",12),e._uU(24,"Caricamento veloce"),e.qZA()()(),e.TgZ(25,"li")(26,"div",10)(27,"input",13),e.NdJ("ngModelChange",function(j){return p.options.openLinkModalAfterUpload=j})("ngModelChange",function(){return p.saveOptions()}),e.qZA(),e.TgZ(28,"label",14),e._uU(29,"Mostra link dopo l'upload"),e.qZA()()()()()),2&a){const n=e.MAs(5);e.Q6J("ngClass",e.WLB(7,H,p.isUploading,p.isWidget)),e.xp6(1),e.Q6J("multiple",!0)("disabled",p.loading||p.isUploading),e.xp6(2),e.Q6J("ngIf",!p.isUploading)("ngIfElse",n),e.xp6(19),e.Q6J("ngModel",p.options.compress),e.xp6(5),e.Q6J("ngModel",p.options.openLinkModalAfterUpload)}},dependencies:[m.mk,m.O5,m.PC,D.Wl,D.JJ,D.On,W.R,_.R,v.z,I.J,m.OU],styles:[".uploader[_ngcontent-%COMP%]:not(.widget){margin:0 1rem;border:2px dashed #4864FE;box-shadow:0 .125rem .25rem #00000013;color:#2036ad}.uploader[_ngcontent-%COMP%]:not(.widget):not(.uploading)   svg[_ngcontent-%COMP%]{animation:bubble 4s linear infinite}.uploader[_ngcontent-%COMP%]:not(.widget).uploading   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{stroke:#2036ad}.uploader[_ngcontent-%COMP%]:not(.widget)   .description[_ngcontent-%COMP%]{max-width:400px}.uploader.widget.uploading[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{stroke:#4864fe}.uploader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.options-icon){height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.uploader.uploading[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{fill:none;stroke-linecap:round;stroke-dasharray:50;stroke-dashoffset:100;animation:draw 3.5s linear infinite}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]{top:5px;right:5px;opacity:.7;transition:opacity .2s}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]:hover{opacity:1}.upload-area[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(app-logo){pointer-events:none}@media (min-width: 768px){.uploader[_ngcontent-%COMP%]{margin:initial}}@keyframes bubble{6%{transform:scale(1.3,.8)}9%{transform:scale(.8,1.3) translateY(-.5rem)}12%{transform:scale(1)}}@keyframes draw{0%{stroke-dashoffset:100}to{stroke-dashoffset:0}}"]}),h})()},1740:(V,F,t)=>{"use strict";t.d(F,{M:()=>s});var f=t(8694),w=t(6895),e=t(433),x=t(6818),L=t(1043),d=t(582),C=t(4650);let s=(()=>{class g{}return g.\u0275fac=function(i){return new(i||g)},g.\u0275mod=C.oAB({type:g}),g.\u0275inj=C.cJS({imports:[f.r,w.ez,e.u5,x.q,L.h,d.z]}),g})()},2381:(V,F,t)=>{"use strict";t.d(F,{y:()=>L});var f=t(5044),w=t(4650),e=t(5700),x=t(5123);let L=(()=>{class d{constructor(s,g){this.cookieConsentService=s,this.localStorageService=g,this.storage=null}getItem(s){return null===this.storage&&(this.storage=this.data),this.storage[s]}get data(){const s=this.localStorageService.getItem(f.dR.PREFERENCES);if(!s)return{};try{return JSON.parse(s)}catch{return{}}}setItem(s,g){null===this.storage&&(this.storage=this.data),g?this.storage[s]=g:delete this.storage[s],this.cookieConsentService.choice?.preferences&&this.localStorageService.setItem(f.dR.PREFERENCES,JSON.stringify(this.storage))}resetItemsOnProfileChange(){const s=this.getItem(f.Ye.UPLOAD);s&&(s.lastPath=[],this.setItem(f.Ye.UPLOAD,s))}}return d.\u0275fac=function(s){return new(s||d)(w.LFG(e.C),w.LFG(x.n))},d.\u0275prov=w.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},146:(V,F,t)=>{"use strict";t.d(F,{r:()=>L});var f=t(7579),w=t(1135),e=t(4650),x=t(8745);let L=(()=>{class d{constructor(s){this.uploadPreferencesService=s,this.selectedFileListArray=[],this.actionSubject=new f.x,this.uploadingFileQueueSubject=new f.x,this.uploadingFileErrorSubject=new f.x,this.currentFolderPathSubject=new f.x,this.layoutOptionsSubject=new f.x,this.renameFileSubject=new f.x,this.entityPendingSubject=new f.x,this.deleteFileSubject=new f.x,this.uploadedFileSubject=new f.x,this.draggedFileListSubject=new f.x,this.startUploadSubject=new f.x,this.selectedFileListSubject=new w.X(this.selectedFileListArray)}get actionObservable(){return this.actionSubject.asObservable()}pushAction(s){this.actionSubject.next(s)}get layoutOptionsObservable(){return this.layoutOptionsSubject.asObservable()}pushLayoutOptions(s){this.uploadPreferencesService.layoutOptions=s,this.layoutOptionsSubject.next(s)}get currentFolderPathObservable(){return this.currentFolderPathSubject.asObservable()}pushCurrentFolderPath(s){this.uploadPreferencesService.lastFolderPath=s,this.currentFolderPathSubject.next(s)}get uploadingFileQueueObservable(){return this.uploadingFileQueueSubject.asObservable()}pushUploadingFileQueue(s){this.uploadingFileQueueSubject.next(s)}get uploadingFileErrorObservable(){return this.uploadingFileErrorSubject.asObservable()}pushUploadingFileError(s){this.uploadingFileErrorSubject.next(s)}get renameFileObservable(){return this.renameFileSubject.asObservable()}pushRenameFile(s){this.renameFileSubject.next(s)}get entityPendingObservable(){return this.entityPendingSubject.asObservable()}pushEntityPending(s){this.entityPendingSubject.next(s)}get deleteFileObservable(){return this.deleteFileSubject.asObservable()}pushDeleteFile(s){this.deleteFileSubject.next(s)}get uploadedFileObservable(){return this.uploadedFileSubject.asObservable()}pushUploadedFile(s){this.uploadedFileSubject.next(s)}get draggedFileListObservable(){return this.draggedFileListSubject.asObservable()}pushDraggedFileList(s){this.draggedFileListSubject.next(s)}get startUploadObservable(){return this.startUploadSubject.asObservable()}pushStartUpload(s){this.startUploadSubject.next(s)}get selectedFileListObservable(){return this.selectedFileListSubject.asObservable()}pushSelectedFile(s){if(Array.isArray(s)||(s=[s]),0===s.length)return void(this.selectedFileListArray.length>0&&(this.selectedFileListArray=[],this.selectedFileListSubject.next(this.selectedFileListArray)));let g=!1;for(const U of s){const i=this.selectedFileListArray.findIndex(O=>O.name===U.name);U.selected?-1===i&&(this.selectedFileListArray.push({name:U.name}),g=!0):i>-1&&(this.selectedFileListArray.splice(i,1),g=!0)}g&&this.selectedFileListSubject.next(this.selectedFileListArray)}}return d.\u0275fac=function(s){return new(s||d)(e.LFG(x.p))},d.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},8745:(V,F,t)=>{"use strict";t.d(F,{p:()=>d});var f=t(5044),w=t(6986),e=t(4650),x=t(2381),L=t(6161);let d=(()=>{class C{constructor(g,U){this.preferencesService=g,this.urlQueryParamsService=U;const i=this.urlQueryParamsService.getAndDeleteParam(f.RT.UPLOAD_PATH);i&&(this.lastFolderPath=i.split("/"))}get preferences(){return this.preferencesService.getItem(f.Ye.UPLOAD)||w.p0}set preferences(g){this.preferencesService.setItem(f.Ye.UPLOAD,g)}get lastFolderPath(){return this.preferences.lastPath||w.p0.lastPath}set lastFolderPath(g){const U=this.preferences;U.lastPath=g,this.preferences=U}get layoutOptions(){const g=w.p0.layout,U=this.preferences.layout;return U&&0===Object.keys(g).filter(i=>!U.hasOwnProperty(i)).length?U:g}set layoutOptions(g){const U=this.preferences;U.layout=g,this.preferences=U}get uploader(){const g=this.preferences.uploader||w.p0.uploader;return!g.checkImage.active&&Date.now()-g.checkImage.time>6048e5&&(g.checkImage.active=!0,this.uploader=g),g.hasOwnProperty("showLinkModal")||(g.showLinkModal=!1),g}set uploader(g){const U=this.preferences;U.uploader=g,this.preferences=U}}return C.\u0275fac=function(g){return new(g||C)(e.LFG(x.y),e.LFG(L.J))},C.\u0275prov=e.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},7320:(V,F,t)=>{"use strict";t.d(F,{C:()=>v});var f=t(5861),w=t(7824),e=t(3905),x=t(3848),i=t(6986),O=t(1042),c=t(4650),M=t(5395),l=t(575),m=t(3138);let D=(()=>{class I{constructor(E){this.globalsService=E,this.ffuid="",this.cache={},this.profileSubscription=this.globalsService.profileObservable.subscribe(A=>{this.ffuid=A?A.user.ffuid:""})}getItem(E){const A=this.createKey(E);if(this.cache.hasOwnProperty(A))return this.cache[A]}setItem(E,A){this.cache[this.createKey(E)]=A}removeItem(E){const A=this.createKey(E);if(this.cache.hasOwnProperty(A)){if(this.cache[A].folders.length)for(const R of this.cache[A].folders)this.removeItem([...E,R.name]);return delete this.cache[A],!0}return!1}addEntities(E,A,R=l.VC.FILE){const b=this.createKey(E);return!!this.cache.hasOwnProperty(b)&&(Array.isArray(A)||(A=[A]),R===l.VC.FILE?this.cache[b].files.unshift(...A):this.cache[b].folders.unshift(...A),!0)}removeEntities(E,A,R=l.VC.FILE){const b=this.createKey(E);if(!this.cache.hasOwnProperty(b))return!1;const Q=R===l.VC.FILE?"files":"folders";Array.isArray(A)||(A=[A]);let G=!1;for(const J of A){const X=this.cache[b][Q].findIndex(ee=>ee.name===J);X>-1&&(this.cache[b][Q].splice(X,1),G=!0)}return G}refactorFolderContent(E,A){const R=this.createKey(E);if(!this.cache.hasOwnProperty(R))return!1;A.endsWith("/")||(A+="/");for(const b of this.cache[R].folders)b.url=A+b.name;for(const b of this.cache[R].files)b.url=b.embedUrl=A+b.name,b.time=Date.now();return!0}createKey(E){return`${this.ffuid}/${E.join("/")}`}ngOnDestroy(){this.profileSubscription.unsubscribe()}}return I.\u0275fac=function(E){return new(E||I)(c.LFG(m.d))},I.\u0275prov=c.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"}),I})();var W=t(8745),_=t(529);let v=(()=>{class I{constructor(E,A,R,b){this.graphqlService=E,this.uploadCacheService=A,this.uploadPreferencesService=R,this.http=b}get cache(){return this.uploadCacheService}get preferences(){return this.uploadPreferencesService}setGqlIdHeader(){this.graphqlService.safeSetGlobalHeader(w._.HeaderKeys.UUID,(0,O.Z)())}removeGqlIdHeader(){this.graphqlService.removeGlobalHeader(w._.HeaderKeys.UUID)}getGqlIdHeader(){return this.graphqlService.getGlobalHeader(w._.HeaderKeys.UUID)||""}getFileList(E,A){var R=this;return(0,f.Z)(function*(){const b=R.uploadCacheService.getItem(E);if(b)return b;const Q=(yield R.graphqlService.query({query:"\nquery UploadEntitiesListToken($scope: String, $target: String!) {\n    uploadEntitiesListToken(scope: $scope, target: $target)\n}",variables:{scope:A,target:E.join("/")}})).data.uploadEntitiesListToken,G=yield R.sendRequest(Q),X={files:G.files.map(ee=>{const ae=(0,x.Tb)(ee.url);return{...ee,time:1e3*ee.time,filename:ae.filename,ext:ae.ext,isImage:(0,x.Or)(ae.ext),embedUrl:`${ee.url}?t=${ee.time}`}}),folders:G.folders};return R.uploadCacheService.setItem(E,X),X})()}createDirectory(E,A){var R=this;return(0,f.Z)(function*(){const b=(yield R.graphqlService.mutate({mutation:"\nquery UploadEntitiesCreateDirectoryToken($scope: String, $target: String!) {\n    uploadEntitiesCreateDirectoryToken(scope: $scope, target: $target)\n}",variables:{scope:A,target:E.join("/")}})).data.uploadEntitiesCreateDirectoryToken;return yield R.sendRequest(b)})()}moveRenameEntity(E,A,R,b,Q){var G=this;return(0,f.Z)(function*(){b||(b=R);const J=(yield G.graphqlService.mutate({mutation:"\nquery UploadEntitiesMoveToken($scope: String, $source: String!, $target: String!) {\n    uploadEntitiesMoveToken(scope: $scope, source: $source, target: $target)\n}",variables:{scope:Q,source:(E.length?`${E.join("/")}/`:"")+R,target:(A.length?`${A.join("/")}/`:"")+b}})).data.uploadEntitiesMoveToken;return yield G.sendRequest(J)})()}deleteEntity(E,A,R){var b=this;return(0,f.Z)(function*(){const Q=(yield b.graphqlService.mutate({mutation:"\nquery UploadEntitiesDeleteToken($scope: String, $target: String!) {\n    uploadEntitiesDeleteToken(scope: $scope, target: $target)\n}",variables:{scope:R,target:(E.length?`${E.join("/")}/`:"")+A}})).data.uploadEntitiesDeleteToken;return yield b.sendRequest(Q),!0})()}getHostToken(E,A,R){var b=this;return(0,f.Z)(function*(){return(yield b.graphqlService.query({query:"\nquery UploadEntitiesHostToken($scope: String, $target: String!) {\n    uploadEntitiesHostToken(scope: $scope, target: $target)\n}",variables:{scope:R,target:(E.length?`${E.join("/")}/`:"")+A}})).data.uploadEntitiesHostToken})()}sendRequest(E){var A=this;return(0,f.Z)(function*(){return(yield(0,e.z)(A.http.post(i.C7,JSON.stringify({payload:E}),{headers:{"Content-Type":"application/json"}}))).success})()}subscribeForChanges(E,A){var R=this;return(0,f.Z)(function*(){return yield R.graphqlService.subscribe({query:"\nsubscription UploadEntities($scope: String) {\n    uploadEntities(scope: $scope) {\n        eventMessage\n        eventType\n        user {\n            avatar\n            host\n            id\n            nickname\n        }\n    }\n}",variables:{scope:A}},b=>{if(!b.data?.uploadEntities)return;const Q=JSON.parse(b.data.uploadEntities.eventMessage);if(!Q.payload.customHeaders||!Q.payload.customHeaders.hasOwnProperty(w._.HeaderKeys.UUID)||Q.payload.customHeaders[w._.HeaderKeys.UUID]===R.getGqlIdHeader())return;const G=(Q.payload.content.source||"").split("/"),J=(Q.payload.content.target||"").split("/"),X=J[J.length-1].indexOf(".")>-1;let ee;try{ee=JSON.parse(Q.output).success||""}catch{return}E({type:b.data.uploadEntities.eventType,sourceName:G[G.length-1],sourcePaths:G.slice(0,-1),targetName:J[J.length-1],targetPaths:J.slice(0,-1),isFile:X,output:ee})})})()}getBlobFromUrl(E){var A=this;return(0,f.Z)(function*(){return yield(0,e.z)(A.http.get(E,{responseType:"blob"})).catch(()=>{})})()}}return I.\u0275fac=function(E){return new(E||I)(c.LFG(M.J),c.LFG(D),c.LFG(W.p),c.LFG(_.eN))},I.\u0275prov=c.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"}),I})()},3848:(V,F,t)=>{"use strict";t.d(F,{$H:()=>c,JN:()=>g,Lv:()=>d,Or:()=>O,Tb:()=>x,jL:()=>i,rc:()=>M,sT:()=>C,zO:()=>L});var f=t(5861),w=t(575),e=t(6986);function x(l){let m=l;if(l.indexOf("/")>-1){const v=l.split("/");m=v[v.length-1]}const D=m.split("."),W=D[D.length-1].toLowerCase(),_=decodeURIComponent(D.slice(0,-1).join("."));return{ext:W,filename:_,name:`${_}.${W}`}}function L(l){const m=x(l),D=Date.now();return{name:m.name,size:0,time:D,url:l,ext:m.ext,filename:m.filename,isImage:O(m.ext),embedUrl:`${l}?t=${D}`}}function d(l){let m=l;m.endsWith("/")&&(m=m.slice(0,-1));const D=m.split("/");return{name:decodeURIComponent(D[D.length-1])}}function C(l){return s.apply(this,arguments)}function s(){return(s=(0,f.Z)(function*(l){const m=new FileReader,D=new Promise(W=>m.addEventListener("load",()=>W(m.result)));return m.readAsDataURL(l),D})).apply(this,arguments)}function g(l){return U.apply(this,arguments)}function U(){return(U=(0,f.Z)(function*(l){const m=new DataView(yield l.arrayBuffer());if(2303741511===m.getUint32(0)&&218765834===m.getUint32(4)){if(-1===[4,6].indexOf(m.getUint8(25)))return!1;const W=Object.assign(new Image,{src:yield C(l)});yield new Promise(I=>W.addEventListener("load",()=>I(!0)));const _=Object.assign(document.createElement("canvas"),{width:W.width,height:W.height}).getContext("2d");if(!_)return!1;_.imageSmoothingEnabled=!1,_.drawImage(W,0,0);const v=_?.getImageData(0,0,W.width,W.height);if(v)for(let I=0;I<v.data.length;I+=4)if(v.data[I+3]<255)return!0}return!1})).apply(this,arguments)}function i(l){return l.map(m=>({name:m.name,ext:m.ext,type:w.VC.FILE,url:m.url,embedUrl:m.embedUrl,isImage:m.isImage}))}function O(l,m=[]){return["png","apng","jpeg","jpg","jpe","gif","svg","webp"].includes(l)&&!m.includes(l)}function c(l){return O(l,["gif","svg"])}function M(l,m,D,W=[],_=""){let v={...e.xt};const I=l.trim();v.invalidLength=0===I.length;const k=(I+_).replace(/\s{2,}/g," ");return v.alreadyUsed=m!==I&&W.includes(k),v.invalidStartOrEnd=/(^(\s|\.))|((\s|\.)$)/.test(l),v.invalidCharacter=!(D===w.VC.FILE?e.Mi.test(l):e.er.test(l)),v}},3612:(V,F,t)=>{"use strict";t.d(F,{q:()=>m});var f=t(5861),w=t(8896),e=t(6730),x=t.n(e),L=t(9969),d=t(3848),C=t(529),s=t(7579),g=t(7445),U=t(2722),i=t(6986);class O{static findApp1Marker(W){const _=new DataView(W),v=new Set([65498,65497,65476,65474,65472,65499,65501]);for(let I=0;I<W.byteLength-2;I+=2){const k=_.getUint16(I);if(65505===k)return{offset:I,size:_.getUint16(I+2),little:18761==_.getUint16(I+8,!1)};if(v.has(k))break}}static stripAndReturnExif(W){return(0,f.Z)(function*(){const _=yield W.arrayBuffer(),v=O.findApp1Marker(_);return v?{file:new File([_.slice(0,v.offset),_.slice(v.offset+v.size+2)],W.name,{type:W.type,lastModified:W.lastModified}),exif:_.slice(v.offset,v.offset+v.size)}:{file:W}})()}static checkImageOrientation(W){const _=new DataView(W);if(1165519206!=_.getUint32(4,!1))return-1;const v=18761==_.getUint16(10,!1);let I=10;I+=_.getUint32(I+4,v);const k=_.getUint16(I,v);I+=2;for(let E=0;E<k;E++)if(274==_.getUint16(I+12*E,v))return _.getUint16(I+12*E+8,v);return-1}}var c=t(4650),M=t(146),l=t(2020);let m=(()=>{class D{constructor(_,v,I){this.http=_,this.uploadObservablesService=v,this.loadImageService=I,this.requestSubscriptions=[],this.uploaderOptionsObject={compress:!0,openLinkModalAfterUpload:!1}}get uploaderOptions(){return{...this.uploaderOptionsObject}}set uploaderOptions(_){this.uploaderOptionsObject={..._}}compressFileIfNeeded(_,v){return(0,f.Z)(function*(){let I=["image/png","image/jpeg"],k={strict:!0,checkOrientation:!0,quality:.8,convertSize:1};v&&(I.push("image/webp"),k.width=v.width,k.height=v.height,k.resize="cover",k.strict=!1);const E=_.type.toLowerCase();return _.size<=4e6&&void 0===v||-1===I.indexOf(_.type.toLowerCase())?_:("image/png"===E&&(yield(0,d.JN)(_))&&(k.convertSize=1/0),new Promise((A,R)=>{new(x())(_,{...k,success:b=>{const Q=b instanceof Blob?new File([b],_.name,{type:_.type,lastModified:_.lastModified}):_;A(Q)},error:R})}))})()}orientFileIfNeeded(_){var v=this;return(0,f.Z)(function*(){if(-1===["image/jpeg"].indexOf(_.type.toLowerCase()))return _;const k=yield O.stripAndReturnExif(_);if(_=k.file,k.exif){const E=O.checkImageOrientation(k.exif);if(1!==E){let A=0;switch(E){case 3:case 4:A=180;break;case 5:case 6:A=90;break;case 7:case 8:A=270}const R=yield(0,d.sT)(_),b=yield new Promise((G,J)=>{const X=new Image;X.onload=()=>G({originalImage:X,originalBase64:R}),X.onerror=J,X.src=R}),Q=yield v.loadImageService.transformLoadedImage({original:{base64:b.originalBase64,image:b.originalImage,size:{width:b.originalImage.naturalWidth,height:b.originalImage.naturalHeight}},exifTransform:{flip:[2,4,5,7].includes(E),rotate:A/90}},new L.R);_=new File([(0,w.L)(Q.transformed.base64)],_.name,{type:_.type,lastModified:Date.now()})}}return _})()}upload(_,v,I,k=!1){const E=new s.x,A=new FormData;A.append("payload",I),A.append("upload",_,_.name),k&&A.append("allowOverwrite","1");const R=this.http.request(new C.aW("POST",i.C7,A,{reportProgress:!0,responseType:"json"}));return this.requestSubscriptions.push(R.subscribe({next:b=>{if(b.type===C.dt.UploadProgress){if(!b.total||(v.progress=Math.round(50*b.loaded/b.total)+20,v.progress<70))return;(0,g.F)(1e3).pipe((0,U.R)(E.asObservable())).subscribe(()=>{if(v.progress<95){const Q=Math.round(8*Math.random()+8);v.progress+Q>95?v.progress=95:v.progress+=Q}})}else if(b instanceof C.Zn){if(v.progress=100,v.completed=!0,b.body?.error||!b.body?.success)v.error=!0,this.uploadObservablesService.pushUploadingFileError(v);else{v.file.url=b.body.success.url,v.file.time=Date.now(),v.file.embedUrl=`${v.file.url}?t=${v.file.time}`;const Q=(0,d.Tb)(v.file.url);v.file.name=Q.name,v.file.filename=Q.filename}E.next(),E.complete()}},error:()=>{v.error=!0,this.uploadObservablesService.pushUploadingFileError(v),E.next(),E.complete()}})),E.asObservable()}clearPendingRequests(){for(const _ of this.requestSubscriptions)_.unsubscribe();this.requestSubscriptions=[]}}return D.\u0275fac=function(_){return new(_||D)(c.LFG(C.eN),c.LFG(M.r),c.LFG(l.y))},D.\u0275prov=c.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})()},6730:function(V){V.exports=function(){"use strict";function F(y,r){var o=Object.keys(y);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(y);r&&(u=u.filter(function(B){return Object.getOwnPropertyDescriptor(y,B).enumerable})),o.push.apply(o,u)}return o}function t(y){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?F(Object(o),!0).forEach(function(u){x(y,u,o[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(o)):F(Object(o)).forEach(function(u){Object.defineProperty(y,u,Object.getOwnPropertyDescriptor(o,u))})}return y}function w(y,r){for(var o=0;o<r.length;o++){var u=r[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(y,u.key,u)}}function x(y,r,o){return r in y?Object.defineProperty(y,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):y[r]=o,y}function L(){return L=Object.assign||function(y){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(y[u]=o[u])}return y},L.apply(this,arguments)}var y,r,o,u,B,S,H,K,d={exports:{}};y=d,typeof window>"u"||(r=window,o=r.HTMLCanvasElement&&r.HTMLCanvasElement.prototype,u=r.Blob&&function(){try{return Boolean(new Blob)}catch{return!1}}(),B=u&&r.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch{return!1}}(),S=r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder,H=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,K=(u||S)&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&function(h){var P,a,p,n,j,T,$,z,te;if(!(P=h.match(H)))throw new Error("invalid data URI");for(a=P[2]?P[1]:"text/plain"+(P[3]||";charset=US-ASCII"),p=!!P[4],n=h.slice(P[0].length),j=p?atob(n):decodeURIComponent(n),T=new ArrayBuffer(j.length),$=new Uint8Array(T),z=0;z<j.length;z+=1)$[z]=j.charCodeAt(z);return u?new Blob([B?$:T],{type:a}):((te=new S).append(T),te.getBlob(a))},r.HTMLCanvasElement&&!o.toBlob&&(o.mozGetAsFile?o.toBlob=function(h,P,a){var p=this;setTimeout(function(){h(a&&o.toDataURL&&K?K(p.toDataURL(P,a)):p.mozGetAsFile("blob",P))})}:o.toDataURL&&K&&(o.toBlob=o.msToBlob?function(h,P,a){var p=this;setTimeout(function(){h((P&&"image/png"!==P||a)&&o.toDataURL&&K?K(p.toDataURL(P,a)):p.msToBlob(P))})}:function(h,P,a){var p=this;setTimeout(function(){h(K(p.toDataURL(P,a)))})})),y.exports?y.exports=K:r.dataURLtoBlob=K);var C=d.exports,g={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},i=typeof window<"u"&&typeof window.document<"u"?window:{},O=function(r){return r>0&&r<1/0},c=Array.prototype.slice;function M(y){return Array.from?Array.from(y):c.call(y)}var l=/^image\/.+$/;function m(y){return l.test(y)}var W=String.fromCharCode;var v=i.btoa;function k(y){var o,r=new DataView(y);try{var u,B,S;if(255===r.getUint8(0)&&216===r.getUint8(1))for(var H=r.byteLength,K=2;K+1<H;){if(255===r.getUint8(K)&&225===r.getUint8(K+1)){B=K;break}K+=1}if(B){var P=B+10;if("Exif"===function _(y,r,o){var B,u="";for(o+=r,B=r;B<o;B+=1)u+=W(y.getUint8(B));return u}(r,B+4,4)){var a=r.getUint16(P);if(((u=18761===a)||19789===a)&&42===r.getUint16(P+2,u)){var p=r.getUint32(P+4,u);p>=8&&(S=P+p)}}}if(S){var j,T,n=r.getUint16(S,u);for(T=0;T<n;T+=1)if(274===r.getUint16(j=S+12*T+2,u)){o=r.getUint16(j+=8,u),r.setUint16(j,1,u);break}}}catch{o=1}return o}var A=/\.\d*(?:0|9){12}\d*$/;function R(y){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return A.test(y)?Math.round(y*r)/r:y}function b(y){var r=y.aspectRatio,o=y.height,u=y.width,B=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",S=O(u),H=O(o);if(S&&H){var K=o*r;("contain"===B||"none"===B)&&K>u||"cover"===B&&K<u?o=u/r:u=o*r}else S?o=u/r:H&&(u=o*r);return{width:u,height:o}}var Q=i.ArrayBuffer,G=i.FileReader,J=i.URL||i.webkitURL,X=/\.\w+$/,ee=i.Compressor;return function(){function y(r,o){(function f(y,r){if(!(y instanceof r))throw new TypeError("Cannot call a class as a function")})(this,y),this.file=r,this.image=new Image,this.options=t(t({},g),o),this.aborted=!1,this.result=null,this.init()}return function e(y,r,o){return r&&w(y.prototype,r),o&&w(y,o),y}(y,[{key:"init",value:function(){var o=this,u=this.file,B=this.options;if(function(r){return!(typeof Blob>"u")&&(r instanceof Blob||"[object Blob]"===Object.prototype.toString.call(r))}(u)){var S=u.type;if(m(S))if(J&&G)if(Q||(B.checkOrientation=!1),J&&!B.checkOrientation)this.load({url:J.createObjectURL(u)});else{var H=new G,K=B.checkOrientation&&"image/jpeg"===S;this.reader=H,H.onload=function(h){var a=h.target.result,p={};if(K){var n=k(a);n>1||!J?(p.url=function I(y,r){for(var o=[],B=new Uint8Array(y);B.length>0;)o.push(W.apply(null,M(B.subarray(0,8192)))),B=B.subarray(8192);return"data:".concat(r,";base64,").concat(v(o.join("")))}(a,S),n>1&&L(p,function E(y){var r=0,o=1,u=1;switch(y){case 2:o=-1;break;case 3:r=-180;break;case 4:u=-1;break;case 5:r=90,u=-1;break;case 6:r=90;break;case 7:r=90,o=-1;break;case 8:r=-90}return{rotate:r,scaleX:o,scaleY:u}}(n))):p.url=J.createObjectURL(u)}else p.url=a;o.load(p)},H.onabort=function(){o.fail(new Error("Aborted to read the image with FileReader."))},H.onerror=function(){o.fail(new Error("Failed to read the image with FileReader."))},H.onloadend=function(){o.reader=null},K?H.readAsArrayBuffer(u):H.readAsDataURL(u)}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(o){var u=this,B=this.file,S=this.image;S.onload=function(){u.draw(t(t({},o),{},{naturalWidth:S.naturalWidth,naturalHeight:S.naturalHeight}))},S.onabort=function(){u.fail(new Error("Aborted to load the image."))},S.onerror=function(){u.fail(new Error("Failed to load the image."))},i.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(i.navigator.userAgent)&&(S.crossOrigin="anonymous"),S.alt=B.name,S.src=o.url}},{key:"draw",value:function(o){var u=this,B=o.naturalWidth,S=o.naturalHeight,H=o.rotate,K=void 0===H?0:H,h=o.scaleX,P=void 0===h?1:h,a=o.scaleY,p=void 0===a?1:a,n=this.file,j=this.image,T=this.options,$=document.createElement("canvas"),z=$.getContext("2d"),te=Math.abs(K)%180==90,oe=("contain"===T.resize||"cover"===T.resize)&&O(T.width)&&O(T.height),re=Math.max(T.maxWidth,0)||1/0,Z=Math.max(T.maxHeight,0)||1/0,N=Math.max(T.minWidth,0)||0,ne=Math.max(T.minHeight,0)||0,ie=B/S,Y=T.width,q=T.height;if(te){var ue=[Z,re];re=ue[0],Z=ue[1];var de=[ne,N];N=de[0],ne=de[1];var pe=[q,Y];Y=pe[0],q=pe[1]}oe&&(ie=Y/q);var he=b({aspectRatio:ie,width:re,height:Z},"contain");re=he.width,Z=he.height;var fe=b({aspectRatio:ie,width:N,height:ne},"cover");if(N=fe.width,ne=fe.height,oe){var ge=b({aspectRatio:ie,width:Y,height:q},T.resize);Y=ge.width,q=ge.height}else{var me=b({aspectRatio:ie,width:Y,height:q}),ve=me.width;Y=void 0===ve?B:ve;var _e=me.height;q=void 0===_e?S:_e}var Ue=-(Y=Math.floor(R(Math.min(Math.max(Y,N),re))))/2,Me=-(q=Math.floor(R(Math.min(Math.max(q,ne),Z))))/2,Pe=Y,Ce=q,se=[];if(oe){var le,ce,be=b({aspectRatio:ie,width:B,height:S},{contain:"cover",cover:"contain"}[T.resize]);se.push((B-(le=be.width))/2,(S-(ce=be.height))/2,le,ce)}if(se.push(Ue,Me,Pe,Ce),te){var ye=[q,Y];Y=ye[0],q=ye[1]}$.width=Y,$.height=q,m(T.mimeType)||(T.mimeType=n.type);var Oe="transparent";if(n.size>T.convertSize&&T.convertTypes.indexOf(T.mimeType)>=0&&(T.mimeType="image/jpeg"),"image/jpeg"===T.mimeType&&(Oe="#fff"),z.fillStyle=Oe,z.fillRect(0,0,Y,q),T.beforeDraw&&T.beforeDraw.call(this,z,$),!this.aborted&&(z.save(),z.translate(Y/2,q/2),z.rotate(K*Math.PI/180),z.scale(P,p),z.drawImage.apply(z,[j].concat(se)),z.restore(),T.drew&&T.drew.call(this,z,$),!this.aborted)){var xe=function(we){u.aborted||u.done({naturalWidth:B,naturalHeight:S,result:we})};$.toBlob?$.toBlob(xe,T.mimeType,T.quality):xe(C($.toDataURL(T.mimeType,T.quality)))}}},{key:"done",value:function(o){var u=o.naturalWidth,B=o.naturalHeight,S=o.result,H=this.file,h=this.options;if(J&&!h.checkOrientation&&J.revokeObjectURL(this.image.src),S)if(h.strict&&S.size>H.size&&h.mimeType===H.type&&!(h.width>u||h.height>B||h.minWidth>u||h.minHeight>B||h.maxWidth<u||h.maxHeight<B))S=H;else{var P=new Date;S.lastModified=P.getTime(),S.lastModifiedDate=P,S.name=H.name,S.name&&S.type!==H.type&&(S.name=S.name.replace(X,function D(y){var r=m(y)?y.substr(6):"";return"jpeg"===r&&(r="jpg"),".".concat(r)}(S.type)))}else S=H;this.result=S,h.success&&h.success.call(this,S)}},{key:"fail",value:function(o){var u=this.options;if(!u.error)throw o;u.error.call(this,o)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=ee,y}},{key:"setDefaults",value:function(o){L(g,o)}}]),y}()}()},7445:(V,F,t)=>{"use strict";t.d(F,{F:()=>e});var f=t(4986),w=t(5963);function e(x=0,L=f.z){return x<0&&(x=0),(0,w.H)(x,x,L)}},1042:(V,F,t)=>{"use strict";t.d(F,{Z:()=>O});var f,w=new Uint8Array(16);function e(){if(!f&&!(f=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return f(w)}const x=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,d=function L(c){return"string"==typeof c&&x.test(c)};for(var C=[],s=0;s<256;++s)C.push((s+256).toString(16).substr(1));const O=function i(c,M,l){var m=(c=c||{}).random||(c.rng||e)();if(m[6]=15&m[6]|64,m[8]=63&m[8]|128,M){l=l||0;for(var D=0;D<16;++D)M[l+D]=m[D];return M}return function g(c){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=(C[c[M+0]]+C[c[M+1]]+C[c[M+2]]+C[c[M+3]]+"-"+C[c[M+4]]+C[c[M+5]]+"-"+C[c[M+6]]+C[c[M+7]]+"-"+C[c[M+8]]+C[c[M+9]]+"-"+C[c[M+10]]+C[c[M+11]]+C[c[M+12]]+C[c[M+13]]+C[c[M+14]]+C[c[M+15]]).toLowerCase();if(!d(l))throw TypeError("Stringified UUID is invalid");return l}(m)}}}]);