"use strict";(self.webpackChunkpages=self.webpackChunkpages||[]).push([[895],{7429:(re,H,f)=>{f.d(H,{d:()=>J});var y=f(5879),j=f(6223),F=f(1993),Z=f(5661),e=f(336);let R=(()=>{var V;class q{constructor(){this.allowedProps={$ref:{validator:this.isString},anyOf:{validator:this.validateAnyOf},default:{validator:this.isNestedOfPrimitives},definitions:null,description:null,enum:{validator:this.validateEnum},items:{child:"allProps"},maximum:null,maxItems:null,maxLength:null,minimum:null,minItems:null,minLength:null,multipleOf:null,oneOf:{validator:this.validateOneOf},properties:null,required:{validator:this.validateRequired},title:null,type:{validator:this.isNestedOfPrimitives},uniqueItems:null,widget:{child:{formlyConfig:{child:{props:{child:{placeholder:{validator:this.isString},multiple:{validator:this.isBoolean},pattern:{validator:this.isString},type:{validator:function(c){return"hidden"===c}},minLength:{validator:this.isNumber},maxLength:{validator:this.isNumber},rows:{validator:this.isNumber},keepGroupsWithoutId:{validator:this.isBoolean},fieldsetTemplate:{validator:this.isBoolean},startDate:{child:{year:null,month:null,day:null}},endDate:{child:{year:null,month:null,day:null}},minDate:{child:{year:null,month:null,day:null}},maxDate:{child:{year:null,month:null,day:null}},selectDomain:{validator:this.isBoolean},resetButton:{validator:this.isBoolean}}},type:{validator:function(c){return"radio"===c}}}}}}},this.fieldListKeys=["properties","definitions"]}validateSchema(c){this.isObject(c)&&((!c.hasOwnProperty("type")||!c.hasOwnProperty("properties")||"object"!==c.type)&&(c.type="object",c.properties={}),this.validate(c))}validate(c,b){b||(b=this.allowedProps);for(const[o,g]of Object.entries(c)){var C,Q;if(b.hasOwnProperty(o)){if(null!==(C=b[o])&&void 0!==C&&C.hasOwnProperty("validator"))b[o].validator.call(this,g)||delete c[o];else if(this.fieldListKeys.includes(o))for(const E of Object.keys(c[o]))this.validate(c[o][E]);else if(!this.isPrimitive(g)){if(null===(Q=b[o])||void 0===Q||!Q.hasOwnProperty("child")||!this.isObject(g)){delete c[o];continue}this.validate(c[o],"allProps"===b[o].child?this.allowedProps:b[o].child)}}else delete c[o]}}isObject(c){return null!=c&&"object"==typeof c&&!Array.isArray(c)}isPrimitive(c){return this.isString(c)||this.isNumber(c)||this.isBoolean(c)||null==c}isString(c){return"string"==typeof c}isBoolean(c){return"boolean"==typeof c}isNumber(c){return"number"==typeof c}validateRequired(c){if(!Array.isArray(c))return!1;for(const b of c)if(!this.isString(b))return!1;return!0}validateEnum(c){if(!Array.isArray(c))return!1;for(const b of c)if(!this.isString(b)&&!this.isNumber(b))return!1;return!0}validateOneOf(c){var b;if(Array.isArray(c)&&null!==(b=c[0])&&void 0!==b&&b.hasOwnProperty("const")){for(const C of c){if(!this.isObject(C))return!1;this.validate(C,{const:null,title:null})}return!0}return this.validateAnyOf(c)}validateAnyOf(c){if(!Array.isArray(c))return!1;for(const b of c){if(!this.isObject(b))return!1;this.validate(b)}return!0}isNestedOfPrimitives(c){if(this.isPrimitive(c))return!0;if(Array.isArray(c)||this.isObject(c)){for(const b of Object.values(c))if(!this.isNestedOfPrimitives(b))return!1;return!0}return!1}}return(V=q).\u0275fac=function(c){return new(c||V)},V.\u0275prov=y.Yz7({token:V,factory:V.\u0275fac,providedIn:"root"}),q})();var z=f(5545);const ee=["app-custom-form",""],W=[[["","buttons",""]]],K=["[buttons]"];let J=(()=>{var V;class q{constructor(c,b,C,Q){this.formlyJsonschema=c,this.customFormSchemaService=b,this.toastService=C,this.destroyRef=Q,this.model={},this.validateSchema=!1,this.enableModelChangeEvent=!1,this.defaultModel={},this.showFieldValidationOnInit=!1,this.cancelEvent=new y.vpe,this.submitEvent=new y.vpe,this.validityChangeEvent=new y.vpe,this.modelChangeEvent=new y.vpe,this.form=new j.nJ({}),this.fields=[],this.options={},this.isFormCurrentlyValid=!0}ngAfterViewInit(){this.validityChangeEvent.emit(this.isFormCurrentlyValid=this.form.valid)}ngOnInit(){this.createFields(),this.form.statusChanges.pipe((0,F.sL)(this.destroyRef)).subscribe(c=>{this.form.valid!==this.isFormCurrentlyValid&&this.validityChangeEvent.emit(this.isFormCurrentlyValid=this.form.valid)})}ngOnChanges(c){c.schema&&!c.schema.firstChange&&this.createFields()}createFields(){this.customFormSchemaService.isObject(this.schema)||(this.schema={}),this.validateSchema&&this.customFormSchemaService.validateSchema(this.schema),this.fields=[this.formlyJsonschema.toFieldConfig(this.schema)],this.showFieldValidationOnInit&&this.showFieldValidation()}showFieldValidation(){this.cycleFields(this.fields)}showFieldValidationWithMessage(){this.showFieldValidation(),this.toastService.show({content:"Tutti i campi sono stati <strong>validati</strong>: quelli con errore sono evidenziati da un <strong>bordo rosso</strong>!"})}cycleFields(c){c.forEach(b=>{this.forceValidation(b),b.fieldGroup&&this.cycleFields(b.fieldGroup)})}forceValidation(c){c.validation||(c.validation={}),c.validation.show=!0}reset(){this.options.resetModel&&this.options.resetModel(this.defaultModel)}cancel(){this.cancelEvent.emit()}submit(){this.form.valid&&(this.log(),this.submitEvent.emit(this.model))}onModelChange(c){this.enableModelChangeEvent&&this.modelChangeEvent.emit(c||{})}log(){}}return(V=q).\u0275fac=function(c){return new(c||V)(y.Y36(e.c),y.Y36(R),y.Y36(Z.k),y.Y36(y.ktI))},V.\u0275cmp=y.Xpm({type:V,selectors:[["","app-custom-form",""]],inputs:{schema:"schema",model:"model",validateSchema:"validateSchema",enableModelChangeEvent:"enableModelChangeEvent",defaultModel:"defaultModel",showFieldValidationOnInit:"showFieldValidationOnInit"},outputs:{cancelEvent:"cancelEvent",submitEvent:"submitEvent",validityChangeEvent:"validityChangeEvent",modelChangeEvent:"modelChangeEvent"},features:[y.TTD],attrs:ee,ngContentSelectors:K,decls:3,vars:5,consts:[[3,"formGroup","ngSubmit"],[3,"model","fields","form","options","modelChange"]],template:function(c,b){1&c&&(y.F$t(W),y.TgZ(0,"form",0),y.NdJ("ngSubmit",function(){return b.submit()}),y.TgZ(1,"formly-form",1),y.NdJ("modelChange",function(Q){return b.onModelChange(Q)}),y.qZA(),y.Hsn(2),y.qZA()),2&c&&(y.Q6J("formGroup",b.form),y.xp6(1),y.Q6J("model",b.model)("fields",b.fields)("form",b.form)("options",b.options))},dependencies:[z.T7,j._Y,j.JL,j.sg]}),q})()},6687:(re,H,f)=>{f.d(H,{I:()=>Zt});var y=f(6814),j=f(7905),F=f(3912),Z=f(5545),e=f(5879),R=f(8595);function z(t,s){1&t&&e.GkF(0)}function ee(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"div",13),e.TgZ(2,"div",14),e._uU(3," ("),e.YNc(4,z,1,0,"ng-container",15),e._uU(5,") "),e.qZA(),e.BQk()),2&t){const n=e.oxw(),i=e.MAs(15);e.xp6(1),e.Q6J("innerHTML",n.parsedTitle,e.oJD),e.xp6(3),e.Q6J("ngTemplateOutlet",i)}}function W(t,s){1&t&&e.GkF(0)}function K(t,s){if(1&t&&(e.TgZ(0,"div",16),e._uU(1," Lista di "),e.YNc(2,W,1,0,"ng-container",15),e.qZA()),2&t){e.oxw();const n=e.MAs(15);e.xp6(2),e.Q6J("ngTemplateOutlet",n)}}function J(t,s){if(1&t&&e._UZ(0,"div",17),2&t){const n=e.oxw();e.Q6J("innerHTML",n.parsedDescription,e.oJD)}}const V=function(t){return{"mt-3":t}};function q(t,s){if(1&t&&(e.TgZ(0,"div",18),e._UZ(1,"formly-validation-message",19),e.qZA()),2&t){const n=e.oxw();e.Q6J("ngClass",e.VKq(2,V,n.parsedDescription.length)),e.xp6(1),e.Q6J("field",n.field)}}function G(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"li")(1,"div",30),e.NdJ("click",function(){e.CHM(n);const r=e.oxw().index,l=e.oxw(2);return e.KtG(l.move(r,r-1))}),e._uU(2," arrow_circle_up "),e.qZA()()}2&t&&(e.xp6(1),e.Q6J("disableOnTouchDevice",!0))}const c=function(t){return{"ms-1":t}};function b(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"li",31)(1,"div",32),e.NdJ("click",function(){e.CHM(n);const r=e.oxw().index,l=e.oxw(2);return e.KtG(l.move(r,r+1))}),e._uU(2," arrow_circle_down "),e.qZA()()}if(2&t){const n=e.oxw().first;e.Q6J("ngClass",e.VKq(2,c,!n)),e.xp6(1),e.Q6J("disableOnTouchDevice",!0)}}function C(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"li",31)(1,"div",33),e.NdJ("click",function(){e.CHM(n);const r=e.oxw().index,l=e.oxw(2);return e.KtG(l.remove(r))}),e._uU(2," highlight_off "),e.qZA()()}if(2&t){const n=e.oxw();e.Q6J("ngClass",e.VKq(2,c,!(n.first&&n.last))),e.xp6(1),e.Q6J("disableOnTouchDevice",!0)}}const Q=function(t){return{"mb-3":t}},o=function(t){return{"has-error":t}};function g(t,s){if(1&t&&(e.TgZ(0,"li",22)(1,"fieldset",23)(2,"legend",24)(3,"div",25)(4,"div",26),e._uU(5),e.qZA(),e.TgZ(6,"ul",27),e.YNc(7,G,3,1,"li",28),e.YNc(8,b,3,4,"li",29),e.YNc(9,C,3,4,"li",29),e.qZA()()(),e._UZ(10,"formly-field",19),e.qZA()()),2&t){const n=s.$implicit,i=s.index,r=s.first,l=s.last;e.Q6J("ngClass",e.VKq(7,Q,!l)),e.xp6(1),e.Q6J("ngClass",e.VKq(9,o,null==n.formControl?null:n.formControl.invalid)),e.xp6(4),e.hij("#",i+1,""),e.xp6(2),e.Q6J("ngIf",!r),e.xp6(1),e.Q6J("ngIf",!l),e.xp6(1),e.Q6J("ngIf",n.props&&!1!==n.props.removable),e.xp6(1),e.Q6J("field",n)}}function E(t,s){if(1&t&&(e.TgZ(0,"ul",20),e.YNc(1,g,11,11,"li",21),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.field.fieldGroup)}}const w=function(t){return{"d-none d-md-inline":t}};function u(t,s){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA(),e.TgZ(2,"span",31),e._uU(3),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Oqu(n.field.fieldGroup?n.field.fieldGroup.length:0),e.xp6(1),e.Q6J("ngClass",e.VKq(3,w,n.props.label)),e.xp6(1),e.hij(" element",n.field.fieldGroup&&1===n.field.fieldGroup.length?"o":"i","")}}const x=function(){return[10,10]},a=function(t){return{placement:"top-end",offset:t}};let p=(()=>{var t;class s extends Z.hv{constructor(i){super(),this.customFormUtilsService=i,this.parsedTitle="",this.parsedDescription=""}ngOnInit(){this.parsedDescription=this.props.description?this.customFormUtilsService.parseBBCode(this.props.description):"",this.parsedTitle=this.props.label?this.customFormUtilsService.parseBBCode(this.props.label):""}get maxLengthExceeded(){return this.props.maxItems&&this.model&&this.model.length>=this.props.maxItems}move(i,r){const l=this.model[i];this.remove(i),this.add(r,l)}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(F.d6))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-array"]],features:[e.qOj],decls:16,vars:14,consts:[[1,"rounded","px-3","pb-3","pt-2","mb-3","formly-fieldset",3,"ngClass"],[1,"legend-reset","pb-1","px-2","mb-0","mw-100"],[1,"d-flex","align-items-center","mw-100"],[4,"ngIf","ngIfElse"],["nolabel",""],["class","mb-2 text-justify",3,"innerHTML",4,"ngIf"],["class","alert alert-danger formly-field-array-error text-center","role","alert",3,"ngClass",4,"ngIf"],["class","list-unstyled mb-3",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["appTippy","Hai aggiunto il numero massimo di elementi!",3,"disableInstance","tippyProps"],["type","button",1,"btn","btn-primary","d-flex","align-items-center",3,"disabled","click"],[1,"material-icons"],["itemscount",""],[1,"fs-lg","text-truncate","mw-100",3,"innerHTML"],[1,"ms-2","fs-reset","lh-1","fst-italic","list-counter","text-nowrap"],[4,"ngTemplateOutlet"],[1,"fs-xl","text-truncate","mw-10"],[1,"mb-2","text-justify",3,"innerHTML"],["role","alert",1,"alert","alert-danger","formly-field-array-error","text-center",3,"ngClass"],[3,"field"],[1,"list-unstyled","mb-3"],["class","item",3,"ngClass",4,"ngFor","ngForOf"],[1,"item",3,"ngClass"],[1,"rounded","formly-fieldset","dashed","show-success","px-3",3,"ngClass"],[1,"legend-reset","ms-auto","mb-0","px-2"],[1,"d-flex","align-items-center"],[1,"fs-xl","ms-1"],[1,"ms-2","mb-0","item-icons","list-unstyled","d-flex","align-items-center"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["appTippy","Sposta in alto",1,"d-block","material-icons","cursor-pointer",3,"disableOnTouchDevice","click"],[3,"ngClass"],["appTippy","Sposta in basso",1,"d-block","material-icons","cursor-pointer",3,"disableOnTouchDevice","click"],["appTippy","Rimuovi",1,"d-block","material-icons","cursor-pointer","text-danger",3,"disableOnTouchDevice","click"]],template:function(i,r){if(1&i&&(e.TgZ(0,"fieldset",0)(1,"legend",1)(2,"div",2),e.YNc(3,ee,6,2,"ng-container",3),e.YNc(4,K,3,1,"ng-template",null,4,e.W1O),e.qZA()(),e.YNc(6,J,1,1,"div",5),e.YNc(7,q,2,4,"div",6),e.YNc(8,E,2,1,"ul",7),e.TgZ(9,"div",8)(10,"div",9)(11,"button",10),e.NdJ("click",function(){return!r.maxLengthExceeded&&r.add()}),e.TgZ(12,"span",11),e._uU(13,"add"),e.qZA()()()(),e.YNc(14,u,4,5,"ng-template",null,12,e.W1O),e.qZA()),2&i){const l=e.MAs(5);e.Q6J("ngClass",e.VKq(9,o,r.formControl.invalid)),e.xp6(3),e.Q6J("ngIf",r.parsedTitle)("ngIfElse",l),e.xp6(3),e.Q6J("ngIf",r.parsedDescription),e.xp6(1),e.Q6J("ngIf",r.showError&&r.formControl.errors),e.xp6(1),e.Q6J("ngIf",r.field.fieldGroup&&r.field.fieldGroup.length),e.xp6(2),e.Q6J("disableInstance",!r.maxLengthExceeded)("tippyProps",e.VKq(12,a,e.DdM(11,x))),e.xp6(1),e.Q6J("disabled",r.maxLengthExceeded)}},dependencies:[y.mk,y.sg,y.O5,y.tP,Z.cw,Z.M2,R.$],styles:["legend[_ngcontent-%COMP%]   .item-icons[_ngcontent-%COMP%]{padding-top:.1rem}"]}),s})();var O=f(1413),m=f(4020),_=f(6223),P=f(91),k=f(2181),D=f(8180),I=f(5619);const Y=["language","theme"],te=["editor"];let de=(()=>{class t{constructor(n,i){this.ngZone=n,this.monacoPathConfig=i,this.isMonacoLoaded$=new I.X(!1),this._monacoPath="assets/monaco-editor/min/vs",window.monacoEditorAlreadyInitialized?n.run(()=>this.isMonacoLoaded$.next(!0)):(window.monacoEditorAlreadyInitialized=!0,this.monacoPathConfig&&(this.monacoPath=this.monacoPathConfig),this.loadMonaco())}set monacoPath(n){n&&(this._monacoPath=n)}loadMonaco(){const n=()=>{let h=this._monacoPath;window.amdRequire=window.require;const S=!!this.nodeRequire,N=h.includes("http");S&&(window.require=this.nodeRequire,N||(h=window.require("path").resolve(window.__dirname,this._monacoPath))),window.amdRequire.config({paths:{vs:h}}),window.amdRequire(["vs/editor/editor.main"],()=>{this.ngZone.run(()=>this.isMonacoLoaded$.next(!0))},A=>console.error("Error loading monaco-editor: ",A))};if(window.amdRequire)return n();window.require&&(this.addElectronFixScripts(),this.nodeRequire=window.require);const l=document.createElement("script");l.type="text/javascript",l.src=`${this._monacoPath}/loader.js`,l.addEventListener("load",n),document.body.appendChild(l)}addElectronFixScripts(){const n=document.createElement("script"),i=document.createTextNode("self.module = undefined;"),r=document.createTextNode("self.process.browser = true;");n.appendChild(i),n.appendChild(r),document.body.appendChild(n)}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(e.R0b),e.LFG("MONACO_PATH",8))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),oe=(()=>{class t{constructor(n){this.monacoLoader=n,this.init=new e.vpe,this.onTouched=()=>{},this.onErrorStatusChange=()=>{},this.propagateChange=()=>{}}get model(){return this.editor&&this.editor.getModel()}get modelMarkers(){return this.model&&monaco.editor.getModelMarkers({resource:this.model.uri})}ngOnInit(){this.monacoLoader.isMonacoLoaded$.pipe((0,k.h)(n=>n),(0,D.q)(1)).subscribe(()=>{this.initEditor()})}ngOnChanges(n){if(this.editor&&n.options&&!n.options.firstChange){const i=n.options.currentValue,{language:r,theme:l}=i,h=(0,P.Z)(i,Y),{language:S,theme:N}=n.options.previousValue;S!==r&&monaco.editor.setModelLanguage(this.editor.getModel(),this.options&&this.options.language?this.options.language:"text"),N!==l&&monaco.editor.setTheme(l),this.editor.updateOptions(h)}if(this.editor&&n.uri){const i=n.uri.currentValue,r=n.uri.previousValue;if(r&&!i||!r&&i||i&&r&&i.path!==r.path){const l=this.editor.getValue();let h;this.modelUriInstance&&this.modelUriInstance.dispose(),i&&(h=monaco.editor.getModels().find(S=>S.uri.path===i.path)),this.modelUriInstance=h||monaco.editor.createModel(l,this.options.language||"text",this.uri),this.editor.setModel(this.modelUriInstance)}}}writeValue(n){this.value=n,this.editor&&n?this.editor.setValue(n):this.editor&&this.editor.setValue("")}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){this.onTouched=n}validate(){return this.parsedError?{monaco:{value:this.parsedError.split("|")}}:null}registerOnValidatorChange(n){this.onErrorStatusChange=n}initEditor(){const n={value:[this.value].join("\n"),language:"text",automaticLayout:!0,scrollBeyondLastLine:!1,theme:"vc"};this.editor=monaco.editor.create(this.editorContent.nativeElement,this.options?(0,O.Z)((0,O.Z)({},n),this.options):n),this.registerEditorListeners(),this.init.emit(this.editor)}registerEditorListeners(){this.editor.onDidChangeModelContent(()=>{this.propagateChange(this.editor.getValue())}),this.editor.onDidChangeModelDecorations(()=>{const n=this.modelMarkers.map(({message:r})=>r).join("|");this.parsedError!==n&&(this.parsedError=n,this.onErrorStatusChange())}),this.editor.onDidBlurEditorText(()=>{this.onTouched()})}ngOnDestroy(){this.editor&&this.editor.dispose()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(de))},t.\u0275cmp=e.Xpm({type:t,selectors:[["ngx-monaco-editor"]],viewQuery:function(n,i){if(1&n&&e.Gf(te,7),2&n){let r;e.iGM(r=e.CRH())&&(i.editorContent=r.first)}},inputs:{options:"options",uri:"uri"},outputs:{init:"init"},features:[e._Bn([{provide:_.JU,useExisting:(0,e.Gpc)(()=>t),multi:!0},{provide:_.Cf,useExisting:(0,e.Gpc)(()=>t),multi:!0}]),e.TTD],decls:4,vars:0,consts:[["fxFlex","",1,"editor-container"],["container",""],[1,"monaco-editor"],["editor",""]],template:function(n,i){1&n&&(e.TgZ(0,"div",0,1),e._UZ(2,"div",2,3),e.qZA())},styles:[".monaco-editor[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}.editor-container[_ngcontent-%COMP%]{overflow:hidden;position:relative;display:table;width:100%;height:100%;min-width:0}"],changeDetection:0}),t})(),se=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[]]}),t})();function T(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"textarea",2),e._uU(2,"            "),e.qZA(),e.BQk()),2&t){const n=e.oxw();e.xp6(1),e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("cols",1)("rows",10)("formlyAttributes",n.field)}}function d(t,s){1&t&&(e.ynx(0),e.TgZ(1,"p",4),e._UZ(2,"span",5),e.qZA(),e.BQk())}function v(t,s){if(1&t&&e._UZ(0,"ngx-monaco-editor",6),2&t){const n=e.oxw(2);e.Udp("height",n.editorHeight),e.Q6J("options",n.editorOptions)("formControl",n.formControl)}}function M(t,s){if(1&t&&(e.YNc(0,d,3,0,"ng-container",0),e.YNc(1,v,1,4,"ng-template",null,3,e.W1O)),2&t){const n=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.loading)("ngIfElse",n)}}let L=(()=>{var t;class s extends Z.fS{constructor(){super(...arguments),this.touchDevice=m.eX,this.editorOptions={theme:"vs-dark",language:"json"},this.loading=!0,this.editorHeight="350px"}ngOnInit(){this.touchDevice||(this.field.props.editorOptions&&(this.field.props.editorOptions.height&&(this.editorHeight=this.field.props.editorOptions.height,delete this.field.props.editorOptions.height),this.editorOptions=(0,O.Z)((0,O.Z)({},this.editorOptions),this.field.props.editorOptions)),this.loading=!1)}}return(t=s).\u0275fac=function(){let n;return function(r){return(n||(n=e.n5z(t)))(r||t)}}(),t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-code-editor-type"]],features:[e.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["notTouchDevice",""],[1,"form-control",3,"formControl","cols","rows","formlyAttributes"],["codeEditor",""],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],[1,"d-block","formly-code-editor",3,"options","formControl"]],template:function(i,r){if(1&i&&(e.YNc(0,T,3,6,"ng-container",0),e.YNc(1,M,3,2,"ng-template",null,1,e.W1O)),2&i){const l=e.MAs(2);e.Q6J("ngIf",r.touchDevice)("ngIfElse",l)}},dependencies:[y.O5,Z.JD,_.Fj,_.JJ,_.oH,oe],encapsulation:2}),s})();var U=f(5861),$=f(8784);function ne(t,s){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"div",4),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.formControl.setValue(void 0))}),e._uU(2,"highlight_off"),e.qZA(),e.BQk()}}function B(t,s){1&t&&(e.ynx(0),e.TgZ(1,"p",5),e._UZ(2,"span",6),e.qZA(),e.BQk())}function ve(t,s){if(1&t&&e._UZ(0,"option",10),2&t){const n=s.$implicit;e.Q6J("ngValue",n.id||n.name)("innerText",n.name)}}function Ce(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"select",8),e.YNc(2,ve,1,2,"option",9),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(1),e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(1),e.Q6J("ngForOf",n.groupsList)}}function Fe(t,s){if(1&t&&e._UZ(0,"option",10),2&t){const n=s.$implicit;e.Q6J("ngValue",n.id||n.name)("innerText",n.name)}}function xe(t,s){if(1&t&&(e.TgZ(0,"select",11),e.YNc(1,Fe,1,2,"option",9),e.qZA()),2&t){const n=e.oxw(2);e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(1),e.Q6J("ngForOf",n.groupsList)}}function Te(t,s){if(1&t&&(e.YNc(0,Ce,3,5,"ng-container",2),e.YNc(1,xe,2,5,"ng-template",null,7,e.W1O)),2&t){const n=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.field.props.multiple)("ngIfElse",n)}}const Oe=function(t){return{"no-label":t}};let Me=(()=>{var t;class s extends Z.fS{constructor(i,r){super(),this.forumService=i,this.changeDetectorRef=r,this.loading=!0,this.groupsList=[]}ngOnInit(){var i=this;return(0,U.Z)(function*(){i.field.defaultValue=void 0,i.field.props.hasOwnProperty("multiple")||(i.field.props.multiple=!0),i.groupsList=(yield i.forumService.getGroups()).sort((r,l)=>r.name.localeCompare(l.name)),i.field.props.keepGroupsWithoutId||(i.groupsList=i.groupsList.filter(r=>r.id>0)),i.loading=!1,i.field.formControl.updateValueAndValidity(),i.changeDetectorRef.detectChanges()})()}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36($._),e.Y36(e.sBO))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-groups"]],features:[e.qOj],decls:5,vars:6,consts:[[1,"position-relative","wrapper",3,"ngClass"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["formSelect",""],[1,"reset-icon","position-absolute","cursor-pointer","d-block","material-icons","text-danger",3,"click"],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],["single",""],["multiple","",1,"form-select",3,"formControl","formlyAttributes"],[3,"ngValue","innerText",4,"ngFor","ngForOf"],[3,"ngValue","innerText"],[1,"form-select",3,"formControl","formlyAttributes"]],template:function(i,r){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,ne,3,0,"ng-container",1),e.YNc(2,B,3,0,"ng-container",2),e.YNc(3,Te,3,2,"ng-template",null,3,e.W1O),e.qZA()),2&i){const l=e.MAs(4);e.Q6J("ngClass",e.VKq(4,Oe,!r.props.label)),e.xp6(1),e.Q6J("ngIf",!r.props.label||void 0!==r.formControl.value),e.xp6(1),e.Q6J("ngIf",r.loading)("ngIfElse",l)}},dependencies:[y.mk,y.sg,y.O5,Z.JD,_.YN,_.Kr,_.EJ,_.K7,_.JJ,_.oH],styles:[".reset-icon[_ngcontent-%COMP%]{right:0}.wrapper[_ngcontent-%COMP%]:not(.no-label)   .reset-icon[_ngcontent-%COMP%]{top:calc(-24px - .45rem)}.no-label[_ngcontent-%COMP%]{padding-top:calc(24px + .45rem)}.no-label[_ngcontent-%COMP%]   .reset-icon[_ngcontent-%COMP%]{top:0}"]}),s})();var Ee=f(1410),ce=f(8645);const be=[{value:F.ig.FORUMFREE,placeholder:"ForumFree"},{value:F.ig.FORUMCOMMUNITY,placeholder:"ForumCommunity"},{value:F.ig.BLOGFREE,placeholder:"BlogFree"}];function we(t,s){if(1&t&&e._UZ(0,"option",2),2&t){const n=s.$implicit;e.Q6J("ngValue",n.value)("innerText",n.placeholder)}}let Se=(()=>{var t;class s{constructor(){this.model=F.ig.FORUMFREE,this.modelChange=new e.vpe,this.options=be}}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-domain-select"]],inputs:{model:"model"},outputs:{modelChange:"modelChange"},decls:2,vars:2,consts:[[1,"form-select",3,"ngModel","ngModelChange"],[3,"ngValue","innerText",4,"ngFor","ngForOf"],[3,"ngValue","innerText"]],template:function(i,r){1&i&&(e.TgZ(0,"select",0),e.NdJ("ngModelChange",function(h){return r.model=h})("ngModelChange",function(h){return r.modelChange.emit(h)}),e.YNc(1,we,1,2,"option",1),e.qZA()),2&i&&(e.Q6J("ngModel",r.model),e.xp6(1),e.Q6J("ngForOf",r.options))},dependencies:[y.sg,_.YN,_.Kr,_.EJ,_.JJ,_.On],encapsulation:2}),s})();var ue=f(7827),Ae=f(9473),De=f(7357);function Ie(t,s){1&t&&(e.TgZ(0,"div",4),e._UZ(1,"app-loader",5),e.qZA())}function Ze(t,s){1&t&&e._UZ(0,"div",8),2&t&&e.Q6J("innerText","Nessun elemento inserito!")}function Pe(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"li")(1,"a",11)(2,"div",12),e.NdJ("click",function(r){const h=e.CHM(n).index,S=e.oxw(3);return e.KtG(S.remove(h,r))}),e.TgZ(3,"div",13),e._uU(4," remove "),e.qZA()(),e._UZ(5,"img",14),e.ALo(6,"uploadsreplace"),e.qZA(),e._UZ(7,"a",15),e.qZA()}if(2&t){const n=s.$implicit,i=e.oxw(3);e.Gre("d-flex flex-column align-items-center item-",n.type,""),e.xp6(1),e.Q6J("href",n.link,e.LSH),e.xp6(1),e.Q6J("disableOnTouchDevice",!0),e.xp6(3),e.s9C("alt",n.title),e.Q6J("src",i.lazyImagePlaceholder,e.LSH)("lazyLoad",e.lcZ(6,12,n.image))("offset",100)("errorImage",i.defaultImage),e.xp6(2),e.Q6J("innerHTML",n.title,e.oJD)("href",n.link,e.LSH)}}function Ve(t,s){if(1&t&&(e.TgZ(0,"ul",9),e.YNc(1,Pe,8,14,"li",10),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.list)}}function Le(t,s){if(1&t&&(e.YNc(0,Ze,1,1,"div",6),e.YNc(1,Ve,2,1,"ng-template",null,7,e.W1O)),2&t){const n=e.MAs(2),i=e.oxw();e.Q6J("ngIf",0===i.list.length)("ngIfElse",n)}}const Je=function(t){return{"empty-list":t}};let Ne=(()=>{var t;class s{constructor(){this.list=[],this.defaultImage="/assets/default_avatar.png",this.loading=!0,this.removeEvent=new e.vpe,this.lazyImagePlaceholder=m.vX}remove(i,r){r.preventDefault(),r.stopPropagation();const l=this.list[i].id;this.list.splice(i,1),this.list=[...this.list],this.removeEvent.emit(l)}}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-formly-typeahead-content"]],inputs:{list:"list",listTitle:"listTitle",defaultImage:"defaultImage",loading:"loading"},outputs:{removeEvent:"removeEvent"},decls:5,vars:6,consts:[[1,"formly-list-container","rounded","px-3","pt-2","mt-2",3,"ngClass"],[1,"legend-reset","fs-reset","mb-0","px-2","pb-1",3,"innerText"],["class","d-flex justify-content-center",4,"ngIf","ngIfElse"],["content",""],[1,"d-flex","justify-content-center"],["message","Recupero dei dati"],["class","text-center mb-0 px-1 pb-1 fst-italic",3,"innerText",4,"ngIf","ngIfElse"],["noEmpty",""],[1,"text-center","mb-0","px-1","pb-1","fst-italic",3,"innerText"],[1,"formly-list","list-unstyled","mb-0","d-grid","px-2"],[3,"class",4,"ngFor","ngForOf"],["target","_blank",1,"preview","rounded-circle","d-block","position-relative",3,"href"],["appTippy","Rimuovi",1,"remove-btn","alert","alert-danger","position-absolute","cursor-pointer","mb-0","py-0","px-1",3,"disableOnTouchDevice","click"],[1,"material-icons","d-block","fs-reset"],[1,"d-block","image-cover","rounded-circle",3,"src","lazyLoad","offset","errorImage","alt"],["target","_blank",1,"d-block","fw-bold","mt-1","item-title","text-truncate","mw-100",3,"innerHTML","href"]],template:function(i,r){if(1&i&&(e.TgZ(0,"fieldset",0),e._UZ(1,"legend",1),e.YNc(2,Ie,2,0,"div",2),e.YNc(3,Le,3,2,"ng-template",null,3,e.W1O),e.qZA()),2&i){const l=e.MAs(4);e.Q6J("ngClass",e.VKq(4,Je,0===r.list.length)),e.xp6(1),e.Q6J("innerText",r.listTitle),e.xp6(1),e.Q6J("ngIf",r.loading)("ngIfElse",l)}},dependencies:[y.mk,y.sg,y.O5,ue.z1,Ae.R,R.$,De.g],styles:[".formly-list-container[_ngcontent-%COMP%]{border:1px dashed var(--bs-gray-500)}.formly-list-container[_ngcontent-%COMP%]:not(.empty-list){padding-bottom:.75rem}.formly-list-container.empty-list[_ngcontent-%COMP%]{padding-bottom:1rem}.formly-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(60px,1fr));gap:1rem}.formly-list[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{top:0;left:-8px}.formly-list[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:60px;height:60px;border:2px solid}.formly-list[_ngcontent-%COMP%]   .item-ff[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{border-color:#58a72e}.formly-list[_ngcontent-%COMP%]   .item-ff[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{color:#58a72e!important}.formly-list[_ngcontent-%COMP%]   .item-fc[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{border-color:#0082cd}.formly-list[_ngcontent-%COMP%]   .item-fc[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{color:#0082cd!important}.formly-list[_ngcontent-%COMP%]   .item-bf[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{border-color:#e67f22}.formly-list[_ngcontent-%COMP%]   .item-bf[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{color:#e67f22!important}@media (min-width: 960px){.formly-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(75px,1fr));gap:1.5rem}.formly-list[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{top:4px}.formly-list[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:75px;height:75px}}"]}),s})();var Qe=f(1378),ke=f(3620),je=f(3997),Ue=f(3019),pe=f(9397),qe=f(4664),Ge=f(2096),Ye=f(1993),$e=f(5661),le=f(8726);function Be(t,s){1&t&&(e.TgZ(0,"span",8),e._uU(1,"*"),e.qZA())}function He(t,s){if(1&t&&(e.TgZ(0,"legend",5)(1,"label",6),e._uU(2),e.YNc(3,Be,2,0,"span",7),e.qZA()()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("for",n.field.id),e.xp6(1),e.hij(" ",n.props.label," "),e.xp6(1),e.Q6J("ngIf",n.props.required)}}function We(t,s){1&t&&e.GkF(0)}function Ke(t,s){1&t&&e.GkF(0)}function Xe(t,s){if(1&t&&e._UZ(0,"div",9),2&t){const n=e.oxw();e.Q6J("innerHTML",n.parsedDescription,e.oJD)}}function ze(t,s){1&t&&(e.TgZ(0,"div",16)(1,"span",17),e._uU(2,"Loading..."),e.qZA()())}function et(t,s){1&t&&e.GkF(0)}function tt(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"div",18),e.YNc(2,et,1,0,"ng-container",2),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(2),e.Q6J("ngTemplateOutlet",n.additionalInputsTemplate)}}function nt(t,s){if(1&t&&(e.TgZ(0,"div",19),e._UZ(1,"formly-validation-message",20),e.qZA()),2&t){const n=e.oxw(2);e.Udp("display","block"),e.xp6(1),e.Q6J("field",n.field)}}function it(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"input",12),e.NdJ("ngModelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.inputValue=r)})("selectItem",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.selectEntity(r))})("focus",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.focusSubject.next(r.target.value))}),e.qZA(),e.YNc(3,ze,3,0,"div",13),e.qZA(),e.YNc(4,tt,3,1,"ng-container",14),e.qZA(),e.YNc(5,nt,2,3,"div",15)}if(2&t){const n=e.oxw();e.xp6(2),e.ekj("is-invalid",n.showError),e.Q6J("ngModel",n.inputValue)("formlyAttributes",n.field)("ngbTypeahead",n.search)("editable",!1)("inputFormatter",n.inputFormatter)("resultFormatter",n.resultFormatter),e.xp6(1),e.Q6J("ngIf",n.searching),e.xp6(1),e.Q6J("ngIf",n.additionalInputsTemplate),e.xp6(1),e.Q6J("ngIf",n.showError)}}let ot=(()=>{var t;class s{constructor(i,r,l,h){this.customFormUtilsService=i,this.changeDetectorRef=r,this.toastService=l,this.destroyRef=h,this.showError=!1,this.selectItemEvent=new e.vpe,this.populateListEvent=new e.vpe,this.inputValue="",this.inputFormatter=S=>S.name,this.focusSubject=new ce.x,this.searching=!1,this.formlyFieldValues=[],this.search=S=>{const N=S.pipe((0,ke.b)(700),(0,je.x)());return(0,Ue.T)(N,this.focusSubject).pipe((0,pe.b)(()=>this.setSearching(!0)),(0,qe.w)(A=>A.length<3?(0,Ge.of)([]):this.searchFunction(A)),(0,pe.b)(()=>this.setSearching(!1)))}}ngOnInit(){this.formControl=this.field.formControl,this.props=this.field.props,this.parsedDescription=this.props.description?this.customFormUtilsService.parseBBCode(this.props.description):void 0,this.formlyFieldValues=Array.isArray(this.formControl.value)?this.formControl.value:Array.isArray(this.field.defaultValue)?this.field.defaultValue:[],this.populateListEvent.emit(this.formlyFieldValues),this.formControl.updateValueAndValidity(),this.removeItemObservable.pipe((0,Ye.sL)(this.destroyRef)).subscribe(i=>{const r=this.formlyFieldValues.indexOf(i);r>-1&&(this.formlyFieldValues.splice(r,1),this.formControl.setValue([...this.formlyFieldValues]))})}resultFormatter(i){return i.name.indexOf("&")>-1?function Re(t){const s=document.createElement("TEXTAREA");return s.innerHTML=t,s.value}(i.name):i.name}setSearching(i){this.searching=i,this.changeDetectorRef.detectChanges()}selectEntity(i){const r=i.item;if(i.preventDefault(),this.formlyFieldValues.includes(r.id))return this.toastService.show({content:`L'elemento <strong>${r.name}</strong> \xe8 gi\xe0 stato aggiunto alla lista!`,level:Qe.m.ERROR}),void(this.inputValue="");this.formlyFieldValues.push(r.id),this.selectItemEvent.emit(i.item),this.inputValue="",this.updateFieldValue()}updateFieldValue(){this.formControl.setValue([...this.formlyFieldValues])}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(F.d6),e.Y36(e.sBO),e.Y36($e.k),e.Y36(e.ktI))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-formly-typeahead"]],inputs:{field:"field",showError:"showError",removeItemObservable:"removeItemObservable",searchFunction:"searchFunction",resultsTemplate:"resultsTemplate",additionalInputsTemplate:"additionalInputsTemplate"},outputs:{selectItemEvent:"selectItemEvent",populateListEvent:"populateListEvent"},decls:7,vars:6,consts:[[1,"mb-3","rounded","px-3","pt-2","pb-3","formly-fieldset"],["class","legend-reset fs-reset mb-0 px-2 mw-100 lh-1 py-1",4,"ngIf"],[4,"ngTemplateOutlet"],["class","form-text text-muted",3,"innerHTML",4,"ngIf"],["typeaheadTemplate",""],[1,"legend-reset","fs-reset","mb-0","px-2","mw-100","lh-1","py-1"],[1,"form-label","mb-0","mw-100","text-truncate",3,"for"],["aria-hidden","true",4,"ngIf"],["aria-hidden","true"],[1,"form-text","text-muted",3,"innerHTML"],[1,"d-flex","flex-column","flex-sm-row"],[1,"position-relative","flex-grow-1"],["type","text","placeholder","Cerca...","container","body",1,"form-control",3,"ngModel","formlyAttributes","ngbTypeahead","editable","inputFormatter","resultFormatter","ngModelChange","selectItem","focus"],["class","spinner-border spinner-border-sm text-primary position-absolute","role","status",4,"ngIf"],[4,"ngIf"],["class","invalid-feedback",3,"display",4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm","text-primary","position-absolute"],[1,"visually-hidden"],[1,"ms-sm-3","mt-3","mt-sm-0"],[1,"invalid-feedback"],[3,"field"]],template:function(i,r){if(1&i&&(e.TgZ(0,"fieldset",0),e.YNc(1,He,4,3,"legend",1),e.YNc(2,We,1,0,"ng-container",2),e.YNc(3,Ke,1,0,"ng-container",2),e.YNc(4,Xe,1,1,"div",3),e.qZA(),e.YNc(5,it,6,11,"ng-template",null,4,e.W1O)),2&i){const l=e.MAs(6);e.ekj("has-error",r.formControl.invalid),e.xp6(1),e.Q6J("ngIf",r.props.label),e.xp6(1),e.Q6J("ngTemplateOutlet",l),e.xp6(1),e.Q6J("ngTemplateOutlet",r.resultsTemplate),e.xp6(1),e.Q6J("ngIf",r.parsedDescription)}},dependencies:[y.O5,y.tP,Z.JD,Z.M2,_.Fj,_.JJ,_.On,le.dR],styles:[".spinner-border[_ngcontent-%COMP%]{top:calc(50% - 8px);right:10px}"],changeDetection:0}),s})();function rt(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"app-formly-typeahead-content",3),e.NdJ("removeEvent",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.removeItemSubject.next(r))}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("listTitle",n.listTitle)("list",n.list)("loading",n.loading)("defaultImage",n.defaultThumb)}}function st(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"app-domain-select",4),e.NdJ("modelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.selectedDomain=r)}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("model",n.selectedDomain)}}let me=(()=>{var t;class s{constructor(i,r){var h,l=this;this.globalsService=i,this.changeDetectorRef=r,this.showError=!1,this.listTitle="",this.defaultThumb="/assets/default_avatar.png",this.removeItemSubject=new ce.x,this.list=[],this.hasDomainSelect=!1,this.loading=!0,this.lastResults=[],this.search=function(){var S=(0,U.Z)(function*(N){return l.lastDomain===l.selectedDomain&&l.lastSearchedValueWithoutResult&&N.startsWith(l.lastSearchedValueWithoutResult)?[]:(l.lastDomain=l.selectedDomain,l.lastResults=yield l.searchFunction(N,(0,F.vV)(l.selectedDomain)),l.lastSearchedValueWithoutResult=l.lastResults.length?void 0:N,l.lastResults.map(ge=>({id:ge.id,name:ge.title})))});return function(N){return S.apply(this,arguments)}}(),this.selectedDomain=this.lastDomain=(null===(h=this.globalsService.credentials)||void 0===h?void 0:h.site.domain)||F.ig.FORUMFREE}ngOnInit(){this.hasDomainSelect=!0===this.field.props.selectDomain}populateListEvent(i){var r=this;return(0,U.Z)(function*(){r.list=(yield r.populateFunction(i)).sort((l,h)=>l.title.localeCompare(h.title)),r.loading=!1,r.changeDetectorRef.detectChanges()})()}selectItemEvent(i){const r=this.lastResults.find(l=>l.id===i.id);r&&(this.list=[...this.list,this.createEntityFunction(r)])}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(Ee.d),e.Y36(e.sBO))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-formly-forum-typeahead"]],inputs:{field:"field",showError:"showError",listTitle:"listTitle",defaultThumb:"defaultThumb",searchFunction:"searchFunction",populateFunction:"populateFunction",createEntityFunction:"createEntityFunction"},decls:5,vars:6,consts:[[3,"field","showError","removeItemObservable","searchFunction","resultsTemplate","additionalInputsTemplate","populateListEvent","selectItemEvent"],["contentList",""],["circuitSelect",""],[3,"listTitle","list","loading","defaultImage","removeEvent"],[3,"model","modelChange"]],template:function(i,r){if(1&i&&(e.TgZ(0,"app-formly-typeahead",0),e.NdJ("populateListEvent",function(h){return r.populateListEvent(h)})("selectItemEvent",function(h){return r.selectItemEvent(h)}),e.qZA(),e.YNc(1,rt,1,4,"ng-template",null,1,e.W1O),e.YNc(3,st,1,1,"ng-template",null,2,e.W1O)),2&i){const l=e.MAs(2),h=e.MAs(4);e.Q6J("field",r.field)("showError",r.showError)("removeItemObservable",r.removeItemSubject)("searchFunction",r.search)("resultsTemplate",l)("additionalInputsTemplate",r.hasDomainSelect?h:void 0)}},dependencies:[Se,Ne,ot],encapsulation:2,changeDetection:0}),s})(),lt=(()=>{var t;class s extends Z.fS{constructor(i){var r;super(),r=this,this.forumService=i,this.defaultThumb="/assets/default_forum.jpg",this.search=function(){var l=(0,U.Z)(function*(h,S){const N=(0,F.$t)(S);return N?(yield r.forumService.searchForumByName(h,S)).map(A=>({id:N.shortdomain+A.id,title:A.domain,preview:A.preview})):[]});return function(h,S){return l.apply(this,arguments)}}(),this.populateList=function(){var l=(0,U.Z)(function*(h){const S=yield r.forumService.getForumDetailsFromCids(h),N=(0,F.tX)(h,S.map(A=>A.cid));return[...S.map(A=>r.generateTypeaheadContentEntity(A.cid,A.domain,A.preview)),...N.map(A=>r.generateTypeaheadContentEntity(A,A,r.defaultThumb,!0))]});return function(h){return l.apply(this,arguments)}}(),this.searchToTypeaheadContentEntity=l=>this.generateTypeaheadContentEntity(l.id,l.title,l.preview)}generateTypeaheadContentEntity(i,r,l,h=!1){const S=(0,F.$t)(i);if(!S)throw new Error(`Invalid cid ${i}!`);return{id:i,title:r,image:l,type:S.shortdomain,link:"https://"+(h?`${S.domain}/?cid=${S.id}`:`${r}.${S.domain}`)}}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36($._))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-list"]],features:[e.qOj],decls:1,vars:6,consts:[["listTitle","Lista forum",3,"field","showError","defaultThumb","searchFunction","populateFunction","createEntityFunction"]],template:function(i,r){1&i&&e._UZ(0,"app-formly-forum-typeahead",0),2&i&&e.Q6J("field",r.field)("showError",r.showError)("defaultThumb",r.defaultThumb)("searchFunction",r.search)("populateFunction",r.populateList)("createEntityFunction",r.searchToTypeaheadContentEntity)},dependencies:[me],encapsulation:2,changeDetection:0}),s})();function at(t,s){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"div",4),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.formControl.setValue(void 0))}),e._uU(2,"highlight_off"),e.qZA(),e.BQk()}}function dt(t,s){1&t&&(e.ynx(0),e.TgZ(1,"p",5),e._UZ(2,"span",6),e.qZA(),e.BQk())}function ct(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&t){const n=s.$implicit;e.xp6(1),e.Q6J("ngValue",n.id)("innerHTML"," - "+n.name,e.oJD)}}function ut(t,s){if(1&t&&(e.ynx(0),e.YNc(1,ct,2,2,"ng-container",9),e.BQk()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",n.subsections)}}function pt(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.YNc(2,ut,2,1,"ng-container",1),e.BQk()),2&t){const n=s.$implicit;e.xp6(1),e.Q6J("ngValue",n.id)("innerHTML",n.name,e.oJD),e.xp6(1),e.Q6J("ngIf",n.subsections&&n.subsections.length)}}function mt(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&t){const n=s.$implicit;e.xp6(1),e.Q6J("ngValue",n)("innerHTML"," -- Sezione ristretta -- #"+n,e.oJD)}}function ft(t,s){if(1&t&&(e.ynx(0),e.YNc(1,mt,2,2,"ng-container",9),e.BQk()),2&t){const n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",n.restrictedOrDeletedSections)}}function ht(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"select",8),e.YNc(2,pt,3,3,"ng-container",9),e.YNc(3,ft,2,1,"ng-container",1),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(1),e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(1),e.Q6J("ngForOf",n.sectionsList),e.xp6(1),e.Q6J("ngIf",n.restrictedOrDeletedSections.length>0)}}function gt(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&t){const n=s.$implicit;e.xp6(1),e.Q6J("ngValue",n.id)("innerHTML"," - "+n.name,e.oJD)}}function _t(t,s){if(1&t&&(e.ynx(0),e.YNc(1,gt,2,2,"ng-container",9),e.BQk()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",n.subsections)}}function yt(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.YNc(2,_t,2,1,"ng-container",1),e.BQk()),2&t){const n=s.$implicit;e.xp6(1),e.Q6J("ngValue",n.id)("innerHTML",n.name,e.oJD),e.xp6(1),e.Q6J("ngIf",n.subsections&&n.subsections.length)}}function vt(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&t){const n=s.$implicit;e.xp6(1),e.Q6J("ngValue",n)("innerHTML"," -- Sezione ristretta -- #"+n,e.oJD)}}function Ct(t,s){if(1&t&&(e.ynx(0),e.YNc(1,vt,2,2,"ng-container",9),e.BQk()),2&t){const n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",n.restrictedOrDeletedSections)}}function Ft(t,s){if(1&t&&(e.TgZ(0,"select",11),e.YNc(1,yt,3,3,"ng-container",9),e.YNc(2,Ct,2,1,"ng-container",1),e.qZA()),2&t){const n=e.oxw(2);e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(1),e.Q6J("ngForOf",n.sectionsList),e.xp6(1),e.Q6J("ngIf",n.restrictedOrDeletedSections.length>0)}}function xt(t,s){if(1&t&&(e.YNc(0,ht,4,6,"ng-container",2),e.YNc(1,Ft,3,6,"ng-template",null,7,e.W1O)),2&t){const n=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.field.props.multiple)("ngIfElse",n)}}const Tt=function(t){return{"no-label":t}};let Ot=(()=>{var t;class s extends Z.fS{constructor(i,r){super(),this.forumService=i,this.changeDetectorRef=r,this.loading=!0,this.sectionsList=[],this.restrictedOrDeletedSections=[]}ngOnInit(){var i=this;return(0,U.Z)(function*(){i.field.defaultValue=void 0,i.field.props.hasOwnProperty("multiple")||(i.field.props.multiple=!0),i.restrictedOrDeletedSections=Array.isArray(i.field.formControl.value)?[...i.field.formControl.value]:[];const r=yield i.forumService.getSections();i.sectionsList=r.map(l=>{const h=i.restrictedOrDeletedSections.indexOf(l.id);return h>-1&&i.restrictedOrDeletedSections.splice(h,1),(0,O.Z)((0,O.Z)({},l),{subsections:i.flattenSubsections(l)})}),i.loading=!1,i.field.formControl.updateValueAndValidity(),i.changeDetectorRef.detectChanges()})()}flattenSubsections(i){let r=[],l=-1;if(i.subsections&&i.subsections.length)for(const h of i.subsections)l=this.restrictedOrDeletedSections.indexOf(h.id),l>-1&&this.restrictedOrDeletedSections.splice(l,1),r.push(h),h.subsections&&(r=[...r,...this.flattenSubsections(h)]);return r}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36($._),e.Y36(e.sBO))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-sections"]],features:[e.qOj],decls:5,vars:6,consts:[[1,"position-relative","wrapper",3,"ngClass"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["formSelect",""],[1,"reset-icon","position-absolute","cursor-pointer","d-block","material-icons","text-danger",3,"click"],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],["single",""],["multiple","",1,"form-select",3,"formControl","formlyAttributes"],[4,"ngFor","ngForOf"],[3,"ngValue","innerHTML"],[1,"form-select",3,"formControl","formlyAttributes"]],template:function(i,r){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,at,3,0,"ng-container",1),e.YNc(2,dt,3,0,"ng-container",2),e.YNc(3,xt,3,2,"ng-template",null,3,e.W1O),e.qZA()),2&i){const l=e.MAs(4);e.Q6J("ngClass",e.VKq(4,Tt,!r.props.label)),e.xp6(1),e.Q6J("ngIf",!r.props.label||void 0!==r.formControl.value),e.xp6(1),e.Q6J("ngIf",r.loading)("ngIfElse",l)}},dependencies:[y.mk,y.sg,y.O5,Z.JD,_.YN,_.Kr,_.EJ,_.K7,_.JJ,_.oH],styles:[".reset-icon[_ngcontent-%COMP%]{right:0}.wrapper[_ngcontent-%COMP%]:not(.no-label)   .reset-icon[_ngcontent-%COMP%]{top:calc(-24px - .45rem)}.no-label[_ngcontent-%COMP%]{padding-top:calc(24px + .45rem)}.no-label[_ngcontent-%COMP%]   .reset-icon[_ngcontent-%COMP%]{top:0}"]}),s})();var Mt=f(8418);let Et=(()=>{var t;class s extends Z.fS{constructor(i){var r;super(),r=this,this.userService=i,this.defaultThumb="/assets/default_avatar.png",this.search=function(){var l=(0,U.Z)(function*(h,S){return(yield r.userService.searchUserByName(h,S)).map(N=>({id:N.uid,title:N.nickname,preview:N.avatar}))});return function(h,S){return l.apply(this,arguments)}}(),this.populateList=function(){var l=(0,U.Z)(function*(h){const S=yield r.userService.getDetailsFromUids(h),N=(0,F.tX)(h,S.map(A=>A.uid));return[...S.map(A=>r.generateTypeaheadContentEntity(A.uid,A.nickname,A.avatar)),...N.map(A=>r.generateTypeaheadContentEntity(A,A,r.defaultThumb))]});return function(h){return l.apply(this,arguments)}}(),this.searchToTypeaheadContentEntity=l=>this.generateTypeaheadContentEntity(l.id,l.title,l.preview)}generateTypeaheadContentEntity(i,r,l){const h=i.substring(0,2),S=(0,F.A)(h);if(!S)throw new Error(`Invalid uid ${i}!`);return{id:i,title:r,image:l,type:h,link:`${S}/?act=Profile&MID=${i.substring(2)}`}}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(Mt.K))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-users"]],features:[e.qOj],decls:1,vars:6,consts:[["listTitle","Lista utenti",3,"field","showError","defaultThumb","searchFunction","populateFunction","createEntityFunction"]],template:function(i,r){1&i&&e._UZ(0,"app-formly-forum-typeahead",0),2&i&&e.Q6J("field",r.field)("showError",r.showError)("defaultThumb",r.defaultThumb)("searchFunction",r.search)("populateFunction",r.populateList)("createEntityFunction",r.searchToTypeaheadContentEntity)},dependencies:[me],encapsulation:2,changeDetection:0}),s})(),bt=(()=>{var t;class s extends Z.fS{constructor(){super(...arguments),this.defaultOptions={props:{label:""}}}}return(t=s).\u0275fac=function(){let n;return function(r){return(n||(n=e.n5z(t)))(r||t)}}(),t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-label"]],features:[e.qOj],decls:2,vars:1,template:function(i,r){1&i&&(e.TgZ(0,"h5"),e._uU(1),e.qZA()),2&i&&(e.xp6(1),e.Oqu(r.props.label))},encapsulation:2,changeDetection:0}),s})(),wt=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,_.u5]}),s})();var fe=f(3038),he=f(5063);let St=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,ue.mZ,j.q,fe.G,he.g]}),s})(),At=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,Z.X0.forChild(),_.u5,le.ZS]}),s})(),Dt=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,wt,Z.X0.forChild(),_.u5,_.UX,St,At]}),s})();var It=f(4295);let Zt=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,j.Vy,j.d3,Dt,Z.X0.forChild({types:[{name:"array",component:p},{name:"code-editor",component:L,wrappers:["form-field"]},{name:"forum-groups",component:Me,wrappers:["form-field"]},{name:"forum-sections",component:Ot,wrappers:["form-field"]},{name:"label",component:bt},{name:"forum-users",component:Et},{name:"forum-list",component:lt}]}),_.u5,It.$,j.q,se,le.ZS,fe.G,he.g]}),s})()},1993:(re,H,f)=>{f.d(H,{sL:()=>e});var y=f(5879),j=f(5592),F=f(9773);function e(T){T||((0,y.gHi)(e),T=(0,y.f3M)(y.ktI));const d=new j.y(v=>T.onDestroy(v.next.bind(v)));return v=>v.pipe((0,F.R)(d))}},336:(re,H,f)=>{f.d(H,{c:()=>b});var y=f(9376),j=f(91),F=f(1413),Z=f(5879),e=f(6223),R=f(5545),z=f(9397);const ee=["key"],W=["allOf"];function J(C){return""===C||null==C}function V(C){return null!=C&&"object"==typeof C&&!Array.isArray(C)}function q(C){return Number.isInteger?Number.isInteger(C):"number"==typeof C&&Math.floor(C)===C}function G(C){return"object"==typeof C&&(C.hasOwnProperty("const")||C.enum&&1===C.enum.length)}function c(C){if(!C.fieldGroup)return(0,R._S)(C)&&void 0!==(0,R.Hl)(C)?1:0;const Q=C.fieldGroup.reduce((o,g)=>c(g)+o,0);if(0===Q&&(0,R._S)(C)){const o=(0,R.Hl)(C);if(null===o||void 0!==o&&(C.fieldArray&&Array.isArray(o)||!C.fieldArray&&V(o)))return 1}return Q}let b=(()=>{class C{toFieldConfig(o,g){return o=(0,R.kg)(o),this._toFieldConfig(o,(0,F.Z)({schema:o},g||{}))}_toFieldConfig(o,g){var E;let{key:w}=g,u=(0,j.Z)(g,ee);o=this.resolveSchema(o,u);const x=this.guessSchemaType(o);let a={type:x[0],defaultValue:o.default,props:{label:o.title,readonly:o.readOnly,description:o.description}};switch(null!=w&&(a.key=w),!u.ignoreDefault&&(o.readOnly||u.readOnly)&&(a.props.disabled=!0,u=(0,F.Z)((0,F.Z)({},u),{},{readOnly:!0})),u.resetOnHide&&(a.resetOnHide=!0),w&&u.strict&&this.addValidator(a,"type",(p,O)=>{const m=(0,R.Hl)(O);if(null!=m)switch(a.type){case"string":return"string"==typeof m;case"integer":return q(m);case"number":return"number"==typeof m;case"object":return V(m);case"array":return Array.isArray(m)}return!0}),!1===u.shareFormControl&&(a.shareFormControl=!1),u.ignoreDefault&&delete a.defaultValue,this.addValidator(a,"type",{schemaType:x,expression:({value:p})=>{if(void 0===p||null===p&&-1!==x.indexOf("null"))return!0;switch(x[0]){case"null":return null===typeof p;case"string":return"string"==typeof p;case"integer":return q(p);case"number":return"number"==typeof p;case"object":return V(p);case"array":return Array.isArray(p)}return!0}}),a.type){case"number":case"integer":a.parsers=[p=>J(p)?p:Number(p)],o.hasOwnProperty("minimum")&&(a.props.min=o.minimum),o.hasOwnProperty("maximum")&&(a.props.max=o.maximum),o.hasOwnProperty("exclusiveMinimum")&&(a.props.exclusiveMinimum=o.exclusiveMinimum,this.addValidator(a,"exclusiveMinimum",({value:p})=>J(p)||p>o.exclusiveMinimum)),o.hasOwnProperty("exclusiveMaximum")&&(a.props.exclusiveMaximum=o.exclusiveMaximum,this.addValidator(a,"exclusiveMaximum",({value:p})=>J(p)||p<o.exclusiveMaximum)),o.hasOwnProperty("multipleOf")&&(a.props.step=o.multipleOf,this.addValidator(a,"multipleOf",({value:p})=>{if(J(p)||"number"!=typeof p||0===p||o.multipleOf<=0)return!0;const O=Math.pow(10,function K(C){if(!isFinite(C))return 0;let Q=1,o=0;for(;Math.round(C*Q)/Q!==C;)Q*=10,o++;return o}(o.multipleOf));return Math.round(p*O)%Math.round(o.multipleOf*O)==0}));break;case"string":a.parsers=[p=>(-1!==x.indexOf("null")?p=J(p)?null:p:a.props.required||(p=""===p?void 0:p),p)],["minLength","maxLength","pattern"].forEach(p=>{o.hasOwnProperty(p)&&(a.props[p]=o[p])});break;case"object":{a.fieldGroup||(a.fieldGroup=[]);const{propDeps:p,schemaDeps:O}=this.resolveDependencies(o);Object.keys(o.properties||{}).forEach(m=>{const _=Array.isArray(o.required)&&-1!==o.required.indexOf(m),P=this._toFieldConfig(o.properties[m],(0,F.Z)((0,F.Z)({},u),{},{key:m,isOptional:u.isOptional||!_}));if(a.fieldGroup.push(P),(_||p[m])&&(P.expressions=(0,F.Z)((0,F.Z)({},P.expressions||{}),{},{"props.required":k=>{let D=k.parent;const I=k.fieldGroup&&null!=k.key?D.model:k.model;for(;null==D.key&&D.parent;)D=D.parent;return!!(I||D&&D.props&&D.props.required)&&(!(!Array.isArray(o.required)||-1===o.required.indexOf(m))||p[m]&&k.model&&p[m].some(te=>!J(k.model[te])))}})),O[m]){const k=I=>I.hasOwnProperty("const")?I.const:I.enum[0],D=O[m].oneOf;D&&D.every(I=>I.properties&&I.properties[m]&&G(I.properties[m]))?D.forEach(I=>{const Y=I.properties,{[m]:te}=Y,X=(0,j.Z)(Y,[m].map(y.Z));a.fieldGroup.push((0,F.Z)((0,F.Z)({},this._toFieldConfig((0,F.Z)((0,F.Z)({},I),{},{properties:X}),(0,F.Z)((0,F.Z)({},u),{},{shareFormControl:!1,resetOnHide:!0}))),{},{expressions:{hide:ie=>!ie.model||k(te)!==ie.model[m]}}))}):a.fieldGroup.push((0,F.Z)((0,F.Z)({},this._toFieldConfig(O[m],u)),{},{expressions:{hide:I=>!I.model||J(I.model[m])}}))}}),o.oneOf&&a.fieldGroup.push(this.resolveMultiSchema("oneOf",o.oneOf,(0,F.Z)((0,F.Z)({},u),{},{shareFormControl:!1}))),o.anyOf&&a.fieldGroup.push(this.resolveMultiSchema("anyOf",o.anyOf,u));break}case"array":o.hasOwnProperty("minItems")&&(a.props.minItems=o.minItems,this.addValidator(a,"minItems",(p,O)=>{const m=(0,R.Hl)(O);return J(m)||m.length>=o.minItems}),!u.isOptional&&o.minItems>0&&void 0===a.defaultValue&&(a.defaultValue=Array.from(new Array(o.minItems)))),o.hasOwnProperty("maxItems")&&(a.props.maxItems=o.maxItems,this.addValidator(a,"maxItems",(p,O)=>{const m=(0,R.Hl)(O);return J(m)||m.length<=o.maxItems})),o.hasOwnProperty("uniqueItems")&&(a.props.uniqueItems=o.uniqueItems,this.addValidator(a,"uniqueItems",(p,O)=>{const m=(0,R.Hl)(O);return!(!J(m)&&o.uniqueItems)||Array.from(new Set(m.map(P=>JSON.stringify(P,(k,D)=>V(D)?Object.keys(P).sort().reduce((I,Y)=>(I[Y]=P[Y],I),{}):D)))).length===m.length})),o.items&&!Array.isArray(o.items)&&(o.items=this.resolveSchema(o.items,u)),this.isEnum(o)||(a.fieldArray=p=>{const O=o.items;if(!Array.isArray(O)){if(!O)return{};const k=O.oneOf||O.anyOf,D=this._toFieldConfig(O,k?(0,F.Z)((0,F.Z)({},u),{},{key:`${p.fieldGroup.length}`}):u);return k&&!(0,R._S)(D)&&(D.key=null),D.props.required=!0,D}const m=p.fieldGroup?p.fieldGroup.length:0,_=O[m]?O[m]:o.additionalItems,P=_?this._toFieldConfig(_,u):{};return P.props&&(P.props.required=!0),O[m]&&(P.props.removable=!1),P})}if(o.hasOwnProperty("const")&&(a.props.const=o.const,this.addValidator(a,"const",({value:p})=>p===o.const),a.type||(a.defaultValue=o.const)),this.isEnum(o)){const p=this.toEnumOptions(o),O="array"===a.type;a.type="enum",a.props.multiple=O,a.props.options=p;const m=p.map(_=>_.value);this.addValidator(a,"enum",({value:_})=>void 0===_||(O?!!Array.isArray(_)&&_.every(P=>m.includes(P)):m.includes(_)))}return o.oneOf&&!a.type&&(delete a.key,a.fieldGroup=[this.resolveMultiSchema("oneOf",o.oneOf,(0,F.Z)((0,F.Z)({},u),{},{key:w,shareFormControl:!1}))]),o.oneOf&&!a.type&&(delete a.key,a.fieldGroup=[this.resolveMultiSchema("oneOf",o.oneOf,(0,F.Z)((0,F.Z)({},u),{},{key:w,shareFormControl:!1}))]),null!==(E=o.widget)&&void 0!==E&&E.formlyConfig&&(a=this.mergeFields(a,o.widget.formlyConfig)),a.templateOptions=a.props,u.map?u.map(a,o):a}resolveSchema(o,g){return o&&o.$ref&&(o=this.resolveDefinition(o,g)),o&&o.allOf&&(o=this.resolveAllOf(o,g)),o}resolveAllOf(o,g){let{allOf:E}=o,w=(0,j.Z)(o,W);if(!E.length)throw Error(`allOf array can not be empty ${E}.`);return E.reduce((u,x)=>(x=this.resolveSchema(x,g),u.required&&x.required&&(u.required=[...u.required,...x.required]),x.uniqueItems&&(u.uniqueItems=x.uniqueItems),["maxLength","maximum","exclusiveMaximum","maxItems","maxProperties"].forEach(a=>{!J(u[a])&&!J(x[a])&&(u[a]=u[a]<x[a]?u[a]:x[a])}),["minLength","minimum","exclusiveMinimum","minItems","minProperties"].forEach(a=>{!J(u[a])&&!J(x[a])&&(u[a]=u[a]>x[a]?u[a]:x[a])}),(0,R.Du)(u,x)),w)}resolveMultiSchema(o,g,E){return{type:"multischema",fieldGroup:[{type:"enum",defaultValue:-1,props:{multiple:"anyOf"===o,options:g.map((w,u)=>({label:w.title,value:u,disabled:w.readOnly}))},hooks:{onInit:w=>w.formControl.valueChanges.pipe((0,z.b)(()=>w.options.detectChanges(w.parent)))}},{fieldGroup:g.map((w,u)=>(0,F.Z)((0,F.Z)({},this._toFieldConfig(w,(0,F.Z)((0,F.Z)({},E),{},{resetOnHide:!0}))),{},{expressions:{hide:(x,a)=>{const p=x.parent.parent.fieldGroup[0].formControl;if(-1===p.value||a){let O=x.parent.fieldGroup.map((m,_)=>[m,_,this.isFieldValid(m,_,g,E)]).sort(([m,,_],[P,,k])=>{if(_!==k)return k?1:-1;const D=c(m),I=c(P);return D===I&&m.props.disabled===P.props.disabled?0:I>D?1:-1}).map(([,m])=>m);if("anyOf"===o){const m=O.filter(_=>c(x.parent.fieldGroup[_]));O=m.length>0?m:[O[0]||0]}O=O.length>0?O:[0],p.setValue("anyOf"===o?O:O[0])}return Array.isArray(p.value)?-1===p.value.indexOf(u):p.value!==u}}}))}]}}resolveDefinition(o,g){const[E,w]=o.$ref.split("#/");if(E)throw Error(`Remote schemas for ${o.$ref} not supported yet.`);const u=w?w.split("/").reduce((x,a)=>null!=x&&x.hasOwnProperty(a)?x[a]:null,g.schema):null;if(!u)throw Error(`Cannot find a definition for ${o.$ref}.`);return u.$ref?this.resolveDefinition(u,g):(0,F.Z)((0,F.Z)({},u),["title","description","default","widget"].reduce((x,a)=>(o.hasOwnProperty(a)&&(x[a]=o[a]),x),{}))}resolveDependencies(o){const g={},E={};return Object.keys(o.dependencies||{}).forEach(w=>{const u=o.dependencies[w];Array.isArray(u)?u.forEach(x=>{g[x]?g[x].push(w):g[x]=[w]}):E[w]=u}),{propDeps:g,schemaDeps:E}}guessSchemaType(o){const g=null==o?void 0:o.type;return!g&&null!=o&&o.properties?["object"]:Array.isArray(g)?1===g.length?g:2===g.length&&-1!==g.indexOf("null")?g.sort(E=>"null"==E?1:-1):g:g?[g]:[]}addValidator(o,g,E){o.validators=o.validators||{},o.validators[g]=E}isEnum(o){return!!o.enum||o.anyOf&&o.anyOf.every(G)||o.oneOf&&o.oneOf.every(G)||o.uniqueItems&&o.items&&!Array.isArray(o.items)&&this.isEnum(o.items)}toEnumOptions(o){if(o.enum)return o.enum.map(E=>({value:E,label:E}));const g=E=>{const w=E.hasOwnProperty("const")?E.const:E.enum[0],u={value:w,label:E.title||w};return E.readOnly&&(u.disabled=!0),u};return o.anyOf?o.anyOf.map(g):o.oneOf?o.oneOf.map(g):this.toEnumOptions(o.items)}isFieldValid(o,g,E,w){const u=E[g];u._field||Object.defineProperty(u,"_field",{enumerable:!1,writable:!0,configurable:!0});let x=u._field;const a=o.model?(0,R.kg)(o.model):o.fieldArray?[]:{};return x?(x.model=a,o.options.build(x)):x=u._field=o.options.build({form:Array.isArray(a)?new e.Oe([]):new e.cw({}),fieldGroup:[this._toFieldConfig(u,(0,F.Z)((0,F.Z)({},w),{},{resetOnHide:!0,ignoreDefault:!0,map:null,strict:!0}))],model:a,options:{}}),x.form.valid}mergeFields(o,g){for(let E in g){const w="templateOptions"===E?"props":E;V(o[w])&&V(g[E])?o[w]=this.mergeFields(o[w],g[E]):null!=g[E]&&(o[w]=g[E])}return o}}return C.\u0275fac=function(o){return new(o||C)},C.\u0275prov=Z.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()}}]);