"use strict";(self.webpackChunkpages=self.webpackChunkpages||[]).push([[73],{7429:(R,Y,f)=>{f.d(Y,{d:()=>H});var h=f(5879),I=f(6223),O=f(5661),T=f(336);let e=(()=>{class M{constructor(){this.allowedProps={$ref:{validator:this.isString},anyOf:{validator:this.validateAnyOf},default:{validator:this.isNestedOfPrimitives},definitions:null,description:null,enum:{validator:this.validateEnum},items:{child:"allProps"},maximum:null,maxItems:null,maxLength:null,minimum:null,minItems:null,minLength:null,multipleOf:null,oneOf:{validator:this.validateOneOf},properties:null,required:{validator:this.validateRequired},title:null,type:{validator:this.isNestedOfPrimitives},uniqueItems:null,widget:{child:{formlyConfig:{child:{props:{child:{placeholder:{validator:this.isString},multiple:{validator:this.isBoolean},pattern:{validator:this.isString},type:{validator:function(a){return"hidden"===a}},minLength:{validator:this.isNumber},maxLength:{validator:this.isNumber},rows:{validator:this.isNumber},keepGroupsWithoutId:{validator:this.isBoolean},fieldsetTemplate:{validator:this.isBoolean},startDate:null,endDate:null,minDate:{child:{year:null,month:null,day:null}},maxDate:{child:{year:null,month:null,day:null}}}},type:{validator:function(a){return"radio"===a}}}}}}},this.fieldListKeys=["properties","definitions"]}validateSchema(a){this.isObject(a)&&((!a.hasOwnProperty("type")||!a.hasOwnProperty("properties")||"object"!==a.type)&&(a.type="object",a.properties={}),this.validate(a))}validate(a,g){g||(g=this.allowedProps);for(const[u,Z]of Object.entries(a)){var E,L;if(g.hasOwnProperty(u)){if(null!==(E=g[u])&&void 0!==E&&E.hasOwnProperty("validator"))g[u].validator.call(this,Z)||delete a[u];else if(this.fieldListKeys.includes(u))for(const n of Object.keys(a[u]))this.validate(a[u][n]);else if(!this.isPrimitive(Z)){if(null===(L=g[u])||void 0===L||!L.hasOwnProperty("child")||!this.isObject(Z)){delete a[u];continue}this.validate(a[u],"allProps"===g[u].child?this.allowedProps:g[u].child)}}else delete a[u]}}isObject(a){return null!=a&&"object"==typeof a&&!Array.isArray(a)}isPrimitive(a){return this.isString(a)||this.isNumber(a)||this.isBoolean(a)||null==a}isString(a){return"string"==typeof a}isBoolean(a){return"boolean"==typeof a}isNumber(a){return"number"==typeof a}validateRequired(a){if(!Array.isArray(a))return!1;for(const g of a)if(!this.isString(g))return!1;return!0}validateEnum(a){if(!Array.isArray(a))return!1;for(const g of a)if(!this.isString(g)&&!this.isNumber(g))return!1;return!0}validateOneOf(a){var g;if(Array.isArray(a)&&null!==(g=a[0])&&void 0!==g&&g.hasOwnProperty("const")){for(const E of a){if(!this.isObject(E))return!1;this.validate(E,{const:null,title:null})}return!0}return this.validateAnyOf(a)}validateAnyOf(a){if(!Array.isArray(a))return!1;for(const g of a){if(!this.isObject(g))return!1;this.validate(g)}return!0}isNestedOfPrimitives(a){if(this.isPrimitive(a))return!0;if(Array.isArray(a)||this.isObject(a)){for(const g of Object.values(a))if(!this.isNestedOfPrimitives(g))return!1;return!0}return!1}}return M.\u0275fac=function(a){return new(a||M)},M.\u0275prov=h.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})();var w=f(5545);const j=["app-custom-form",""],G=[[["","buttons",""]]],q=["[buttons]"];let H=(()=>{class M{constructor(a,g,E){this.formlyJsonschema=a,this.customFormSchemaService=g,this.toastService=E,this.model={},this.validateSchema=!1,this.enableModelChangeEvent=!1,this.defaultModel={},this.cancelEvent=new h.vpe,this.submitEvent=new h.vpe,this.validityChangeEvent=new h.vpe,this.modelChangeEvent=new h.vpe,this.form=new I.nJ({}),this.fields=[],this.options={},this.valid=!1,this.isFormCurrentlyValid=!0}ngOnInit(){this.createFields()}ngOnChanges(a){a.schema&&!a.schema.firstChange&&this.createFields()}createFields(){this.customFormSchemaService.isObject(this.schema)||(this.schema={}),this.validateSchema&&this.customFormSchemaService.validateSchema(this.schema),this.fields=[this.formlyJsonschema.toFieldConfig(this.schema)]}showFieldValidation(){this.cycleFields(this.fields)}showFieldValidationWithMessage(){this.showFieldValidation(),this.toastService.show({content:"Tutti i campi sono stati <strong>validati</strong>: quelli con errore sono evidenziati da un <strong>bordo rosso</strong>!"})}cycleFields(a){a.forEach(g=>{this.forceValidation(g),g.fieldGroup&&this.cycleFields(g.fieldGroup)})}forceValidation(a){a.validation||(a.validation={}),a.validation.show=!0}reset(){this.options.resetModel&&this.options.resetModel(this.defaultModel)}cancel(){this.cancelEvent.emit()}submit(){this.form.valid&&(this.log(),this.submitEvent.emit(this.model))}onModelChange(a){this.valid=this.form.valid,this.enableModelChangeEvent&&this.modelChangeEvent.emit(a||{}),this.form.valid!==this.isFormCurrentlyValid&&this.validityChangeEvent.emit(this.isFormCurrentlyValid=this.form.valid)}log(){}}return M.\u0275fac=function(a){return new(a||M)(h.Y36(T.c),h.Y36(e),h.Y36(O.k))},M.\u0275cmp=h.Xpm({type:M,selectors:[["","app-custom-form",""]],inputs:{schema:"schema",model:"model",validateSchema:"validateSchema",enableModelChangeEvent:"enableModelChangeEvent",defaultModel:"defaultModel"},outputs:{cancelEvent:"cancelEvent",submitEvent:"submitEvent",validityChangeEvent:"validityChangeEvent",modelChangeEvent:"modelChangeEvent"},features:[h.TTD],attrs:j,ngContentSelectors:q,decls:3,vars:5,consts:[[3,"formGroup","ngSubmit"],[3,"model","fields","form","options","modelChange"]],template:function(a,g){1&a&&(h.F$t(G),h.TgZ(0,"form",0),h.NdJ("ngSubmit",function(){return g.submit()}),h.TgZ(1,"formly-form",1),h.NdJ("modelChange",function(L){return g.onModelChange(L)}),h.qZA(),h.Hsn(2),h.qZA()),2&a&&(h.Q6J("formGroup",g.form),h.xp6(1),h.Q6J("model",g.model)("fields",g.fields)("form",g.form)("options",g.options))},dependencies:[w.T7,I._Y,I.JL,I.sg]}),M})()},1059:(R,Y,f)=>{f.d(Y,{I:()=>pt});var h=f(6814),I=f(8876),O=f(2907),T=f(5545),e=f(5879),w=f(8595);function j(i,r){1&i&&e.GkF(0)}function G(i,r){if(1&i&&(e.ynx(0),e._UZ(1,"div",13),e.TgZ(2,"div",14),e._uU(3," ("),e.YNc(4,j,1,0,"ng-container",15),e._uU(5,") "),e.qZA(),e.BQk()),2&i){const t=e.oxw(),o=e.MAs(15);e.xp6(1),e.Q6J("innerHTML",t.parsedTitle,e.oJD),e.xp6(3),e.Q6J("ngTemplateOutlet",o)}}function q(i,r){1&i&&e.GkF(0)}function H(i,r){if(1&i&&(e.TgZ(0,"div",16),e._uU(1," Lista di "),e.YNc(2,q,1,0,"ng-container",15),e.qZA()),2&i){e.oxw();const t=e.MAs(15);e.xp6(2),e.Q6J("ngTemplateOutlet",t)}}function M(i,r){if(1&i&&e._UZ(0,"div",17),2&i){const t=e.oxw();e.Q6J("innerHTML",t.parsedDescription,e.oJD)}}const J=function(i){return{"mt-3":i}};function a(i,r){if(1&i&&(e.TgZ(0,"div",18),e._UZ(1,"formly-validation-message",19),e.qZA()),2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(2,J,t.parsedDescription.length)),e.xp6(1),e.Q6J("field",t.field)}}function g(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li")(1,"div",30),e.NdJ("click",function(){e.CHM(t);const l=e.oxw().index,v=e.oxw(2);return e.KtG(v.move(l,l-1))}),e._uU(2," arrow_circle_up "),e.qZA()()}2&i&&(e.xp6(1),e.Q6J("disableOnTouchDevice",!0))}const E=function(i){return{"ms-1":i}};function L(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",31)(1,"div",32),e.NdJ("click",function(){e.CHM(t);const l=e.oxw().index,v=e.oxw(2);return e.KtG(v.move(l,l+1))}),e._uU(2," arrow_circle_down "),e.qZA()()}if(2&i){const t=e.oxw().first;e.Q6J("ngClass",e.VKq(2,E,!t)),e.xp6(1),e.Q6J("disableOnTouchDevice",!0)}}function u(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",31)(1,"div",33),e.NdJ("click",function(){e.CHM(t);const l=e.oxw().index,v=e.oxw(2);return e.KtG(v.remove(l))}),e._uU(2," highlight_off "),e.qZA()()}if(2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(2,E,!(t.first&&t.last))),e.xp6(1),e.Q6J("disableOnTouchDevice",!0)}}const Z=function(i){return{"mb-3":i}},n=function(i){return{"has-error":i}};function m(i,r){if(1&i&&(e.TgZ(0,"li",22)(1,"fieldset",23)(2,"legend",24)(3,"div",25)(4,"div",26),e._uU(5),e.qZA(),e.TgZ(6,"ul",27),e.YNc(7,g,3,1,"li",28),e.YNc(8,L,3,4,"li",29),e.YNc(9,u,3,4,"li",29),e.qZA()()(),e._UZ(10,"formly-field",19),e.qZA()()),2&i){const t=r.$implicit,o=r.index,l=r.first,v=r.last;e.Q6J("ngClass",e.VKq(7,Z,!v)),e.xp6(1),e.Q6J("ngClass",e.VKq(9,n,null==t.formControl?null:t.formControl.invalid)),e.xp6(4),e.hij("#",o+1,""),e.xp6(2),e.Q6J("ngIf",!l),e.xp6(1),e.Q6J("ngIf",!v),e.xp6(1),e.Q6J("ngIf",t.props&&!1!==t.props.removable),e.xp6(1),e.Q6J("field",t)}}function y(i,r){if(1&i&&(e.TgZ(0,"ul",20),e.YNc(1,m,11,11,"li",21),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.field.fieldGroup)}}const x=function(i){return{"d-none d-md-inline":i}};function d(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA(),e.TgZ(2,"span",31),e._uU(3),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.field.fieldGroup?t.field.fieldGroup.length:0),e.xp6(1),e.Q6J("ngClass",e.VKq(3,x,t.props.label)),e.xp6(1),e.hij(" element",t.field.fieldGroup&&1===t.field.fieldGroup.length?"o":"i","")}}const _=function(){return[10,10]},s=function(i){return{placement:"top-end",offset:i}};let c=(()=>{class i extends T.hv{constructor(t){super(),this.customFormUtilsService=t,this.parsedTitle="",this.parsedDescription=""}ngOnInit(){this.parsedDescription=this.props.description?this.customFormUtilsService.parseBBCode(this.props.description):"",this.parsedTitle=this.props.label?this.customFormUtilsService.parseBBCode(this.props.label):""}get maxLengthExceeded(){return this.props.maxItems&&this.model&&this.model.length>=this.props.maxItems}move(t,o){const l=this.model[t];this.remove(t),this.add(o,l)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(O.d6))},i.\u0275cmp=e.Xpm({type:i,selectors:[["formly-field-array"]],features:[e.qOj],decls:16,vars:14,consts:[[1,"rounded","px-3","pb-3","pt-2","mb-3","formly-fieldset",3,"ngClass"],[1,"legend-reset","pb-1","px-2","mb-0","mw-100"],[1,"d-flex","align-items-center","mw-100"],[4,"ngIf","ngIfElse"],["nolabel",""],["class","mb-2 text-justify",3,"innerHTML",4,"ngIf"],["class","alert alert-danger formly-field-array-error text-center","role","alert",3,"ngClass",4,"ngIf"],["class","list-unstyled mb-3",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["appTippy","Hai aggiunto il numero massimo di elementi!",3,"disableInstance","tippyProps"],["type","button",1,"btn","btn-primary","d-flex","align-items-center",3,"disabled","click"],[1,"material-icons"],["itemscount",""],[1,"fs-xl","text-truncate","mw-100",3,"innerHTML"],[1,"ms-2","fs-reset","lh-1","fst-italic","list-counter","text-nowrap"],[4,"ngTemplateOutlet"],[1,"fs-xl","text-truncate","mw-10"],[1,"mb-2","text-justify",3,"innerHTML"],["role","alert",1,"alert","alert-danger","formly-field-array-error","text-center",3,"ngClass"],[3,"field"],[1,"list-unstyled","mb-3"],["class","item",3,"ngClass",4,"ngFor","ngForOf"],[1,"item",3,"ngClass"],[1,"rounded","formly-fieldset","dashed","show-success","px-3",3,"ngClass"],[1,"legend-reset","ms-auto","mb-0","px-2"],[1,"d-flex","align-items-center"],[1,"fs-xl","ms-1"],[1,"ms-2","mb-0","item-icons","list-unstyled","d-flex","align-items-center"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["appTippy","Sposta in alto",1,"d-block","material-icons","cursor-pointer",3,"disableOnTouchDevice","click"],[3,"ngClass"],["appTippy","Sposta in basso",1,"d-block","material-icons","cursor-pointer",3,"disableOnTouchDevice","click"],["appTippy","Rimuovi",1,"d-block","material-icons","cursor-pointer","text-danger",3,"disableOnTouchDevice","click"]],template:function(t,o){if(1&t&&(e.TgZ(0,"fieldset",0)(1,"legend",1)(2,"div",2),e.YNc(3,G,6,2,"ng-container",3),e.YNc(4,H,3,1,"ng-template",null,4,e.W1O),e.qZA()(),e.YNc(6,M,1,1,"div",5),e.YNc(7,a,2,4,"div",6),e.YNc(8,y,2,1,"ul",7),e.TgZ(9,"div",8)(10,"div",9)(11,"button",10),e.NdJ("click",function(){return!o.maxLengthExceeded&&o.add()}),e.TgZ(12,"span",11),e._uU(13,"add"),e.qZA()()()(),e.YNc(14,d,4,5,"ng-template",null,12,e.W1O),e.qZA()),2&t){const l=e.MAs(5);e.Q6J("ngClass",e.VKq(9,n,o.formControl.invalid)),e.xp6(3),e.Q6J("ngIf",o.parsedTitle)("ngIfElse",l),e.xp6(3),e.Q6J("ngIf",o.parsedDescription),e.xp6(1),e.Q6J("ngIf",o.showError&&o.formControl.errors),e.xp6(1),e.Q6J("ngIf",o.field.fieldGroup&&o.field.fieldGroup.length),e.xp6(2),e.Q6J("disableInstance",!o.maxLengthExceeded)("tippyProps",e.VKq(12,s,e.DdM(11,_))),e.xp6(1),e.Q6J("disabled",o.maxLengthExceeded)}},dependencies:[h.mk,h.sg,h.O5,h.tP,T.cw,T.M2,w.$],styles:["legend[_ngcontent-%COMP%]   .list-counter[_ngcontent-%COMP%]{padding-top:.175rem}legend[_ngcontent-%COMP%]   .item-icons[_ngcontent-%COMP%]{padding-top:.1rem}"]}),i})();var C=f(1413),p=f(4020),F=f(6223),S=f(91),D=f(2181),A=f(8180),b=f(5619);const N=["language","theme"],B=["editor"];let ne=(()=>{class i{constructor(t,o){this.ngZone=t,this.monacoPathConfig=o,this.isMonacoLoaded$=new b.X(!1),this._monacoPath="assets/monaco-editor/min/vs",window.monacoEditorAlreadyInitialized?t.run(()=>this.isMonacoLoaded$.next(!0)):(window.monacoEditorAlreadyInitialized=!0,this.monacoPathConfig&&(this.monacoPath=this.monacoPathConfig),this.loadMonaco())}set monacoPath(t){t&&(this._monacoPath=t)}loadMonaco(){const t=()=>{let P=this._monacoPath;window.amdRequire=window.require;const U=!!this.nodeRequire,V=P.includes("http");U&&(window.require=this.nodeRequire,V||(P=window.require("path").resolve(window.__dirname,this._monacoPath))),window.amdRequire.config({paths:{vs:P}}),window.amdRequire(["vs/editor/editor.main"],()=>{this.ngZone.run(()=>this.isMonacoLoaded$.next(!0))},Q=>console.error("Error loading monaco-editor: ",Q))};if(window.amdRequire)return t();window.require&&(this.addElectronFixScripts(),this.nodeRequire=window.require);const v=document.createElement("script");v.type="text/javascript",v.src=`${this._monacoPath}/loader.js`,v.addEventListener("load",t),document.body.appendChild(v)}addElectronFixScripts(){const t=document.createElement("script"),o=document.createTextNode("self.module = undefined;"),l=document.createTextNode("self.process.browser = true;");t.appendChild(o),t.appendChild(l),document.body.appendChild(t)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(e.R0b),e.LFG("MONACO_PATH",8))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),oe=(()=>{class i{constructor(t){this.monacoLoader=t,this.init=new e.vpe,this.onTouched=()=>{},this.onErrorStatusChange=()=>{},this.propagateChange=()=>{}}get model(){return this.editor&&this.editor.getModel()}get modelMarkers(){return this.model&&monaco.editor.getModelMarkers({resource:this.model.uri})}ngOnInit(){this.monacoLoader.isMonacoLoaded$.pipe((0,D.h)(t=>t),(0,A.q)(1)).subscribe(()=>{this.initEditor()})}ngOnChanges(t){if(this.editor&&t.options&&!t.options.firstChange){const o=t.options.currentValue,{language:l,theme:v}=o,P=(0,S.Z)(o,N),{language:U,theme:V}=t.options.previousValue;U!==l&&monaco.editor.setModelLanguage(this.editor.getModel(),this.options&&this.options.language?this.options.language:"text"),V!==v&&monaco.editor.setTheme(v),this.editor.updateOptions(P)}if(this.editor&&t.uri){const o=t.uri.currentValue,l=t.uri.previousValue;if(l&&!o||!l&&o||o&&l&&o.path!==l.path){const v=this.editor.getValue();let P;this.modelUriInstance&&this.modelUriInstance.dispose(),o&&(P=monaco.editor.getModels().find(U=>U.uri.path===o.path)),this.modelUriInstance=P||monaco.editor.createModel(v,this.options.language||"text",this.uri),this.editor.setModel(this.modelUriInstance)}}}writeValue(t){this.value=t,this.editor&&t?this.editor.setValue(t):this.editor&&this.editor.setValue("")}registerOnChange(t){this.propagateChange=t}registerOnTouched(t){this.onTouched=t}validate(){return this.parsedError?{monaco:{value:this.parsedError.split("|")}}:null}registerOnValidatorChange(t){this.onErrorStatusChange=t}initEditor(){const t={value:[this.value].join("\n"),language:"text",automaticLayout:!0,scrollBeyondLastLine:!1,theme:"vc"};this.editor=monaco.editor.create(this.editorContent.nativeElement,this.options?(0,C.Z)((0,C.Z)({},t),this.options):t),this.registerEditorListeners(),this.init.emit(this.editor)}registerEditorListeners(){this.editor.onDidChangeModelContent(()=>{this.propagateChange(this.editor.getValue())}),this.editor.onDidChangeModelDecorations(()=>{const t=this.modelMarkers.map(({message:l})=>l).join("|");this.parsedError!==t&&(this.parsedError=t,this.onErrorStatusChange())}),this.editor.onDidBlurEditorText(()=>{this.onTouched()})}ngOnDestroy(){this.editor&&this.editor.dispose()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(ne))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ngx-monaco-editor"]],viewQuery:function(t,o){if(1&t&&e.Gf(B,7),2&t){let l;e.iGM(l=e.CRH())&&(o.editorContent=l.first)}},inputs:{options:"options",uri:"uri"},outputs:{init:"init"},features:[e._Bn([{provide:F.JU,useExisting:(0,e.Gpc)(()=>i),multi:!0},{provide:F.Cf,useExisting:(0,e.Gpc)(()=>i),multi:!0}]),e.TTD],decls:4,vars:0,consts:[["fxFlex","",1,"editor-container"],["container",""],[1,"monaco-editor"],["editor",""]],template:function(t,o){1&t&&(e.TgZ(0,"div",0,1),e._UZ(2,"div",2,3),e.qZA())},styles:[".monaco-editor[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}.editor-container[_ngcontent-%COMP%]{overflow:hidden;position:relative;display:table;width:100%;height:100%;min-width:0}"],changeDetection:0}),i})(),re=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[]]}),i})();function se(i,r){if(1&i&&(e.ynx(0),e.TgZ(1,"textarea",2),e._uU(2,"            "),e.qZA(),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.ekj("is-invalid",t.showError),e.Q6J("formControl",t.formControl)("cols",1)("rows",10)("formlyAttributes",t.field)}}function le(i,r){1&i&&(e.ynx(0),e.TgZ(1,"p",4),e._UZ(2,"span",5),e.qZA(),e.BQk())}function ae(i,r){if(1&i&&e._UZ(0,"ngx-monaco-editor",6),2&i){const t=e.oxw(2);e.Udp("height",t.editorHeight),e.Q6J("options",t.editorOptions)("formControl",t.formControl)}}function de(i,r){if(1&i&&(e.YNc(0,le,3,0,"ng-container",0),e.YNc(1,ae,1,4,"ng-template",null,3,e.W1O)),2&i){const t=e.MAs(2),o=e.oxw();e.Q6J("ngIf",o.loading)("ngIfElse",t)}}let ce=(()=>{class i extends T.fS{constructor(){super(...arguments),this.touchDevice=p.eX,this.editorOptions={theme:"vs-dark",language:"json"},this.loading=!0,this.editorHeight="350px"}ngOnInit(){this.touchDevice||(this.field.props.editorOptions&&(this.field.props.editorOptions.height&&(this.editorHeight=this.field.props.editorOptions.height,delete this.field.props.editorOptions.height),this.editorOptions=(0,C.Z)((0,C.Z)({},this.editorOptions),this.field.props.editorOptions)),this.loading=!1)}}return i.\u0275fac=function(){let r;return function(o){return(r||(r=e.n5z(i)))(o||i)}}(),i.\u0275cmp=e.Xpm({type:i,selectors:[["formly-code-editor-type"]],features:[e.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["notTouchDevice",""],[1,"form-control",3,"formControl","cols","rows","formlyAttributes"],["codeEditor",""],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],[1,"d-block","formly-code-editor",3,"options","formControl"]],template:function(t,o){if(1&t&&(e.YNc(0,se,3,6,"ng-container",0),e.YNc(1,de,3,2,"ng-template",null,1,e.W1O)),2&t){const l=e.MAs(2);e.Q6J("ngIf",o.touchDevice)("ngIfElse",l)}},dependencies:[h.O5,T.JD,F.Fj,F.JJ,F.oH,oe],encapsulation:2}),i})();var k=f(5861),W=f(8784);function ue(i,r){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",4),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.formControl.setValue(void 0))}),e._uU(2," highlight_off "),e.qZA(),e.BQk()}}function me(i,r){1&i&&(e.ynx(0),e.TgZ(1,"p",5),e._UZ(2,"span",6),e.qZA(),e.BQk())}function fe(i,r){if(1&i&&e._UZ(0,"option",10),2&i){const t=r.$implicit;e.Q6J("ngValue",t.id||t.name)("innerText",t.name)}}function pe(i,r){if(1&i&&(e.ynx(0),e.TgZ(1,"select",8),e.YNc(2,fe,1,2,"option",9),e.qZA(),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.ekj("is-invalid",t.showError),e.Q6J("formControl",t.formControl)("formlyAttributes",t.field),e.xp6(1),e.Q6J("ngForOf",t.groupsList)}}function ge(i,r){if(1&i&&e._UZ(0,"option",10),2&i){const t=r.$implicit;e.Q6J("ngValue",t.id||t.name)("innerText",t.name)}}function _e(i,r){if(1&i&&(e.TgZ(0,"select",11),e.YNc(1,ge,1,2,"option",9),e.qZA()),2&i){const t=e.oxw(2);e.ekj("is-invalid",t.showError),e.Q6J("formControl",t.formControl)("formlyAttributes",t.field),e.xp6(1),e.Q6J("ngForOf",t.groupsList)}}function he(i,r){if(1&i&&(e.YNc(0,pe,3,5,"ng-container",2),e.YNc(1,_e,2,5,"ng-template",null,7,e.W1O)),2&i){const t=e.MAs(2),o=e.oxw();e.Q6J("ngIf",o.field.props.multiple)("ngIfElse",t)}}const ye=function(i){return{"no-label":i}};let ve=(()=>{class i extends T.fS{constructor(t){super(),this.forumService=t,this.loading=!0,this.groupsList=[]}ngOnInit(){var t=this;return(0,k.Z)(function*(){t.field.defaultValue=void 0,t.field.props.hasOwnProperty("multiple")||(t.field.props.multiple=!0),t.groupsList=(yield t.forumService.getGroups()).sort((o,l)=>o.name.localeCompare(l.name)),t.field.props.keepGroupsWithoutId||(t.groupsList=t.groupsList.filter(o=>o.id>0)),t.loading=!1,t.field.formControl.updateValueAndValidity()})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(W._))},i.\u0275cmp=e.Xpm({type:i,selectors:[["formly-field-forum-groups"]],features:[e.qOj],decls:5,vars:6,consts:[[1,"position-relative","wrapper",3,"ngClass"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["formSelect",""],[1,"reset-icon","position-absolute","cursor-pointer","d-block","material-icons","text-danger",3,"click"],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],["single",""],["multiple","",1,"form-select",3,"formControl","formlyAttributes"],[3,"ngValue","innerText",4,"ngFor","ngForOf"],[3,"ngValue","innerText"],[1,"form-select",3,"formControl","formlyAttributes"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,ue,3,0,"ng-container",1),e.YNc(2,me,3,0,"ng-container",2),e.YNc(3,he,3,2,"ng-template",null,3,e.W1O),e.qZA()),2&t){const l=e.MAs(4);e.Q6J("ngClass",e.VKq(4,ye,!o.props.label)),e.xp6(1),e.Q6J("ngIf",!o.props.label||void 0!==o.formControl.value),e.xp6(1),e.Q6J("ngIf",o.loading)("ngIfElse",l)}},dependencies:[h.mk,h.sg,h.O5,T.JD,F.YN,F.Kr,F.EJ,F.K7,F.JJ,F.oH],styles:[".reset-icon[_ngcontent-%COMP%]{right:0}.wrapper[_ngcontent-%COMP%]:not(.no-label)   .reset-icon[_ngcontent-%COMP%]{top:calc(-24px - .45rem)}.no-label[_ngcontent-%COMP%]{padding-top:calc(24px + .45rem)}.no-label[_ngcontent-%COMP%]   .reset-icon[_ngcontent-%COMP%]{top:0}"]}),i})();function Fe(i,r){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",4),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.formControl.setValue(void 0))}),e._uU(2," highlight_off "),e.qZA(),e.BQk()}}function xe(i,r){1&i&&(e.ynx(0),e.TgZ(1,"p",5),e._UZ(2,"span",6),e.qZA(),e.BQk())}function Oe(i,r){if(1&i&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngValue",t.id)("innerHTML"," - "+t.name,e.oJD)}}function Ce(i,r){if(1&i&&(e.ynx(0),e.YNc(1,Oe,2,2,"ng-container",9),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.subsections)}}function Me(i,r){if(1&i&&(e.ynx(0),e._UZ(1,"option",10),e.YNc(2,Ce,2,1,"ng-container",1),e.BQk()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngValue",t.id)("innerHTML",t.name,e.oJD),e.xp6(1),e.Q6J("ngIf",t.subsections&&t.subsections.length)}}function be(i,r){if(1&i&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngValue",t)("innerHTML"," -- Sezione ristretta -- #"+t,e.oJD)}}function Te(i,r){if(1&i&&(e.ynx(0),e.YNc(1,be,2,2,"ng-container",9),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.restrictedOrDeletedSections)}}function Ee(i,r){if(1&i&&(e.ynx(0),e.TgZ(1,"select",8),e.YNc(2,Me,3,3,"ng-container",9),e.YNc(3,Te,2,1,"ng-container",1),e.qZA(),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.ekj("is-invalid",t.showError),e.Q6J("formControl",t.formControl)("formlyAttributes",t.field),e.xp6(1),e.Q6J("ngForOf",t.sectionsList),e.xp6(1),e.Q6J("ngIf",t.restrictedOrDeletedSections.length>0)}}function Ae(i,r){if(1&i&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngValue",t.id)("innerHTML"," - "+t.name,e.oJD)}}function we(i,r){if(1&i&&(e.ynx(0),e.YNc(1,Ae,2,2,"ng-container",9),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.subsections)}}function Ze(i,r){if(1&i&&(e.ynx(0),e._UZ(1,"option",10),e.YNc(2,we,2,1,"ng-container",1),e.BQk()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngValue",t.id)("innerHTML",t.name,e.oJD),e.xp6(1),e.Q6J("ngIf",t.subsections&&t.subsections.length)}}function Se(i,r){if(1&i&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("ngValue",t)("innerHTML"," -- Sezione ristretta -- #"+t,e.oJD)}}function De(i,r){if(1&i&&(e.ynx(0),e.YNc(1,Se,2,2,"ng-container",9),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.restrictedOrDeletedSections)}}function Pe(i,r){if(1&i&&(e.TgZ(0,"select",11),e.YNc(1,Ze,3,3,"ng-container",9),e.YNc(2,De,2,1,"ng-container",1),e.qZA()),2&i){const t=e.oxw(2);e.ekj("is-invalid",t.showError),e.Q6J("formControl",t.formControl)("formlyAttributes",t.field),e.xp6(1),e.Q6J("ngForOf",t.sectionsList),e.xp6(1),e.Q6J("ngIf",t.restrictedOrDeletedSections.length>0)}}function Ie(i,r){if(1&i&&(e.YNc(0,Ee,4,6,"ng-container",2),e.YNc(1,Pe,3,6,"ng-template",null,7,e.W1O)),2&i){const t=e.MAs(2),o=e.oxw();e.Q6J("ngIf",o.field.props.multiple)("ngIfElse",t)}}const Je=function(i){return{"no-label":i}};let Le=(()=>{class i extends T.fS{constructor(t){super(),this.forumService=t,this.loading=!0,this.sectionsList=[],this.restrictedOrDeletedSections=[]}ngOnInit(){var t=this;return(0,k.Z)(function*(){t.field.defaultValue=void 0,t.field.props.hasOwnProperty("multiple")||(t.field.props.multiple=!0),t.restrictedOrDeletedSections=Array.isArray(t.field.formControl.value)?[...t.field.formControl.value]:[];const o=yield t.forumService.getSections();t.sectionsList=o.map(l=>{const v=t.restrictedOrDeletedSections.indexOf(l.id);return v>-1&&t.restrictedOrDeletedSections.splice(v,1),(0,C.Z)((0,C.Z)({},l),{subsections:t.flattenSubsections(l)})}),t.loading=!1,t.field.formControl.updateValueAndValidity()})()}flattenSubsections(t){let o=[],l=-1;if(t.subsections&&t.subsections.length)for(const v of t.subsections)l=this.restrictedOrDeletedSections.indexOf(v.id),l>-1&&this.restrictedOrDeletedSections.splice(l,1),o.push(v),v.subsections&&(o=[...o,...this.flattenSubsections(v)]);return o}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(W._))},i.\u0275cmp=e.Xpm({type:i,selectors:[["formly-field-forum-sections"]],features:[e.qOj],decls:5,vars:6,consts:[[1,"position-relative","wrapper",3,"ngClass"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["formSelect",""],[1,"reset-icon","position-absolute","cursor-pointer","d-block","material-icons","text-danger",3,"click"],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],["single",""],["multiple","",1,"form-select",3,"formControl","formlyAttributes"],[4,"ngFor","ngForOf"],[3,"ngValue","innerHTML"],[1,"form-select",3,"formControl","formlyAttributes"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,Fe,3,0,"ng-container",1),e.YNc(2,xe,3,0,"ng-container",2),e.YNc(3,Ie,3,2,"ng-template",null,3,e.W1O),e.qZA()),2&t){const l=e.MAs(4);e.Q6J("ngClass",e.VKq(4,Je,!o.props.label)),e.xp6(1),e.Q6J("ngIf",!o.props.label||void 0!==o.formControl.value),e.xp6(1),e.Q6J("ngIf",o.loading)("ngIfElse",l)}},dependencies:[h.mk,h.sg,h.O5,T.JD,F.YN,F.Kr,F.EJ,F.K7,F.JJ,F.oH],styles:[".reset-icon[_ngcontent-%COMP%]{right:0}.wrapper[_ngcontent-%COMP%]:not(.no-label)   .reset-icon[_ngcontent-%COMP%]{top:calc(-24px - .45rem)}.no-label[_ngcontent-%COMP%]{padding-top:calc(24px + .45rem)}.no-label[_ngcontent-%COMP%]   .reset-icon[_ngcontent-%COMP%]{top:0}"]}),i})();var Ue=f(8645),Qe=f(3620),Ve=f(3997),Ne=f(3019),X=f(9397),ke=f(4664),Ye=f(2096);let z=(()=>{class i{transform(t){let o=document.createElement("TEXTAREA");return o.innerHTML=t,o.value}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=e.Yjl({name:"decodeHtmlEntitites",type:i,pure:!0}),i})();var je=f(1410),Ge=f(7165),qe=f(5661),He=f(8418),Be=f(4291),$e=f(9473),ee=f(3946),Re=f(7357);function Ke(i,r){1&i&&(e.TgZ(0,"span",8),e._uU(1,"*"),e.qZA())}function We(i,r){if(1&i&&(e.TgZ(0,"legend",5)(1,"label",6),e._uU(2),e.YNc(3,Ke,2,0,"span",7),e.qZA()()),2&i){const t=e.oxw();e.xp6(1),e.s9C("for",t.id),e.xp6(1),e.hij(" ",t.props.label," "),e.xp6(1),e.Q6J("ngIf",t.props.required)}}function Xe(i,r){1&i&&e.GkF(0)}function ze(i,r){if(1&i&&e._UZ(0,"div",9),2&i){const t=e.oxw();e.Q6J("innerHTML",t.parsedDescription,e.oJD)}}function et(i,r){1&i&&(e.TgZ(0,"div",16)(1,"span",17),e._uU(2,"Loading..."),e.qZA()())}function tt(i,r){if(1&i&&(e.TgZ(0,"div",18),e._UZ(1,"formly-validation-message",19),e.qZA()),2&i){const t=e.oxw(2);e.Udp("display","block"),e.xp6(1),e.Q6J("field",t.field)}}function it(i,r){1&i&&e._UZ(0,"app-loader",20)}function nt(i,r){1&i&&e._UZ(0,"div",25),2&i&&e.Q6J("innerText","Nessun utente inserito!")}function ot(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li")(1,"a",28)(2,"div",29),e.NdJ("click",function(l){const P=e.CHM(t).$implicit,U=e.oxw(4);return e.KtG(U.removeUser(P,l))}),e.TgZ(3,"div",30),e._uU(4," remove "),e.qZA()(),e._UZ(5,"img",31),e.ALo(6,"uploadsreplace"),e.qZA(),e._UZ(7,"a",32),e.qZA()}if(2&i){const t=r.$implicit,o=e.oxw(4);e.Gre("d-flex flex-column align-items-center user-",o.circuit,""),e.xp6(1),e.Q6J("href",o.baseUrl+t.uid.substring(2),e.LSH),e.xp6(1),e.Q6J("disableOnTouchDevice",!0),e.xp6(3),e.s9C("alt",t.nickname+"'s avatar"),e.Q6J("src",e.lcZ(6,9,t.avatar),e.LSH),e.xp6(2),e.Q6J("innerHTML",t.nickname,e.oJD)("href",o.baseUrl+t.uid.substring(2),e.LSH)}}function rt(i,r){if(1&i&&(e.TgZ(0,"ul",26),e.YNc(1,ot,8,11,"li",27),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.selectedUsers)}}const st=function(i){return{"empty-list":i}};function lt(i,r){if(1&i&&(e.TgZ(0,"fieldset",21)(1,"legend",22),e._uU(2," Lista utenti "),e.qZA(),e.YNc(3,nt,1,1,"div",23),e.YNc(4,rt,2,1,"ng-template",null,24,e.W1O),e.qZA()),2&i){const t=e.MAs(5),o=e.oxw(2);e.Q6J("ngClass",e.VKq(3,st,0===o.selectedUsers.length)),e.xp6(3),e.Q6J("ngIf",0===o.selectedUsers.length)("ngIfElse",t)}}function at(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"input",11),e.NdJ("ngModelChange",function(l){e.CHM(t);const v=e.oxw();return e.KtG(v.inputValue=l)})("selectItem",function(l){e.CHM(t);const v=e.oxw();return e.KtG(v.selectUser(l))})("focus",function(l){e.CHM(t);const v=e.oxw();return e.KtG(v.focus.next(l.target.value))}),e.qZA(),e.YNc(2,et,3,0,"div",12),e.qZA(),e.YNc(3,tt,2,3,"div",13),e.YNc(4,it,1,0,"app-loader",14),e.YNc(5,lt,6,5,"ng-template",null,15,e.W1O)}if(2&i){const t=e.MAs(6),o=e.oxw();e.xp6(1),e.ekj("is-invalid",o.showError),e.Q6J("ngModel",o.inputValue)("formlyAttributes",o.field)("ngbTypeahead",o.search)("editable",!1)("inputFormatter",o.inputFormatter)("resultFormatter",o.outputFormatter),e.xp6(1),e.Q6J("ngIf",o.searching),e.xp6(1),e.Q6J("ngIf",o.showError),e.xp6(1),e.Q6J("ngIf",o.loading)("ngIfElse",t)}}let dt=(()=>{class i extends T.fS{constructor(t,o,l,v,P,U){var V;if(super(),this.userService=t,this.globalsService=o,this.changeDetectorRef=l,this.toastService=v,this.customFormUtilsService=P,this.decodeHtmlEntitiesPipe=U,this.inputValue="",this.selectedUsers=[],this.loading=!0,this.searching=!1,this.focus=new Ue.x,this.parsedDescription="",this.formlyFieldValues=[],this.lastSearchedValueWithoutResult="",this.outputFormatter=Q=>Q?Q.nickname.indexOf("&")>-1?this.decodeHtmlEntitiesPipe.transform(Q.nickname):Q.nickname:"",this.search=Q=>{const gt=Q.pipe((0,Qe.b)(1e3),(0,Ve.x)());return(0,Ne.T)(gt,this.focus).pipe((0,X.b)(()=>this.setSearching(!0)),(0,ke.w)(te=>te.length<3?(0,Ye.of)([]):this.getUsers(te)),(0,X.b)(()=>this.setSearching(!1)))},this.circuit=(null===(V=this.globalsService.credentials)||void 0===V?void 0:V.site.short)||"",!this.circuit)throw new Error("Missing credentials!");this.baseUrl=Ge.hD[this.circuit]+"/?act=Profile&MID="}ngOnInit(){var t=this;return(0,k.Z)(function*(){t.parsedDescription=t.props.description?t.customFormUtilsService.parseBBCode(t.props.description):"",t.formlyFieldValues=Array.isArray(t.formControl.value)?t.formControl.value:Array.isArray(t.field.defaultValue)?t.field.defaultValue:[],yield t.getSelectedUsersFromApi(),t.loading=!1,t.formControl.updateValueAndValidity(),t.formControl.registerOnChange(()=>{t.formControlChangeCallback()})})()}inputFormatter(t){return t.nickname}getUsers(t){var o=this;return(0,k.Z)(function*(){if(o.lastSearchedValueWithoutResult&&0===t.indexOf(o.lastSearchedValueWithoutResult))return[];const l=yield o.userService.searchUserByName(t);return 0===l.length&&(o.lastSearchedValueWithoutResult=t),l})()}setSearching(t){this.searching=t,this.changeDetectorRef.detectChanges()}selectUser(t){const o=t.item,l=Number(o.uid.substring(2));if(this.formlyFieldValues.includes(l))return this.toastService.show({content:`L'utente <strong>${o.nickname}</strong> \xe8 gi\xe0 stato aggiunto alla lista!`}),void(this.inputValue="");this.formlyFieldValues.push(l),this.selectedUsers.push(o),t.preventDefault(),this.inputValue="",this.formControl.setValue([...this.formlyFieldValues])}removeUser(t,o){o.preventDefault(),o.stopPropagation();const l=Number(t.uid.substring(2));this.formlyFieldValues=this.formlyFieldValues.filter(v=>v!==l),this.selectedUsers=this.selectedUsers.filter(v=>v.uid!==t.uid),this.formControl.setValue([...this.formlyFieldValues])}formControlChangeCallback(){var t=this;return(0,k.Z)(function*(){if(!Array.isArray(t.formControl.value))return;let o=!1;if(t.formControl.value.length!==t.formlyFieldValues.length)o=!0;else for(const l of t.formControl.value)if(!t.formlyFieldValues.includes(l)){o=!0;break}o&&(t.formlyFieldValues=t.formControl.value,t.loading=!0,t.changeDetectorRef.detectChanges(),yield t.getSelectedUsersFromApi(),t.loading=!1,t.changeDetectorRef.detectChanges())})()}getSelectedUsersFromApi(){var t=this;return(0,k.Z)(function*(){t.selectedUsers=0!==t.formlyFieldValues.length?(yield t.userService.getDetailsFromUids(t.formlyFieldValues.map(o=>t.circuit+o))).sort((o,l)=>o.nickname>l.nickname?1:l.nickname>o.nickname?-1:0):[]})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(He.K),e.Y36(je.d),e.Y36(e.sBO),e.Y36(qe.k),e.Y36(O.d6),e.Y36(z))},i.\u0275cmp=e.Xpm({type:i,selectors:[["formly-field-forum-users"]],features:[e._Bn([z]),e.qOj],decls:6,vars:5,consts:[[1,"mb-3","rounded","px-3","pt-2","pb-3","formly-fieldset"],["class","legend-reset fs-reset mb-0 px-2 mw-100 lh-1 py-1",4,"ngIf"],[4,"ngTemplateOutlet"],["class","form-text text-muted",3,"innerHTML",4,"ngIf"],["fieldContet",""],[1,"legend-reset","fs-reset","mb-0","px-2","mw-100","lh-1","py-1"],[1,"form-label","mb-0","mw-100","text-truncate",3,"for"],["aria-hidden","true",4,"ngIf"],["aria-hidden","true"],[1,"form-text","text-muted",3,"innerHTML"],[1,"position-relative"],["type","text","container","body",1,"form-control",3,"ngModel","formlyAttributes","ngbTypeahead","editable","inputFormatter","resultFormatter","ngModelChange","selectItem","focus"],["class","spinner-border spinner-border-sm text-primary position-absolute","role","status",4,"ngIf"],["class","invalid-feedback",3,"display",4,"ngIf"],["message","Recupero utenti","class","d-block mt-3",4,"ngIf","ngIfElse"],["userList",""],["role","status",1,"spinner-border","spinner-border-sm","text-primary","position-absolute"],[1,"visually-hidden"],[1,"invalid-feedback"],[3,"field"],["message","Recupero utenti",1,"d-block","mt-3"],[1,"formly-user-list-container","rounded","px-3","pt-2","mb-3","mt-2",3,"ngClass"],[1,"legend-reset","fs-reset","mb-0","px-2","pb-1"],["class","alert alert-primary text-center mb-0 fw-bold",3,"innerText",4,"ngIf","ngIfElse"],["noEmpty",""],[1,"alert","alert-primary","text-center","mb-0","fw-bold",3,"innerText"],[1,"formly-user-list","list-unstyled","mb-0","d-grid","px-2"],[3,"class",4,"ngFor","ngForOf"],["target","_blank",1,"avatar-container","rounded-circle","d-block","position-relative",3,"href"],["appTippy","Rimuovi",1,"remove-user","alert","alert-danger","position-absolute","cursor-pointer","mb-0","py-0","px-1",3,"disableOnTouchDevice","click"],[1,"material-icons","d-block","fs-reset"],["appImage","",1,"d-block","image-cover","rounded-circle",3,"src","alt"],["target","_blank",1,"d-block","fw-bold","mt-1","nickname","text-truncate","mw-100",3,"innerHTML","href"]],template:function(t,o){if(1&t&&(e.TgZ(0,"fieldset",0),e.YNc(1,We,4,3,"legend",1),e.YNc(2,Xe,1,0,"ng-container",2),e.YNc(3,ze,1,1,"div",3),e.qZA(),e.YNc(4,at,7,12,"ng-template",null,4,e.W1O)),2&t){const l=e.MAs(5);e.ekj("has-error",o.formControl.invalid),e.xp6(1),e.Q6J("ngIf",o.props.label),e.xp6(1),e.Q6J("ngTemplateOutlet",l),e.xp6(1),e.Q6J("ngIf",o.parsedDescription)}},dependencies:[h.mk,h.sg,h.O5,h.tP,T.JD,T.M2,F.Fj,F.JJ,F.On,Be.t,$e.R,ee.dR,w.$,Re.g],styles:[".spinner-border[_ngcontent-%COMP%]{top:calc(50% - 8px);right:10px}fieldset.formly-user-list-container[_ngcontent-%COMP%]{border:1px dashed var(--ei-gray-500)}fieldset.formly-user-list-container[_ngcontent-%COMP%]:not(.empty-list){padding-bottom:.75rem}fieldset.formly-user-list-container.empty-list[_ngcontent-%COMP%]{padding-bottom:1rem}.formly-user-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(60px,1fr));gap:1rem}.formly-user-list[_ngcontent-%COMP%]   .remove-user[_ngcontent-%COMP%]{top:0;left:-8px}.formly-user-list[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{width:60px;height:60px;border:2px solid}.formly-user-list[_ngcontent-%COMP%]   .user-ff[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{border-color:#58a72e}.formly-user-list[_ngcontent-%COMP%]   .user-ff[_ngcontent-%COMP%]   .nickname[_ngcontent-%COMP%]{color:#58a72e!important}.formly-user-list[_ngcontent-%COMP%]   .user-fc[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{border-color:#0082cd}.formly-user-list[_ngcontent-%COMP%]   .user-fc[_ngcontent-%COMP%]   .nickname[_ngcontent-%COMP%]{color:#0082cd!important}.formly-user-list[_ngcontent-%COMP%]   .user-bf[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{border-color:#e67f22}.formly-user-list[_ngcontent-%COMP%]   .user-bf[_ngcontent-%COMP%]   .nickname[_ngcontent-%COMP%]{color:#e67f22!important}@media (min-width: 960px){.formly-user-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(75px,1fr));gap:1.5rem}.formly-user-list[_ngcontent-%COMP%]   .remove-user[_ngcontent-%COMP%]{top:4px}.formly-user-list[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{width:75px;height:75px}}"]}),i})(),ct=(()=>{class i extends T.fS{constructor(){super(...arguments),this.defaultOptions={props:{label:""}}}}return i.\u0275fac=function(){let r;return function(o){return(r||(r=e.n5z(i)))(o||i)}}(),i.\u0275cmp=e.Xpm({type:i,selectors:[["formly-field-label"]],features:[e.qOj],decls:2,vars:1,template:function(t,o){1&t&&(e.TgZ(0,"h5"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu(o.props.label))},encapsulation:2,changeDetection:0}),i})();var ut=f(4295),mt=f(3038),ft=f(5063);let pt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[h.ez,I.Vy,I.d3,T.X0.forChild({types:[{name:"array",component:c},{name:"code-editor",component:ce,wrappers:["form-field"]},{name:"forum-groups",component:ve,wrappers:["form-field"]},{name:"forum-sections",component:Le,wrappers:["form-field"]},{name:"label",component:ct},{name:"forum-users",component:dt}]}),F.u5,ut.$,I.q,re,ee.ZS,mt.G,ft.g]}),i})()},336:(R,Y,f)=>{f.d(Y,{c:()=>L});var h=f(9376),I=f(91),O=f(1413),T=f(5879),e=f(6223),w=f(5545),j=f(9397);const G=["key"],q=["allOf"];function M(u){return""===u||null==u}function J(u){return null!=u&&"object"==typeof u&&!Array.isArray(u)}function a(u){return Number.isInteger?Number.isInteger(u):"number"==typeof u&&Math.floor(u)===u}function g(u){return"object"==typeof u&&(u.hasOwnProperty("const")||u.enum&&1===u.enum.length)}function E(u){if(!u.fieldGroup)return(0,w._S)(u)&&void 0!==(0,w.Hl)(u)?1:0;const Z=u.fieldGroup.reduce((n,m)=>E(m)+n,0);if(0===Z&&(0,w._S)(u)){const n=(0,w.Hl)(u);if(null===n||void 0!==n&&(u.fieldArray&&Array.isArray(n)||!u.fieldArray&&J(n)))return 1}return Z}let L=(()=>{class u{toFieldConfig(n,m){return this._toFieldConfig(n,(0,O.Z)({schema:n},m||{}))}_toFieldConfig(n,m){var y;let{key:x}=m,d=(0,I.Z)(m,G);n=this.resolveSchema(n,d);const _=this.guessSchemaType(n);let s={type:_[0],defaultValue:n.default,props:{label:n.title,readonly:n.readOnly,description:n.description}};switch(null!=x&&(s.key=x),!d.ignoreDefault&&(n.readOnly||d.readOnly)&&(s.props.disabled=!0,d=(0,O.Z)((0,O.Z)({},d),{},{readOnly:!0})),d.resetOnHide&&(s.resetOnHide=!0),x&&d.strict&&this.addValidator(s,"type",(c,C)=>{const p=(0,w.Hl)(C);if(null!=p)switch(s.type){case"string":return"string"==typeof p;case"integer":return a(p);case"number":return"number"==typeof p;case"object":return J(p);case"array":return Array.isArray(p)}return!0}),!1===d.shareFormControl&&(s.shareFormControl=!1),d.ignoreDefault&&delete s.defaultValue,this.addValidator(s,"type",{schemaType:_,expression:({value:c})=>{if(void 0===c||null===c&&-1!==_.indexOf("null"))return!0;switch(_[0]){case"null":return null===typeof c;case"string":return"string"==typeof c;case"integer":return a(c);case"number":return"number"==typeof c;case"object":return J(c);case"array":return Array.isArray(c)}return!0}}),s.type){case"number":case"integer":s.parsers=[c=>M(c)?void 0:Number(c)],n.hasOwnProperty("minimum")&&(s.props.min=n.minimum),n.hasOwnProperty("maximum")&&(s.props.max=n.maximum),n.hasOwnProperty("exclusiveMinimum")&&(s.props.exclusiveMinimum=n.exclusiveMinimum,this.addValidator(s,"exclusiveMinimum",({value:c})=>M(c)||c>n.exclusiveMinimum)),n.hasOwnProperty("exclusiveMaximum")&&(s.props.exclusiveMaximum=n.exclusiveMaximum,this.addValidator(s,"exclusiveMaximum",({value:c})=>M(c)||c<n.exclusiveMaximum)),n.hasOwnProperty("multipleOf")&&(s.props.step=n.multipleOf,this.addValidator(s,"multipleOf",({value:c})=>{if(M(c)||"number"!=typeof c||0===c||n.multipleOf<=0)return!0;const C=Math.pow(10,function H(u){if(!isFinite(u))return 0;let Z=1,n=0;for(;Math.round(u*Z)/Z!==u;)Z*=10,n++;return n}(n.multipleOf));return Math.round(c*C)%Math.round(n.multipleOf*C)==0}));break;case"string":s.parsers=[c=>(-1!==_.indexOf("null")?c=M(c)?null:c:s.props.required||(c=""===c?void 0:c),c)],["minLength","maxLength","pattern"].forEach(c=>{n.hasOwnProperty(c)&&(s.props[c]=n[c])});break;case"object":{s.fieldGroup||(s.fieldGroup=[]);const{propDeps:c,schemaDeps:C}=this.resolveDependencies(n);Object.keys(n.properties||{}).forEach(p=>{const F=Array.isArray(n.required)&&-1!==n.required.indexOf(p),S=this._toFieldConfig(n.properties[p],(0,O.Z)((0,O.Z)({},d),{},{key:p,isOptional:d.isOptional||!F}));if(s.fieldGroup.push(S),(F||c[p])&&(S.expressions=(0,O.Z)((0,O.Z)({},S.expressions||{}),{},{"props.required":D=>{let A=D.parent;const b=D.fieldGroup&&null!=D.key?A.model:D.model;for(;null==A.key&&A.parent;)A=A.parent;return!!(b||A&&A.props&&A.props.required)&&(!(!Array.isArray(n.required)||-1===n.required.indexOf(p))||c[p]&&D.model&&c[p].some(B=>!M(D.model[B])))}})),C[p]){const D=b=>b.hasOwnProperty("const")?b.const:b.enum[0],A=C[p].oneOf;A&&A.every(b=>b.properties&&b.properties[p]&&g(b.properties[p]))?A.forEach(b=>{const N=b.properties,{[p]:B}=N,K=(0,I.Z)(N,[p].map(h.Z));s.fieldGroup.push((0,O.Z)((0,O.Z)({},this._toFieldConfig((0,O.Z)((0,O.Z)({},b),{},{properties:K}),(0,O.Z)((0,O.Z)({},d),{},{resetOnHide:!0}))),{},{expressions:{hide:$=>!$.model||D(B)!==$.model[p]}}))}):s.fieldGroup.push((0,O.Z)((0,O.Z)({},this._toFieldConfig(C[p],d)),{},{expressions:{hide:b=>!b.model||M(b.model[p])}}))}}),n.oneOf&&s.fieldGroup.push(this.resolveMultiSchema("oneOf",n.oneOf,(0,O.Z)((0,O.Z)({},d),{},{shareFormControl:!1}))),n.anyOf&&s.fieldGroup.push(this.resolveMultiSchema("anyOf",n.anyOf,d));break}case"array":n.hasOwnProperty("minItems")&&(s.props.minItems=n.minItems,this.addValidator(s,"minItems",(c,C)=>{const p=(0,w.Hl)(C);return M(p)||p.length>=n.minItems}),!d.isOptional&&n.minItems>0&&void 0===s.defaultValue&&(s.defaultValue=Array.from(new Array(n.minItems)))),n.hasOwnProperty("maxItems")&&(s.props.maxItems=n.maxItems,this.addValidator(s,"maxItems",(c,C)=>{const p=(0,w.Hl)(C);return M(p)||p.length<=n.maxItems})),n.hasOwnProperty("uniqueItems")&&(s.props.uniqueItems=n.uniqueItems,this.addValidator(s,"uniqueItems",(c,C)=>{const p=(0,w.Hl)(C);return!(!M(p)&&n.uniqueItems)||Array.from(new Set(p.map(S=>JSON.stringify(S)))).length===p.length})),n.items&&!Array.isArray(n.items)&&(n.items=this.resolveSchema(n.items,d)),this.isEnum(n)||(s.fieldArray=c=>{if(!Array.isArray(n.items)){const S=n.items?this._toFieldConfig(n.items,d):{};return S.props&&(S.props.required=!0),S}const C=c.fieldGroup?c.fieldGroup.length:0,p=n.items[C]?n.items[C]:n.additionalItems,F=p?this._toFieldConfig(p,d):{};return F.props&&(F.props.required=!0),n.items[C]&&(F.props.removable=!1),F})}return n.hasOwnProperty("const")&&(s.props.const=n.const,this.addValidator(s,"const",({value:c})=>c===n.const),s.type||(s.defaultValue=n.const)),this.isEnum(n)&&(s.props.multiple="array"===s.type,s.type="enum",s.props.options=this.toEnumOptions(n)),n.oneOf&&!s.type&&(delete s.key,s.fieldGroup=[this.resolveMultiSchema("oneOf",n.oneOf,(0,O.Z)((0,O.Z)({},d),{},{key:x,shareFormControl:!1}))]),n.oneOf&&!s.type&&(delete s.key,s.fieldGroup=[this.resolveMultiSchema("oneOf",n.oneOf,(0,O.Z)((0,O.Z)({},d),{},{key:x,shareFormControl:!1}))]),null!==(y=n.widget)&&void 0!==y&&y.formlyConfig&&(s=this.mergeFields(s,n.widget.formlyConfig)),s.templateOptions=s.props,d.map?d.map(s,n):s}resolveSchema(n,m){return n&&n.$ref&&(n=this.resolveDefinition(n,m)),n&&n.allOf&&(n=this.resolveAllOf(n,m)),n}resolveAllOf(n,m){let{allOf:y}=n,x=(0,I.Z)(n,q);if(!y.length)throw Error(`allOf array can not be empty ${y}.`);return y.reduce((d,_)=>(_=this.resolveSchema(_,m),d.required&&_.required&&(d.required=[...d.required,..._.required]),_.uniqueItems&&(d.uniqueItems=_.uniqueItems),["maxLength","maximum","exclusiveMaximum","maxItems","maxProperties"].forEach(s=>{!M(d[s])&&!M(_[s])&&(d[s]=d[s]<_[s]?d[s]:_[s])}),["minLength","minimum","exclusiveMinimum","minItems","minProperties"].forEach(s=>{!M(d[s])&&!M(_[s])&&(d[s]=d[s]>_[s]?d[s]:_[s])}),(0,w.Du)(d,_)),x)}resolveMultiSchema(n,m,y){return{type:"multischema",fieldGroup:[{type:"enum",defaultValue:-1,props:{multiple:"anyOf"===n,options:m.map((x,d)=>({label:x.title,value:d,disabled:x.readOnly}))},hooks:{onInit:x=>x.formControl.valueChanges.pipe((0,j.b)(()=>x.options.detectChanges(x.parent)))}},{fieldGroup:m.map((x,d)=>(0,O.Z)((0,O.Z)({},this._toFieldConfig(x,(0,O.Z)((0,O.Z)({},y),{},{resetOnHide:!0}))),{},{expressions:{hide:(_,s)=>{const c=_.parent.parent.fieldGroup[0].formControl;if(-1===c.value||s){let C=_.parent.fieldGroup.map((p,F)=>[p,F,this.isFieldValid(p,F,m,y)]).sort(([p,,F],[S,,D])=>{if(F!==D)return D?1:-1;const A=E(p),b=E(S);return A===b&&p.props.disabled===S.props.disabled?0:b>A?1:-1}).map(([,p])=>p);if("anyOf"===n){const p=C.filter(F=>E(_.parent.fieldGroup[F]));C=p.length>0?p:[C[0]||0]}C=C.length>0?C:[0],c.setValue("anyOf"===n?C:C[0])}return Array.isArray(c.value)?-1===c.value.indexOf(d):c.value!==d}}}))}]}}resolveDefinition(n,m){const[y,x]=n.$ref.split("#/");if(y)throw Error(`Remote schemas for ${n.$ref} not supported yet.`);const d=x?x.split("/").reduce((_,s)=>null!=_&&_.hasOwnProperty(s)?_[s]:null,m.schema):null;if(!d)throw Error(`Cannot find a definition for ${n.$ref}.`);return d.$ref?this.resolveDefinition(d,m):(0,O.Z)((0,O.Z)({},d),["title","description","default","widget"].reduce((_,s)=>(n.hasOwnProperty(s)&&(_[s]=n[s]),_),{}))}resolveDependencies(n){const m={},y={};return Object.keys(n.dependencies||{}).forEach(x=>{const d=n.dependencies[x];Array.isArray(d)?d.forEach(_=>{m[_]?m[_].push(x):m[_]=[x]}):y[x]=d}),{propDeps:m,schemaDeps:y}}guessSchemaType(n){const m=null==n?void 0:n.type;return!m&&null!=n&&n.properties?["object"]:Array.isArray(m)?1===m.length?m:2===m.length&&-1!==m.indexOf("null")?m.sort(y=>"null"==y?1:-1):m:m?[m]:[]}addValidator(n,m,y){n.validators=n.validators||{},n.validators[m]=y}isEnum(n){return!!n.enum||n.anyOf&&n.anyOf.every(g)||n.oneOf&&n.oneOf.every(g)||n.uniqueItems&&n.items&&!Array.isArray(n.items)&&this.isEnum(n.items)}toEnumOptions(n){if(n.enum)return n.enum.map(y=>({value:y,label:y}));const m=y=>{const x=y.hasOwnProperty("const")?y.const:y.enum[0],d={value:x,label:y.title||x};return y.readOnly&&(d.disabled=!0),d};return n.anyOf?n.anyOf.map(m):n.oneOf?n.oneOf.map(m):this.toEnumOptions(n.items)}isFieldValid(n,m,y,x){n._schemasFields||(Object.defineProperty(n,"_schemasFields",{enumerable:!1,writable:!0,configurable:!0}),n._schemasFields={});let d=n._schemasFields[m];const _=n.model?(0,w.kg)(n.model):n.fieldArray?[]:{};return d?(d.model=_,n.options.build(d)):d=n._schemasFields[m]=n.options.build({form:Array.isArray(_)?new e.Oe([]):new e.cw({}),fieldGroup:[this._toFieldConfig(y[m],(0,O.Z)((0,O.Z)({},x),{},{resetOnHide:!0,ignoreDefault:!0,map:null,strict:!0}))],model:_,options:{}}),d.form.valid}mergeFields(n,m){for(let y in m){const x="templateOptions"===y?"props":y;J(n[x])&&J(m[y])?n[x]=this.mergeFields(n[x],m[y]):null!=m[y]&&(n[x]=m[y])}return n}}return u.\u0275fac=function(n){return new(n||u)},u.\u0275prov=T.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()}}]);