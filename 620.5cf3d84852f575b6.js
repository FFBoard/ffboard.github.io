(self.webpackChunkboard=self.webpackChunkboard||[]).push([[620],{9969:(V,B,t)=>{"use strict";t.d(B,{R:()=>h});class h{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(e){Object.keys(e).filter(x=>x in this).forEach(x=>this[x]=e[x]),this.validateOptions()}setOptionsFromChanges(e){Object.keys(e).filter(x=>x in this).forEach(x=>this[x]=e[x].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}},2020:(V,B,t)=>{"use strict";t.d(B,{y:()=>n});var h=t(5861);var v=t(4650);let n=(()=>{class c{constructor(){this.autoRotateSupported=function e(){return new Promise(c=>{const u=new Image;u.onload=()=>{c(1===u.width&&2===u.height)},u.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(r,_){return new Promise((p,A)=>{const T=new FileReader;T.onload=R=>{this.loadImage(R.target.result,r.type,_).then(p).catch(A)},T.readAsDataURL(r)})}loadImage(r,_,p){return this.isValidImageType(_)?this.loadBase64Image(r,p):Promise.reject(new Error("Invalid image type"))}isValidImageType(r){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(r)}loadImageFromURL(r,_){return new Promise((p,A)=>{const T=new Image;T.onerror=()=>A,T.onload=()=>{const R=document.createElement("canvas"),Q=R.getContext("2d");R.width=T.width,R.height=T.height,Q?.drawImage(T,0,0),this.loadBase64Image(R.toDataURL(),_).then(p)},T.crossOrigin="anonymous",T.src=r})}loadBase64Image(r,_){return new Promise((p,A)=>{const T=new Image;T.onload=()=>p({originalImage:T,originalBase64:r}),T.onerror=A,T.src=r}).then(p=>this.transformImageBase64(p,_))}transformImageBase64(r,_){var p=this;return(0,h.Z)(function*(){const A=yield p.autoRotateSupported,T=yield function x(c){switch("string"==typeof c&&(c=function C(c){const u=new DataView(function m(c){c=c.replace(/^data\:([^\;]+)\;base64,/gim,"");const u=atob(c),r=u.length,_=new Uint8Array(r);for(let p=0;p<r;p++)_[p]=u.charCodeAt(p);return _.buffer}(c));if(65496!==u.getUint16(0,!1))return-2;const r=u.byteLength;let _=2;for(;_<r;){if(u.getUint16(_+2,!1)<=8)return-1;const p=u.getUint16(_,!1);if(_+=2,65505==p){if(1165519206!==u.getUint32(_+=2,!1))return-1;const A=18761==u.getUint16(_+=6,!1);_+=u.getUint32(_+4,A);const T=u.getUint16(_,A);_+=2;for(let R=0;R<T;R++)if(274==u.getUint16(_+12*R,A))return u.getUint16(_+12*R+8,A)}else{if(65280!=(65280&p))break;_+=u.getUint16(_,!1)}}return-1}(c)),c){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(A?-1:r.originalBase64);return r.originalImage&&r.originalImage.complete?p.transformLoadedImage({original:{base64:r.originalBase64,image:r.originalImage,size:{width:r.originalImage.naturalWidth,height:r.originalImage.naturalHeight}},exifTransform:T},_):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(r,_){var p=this;return(0,h.Z)(function*(){const A=_.canvasRotation+r.exifTransform.rotate,T={width:r.original.image.naturalWidth,height:r.original.image.naturalHeight};if(0===A&&!r.exifTransform.flip&&!_.containWithinAspectRatio)return{original:{base64:r.original.base64,image:r.original.image,size:{...T}},transformed:{base64:r.original.base64,image:r.original.image,size:{...T}},exifTransform:r.exifTransform};const R=p.getTransformedSize(T,r.exifTransform,_),Q=document.createElement("canvas");Q.width=R.width,Q.height=R.height;const O=Q.getContext("2d");O?.setTransform(r.exifTransform.flip?-1:1,0,0,1,Q.width/2,Q.height/2),O?.rotate(Math.PI*(A/2)),O?.drawImage(r.original.image,-T.width/2,-T.height/2);const s=Q.toDataURL(),d=yield p.loadImageFromBase64(s);return{original:{base64:r.original.base64,image:r.original.image,size:{...T}},transformed:{base64:s,image:d,size:{width:d.width,height:d.height}},exifTransform:r.exifTransform}})()}loadImageFromBase64(r){return new Promise((_,p)=>{const A=new Image;A.onload=()=>_(A),A.onerror=p,A.src=r})}getTransformedSize(r,_,p){const A=p.canvasRotation+_.rotate;if(p.containWithinAspectRatio){if(A%2){const R=r.height/p.aspectRatio;return{width:Math.max(r.height,r.width*p.aspectRatio),height:Math.max(r.width,R)}}{const R=r.width/p.aspectRatio;return{width:Math.max(r.width,r.height*p.aspectRatio),height:Math.max(r.height,R)}}}return A%2?{height:r.width,width:r.height}:{width:r.width,height:r.height}}}return c.\u0275fac=function(r){return new(r||c)},c.\u0275prov=v.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},8896:(V,B,t)=>{"use strict";function h(U){const e=U.split(","),x=e[0].replace("data:","").replace(";base64",""),C=atob(e[1]),m=new ArrayBuffer(C.length),v=new Uint8Array(m);for(let n=0;n<C.length;n+=1)v[n]=C.charCodeAt(n);return new Blob([m],{type:x})}t.d(B,{L:()=>h})},1891:(V,B,t)=>{"use strict";t.d(B,{B:()=>j});var h=t(5861),U=t(1309),e=t(4650),x=t(3905),C=t(4968),m=t(3848),v=t(1460),n=t(4323),c=t(6986),u=t(575),r=t(7693),_=t(3207),p=t(146),A=t(3612),T=t(6378),R=t(9383),Q=t(6895),O=t(4006),s=t(4029),d=t(8279),I=t(3450),M=t(8212);const P=["fileInput"];function S(g,w){1&g&&(e.O4$(),e.TgZ(0,"svg",22),e._UZ(1,"path",23)(2,"path",24),e.qZA())}const W=function(){return["text-primary"]};function F(g,w){1&g&&e._UZ(0,"app-logo",25),2&g&&e.Q6J("svgClass",e.DdM(2,W))("responsive",!1)}function J(g,w){1&g&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&g&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"COMPONENTS.UPLOADER.DESCRIPTION.DESKTOP")))}function re(g,w){1&g&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&g&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"COMPONENTS.UPLOADER.DESCRIPTION.TOUCH")))}function Y(g,w){if(1&g&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"em",26),e.ALo(5,"arrayJoin"),e.BQk()),2&g){const i=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"COMPONENTS.UPLOADER.PATH.LONG")," "),e.xp6(2),e.Q6J("innerText",i.currentFolderPath.length?e.xi3(5,4,i.currentFolderPath,"/"):"root")}}function X(g,w){if(1&g&&(e._UZ(0,"div",31),e.ALo(1,"arrayJoin"),e.ALo(2,"slice")),2&g){const i=e.oxw(3);e.Q6J("innerText",e.xi3(1,1,e.Dn7(2,4,i.currentFolderPath,0,-1),"/"))}}function ie(g,w){if(1&g&&(e.TgZ(0,"div",27)(1,"div",28),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,X,3,8,"div",29),e._UZ(5,"div",30),e.ALo(6,"arrayJoin"),e.ALo(7,"slice"),e.qZA()),2&g){const i=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,3,"COMPONENTS.UPLOADER.PATH.SHORT")),e.xp6(2),e.Q6J("ngIf",i.currentFolderPath.length>1),e.xp6(1),e.Q6J("innerText",(i.currentFolderPath.length>1?"/":"")+(i.currentFolderPath.length?e.xi3(6,5,e.xi3(7,8,i.currentFolderPath,i.currentFolderPath.length-1),"/"):"root"))}}const se=function(){return{bottom:0,left:0}};function y(g,w){if(1&g){const i=e.EpF();e.ynx(0),e.TgZ(1,"a",32),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2);return e.KtG(o.openInfoModal.emit())}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",33),e.NdJ("click",function(){e.CHM(i),e.oxw(2);const o=e.MAs(7);return e.KtG(o.open())}),e._uU(5,"settings"),e.qZA(),e.BQk()}2&g&&(e.xp6(1),e.Q6J("ngStyle",e.DdM(4,se)),e.xp6(1),e.Oqu(e.lcZ(3,2,"COMPONENTS.UPLOADER.INFO")))}const a=function(g,w,i){return{"cursor-pointer":g,"p-4":w,"p-2 pb-3":i}},l=function(g,w){return{"fw-bold fs-lg":g,small:w}},f=function(g,w,i){return{"my-2":g,"mb-2":w,"mw-100":i}};function L(g,w){if(1&g){const i=e.EpF();e.ynx(0),e.TgZ(1,"div",14,15),e.NdJ("dragenter",function(){e.CHM(i);const o=e.MAs(2),b=e.oxw();return e.KtG(b.setDragOverEvent(o))})("drop",function(o){e.CHM(i);const b=e.oxw();return e.KtG(b.handleDropEvent(o))})("click",function(){e.CHM(i),e.oxw();const o=e.MAs(2);return e.KtG(o.click())}),e.YNc(3,S,3,0,"svg",16),e.YNc(4,F,1,3,"ng-template",null,17,e.W1O),e.TgZ(6,"div",18),e.YNc(7,J,3,3,"span",19),e.YNc(8,re,3,3,"span",19),e.qZA(),e.TgZ(9,"div",20),e.YNc(10,Y,6,7,"ng-container",3),e.YNc(11,ie,8,11,"ng-template",null,21,e.W1O),e.qZA()(),e.YNc(13,y,6,5,"ng-container",19),e.BQk()}if(2&g){const i=e.MAs(5),E=e.MAs(12),o=e.oxw();e.xp6(1),e.Q6J("ngClass",e.kEZ(10,a,!o.loading,!o.isWidget,o.isWidget)),e.xp6(2),e.Q6J("ngIf",!o.isWidget)("ngIfElse",i),e.xp6(3),e.Q6J("ngClass",e.WLB(14,l,!o.isWidget,o.isWidget)),e.xp6(1),e.Q6J("ngIf",!o.touchDevice),e.xp6(1),e.Q6J("ngIf",o.touchDevice),e.xp6(1),e.Q6J("ngClass",e.kEZ(17,f,!o.isWidget&&!o.touchDevice,!o.isWidget&&o.touchDevice,o.isWidget)),e.xp6(1),e.Q6J("ngIf",!o.isWidget)("ngIfElse",E),e.xp6(3),e.Q6J("ngIf",!o.isWidget)}}const D=function(g,w){return{"p-4":g,"p-2":w}};function H(g,w){if(1&g&&(e.TgZ(0,"div",34),e.O4$(),e.TgZ(1,"svg",35),e._UZ(2,"path",36),e.qZA(),e.kcU(),e._UZ(3,"app-loader",37),e.TgZ(4,"div",38),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&g){const i=e.oxw();e.Q6J("ngClass",e.WLB(6,D,!i.isWidget,i.isWidget)),e.xp6(3),e.Q6J("onlyMessage",!0)("message",i.loadingMessage),e.xp6(2),e.Oqu(e.lcZ(6,4,"COMPONENTS.UPLOADER.LOADING.SUBTEXT"))}}const N=function(g,w){return{uploading:g,"widget flex-grow-1":w}};let j=(()=>{class g{constructor(i,E,o,b,k,Z,q,ee){this.postMessageService=i,this.uploadService=E,this.uploadObservablesService=o,this.uploaderService=b,this.toastService=k,this.renderer=Z,this.ngZone=q,this.translateService=ee,this.loading=!0,this.currentFolderPath=[],this.isWidget=!1,this.fileUploadedEvent=new e.vpe,this.openInfoModal=new e.vpe,this.isUploading=!1,this.loadingMessage="",this.touchDevice=v.eX,this.dragOverEvent=!1,this.checkingFileMessage="",this.options=this.uploaderService.uploaderOptions;const te=this.uploadService.preferences.uploader;te.checkImage.active||(this.options.compress=!1),te.showLinkModal&&(this.options.openLinkModalAfterUpload=!0),this.uploaderService.uploaderOptions=this.options}ngOnInit(){var i=this;return(0,h.Z)(function*(){i.handleClipboardPasteEvent(),i.handleExternalUpload(),i.checkingFileMessage=yield(0,x.z)(i.translateService.get("COMPONENTS.UPLOADER.LOADING.MESSAGE.CHECK")),i.loadingMessage=i.checkingFileMessage})()}handleClipboardPasteEvent(){var i=this;this.clipboardPasteEventSubscription=(0,C.R)(document.body,"paste").subscribe(function(){var E=(0,h.Z)(function*(o){if(!i.canUpload)return;const b=Array.from((o.clipboardData||o.originalEvent.clipboardData).items);let k=[];for(const Z of b)if(0===Z.type.indexOf("image")){const q=Z.getAsFile();q&&k.push(q)}k.length>0?yield i.preUpload(k):i.reset()});return function(o){return E.apply(this,arguments)}}())}handleExternalUpload(){var i=this;this.startExternalUploadSubscription=this.uploadObservablesService.startUploadObservable.subscribe(function(){var E=(0,h.Z)(function*(o){if(o){if(!i.canUpload)return;yield i.preUpload([o.file],o.options)}else i.fileInputRef.nativeElement.click()});return function(o){return E.apply(this,arguments)}}())}handleSelectionEvent(i){var E=this;return(0,h.Z)(function*(){if(!E.canUpload)return;const o=i.target;if(o.files&&o.files.length){const b=Array.from(o.files);return o.value="",E.preUpload(b)}E.reset()})()}handleDropEvent(i){var E=this;return(0,h.Z)(function*(){if(i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation(),!E.canUpload)return;const o=i.dataTransfer?.files?Array.from(i.dataTransfer.files):[];if(o.length)return E.preUpload(o);E.reset()})()}saveOptions(i=!0){this.uploaderService.uploaderOptions=this.options,i&&this.savePreferences()}savePreferences(){this.uploadService.preferences.uploader={checkImage:{active:this.options.compress,time:Date.now()},showLinkModal:this.options.openLinkModalAfterUpload}}setDragOverEvent(i){this.dragOverEvent||(this.dragOverEvent=!0,this.ngZone.runOutsideAngular(()=>{this.renderer.listen(i,"dragover",E=>{E.preventDefault()})}))}get canUpload(){return!this.loading&&!this.isUploading&&(this.isUploading=!0,this.dragOverEvent=!1,!0)}reset(){this.isUploading=!1,this.loadingMessage=this.checkingFileMessage,this.postMessageService.send(n.l.UPLOAD_END,{}),this.options.allowOverwrite=!1,this.saveOptions(!1)}preUpload(i,E){var o=this;return(0,h.Z)(function*(){const b=[...o.currentFolderPath];let k=[],Z=[],q=[],ee=[];E?E.allowOverwrite=E.allowOverwrite||!1:(E=o.uploaderService.uploaderOptions).allowOverwrite=!1;for(let K=0;K<i.length;K++){let z=E.compress?yield o.uploaderService.compressFileIfNeeded(i[K],E.imageDimensions):i[K];if(z=yield o.uploaderService.orientFileIfNeeded(z),z){const G=(0,m.Tb)(z.name),$=c.O8.find(oe=>-1!==oe.ext.indexOf(G.ext));if(!$){q.push(z);continue}if(z.size>$.maxSize){ee.push(z);continue}k.push({file:{name:z.name,size:z.size,time:0,url:"",ext:G.ext,filename:G.filename,isImage:(0,m.Or)(G.ext),embedUrl:"",type:u.VC.FILE},progress:0,completed:!1}),Z.push(z)}}if((q.length||ee.length)&&(o.isWidget||o.toastService.show({content:o.createToastMessage(q,ee),level:U.m.ERROR}),[["UNSUPPORTED",q],["OVERSIZED",ee]].forEach(K=>{K[1].forEach(z=>{o.postMessageService.send(n.l.UPLOAD_ERROR,{filename:z.name,error:K[0]})})})),0===Z.length)return void o.reset();const te=yield(0,x.z)(o.translateService.get("COMPONENTS.UPLOADER.LOADING.MESSAGE.UPLOADING",{total:Z.length})),ae=yield(0,x.z)(o.translateService.get("COMPONENTS.UPLOADER.LOADING.MESSAGE.CREATING_PACKAGE",{total:Z.length}));o.uploadObservablesService.pushUploadingFileQueue(k);for(let K=0;K<Z.length;++K){o.loadingMessage=ae;const z=yield o.uploadService.getHostToken(b,Z[K].name);k[K].progress+=20,o.loadingMessage=te.replace("{{current}}",`${K+1}`),yield(0,x.z)(o.uploaderService.upload(Z[K],k[K],z,E.allowOverwrite))}o.uploadObservablesService.pushUploadingFileQueue([]);const ne=k.filter(K=>!K.error).map(K=>K.file);ne.length>0&&(o.fileUploadedEvent.emit({list:ne,rewrite:E.allowOverwrite,destPath:b}),o.postMessageService.send(n.l.UPLOAD_SUCCESS,{fileList:ne.map(K=>({filename:K.name,isImage:K.isImage,url:K.url}))}),E.openLinkModalAfterUpload&&o.uploadObservablesService.pushAction({name:u.In.FILE_SHOW_LINKS,payload:{entities:(0,m.jL)(ne)}})),o.reset()})()}createToastMessage(i,E){let o=[];return i.length&&o.push(i.length>1?`I file <strong>${i.map(b=>b.name).join(", ")}</strong> hanno un formato non supportato!`:`Il file <strong>${i[0].name}</strong> ha un formato non supportato!`),E.length&&o.push(E.length>1?`I file <strong>${E.map(b=>b.name).join(", ")}</strong> sono troppo pesanti!`:`Il file <strong>${E[0].name}</strong> \xe8 troppo pesante!`),o.join("<br><br>")}ngOnDestroy(){this.startExternalUploadSubscription?.unsubscribe(),this.clipboardPasteEventSubscription.unsubscribe(),this.uploaderService.clearPendingRequests()}}return g.\u0275fac=function(i){return new(i||g)(e.Y36(r.F),e.Y36(_.C),e.Y36(p.r),e.Y36(A.q),e.Y36(T.k),e.Y36(e.Qsj),e.Y36(e.R0b),e.Y36(R.sK))},g.\u0275cmp=e.Xpm({type:g,selectors:[["app-uploader"]],viewQuery:function(i,E){if(1&i&&e.Gf(P,5),2&i){let o;e.iGM(o=e.CRH())&&(E.fileInputRef=o.first)}},inputs:{loading:"loading",currentFolderPath:"currentFolderPath",isWidget:"isWidget"},outputs:{fileUploadedEvent:"fileUploadedEvent",openInfoModal:"openInfoModal"},decls:22,vars:22,consts:[[1,"uploader","rounded","position-relative",3,"ngClass"],["type","file",1,"d-none",3,"multiple","disabled","change"],["fileInput",""],[4,"ngIf","ngIfElse"],["uploading",""],[3,"title"],["optionsModal",""],[3,"innerHtml"],[1,"mb-1","list-unstyled"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","speed-upload",1,"form-check-input",3,"ngModel","ngModelChange"],["for","speed-upload",1,"form-check-label","me-auto",3,"innerHTML"],["type","checkbox","role","switch","id","show-link-modal",1,"form-check-input",3,"ngModel","ngModelChange"],["for","show-link-modal",1,"form-check-label","me-auto",3,"innerHTML"],[1,"rounded","upload-area",3,"ngClass","dragenter","drop","click"],["uploadArea",""],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16",4,"ngIf","ngIfElse"],["appLogo",""],[1,"description","text-center",3,"ngClass"],[4,"ngIf"],[1,"small","text-center",3,"ngClass"],["widgetFolder",""],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16"],["fill-rule","evenodd","d","M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"],["d","M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"],["svgSize","xl","subtext","Upload",1,"d-block","my-auto","py-1",3,"svgClass","responsive"],[1,"text-break",3,"innerText"],[1,"d-flex","min-w-0"],[1,"me-1"],["class","fst-italic text-truncate mw-100",3,"innerText",4,"ngIf"],[1,"fst-italic","text-nowrap",3,"innerText"],[1,"fst-italic","text-truncate","mw-100",3,"innerText"],[1,"fs-xs","fst-italic","d-block","px-2","py-1","text-reset","cursor-pointer","position-absolute",3,"ngStyle","click"],[1,"material-icons-outlined","d-block","cursor-pointer","fs-xl","position-absolute","options-icon",3,"click"],[1,"p-4","rounded",3,"ngClass"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","viewBox","0 0 16 16",1,"overflow-visible"],["d","M 4.406 3.342 A 5.53 5.53 0 0 1 8 2 c 2.69 0 4.923 2 5.166 4.579 C 14.758 6.804 16 8.137 16 9.773 C 16 11.569 14.502 13 12.687 13 H 3.781 C 1.708 13 0 11.366 0 9.318 c 0 -1.763 1.266 -3.223 2.942 -3.593 c 0.143 -0.863 0.698 -1.723 1.464 -2.383 z",1,"cloud"],[3,"onlyMessage","message"],[1,"small","text-center"]],template:function(i,E){if(1&i&&(e.TgZ(0,"div",0)(1,"input",1,2),e.NdJ("change",function(b){return E.handleSelectionEvent(b)}),e.qZA(),e.YNc(3,L,14,21,"ng-container",3),e.YNc(4,H,7,9,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(6,"app-modal",5,6),e.ALo(8,"translate"),e._UZ(9,"div",7),e.ALo(10,"translate"),e.TgZ(11,"ul",8)(12,"li")(13,"div",9)(14,"input",10),e.NdJ("ngModelChange",function(b){return E.options.compress=b})("ngModelChange",function(){return E.saveOptions()}),e.qZA(),e._UZ(15,"label",11),e.ALo(16,"translate"),e.qZA()(),e.TgZ(17,"li")(18,"div",9)(19,"input",12),e.NdJ("ngModelChange",function(b){return E.options.openLinkModalAfterUpload=b})("ngModelChange",function(){return E.saveOptions()}),e.qZA(),e._UZ(20,"label",13),e.ALo(21,"translate"),e.qZA()()()()),2&i){const o=e.MAs(5);e.Q6J("ngClass",e.WLB(19,N,E.isUploading,E.isWidget)),e.xp6(1),e.Q6J("multiple",!0)("disabled",E.loading||E.isUploading),e.xp6(2),e.Q6J("ngIf",!E.isUploading)("ngIfElse",o),e.xp6(3),e.Q6J("title",e.lcZ(8,11,"COMPONENTS.UPLOADER.SETTINGS_MODAL.TITLE")),e.xp6(3),e.Q6J("innerHtml",e.lcZ(10,13,"COMPONENTS.UPLOADER.SETTINGS_MODAL.CONTENT.DESCRIPTION"),e.oJD),e.xp6(5),e.Q6J("ngModel",E.options.compress),e.xp6(1),e.Q6J("innerHTML",e.lcZ(16,15,"COMPONENTS.UPLOADER.SETTINGS_MODAL.CONTENT.COMPRESS_SWITCH"),e.oJD),e.xp6(4),e.Q6J("ngModel",E.options.openLinkModalAfterUpload),e.xp6(1),e.Q6J("innerHTML",e.lcZ(21,17,"COMPONENTS.UPLOADER.SETTINGS_MODAL.CONTENT.SHOW_LINK_SWITCH"),e.oJD)}},dependencies:[Q.mk,Q.O5,Q.PC,O.Wl,O.JJ,O.On,s.R,d.R,I.z,M.J,Q.OU,R.X$],styles:[".uploader[_ngcontent-%COMP%]:not(.widget){margin:0 1rem;border:2px dashed #4864FE;box-shadow:0 .125rem .25rem #00000013;color:#2036ad;height:100%}.uploader[_ngcontent-%COMP%]:not(.widget):not(.uploading)   svg[_ngcontent-%COMP%]{animation:bubble 4s linear infinite}.uploader[_ngcontent-%COMP%]:not(.widget).uploading   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{stroke:#2036ad}.uploader[_ngcontent-%COMP%]:not(.widget)   .description[_ngcontent-%COMP%]{max-width:400px}.uploader.widget.uploading[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{stroke:#4864fe}.uploader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.options-icon){height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.uploader.uploading[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{fill:none;stroke-linecap:round;stroke-dasharray:50;stroke-dashoffset:100;animation:draw 3.5s linear infinite}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]{top:5px;right:5px;opacity:.7;transition:opacity .2s}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]:hover{opacity:1}.upload-area[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(app-logo){pointer-events:none}@media (min-width: 768px){.uploader[_ngcontent-%COMP%]:not(.widget){margin:initial}}@keyframes bubble{6%{transform:scale(1.3,.8)}9%{transform:scale(.8,1.3) translateY(-.5rem)}12%{transform:scale(1)}}@keyframes draw{0%{stroke-dashoffset:100}to{stroke-dashoffset:0}}"]}),g})()},1197:(V,B,t)=>{"use strict";t.d(B,{M:()=>c});var h=t(8694),U=t(6895),e=t(4006),x=t(6818),C=t(1043),m=t(582),v=t(9383),n=t(4650);let c=(()=>{class u{}return u.\u0275fac=function(_){return new(_||u)},u.\u0275mod=n.oAB({type:u}),u.\u0275inj=n.cJS({imports:[h.r,U.ez,e.u5,x.q,C.h,m.z,v.aw.forChild()]}),u})()},8694:(V,B,t)=>{"use strict";t.d(B,{r:()=>e});var h=t(6895),U=t(4650);let e=(()=>{class x{}return x.\u0275fac=function(m){return new(m||x)},x.\u0275mod=U.oAB({type:x}),x.\u0275inj=U.cJS({imports:[h.ez]}),x})()},8212:(V,B,t)=>{"use strict";t.d(B,{J:()=>U});var h=t(4650);let U=(()=>{class e{transform(C,m){return C.join(m)}}return e.\u0275fac=function(C){return new(C||e)},e.\u0275pipe=h.Yjl({name:"arrayJoin",type:e,pure:!0}),e})()},575:(V,B,t)=>{"use strict";t.d(B,{In:()=>h,Ky:()=>C,VC:()=>U,c5:()=>x,gG:()=>e});var h=(()=>{return(m=h||(h={})).FILE_SHOW_LINKS="fileLinks",m.FILE_EDIT="fileEdit",m.DELETE="delete",m.RENAME="rename",m.MOVE="move",h;var m})(),U=(()=>{return(m=U||(U={})).FILE="file",m.FOLDER="folder",U;var m})(),e=(()=>{return(m=e||(e={})).FILENAME="filename",m.SIZE="size",m.TIME="time",m.EXTENSION="ext",e;var m})(),x=(()=>{return(m=x||(x={})).GRID="grid",m.LIST="list",x;var m})(),C=(()=>{return(m=C||(C={})).W_768_I_1="(max-width: 767.98px)",m.W_933_I_2="(min-width: 768px) and (max-width: 933.98px)",m.W_960_I_3="(min-width: 934px) and (max-width: 959.98px)",m.W_1226_I_2="(min-width: 960px) and (max-width: 1225.98px)",m.W_1540_I_3="(min-width: 1226px) and (max-width: 1539.98px)",m.W_1854_I_4="(min-width: 1540px) and (max-width: 1853.98px)",m.W_2168_I_5="(min-width: 1854px) and (max-width: 2167.98px)",m.W_2482_I_6="(min-width: 2168px) and (max-width: 2481.98px)",m.W_2796_I_7="(min-width: 2482px) and (max-width: 2795.98px)",m.W_3110_I_8="(min-width: 2796px) and (max-width: 3109.98px)",m.W_3424_I_9="(min-width: 3110px) and (max-width: 3423.98px)",m.W_3738_I_10="(min-width: 3424px)",C;var m})()},6986:(V,B,t)=>{"use strict";t.d(B,{C7:()=>x,Mi:()=>C,O8:()=>U,er:()=>m,p0:()=>e,xt:()=>v});var h=t(575);const U=[{ext:["png","apng"],maxSize:15},{ext:["jpeg","jpg","jpe"],maxSize:10},{ext:["gif"],maxSize:15},{ext:["bmp"],maxSize:10},{ext:["webp","webm"],maxSize:10},{ext:["psd","xcf"],maxSize:150},{ext:["svg"],maxSize:30}].map(n=>(n.maxSize*=1048576,n)),e={lastPath:[],layout:{asc:!0,orderBy:h.gG.FILENAME,type:h.c5.GRID},uploader:{checkImage:{time:0,active:!0},showLinkModal:!1}},x="https://upload.forumfree.net/api/",C=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-.\s])*$/,m=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-\s])*$/,v={invalidLength:!1,alreadyUsed:!1,invalidStartOrEnd:!1,invalidCharacter:!1}},3124:(V,B,t)=>{"use strict";t.d(B,{B:()=>x});var h=t(575),U=t(4650),e=t(3138);let x=(()=>{class C{constructor(v){this.globalsService=v,this.ffuid="",this.cache={},this.profileSubscription=this.globalsService.profileObservable.subscribe(n=>{this.ffuid=n?n.user.ffuid:""})}getItem(v){const n=this.createKey(v);if(this.cache.hasOwnProperty(n))return this.cache[n]}setItem(v,n){this.cache[this.createKey(v)]=n}removeItem(v){const n=this.createKey(v);if(this.cache.hasOwnProperty(n)){if(this.cache[n].folders.length)for(const c of this.cache[n].folders)this.removeItem([...v,c.name]);return delete this.cache[n],!0}return!1}getEntities(v,n){let c={};const u=this.createKey(v);if(!this.cache.hasOwnProperty(u))return c;for(const r of n){const _=(r.type===h.VC.FILE?this.cache[u].files:this.cache[u].folders).find(p=>p.name===r.name);_&&(c[_.name]=_)}return c}addEntities(v,n,c=h.VC.FILE){const u=this.createKey(v);return!!this.cache.hasOwnProperty(u)&&(Array.isArray(n)||(n=[n]),c===h.VC.FILE?this.cache[u].files.unshift(...n):this.cache[u].folders.unshift(...n),!0)}removeEntities(v,n,c=h.VC.FILE){if(Array.isArray(n)||(n=[n]),c===h.VC.FOLDER)for(const p of n)this.removeItem([...v,p]);const u=this.createKey(v);if(!this.cache.hasOwnProperty(u))return[];const r=c===h.VC.FILE?"files":"folders";let _=[];for(const p of n){const A=this.cache[u][r].findIndex(T=>T.name===p);A>-1&&(this.cache[u][r].splice(A,1),_.push(p))}return _}refactorFolderContent(v,n){const c=this.createKey(v);if(!this.cache.hasOwnProperty(c))return!1;n.endsWith("/")||(n+="/");for(const u of this.cache[c].folders)u.url=n+u.name;for(const u of this.cache[c].files)u.url=u.embedUrl=n+u.name,u.time=Date.now();return!0}createKey(v){return`${this.ffuid}/${v.join("/")}`}ngOnDestroy(){this.profileSubscription.unsubscribe()}}return C.\u0275fac=function(v){return new(v||C)(U.LFG(e.d))},C.\u0275prov=U.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},146:(V,B,t)=>{"use strict";t.d(B,{r:()=>C});var h=t(7579),U=t(1135),e=t(4650),x=t(8745);let C=(()=>{class m{constructor(n){this.uploadPreferencesService=n,this.selectedFileListArray=[],this.actionSubject=new h.x,this.uploadingFileQueueSubject=new h.x,this.uploadingFileErrorSubject=new h.x,this.currentFolderPathSubject=new h.x,this.layoutOptionsSubject=new h.x,this.renameEntitySubject=new h.x,this.entityPendingSubject=new h.x,this.deleteFileSubject=new h.x,this.uploadedFileSubject=new h.x,this.draggedFileListSubject=new h.x,this.startUploadSubject=new h.x,this.startMoveSubject=new h.x,this.selectedFileListSubject=new U.X(this.selectedFileListArray)}get actionObservable(){return this.actionSubject.asObservable()}pushAction(n){this.actionSubject.next(n)}get layoutOptionsObservable(){return this.layoutOptionsSubject.asObservable()}pushLayoutOptions(n){this.uploadPreferencesService.layoutOptions=n,this.layoutOptionsSubject.next(n)}get currentFolderPathObservable(){return this.currentFolderPathSubject.asObservable()}pushCurrentFolderPath(n){this.uploadPreferencesService.lastFolderPath=n,this.currentFolderPathSubject.next(n)}get uploadingFileQueueObservable(){return this.uploadingFileQueueSubject.asObservable()}pushUploadingFileQueue(n){this.uploadingFileQueueSubject.next(n)}get uploadingFileErrorObservable(){return this.uploadingFileErrorSubject.asObservable()}pushUploadingFileError(n){this.uploadingFileErrorSubject.next(n)}get renameEntityObservable(){return this.renameEntitySubject.asObservable()}pushRenameEntity(n){this.renameEntitySubject.next(n)}get entityPendingObservable(){return this.entityPendingSubject.asObservable()}pushEntityPending(n){this.entityPendingSubject.next(n)}get deleteFileObservable(){return this.deleteFileSubject.asObservable()}pushDeleteFile(n){this.deleteFileSubject.next(n)}get uploadedFileObservable(){return this.uploadedFileSubject.asObservable()}pushUploadedFile(n){this.uploadedFileSubject.next(n)}get draggedFileListObservable(){return this.draggedFileListSubject.asObservable()}pushDraggedFileList(n){this.draggedFileListSubject.next(n)}get startUploadObservable(){return this.startUploadSubject.asObservable()}pushStartUpload(n){this.startUploadSubject.next(n)}get startMoveObservable(){return this.startMoveSubject.asObservable()}pushStartMove(n){this.startMoveSubject.next(n)}get selectedFileListObservable(){return this.selectedFileListSubject.asObservable()}pushSelectedFile(n){if(Array.isArray(n)||(n=[n]),0===n.length)return void(this.selectedFileListArray.length>0&&(this.selectedFileListArray=[],this.selectedFileListSubject.next(this.selectedFileListArray)));let c=!1;for(const u of n){const r=this.selectedFileListArray.findIndex(_=>_.name===u.name);u.selected?-1===r&&(this.selectedFileListArray.push({name:u.name}),c=!0):r>-1&&(this.selectedFileListArray.splice(r,1),c=!0)}c&&this.selectedFileListSubject.next(this.selectedFileListArray)}}return m.\u0275fac=function(n){return new(n||m)(e.LFG(x.p))},m.\u0275prov=e.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},8745:(V,B,t)=>{"use strict";t.d(B,{p:()=>m});var h=t(5044),U=t(6986),e=t(4650),x=t(2381),C=t(6161);let m=(()=>{class v{constructor(c,u){this.preferencesService=c,this.urlQueryParamsService=u;const r=this.urlQueryParamsService.getAndDeleteParam(h.RT.UPLOAD_PATH);r&&(this.lastFolderPath=r.split("/").filter(_=>_.length>0))}get preferences(){return this.preferencesService.getItem(h.Ye.UPLOAD)||U.p0}set preferences(c){this.preferencesService.setItem(h.Ye.UPLOAD,c)}get lastFolderPath(){return(this.preferences.lastPath||U.p0.lastPath).filter(c=>c.length>0)}set lastFolderPath(c){const u=this.preferences;u.lastPath=c,this.preferences=u}get layoutOptions(){const c=U.p0.layout,u=this.preferences.layout;return u&&0===Object.keys(c).filter(r=>!u.hasOwnProperty(r)).length?u:c}set layoutOptions(c){const u=this.preferences;u.layout=c,this.preferences=u}get uploader(){const c=this.preferences.uploader||U.p0.uploader;return!c.checkImage.active&&Date.now()-c.checkImage.time>6048e5&&(c.checkImage.active=!0,this.uploader=c),c.hasOwnProperty("showLinkModal")||(c.showLinkModal=!1),c}set uploader(c){const u=this.preferences;u.uploader=c,this.preferences=u}}return v.\u0275fac=function(c){return new(c||v)(e.LFG(x.y),e.LFG(C.J))},v.\u0275prov=e.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},3207:(V,B,t)=>{"use strict";t.d(B,{C:()=>s});var h=t(5861),U=t(7824),e=t(3905),x=t(575),C=t(3848),_=t(6986),p=t(1042),A=t(4650),T=t(5395),R=t(3124),Q=t(8745),O=t(529);let s=(()=>{class d{constructor(M,P,S,W){this.graphqlService=M,this.uploadCacheService=P,this.uploadPreferencesService=S,this.http=W}get cache(){return this.uploadCacheService}get preferences(){return this.uploadPreferencesService}setGqlIdHeader(){this.graphqlService.safeSetGlobalHeader(U._.HeaderKeys.UUID,(0,p.Z)())}removeGqlIdHeader(){this.graphqlService.removeGlobalHeader(U._.HeaderKeys.UUID)}getGqlIdHeader(){return this.graphqlService.getGlobalHeader(U._.HeaderKeys.UUID)||""}getFileList(M,P){var S=this;return(0,h.Z)(function*(){const W=S.uploadCacheService.getItem(M);if(W)return W;const F=(yield S.graphqlService.query({query:"\nquery UploadEntitiesListToken($scope: String, $target: String!) {\n    uploadEntitiesListToken(scope: $scope, target: $target)\n}",variables:{scope:P,target:M.join("/")}})).data.uploadEntitiesListToken,J=yield S.sendRequest(F),Y={files:J.files.map(X=>{const ie=(0,C.Tb)(X.url);return{...X,time:1e3*X.time,filename:ie.filename,ext:ie.ext,isImage:(0,C.Or)(ie.ext),embedUrl:`${X.url}?t=${X.time}`,type:x.VC.FILE}}),folders:J.folders.map(X=>({...X,type:x.VC.FOLDER}))};return S.uploadCacheService.setItem(M,Y),Y})()}createDirectory(M,P){var S=this;return(0,h.Z)(function*(){const W=(yield S.graphqlService.mutate({mutation:"\nquery UploadEntitiesCreateDirectoryToken($scope: String, $target: String!) {\n    uploadEntitiesCreateDirectoryToken(scope: $scope, target: $target)\n}",variables:{scope:P,target:M.join("/")}})).data.uploadEntitiesCreateDirectoryToken;return yield S.sendRequest(W)})()}moveRenameEntity(M,P,S,W,F){var J=this;return(0,h.Z)(function*(){W||(W=S);const re=(yield J.graphqlService.mutate({mutation:"\nquery UploadEntitiesMoveToken($scope: String, $source: String!, $target: String!) {\n    uploadEntitiesMoveToken(scope: $scope, source: $source, target: $target)\n}",variables:{scope:F,source:(M.length?`${M.join("/")}/`:"")+S,target:(P.length?`${P.join("/")}/`:"")+W}})).data.uploadEntitiesMoveToken,Y=yield J.sendRequest(re);return{...Y,time:1e3*Y.time}})()}deleteEntity(M,P,S){var W=this;return(0,h.Z)(function*(){const F=(yield W.graphqlService.mutate({mutation:"\nquery UploadEntitiesDeleteToken($scope: String, $target: String!) {\n    uploadEntitiesDeleteToken(scope: $scope, target: $target)\n}",variables:{scope:S,target:(M.length?`${M.join("/")}/`:"")+P}})).data.uploadEntitiesDeleteToken;return yield W.sendRequest(F),!0})()}getHostToken(M,P,S){var W=this;return(0,h.Z)(function*(){return(yield W.graphqlService.query({query:"\nquery UploadEntitiesHostToken($scope: String, $target: String!) {\n    uploadEntitiesHostToken(scope: $scope, target: $target)\n}",variables:{scope:S,target:(M.length?`${M.join("/")}/`:"")+P}})).data.uploadEntitiesHostToken})()}sendRequest(M){var P=this;return(0,h.Z)(function*(){return(yield(0,e.z)(P.http.post(_.C7,JSON.stringify({payload:M}),{headers:{"Content-Type":"application/json"}}))).success})()}subscribeForChanges(M,P){var S=this;return(0,h.Z)(function*(){return yield S.graphqlService.subscribe({query:"\nsubscription UploadEntities($scope: String) {\n    uploadEntities(scope: $scope) {\n        eventMessage\n        eventType\n        user {\n            avatar\n            host\n            id\n            nickname\n        }\n    }\n}",variables:{scope:P}},W=>{if(!W.data?.uploadEntities)return;const F=JSON.parse(W.data.uploadEntities.eventMessage);!F.payload.customHeaders||!F.payload.customHeaders.hasOwnProperty(U._.HeaderKeys.UUID)||F.payload.customHeaders[U._.HeaderKeys.UUID]===S.getGqlIdHeader()||M({type:W.data.uploadEntities.eventType,message:F})})})()}getBlobFromUrl(M){var P=this;return(0,h.Z)(function*(){return yield(0,e.z)(P.http.get(M,{responseType:"blob"})).catch(()=>{})})()}}return d.\u0275fac=function(M){return new(M||d)(A.LFG(T.J),A.LFG(R.B),A.LFG(Q.p),A.LFG(O.eN))},d.\u0275prov=A.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},3848:(V,B,t)=>{"use strict";t.d(B,{$H:()=>A,JN:()=>u,Lv:()=>m,Or:()=>p,Tb:()=>x,jL:()=>_,lY:()=>v,ok:()=>R,rQ:()=>Q,rc:()=>T,sT:()=>n,zO:()=>C});var h=t(5861),U=t(575),e=t(6986);function x(O){let s=O;if(O.indexOf("/")>-1){const P=O.split("/");s=P[P.length-1]}const d=s.split("."),I=d[d.length-1].toLowerCase(),M=decodeURIComponent(d.slice(0,-1).join("."));return{ext:I,filename:M,name:`${M}.${I}`}}function C(O,s={}){const d=x(O),I=Date.now();return{name:d.name,size:0,time:I,url:O,ext:d.ext,filename:d.filename,isImage:p(d.ext),embedUrl:`${O}?t=${I}`,type:U.VC.FILE,...s}}function m(O){let s=O;s.endsWith("/")&&(s=s.slice(0,-1));const d=s.split("/");return{name:decodeURIComponent(d[d.length-1])}}function v(O){return{name:m(O).name,url:O,type:U.VC.FOLDER}}function n(O){return c.apply(this,arguments)}function c(){return(c=(0,h.Z)(function*(O){const s=new FileReader,d=new Promise(I=>s.addEventListener("load",()=>I(s.result)));return s.readAsDataURL(O),d})).apply(this,arguments)}function u(O){return r.apply(this,arguments)}function r(){return(r=(0,h.Z)(function*(O){const s=new DataView(yield O.arrayBuffer());if(2303741511===s.getUint32(0)&&218765834===s.getUint32(4)){if(-1===[4,6].indexOf(s.getUint8(25)))return!1;const I=Object.assign(new Image,{src:yield n(O)});yield new Promise(S=>I.addEventListener("load",()=>S(!0)));const M=Object.assign(document.createElement("canvas"),{width:I.width,height:I.height}).getContext("2d");if(!M)return!1;M.imageSmoothingEnabled=!1,M.drawImage(I,0,0);const P=M?.getImageData(0,0,I.width,I.height);if(P)for(let S=0;S<P.data.length;S+=4)if(P.data[S+3]<255)return!0}return!1})).apply(this,arguments)}function _(O){return O.map(s=>({name:s.name,ext:s.ext,type:U.VC.FILE,url:s.url,embedUrl:s.embedUrl,isImage:s.isImage}))}function p(O,s=[]){return["png","apng","jpeg","jpg","jpe","gif","svg","webp"].includes(O)&&!s.includes(O)}function A(O){return p(O,["gif","svg"])}function T(O,s,d,I=[],M=""){let P={...e.xt};const S=O.trim();P.invalidLength=0===S.length;const W=(S+M).replace(/\s{2,}/g," ");return P.alreadyUsed=s!==S&&I.includes(W),P.invalidStartOrEnd=/(^(\s|\.))|((\s|\.)$)/.test(O),P.invalidCharacter=!(d===U.VC.FILE?e.Mi.test(O):e.er.test(O)),P}function R(O,s){return O.join("/")===s.join("/")}function Q(O){let s=[],d=[];for(const I of O)I.type===U.VC.FILE?s.push(I):d.push(I);return{[U.VC.FILE]:s,[U.VC.FOLDER]:d}}},3612:(V,B,t)=>{"use strict";t.d(B,{q:()=>R});var h=t(5861),U=t(8896),e=t(6730),x=t.n(e),C=t(9969),m=t(3848),v=t(529),n=t(7579),c=t(7445),u=t(2722),r=t(6986);class _{static findApp1Marker(O){const s=new DataView(O),d=new Set([65498,65497,65476,65474,65472,65499,65501]);for(let I=0;I<O.byteLength-2;I+=2){const M=s.getUint16(I);if(65505===M)return{offset:I,size:s.getUint16(I+2),little:18761==s.getUint16(I+8,!1)};if(d.has(M))break}}static stripAndReturnExif(O){return(0,h.Z)(function*(){const s=yield O.arrayBuffer(),d=_.findApp1Marker(s);return d?{file:new File([s.slice(0,d.offset),s.slice(d.offset+d.size+2)],O.name,{type:O.type,lastModified:O.lastModified}),exif:s.slice(d.offset,d.offset+d.size)}:{file:O}})()}static checkImageOrientation(O){const s=new DataView(O);if(1165519206!=s.getUint32(4,!1))return-1;const d=18761==s.getUint16(10,!1);let I=10;I+=s.getUint32(I+4,d);const M=s.getUint16(I,d);I+=2;for(let P=0;P<M;P++)if(274==s.getUint16(I+12*P,d))return s.getUint16(I+12*P+8,d);return-1}}var p=t(4650),A=t(146),T=t(2020);let R=(()=>{class Q{constructor(s,d,I){this.http=s,this.uploadObservablesService=d,this.loadImageService=I,this.requestSubscriptions=[],this.uploaderOptionsObject={compress:!0,openLinkModalAfterUpload:!1}}get uploaderOptions(){return{...this.uploaderOptionsObject}}set uploaderOptions(s){this.uploaderOptionsObject={...s}}compressFileIfNeeded(s,d){return(0,h.Z)(function*(){let I=["image/png","image/jpeg"],M={strict:!0,checkOrientation:!0,quality:.8,convertSize:1};d&&(I.push("image/webp"),M.width=d.width,M.height=d.height,M.resize="cover",M.strict=!1);const P=s.type.toLowerCase();return s.size<=4e6&&void 0===d||-1===I.indexOf(s.type.toLowerCase())?s:("image/png"===P&&(yield(0,m.JN)(s))&&(M.convertSize=1/0),new Promise((S,W)=>{new(x())(s,{...M,success:F=>{const J=F instanceof Blob?new File([F],s.name,{type:s.type,lastModified:s.lastModified}):s;S(J)},error:W})}))})()}orientFileIfNeeded(s){var d=this;return(0,h.Z)(function*(){if(-1===["image/jpeg"].indexOf(s.type.toLowerCase()))return s;const M=yield _.stripAndReturnExif(s);if(s=M.file,M.exif){const P=_.checkImageOrientation(M.exif);if(1!==P){let S=0;switch(P){case 3:case 4:S=180;break;case 5:case 6:S=90;break;case 7:case 8:S=270}const W=yield(0,m.sT)(s),F=yield new Promise((re,Y)=>{const X=new Image;X.onload=()=>re({originalImage:X,originalBase64:W}),X.onerror=Y,X.src=W}),J=yield d.loadImageService.transformLoadedImage({original:{base64:F.originalBase64,image:F.originalImage,size:{width:F.originalImage.naturalWidth,height:F.originalImage.naturalHeight}},exifTransform:{flip:[2,4,5,7].includes(P),rotate:S/90}},new C.R);s=new File([(0,U.L)(J.transformed.base64)],s.name,{type:s.type,lastModified:Date.now()})}}return s})()}upload(s,d,I,M=!1){const P=new n.x,S=new FormData;S.append("payload",I),S.append("upload",s,s.name),M&&S.append("allowOverwrite","1");const W=this.http.request(new v.aW("POST",r.C7,S,{reportProgress:!0,responseType:"json"}));return this.requestSubscriptions.push(W.subscribe({next:F=>{if(F.type===v.dt.UploadProgress){if(!F.total||(d.progress=Math.round(50*F.loaded/F.total)+20,d.progress<70))return;(0,c.F)(1e3).pipe((0,u.R)(P.asObservable())).subscribe(()=>{if(d.progress<95){const J=Math.round(8*Math.random()+8);d.progress+J>95?d.progress=95:d.progress+=J}})}else if(F instanceof v.Zn){if(d.progress=100,d.completed=!0,F.body?.error||!F.body?.success)d.error=!0,this.uploadObservablesService.pushUploadingFileError(d);else{d.file.url=F.body.success.url,d.file.time=Date.now(),d.file.embedUrl=`${d.file.url}?t=${d.file.time}`;const J=(0,m.Tb)(d.file.url);d.file.name=J.name,d.file.filename=J.filename}P.next(),P.complete()}},error:()=>{d.error=!0,this.uploadObservablesService.pushUploadingFileError(d),P.next(),P.complete()}})),P.asObservable()}clearPendingRequests(){for(const s of this.requestSubscriptions)s.unsubscribe();this.requestSubscriptions=[]}}return Q.\u0275fac=function(s){return new(s||Q)(p.LFG(v.eN),p.LFG(A.r),p.LFG(T.y))},Q.\u0275prov=p.Yz7({token:Q,factory:Q.\u0275fac,providedIn:"root"}),Q})()},6730:function(V){V.exports=function(){"use strict";function B(y,a){var l=Object.keys(y);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(y);a&&(f=f.filter(function(L){return Object.getOwnPropertyDescriptor(y,L).enumerable})),l.push.apply(l,f)}return l}function t(y){for(var a=1;a<arguments.length;a++){var l=null!=arguments[a]?arguments[a]:{};a%2?B(Object(l),!0).forEach(function(f){x(y,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(l)):B(Object(l)).forEach(function(f){Object.defineProperty(y,f,Object.getOwnPropertyDescriptor(l,f))})}return y}function U(y,a){for(var l=0;l<a.length;l++){var f=a[l];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}function x(y,a,l){return a in y?Object.defineProperty(y,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):y[a]=l,y}function C(){return C=Object.assign||function(y){for(var a=1;a<arguments.length;a++){var l=arguments[a];for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(y[f]=l[f])}return y},C.apply(this,arguments)}var y,a,l,f,L,D,H,N,m={exports:{}};y=m,typeof window>"u"||(a=window,l=a.HTMLCanvasElement&&a.HTMLCanvasElement.prototype,f=a.Blob&&function(){try{return Boolean(new Blob)}catch{return!1}}(),L=f&&a.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch{return!1}}(),D=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder,H=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,N=(f||D)&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&function(j){var g,w,i,E,o,b,k,Z,q;if(!(g=j.match(H)))throw new Error("invalid data URI");for(w=g[2]?g[1]:"text/plain"+(g[3]||";charset=US-ASCII"),i=!!g[4],E=j.slice(g[0].length),o=i?atob(E):decodeURIComponent(E),b=new ArrayBuffer(o.length),k=new Uint8Array(b),Z=0;Z<o.length;Z+=1)k[Z]=o.charCodeAt(Z);return f?new Blob([L?k:b],{type:w}):((q=new D).append(b),q.getBlob(w))},a.HTMLCanvasElement&&!l.toBlob&&(l.mozGetAsFile?l.toBlob=function(j,g,w){var i=this;setTimeout(function(){j(w&&l.toDataURL&&N?N(i.toDataURL(g,w)):i.mozGetAsFile("blob",g))})}:l.toDataURL&&N&&(l.toBlob=l.msToBlob?function(j,g,w){var i=this;setTimeout(function(){j((g&&"image/png"!==g||w)&&l.toDataURL&&N?N(i.toDataURL(g,w)):i.msToBlob(g))})}:function(j,g,w){var i=this;setTimeout(function(){j(N(i.toDataURL(g,w)))})})),y.exports?y.exports=N:a.dataURLtoBlob=N);var v=m.exports,c={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},r=typeof window<"u"&&typeof window.document<"u"?window:{},_=function(a){return a>0&&a<1/0},p=Array.prototype.slice;function A(y){return Array.from?Array.from(y):p.call(y)}var T=/^image\/.+$/;function R(y){return T.test(y)}var O=String.fromCharCode;var d=r.btoa;function M(y){var l,a=new DataView(y);try{var f,L,D;if(255===a.getUint8(0)&&216===a.getUint8(1))for(var H=a.byteLength,N=2;N+1<H;){if(255===a.getUint8(N)&&225===a.getUint8(N+1)){L=N;break}N+=1}if(L){var g=L+10;if("Exif"===function s(y,a,l){var L,f="";for(l+=a,L=a;L<l;L+=1)f+=O(y.getUint8(L));return f}(a,L+4,4)){var w=a.getUint16(g);if(((f=18761===w)||19789===w)&&42===a.getUint16(g+2,f)){var i=a.getUint32(g+4,f);i>=8&&(D=g+i)}}}if(D){var o,b,E=a.getUint16(D,f);for(b=0;b<E;b+=1)if(274===a.getUint16(o=D+12*b+2,f)){l=a.getUint16(o+=8,f),a.setUint16(o,1,f);break}}}catch{l=1}return l}var S=/\.\d*(?:0|9){12}\d*$/;function W(y){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return S.test(y)?Math.round(y*a)/a:y}function F(y){var a=y.aspectRatio,l=y.height,f=y.width,L=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",D=_(f),H=_(l);if(D&&H){var N=l*a;("contain"===L||"none"===L)&&N>f||"cover"===L&&N<f?l=f/a:f=l*a}else D?l=f/a:H&&(f=l*a);return{width:f,height:l}}var J=r.ArrayBuffer,re=r.FileReader,Y=r.URL||r.webkitURL,X=/\.\w+$/,ie=r.Compressor;return function(){function y(a,l){(function h(y,a){if(!(y instanceof a))throw new TypeError("Cannot call a class as a function")})(this,y),this.file=a,this.image=new Image,this.options=t(t({},c),l),this.aborted=!1,this.result=null,this.init()}return function e(y,a,l){return a&&U(y.prototype,a),l&&U(y,l),y}(y,[{key:"init",value:function(){var l=this,f=this.file,L=this.options;if(function(a){return!(typeof Blob>"u")&&(a instanceof Blob||"[object Blob]"===Object.prototype.toString.call(a))}(f)){var D=f.type;if(R(D))if(Y&&re)if(J||(L.checkOrientation=!1),Y&&!L.checkOrientation)this.load({url:Y.createObjectURL(f)});else{var H=new re,N=L.checkOrientation&&"image/jpeg"===D;this.reader=H,H.onload=function(j){var w=j.target.result,i={};if(N){var E=M(w);E>1||!Y?(i.url=function I(y,a){for(var l=[],L=new Uint8Array(y);L.length>0;)l.push(O.apply(null,A(L.subarray(0,8192)))),L=L.subarray(8192);return"data:".concat(a,";base64,").concat(d(l.join("")))}(w,D),E>1&&C(i,function P(y){var a=0,l=1,f=1;switch(y){case 2:l=-1;break;case 3:a=-180;break;case 4:f=-1;break;case 5:a=90,f=-1;break;case 6:a=90;break;case 7:a=90,l=-1;break;case 8:a=-90}return{rotate:a,scaleX:l,scaleY:f}}(E))):i.url=Y.createObjectURL(f)}else i.url=w;l.load(i)},H.onabort=function(){l.fail(new Error("Aborted to read the image with FileReader."))},H.onerror=function(){l.fail(new Error("Failed to read the image with FileReader."))},H.onloadend=function(){l.reader=null},N?H.readAsArrayBuffer(f):H.readAsDataURL(f)}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(l){var f=this,L=this.file,D=this.image;D.onload=function(){f.draw(t(t({},l),{},{naturalWidth:D.naturalWidth,naturalHeight:D.naturalHeight}))},D.onabort=function(){f.fail(new Error("Aborted to load the image."))},D.onerror=function(){f.fail(new Error("Failed to load the image."))},r.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(r.navigator.userAgent)&&(D.crossOrigin="anonymous"),D.alt=L.name,D.src=l.url}},{key:"draw",value:function(l){var f=this,L=l.naturalWidth,D=l.naturalHeight,H=l.rotate,N=void 0===H?0:H,j=l.scaleX,g=void 0===j?1:j,w=l.scaleY,i=void 0===w?1:w,E=this.file,o=this.image,b=this.options,k=document.createElement("canvas"),Z=k.getContext("2d"),q=Math.abs(N)%180==90,ee=("contain"===b.resize||"cover"===b.resize)&&_(b.width)&&_(b.height),te=Math.max(b.maxWidth,0)||1/0,ae=Math.max(b.maxHeight,0)||1/0,ne=Math.max(b.minWidth,0)||0,K=Math.max(b.minHeight,0)||0,z=L/D,G=b.width,$=b.height;if(q){var oe=[ae,te];te=oe[0],ae=oe[1];var de=[K,ne];ne=de[0],K=de[1];var pe=[$,G];G=pe[0],$=pe[1]}ee&&(z=G/$);var he=F({aspectRatio:z,width:te,height:ae},"contain");te=he.width,ae=he.height;var fe=F({aspectRatio:z,width:ne,height:K},"cover");if(ne=fe.width,K=fe.height,ee){var ge=F({aspectRatio:z,width:G,height:$},b.resize);G=ge.width,$=ge.height}else{var me=F({aspectRatio:z,width:G,height:$}),ve=me.width;G=void 0===ve?L:ve;var _e=me.height;$=void 0===_e?D:_e}var Me=-(G=Math.floor(W(Math.min(Math.max(G,ne),te))))/2,Ue=-($=Math.floor(W(Math.min(Math.max($,K),ae))))/2,Pe=G,Ce=$,le=[];if(ee){var ce,ue,Oe=F({aspectRatio:z,width:L,height:D},{contain:"cover",cover:"contain"}[b.resize]);le.push((L-(ce=Oe.width))/2,(D-(ue=Oe.height))/2,ce,ue)}if(le.push(Me,Ue,Pe,Ce),q){var ye=[$,G];G=ye[0],$=ye[1]}k.width=G,k.height=$,R(b.mimeType)||(b.mimeType=E.type);var be="transparent";if(E.size>b.convertSize&&b.convertTypes.indexOf(b.mimeType)>=0&&(b.mimeType="image/jpeg"),"image/jpeg"===b.mimeType&&(be="#fff"),Z.fillStyle=be,Z.fillRect(0,0,G,$),b.beforeDraw&&b.beforeDraw.call(this,Z,k),!this.aborted&&(Z.save(),Z.translate(G/2,$/2),Z.rotate(N*Math.PI/180),Z.scale(g,i),Z.drawImage.apply(Z,[o].concat(le)),Z.restore(),b.drew&&b.drew.call(this,Z,k),!this.aborted)){var xe=function(Te){f.aborted||f.done({naturalWidth:L,naturalHeight:D,result:Te})};k.toBlob?k.toBlob(xe,b.mimeType,b.quality):xe(v(k.toDataURL(b.mimeType,b.quality)))}}},{key:"done",value:function(l){var f=l.naturalWidth,L=l.naturalHeight,D=l.result,H=this.file,j=this.options;if(Y&&!j.checkOrientation&&Y.revokeObjectURL(this.image.src),D)if(j.strict&&D.size>H.size&&j.mimeType===H.type&&!(j.width>f||j.height>L||j.minWidth>f||j.minHeight>L||j.maxWidth<f||j.maxHeight<L))D=H;else{var g=new Date;D.lastModified=g.getTime(),D.lastModifiedDate=g,D.name=H.name,D.name&&D.type!==H.type&&(D.name=D.name.replace(X,function Q(y){var a=R(y)?y.substr(6):"";return"jpeg"===a&&(a="jpg"),".".concat(a)}(D.type)))}else D=H;this.result=D,j.success&&j.success.call(this,D)}},{key:"fail",value:function(l){var f=this.options;if(!f.error)throw l;f.error.call(this,l)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=ie,y}},{key:"setDefaults",value:function(l){C(c,l)}}]),y}()}()},7445:(V,B,t)=>{"use strict";t.d(B,{F:()=>e});var h=t(4986),U=t(5963);function e(x=0,C=h.z){return x<0&&(x=0),(0,U.H)(x,x,C)}},1042:(V,B,t)=>{"use strict";t.d(B,{Z:()=>_});var h,U=new Uint8Array(16);function e(){if(!h&&!(h=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(U)}const x=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,m=function C(p){return"string"==typeof p&&x.test(p)};for(var v=[],n=0;n<256;++n)v.push((n+256).toString(16).substr(1));const _=function r(p,A,T){var R=(p=p||{}).random||(p.rng||e)();if(R[6]=15&R[6]|64,R[8]=63&R[8]|128,A){T=T||0;for(var Q=0;Q<16;++Q)A[T+Q]=R[Q];return A}return function c(p){var A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,T=(v[p[A+0]]+v[p[A+1]]+v[p[A+2]]+v[p[A+3]]+"-"+v[p[A+4]]+v[p[A+5]]+"-"+v[p[A+6]]+v[p[A+7]]+"-"+v[p[A+8]]+v[p[A+9]]+"-"+v[p[A+10]]+v[p[A+11]]+v[p[A+12]]+v[p[A+13]]+v[p[A+14]]+v[p[A+15]]).toLowerCase();if(!m(T))throw TypeError("Stringified UUID is invalid");return T}(R)}}}]);