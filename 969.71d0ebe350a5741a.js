(self.webpackChunkboard=self.webpackChunkboard||[]).push([[969],{9969:(Y,F,t)=>{"use strict";t.d(F,{R:()=>h});class h{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(e){Object.keys(e).filter(U=>U in this).forEach(U=>this[U]=e[U]),this.validateOptions()}setOptionsFromChanges(e){Object.keys(e).filter(U=>U in this).forEach(U=>this[U]=e[U].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}},2020:(Y,F,t)=>{"use strict";t.d(F,{y:()=>r});var h=t(5861);var P=t(4650);let r=(()=>{class b{constructor(){this.autoRotateSupported=function e(){return new Promise(b=>{const T=new Image;T.onload=()=>{b(1===T.width&&2===T.height)},T.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(o,O){return new Promise((u,M)=>{const c=new FileReader;c.onload=f=>{this.loadImage(f.target.result,o.type,O).then(u).catch(M)},c.readAsDataURL(o)})}loadImage(o,O,u){return this.isValidImageType(O)?this.loadBase64Image(o,u):Promise.reject(new Error("Invalid image type"))}isValidImageType(o){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(o)}loadImageFromURL(o,O){return new Promise((u,M)=>{const c=new Image;c.onerror=()=>M,c.onload=()=>{const f=document.createElement("canvas"),S=f.getContext("2d");f.width=c.width,f.height=c.height,S?.drawImage(c,0,0),this.loadBase64Image(f.toDataURL(),O).then(u)},c.crossOrigin="anonymous",c.src=o})}loadBase64Image(o,O){return new Promise((u,M)=>{const c=new Image;c.onload=()=>u({originalImage:c,originalBase64:o}),c.onerror=M,c.src=o}).then(u=>this.transformImageBase64(u,O))}transformImageBase64(o,O){var u=this;return(0,h.Z)(function*(){const M=yield u.autoRotateSupported,c=yield function U(b){switch("string"==typeof b&&(b=function L(b){const T=new DataView(function l(b){b=b.replace(/^data\:([^\;]+)\;base64,/gim,"");const T=atob(b),o=T.length,O=new Uint8Array(o);for(let u=0;u<o;u++)O[u]=T.charCodeAt(u);return O.buffer}(b));if(65496!==T.getUint16(0,!1))return-2;const o=T.byteLength;let O=2;for(;O<o;){if(T.getUint16(O+2,!1)<=8)return-1;const u=T.getUint16(O,!1);if(O+=2,65505==u){if(1165519206!==T.getUint32(O+=2,!1))return-1;const M=18761==T.getUint16(O+=6,!1);O+=T.getUint32(O+4,M);const c=T.getUint16(O,M);O+=2;for(let f=0;f<c;f++)if(274==T.getUint16(O+12*f,M))return T.getUint16(O+12*f+8,M)}else{if(65280!=(65280&u))break;O+=T.getUint16(O,!1)}}return-1}(b)),b){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(M?-1:o.originalBase64);return o.originalImage&&o.originalImage.complete?u.transformLoadedImage({original:{base64:o.originalBase64,image:o.originalImage,size:{width:o.originalImage.naturalWidth,height:o.originalImage.naturalHeight}},exifTransform:c},O):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(o,O){var u=this;return(0,h.Z)(function*(){const M=O.canvasRotation+o.exifTransform.rotate,c={width:o.original.image.naturalWidth,height:o.original.image.naturalHeight};if(0===M&&!o.exifTransform.flip&&!O.containWithinAspectRatio)return{original:{base64:o.original.base64,image:o.original.image,size:{...c}},transformed:{base64:o.original.base64,image:o.original.image,size:{...c}},exifTransform:o.exifTransform};const f=u.getTransformedSize(c,o.exifTransform,O),S=document.createElement("canvas");S.width=f.width,S.height=f.height;const W=S.getContext("2d");W?.setTransform(o.exifTransform.flip?-1:1,0,0,1,S.width/2,S.height/2),W?.rotate(Math.PI*(M/2)),W?.drawImage(o.original.image,-c.width/2,-c.height/2);const m=S.toDataURL(),g=yield u.loadImageFromBase64(m);return{original:{base64:o.original.base64,image:o.original.image,size:{...c}},transformed:{base64:m,image:g,size:{width:g.width,height:g.height}},exifTransform:o.exifTransform}})()}loadImageFromBase64(o){return new Promise((O,u)=>{const M=new Image;M.onload=()=>O(M),M.onerror=u,M.src=o})}getTransformedSize(o,O,u){const M=u.canvasRotation+O.rotate;if(u.containWithinAspectRatio){if(M%2){const f=o.height/u.aspectRatio;return{width:Math.max(o.height,o.width*u.aspectRatio),height:Math.max(o.width,f)}}{const f=o.width/u.aspectRatio;return{width:Math.max(o.width,o.height*u.aspectRatio),height:Math.max(o.height,f)}}}return M%2?{height:o.width,width:o.height}:{width:o.width,height:o.height}}}return b.\u0275fac=function(o){return new(o||b)},b.\u0275prov=P.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})()},8896:(Y,F,t)=>{"use strict";function h(I){const e=I.split(","),U=e[0].replace("data:","").replace(";base64",""),L=atob(e[1]),l=new ArrayBuffer(L.length),P=new Uint8Array(l);for(let r=0;r<L.length;r+=1)P[r]=L.charCodeAt(r);return new Blob([l],{type:U})}t.d(F,{L:()=>h})},8694:(Y,F,t)=>{"use strict";t.d(F,{r:()=>e});var h=t(6895),I=t(4650);let e=(()=>{class U{}return U.\u0275fac=function(l){return new(l||U)},U.\u0275mod=I.oAB({type:U}),U.\u0275inj=I.cJS({imports:[h.ez]}),U})()},8212:(Y,F,t)=>{"use strict";t.d(F,{J:()=>I});var h=t(4650);let I=(()=>{class e{transform(L,l){return L.join(l)}}return e.\u0275fac=function(L){return new(L||e)},e.\u0275pipe=h.Yjl({name:"arrayJoin",type:e,pure:!0}),e})()},575:(Y,F,t)=>{"use strict";t.d(F,{In:()=>h,Ky:()=>L,VC:()=>I,c5:()=>U,gG:()=>e});var h=(()=>{return(l=h||(h={})).FILE_SHOW_LINKS="fileLinks",l.FILE_EDIT="fileEdit",l.DELETE="delete",l.RENAME="rename",l.MOVE="move",h;var l})(),I=(()=>{return(l=I||(I={})).FILE="file",l.FOLDER="folder",I;var l})(),e=(()=>{return(l=e||(e={})).FILENAME="filename",l.SIZE="size",l.TIME="time",l.EXTENSION="ext",e;var l})(),U=(()=>{return(l=U||(U={})).GRID="grid",l.LIST="list",U;var l})(),L=(()=>{return(l=L||(L={})).W_768_I_1="(max-width: 767.98px)",l.W_933_I_2="(min-width: 768px) and (max-width: 933.98px)",l.W_960_I_3="(min-width: 934px) and (max-width: 959.98px)",l.W_1226_I_2="(min-width: 960px) and (max-width: 1225.98px)",l.W_1540_I_3="(min-width: 1226px) and (max-width: 1539.98px)",l.W_1854_I_4="(min-width: 1540px) and (max-width: 1853.98px)",l.W_2168_I_5="(min-width: 1854px) and (max-width: 2167.98px)",l.W_2482_I_6="(min-width: 2168px) and (max-width: 2481.98px)",l.W_2796_I_7="(min-width: 2482px) and (max-width: 2795.98px)",l.W_3110_I_8="(min-width: 2796px) and (max-width: 3109.98px)",l.W_3424_I_9="(min-width: 3110px) and (max-width: 3423.98px)",l.W_3738_I_10="(min-width: 3424px)",L;var l})()},6986:(Y,F,t)=>{"use strict";t.d(F,{C7:()=>U,Mi:()=>L,O8:()=>I,er:()=>l,p0:()=>e,xt:()=>P});var h=t(575);const I=[{ext:["png","apng"],maxSize:15},{ext:["jpeg","jpg","jpe"],maxSize:10},{ext:["gif"],maxSize:15},{ext:["bmp"],maxSize:10},{ext:["webp","webm"],maxSize:10},{ext:["psd","xcf"],maxSize:150},{ext:["svg"],maxSize:30}].map(r=>(r.maxSize*=1048576,r)),e={lastPath:[],layout:{asc:!0,orderBy:h.gG.FILENAME,type:h.c5.GRID},uploader:{checkImage:{time:0,active:!0},showLinkModal:!1}},U="https://upload.forumfree.net/api/",L=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-.\s])*$/,l=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-\s])*$/,P={invalidLength:!1,alreadyUsed:!1,invalidStartOrEnd:!1,invalidCharacter:!1}},8375:(Y,F,t)=>{"use strict";t.d(F,{B:()=>j});var h=t(5861),I=t(1309),e=t(4650),U=t(4968),L=t(3905),l=t(3848),P=t(1460),r=t(6986),b=t(575),T=t(4323),o=t(7693),O=t(7320),u=t(146),M=t(3612),c=t(6378),f=t(6895),S=t(433),W=t(4029),m=t(8279),g=t(3450),w=t(8212);const K=["fileInput"];function _(p,D){1&p&&(e.O4$(),e.TgZ(0,"svg",25),e._UZ(1,"path",26)(2,"path",27),e.qZA())}const E=function(){return["text-primary"]};function R(p,D){1&p&&e._UZ(0,"app-logo",28),2&p&&e.Q6J("svgClass",e.DdM(2,E))("responsive",!1)}function A(p,D){1&p&&(e.TgZ(0,"span"),e._uU(1,"Trascina i file da caricare oppure c"),e.qZA())}function Q(p,D){1&p&&(e.TgZ(0,"span"),e._uU(1,"C"),e.qZA())}function G(p,D){if(1&p&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2,"I file verranno caricati nella cartella "),e.qZA(),e._UZ(3,"em",29),e.ALo(4,"arrayJoin"),e.BQk()),2&p){const a=e.oxw(2);e.xp6(3),e.Q6J("innerText",a.currentFolderPath.length?e.xi3(4,1,a.currentFolderPath,"/"):"root")}}function J(p,D){if(1&p&&(e._UZ(0,"div",34),e.ALo(1,"arrayJoin"),e.ALo(2,"slice")),2&p){const a=e.oxw(3);e.Q6J("innerText",e.xi3(1,1,e.Dn7(2,4,a.currentFolderPath,0,-1),"/"))}}function q(p,D){if(1&p&&(e.TgZ(0,"div",30)(1,"div",31),e._uU(2,"Cartella:"),e.qZA(),e.YNc(3,J,3,8,"div",32),e._UZ(4,"div",33),e.ALo(5,"arrayJoin"),e.ALo(6,"slice"),e.qZA()),2&p){const a=e.oxw(2);e.xp6(3),e.Q6J("ngIf",a.currentFolderPath.length>1),e.xp6(1),e.Q6J("innerText",(a.currentFolderPath.length>1?"/":"")+(a.currentFolderPath.length?e.xi3(5,2,e.xi3(6,5,a.currentFolderPath,a.currentFolderPath.length-1),"/"):"root"))}}const te=function(){return{bottom:0,left:0}};function ae(p,D){if(1&p){const a=e.EpF();e.TgZ(0,"a",35),e.NdJ("click",function(){e.CHM(a);const i=e.oxw(2);return e.KtG(i.openInfoModal.emit())}),e._uU(1,"Informazioni"),e.qZA()}2&p&&e.Q6J("ngStyle",e.DdM(1,te))}function y(p,D){if(1&p){const a=e.EpF();e.TgZ(0,"div",36),e.NdJ("click",function(){e.CHM(a),e.oxw(2);const i=e.MAs(7);return e.KtG(i.open())}),e._uU(1,"settings"),e.qZA()}}const n=function(p,D,a){return{"cursor-pointer":p,"p-4":D,"py-3 mt-1":a}},s=function(p){return{"fw-bold fs-lg":p}},d=function(p,D,a){return{"my-2":p,"mb-2":D,"mw-100":a}};function B(p,D){if(1&p){const a=e.EpF();e.ynx(0),e.TgZ(1,"div",15,16),e.NdJ("dragenter",function(){e.CHM(a);const i=e.MAs(2),x=e.oxw();return e.KtG(x.setDragOverEvent(i))})("drop",function(i){e.CHM(a);const x=e.oxw();return e.KtG(x.handleDropEvent(i))})("click",function(){e.CHM(a),e.oxw();const i=e.MAs(2);return e.KtG(i.click())}),e.YNc(3,_,3,0,"svg",17),e.YNc(4,R,1,3,"ng-template",null,18,e.W1O),e.TgZ(6,"div",19),e.YNc(7,A,2,0,"span",20),e.YNc(8,Q,2,0,"span",20),e.TgZ(9,"span"),e._uU(10,"licca per scegliere da memoria"),e.qZA()(),e.TgZ(11,"div",21),e.YNc(12,G,5,4,"ng-container",3),e.YNc(13,q,7,8,"ng-template",null,22,e.W1O),e.qZA()(),e.YNc(15,ae,2,2,"a",23),e.YNc(16,y,2,0,"div",24),e.BQk()}if(2&p){const a=e.MAs(5),v=e.MAs(14),i=e.oxw();e.xp6(1),e.Q6J("ngClass",e.kEZ(11,n,!i.loading,!i.isWidget,i.isWidget)),e.xp6(2),e.Q6J("ngIf",!i.isWidget)("ngIfElse",a),e.xp6(3),e.Q6J("ngClass",e.VKq(15,s,!i.isWidget)),e.xp6(1),e.Q6J("ngIf",!i.touchDevice),e.xp6(1),e.Q6J("ngIf",i.touchDevice),e.xp6(3),e.Q6J("ngClass",e.kEZ(17,d,!i.isWidget&&!i.touchDevice,!i.isWidget&&i.touchDevice,i.isWidget)),e.xp6(1),e.Q6J("ngIf",!i.isWidget)("ngIfElse",v),e.xp6(3),e.Q6J("ngIf",!i.isWidget),e.xp6(1),e.Q6J("ngIf",!i.isWidget)}}const C=function(p,D){return{"p-4":p,"pt-2 pb-3":D}};function H(p,D){if(1&p&&(e.TgZ(0,"div",37),e.O4$(),e.TgZ(1,"svg",38),e._UZ(2,"path",39),e.qZA(),e.kcU(),e._UZ(3,"app-loader",40),e.TgZ(4,"div",41),e._uU(5,"Attendi il completamento dell'upload per caricare altre immagini."),e.qZA()()),2&p){const a=e.oxw();e.Q6J("ngClass",e.WLB(3,C,!a.isWidget,a.isWidget)),e.xp6(3),e.Q6J("onlyMessage",!0)("message",a.loadingMessage)}}const z=function(p,D){return{uploading:p,widget:D}};let j=(()=>{class p{constructor(a,v,i,x,$,Z,ee){this.postMessageService=a,this.uploadService=v,this.uploadObservablesService=i,this.uploaderService=x,this.toastService=$,this.renderer=Z,this.ngZone=ee,this.loading=!0,this.currentFolderPath=[],this.isWidget=!1,this.fileUploadedEvent=new e.vpe,this.openInfoModal=new e.vpe,this.isUploading=!1,this.loadingMessage="Controllo dei file in corso",this.touchDevice=P.eX,this.dragOverEvent=!1,this.options=this.uploaderService.uploaderOptions;const re=this.uploadService.preferences.uploader;re.checkImage.active||(this.options.compress=!1),re.showLinkModal&&(this.options.openLinkModalAfterUpload=!0),this.uploaderService.uploaderOptions=this.options}ngOnInit(){this.handleClipboardPasteEvent(),this.handleExternalUpload()}handleClipboardPasteEvent(){var a=this;this.clipboardPasteEventSubscription=(0,U.R)(document.body,"paste").subscribe(function(){var v=(0,h.Z)(function*(i){if(!a.canUpload)return;const x=Array.from((i.clipboardData||i.originalEvent.clipboardData).items);let $=[];for(const Z of x)if(0===Z.type.indexOf("image")){const ee=Z.getAsFile();ee&&$.push(ee)}$.length>0?yield a.preUpload($):a.reset()});return function(i){return v.apply(this,arguments)}}())}handleExternalUpload(){var a=this;this.startExternalUploadSubscription=this.uploadObservablesService.startUploadObservable.subscribe(function(){var v=(0,h.Z)(function*(i){if(i)return a.canUpload?void(yield a.preUpload([i.file],i.options)):void a.reset();a.fileInputRef.nativeElement.click()});return function(i){return v.apply(this,arguments)}}())}handleSelectionEvent(a){var v=this;return(0,h.Z)(function*(){if(!v.canUpload)return;const i=a.target;if(i.files&&i.files.length){const x=Array.from(i.files);return i.value="",v.preUpload(x)}v.reset()})()}handleDropEvent(a){var v=this;return(0,h.Z)(function*(){if(!v.canUpload)return;a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation();const i=a.dataTransfer?.files?Array.from(a.dataTransfer.files):[];if(i.length)return v.preUpload(i);v.reset()})()}saveOptions(a=!0){this.uploaderService.uploaderOptions=this.options,a&&this.savePreferences()}savePreferences(){this.uploadService.preferences.uploader={checkImage:{active:this.options.compress,time:Date.now()},showLinkModal:this.options.openLinkModalAfterUpload}}setDragOverEvent(a){this.dragOverEvent||(this.dragOverEvent=!0,this.ngZone.runOutsideAngular(()=>{this.renderer.listen(a,"dragover",v=>{v.preventDefault()})}))}get canUpload(){return!this.loading&&!this.isUploading&&(this.isUploading=!0,!0)}reset(){this.isUploading=!1,this.loadingMessage="Controllo dei file da caricare",this.options.allowOverwrite=!1,this.saveOptions(!1)}preUpload(a,v){var i=this;return(0,h.Z)(function*(){const x=[...i.currentFolderPath];let $=[],Z=[],ee=[],re=[];v?v.allowOverwrite=v.allowOverwrite||!1:(v=i.uploaderService.uploaderOptions).allowOverwrite=!1;for(let k=0;k<a.length;k++){let N=v.compress?yield i.uploaderService.compressFileIfNeeded(a[k],v.imageDimensions):a[k];if(N=yield i.uploaderService.orientFileIfNeeded(N),N){const ne=(0,l.Tb)(N.name),V=r.O8.find(X=>-1!==X.ext.indexOf(ne.ext));if(!V){ee.push(N);continue}if(N.size>V.maxSize){re.push(N);continue}$.push({file:{name:N.name,size:N.size,time:0,url:"",ext:ne.ext,filename:ne.filename,isImage:(0,l.Or)(ne.ext),embedUrl:""},progress:0,completed:!1}),Z.push(N)}}if((ee.length||re.length)&&(i.toastService.show({content:i.createToastMessage(ee,re),level:I.m.ERROR}),[["UNSUPPORTED",ee],["OVERSIZED",re]].forEach(k=>{k[1].forEach(N=>{i.postMessageService.send(T.l.UPLOAD_ERROR,{filename:N.name,error:k[0]})})})),0===Z.length)return void i.reset();const oe=`Caricamento file {{fileNumber}} di ${Z.length} in corso`;i.uploadObservablesService.pushUploadingFileQueue($);for(let k=0;k<Z.length;++k){i.loadingMessage="Creazione del pacchetto da inviare";const N=yield i.uploadService.getHostToken(x,Z[k].name);$[k].progress+=20,i.loadingMessage=oe.replace("{{fileNumber}}",`${k+1}`),yield(0,L.z)(i.uploaderService.upload(Z[k],$[k],N,v.allowOverwrite))}i.uploadObservablesService.pushUploadingFileQueue([]);const ie=$.filter(k=>!k.error).map(k=>k.file);ie.length>0&&(i.fileUploadedEvent.emit({fileList:ie,rewrite:v.allowOverwrite,paths:x}),ie.forEach(k=>{i.postMessageService.send(T.l.UPLOAD_SUCCESS,{filename:k.name,isImage:k.isImage,embedUrl:k.embedUrl})}),v.openLinkModalAfterUpload&&i.uploadObservablesService.pushAction({name:b.In.FILE_SHOW_LINKS,payload:{entities:(0,l.jL)(ie)}})),i.reset()})()}createToastMessage(a,v){let i=[];return a.length&&i.push(a.length>1?`I file <strong>${a.map(x=>x.name).join(", ")}</strong> hanno un formato non supportato!`:`Il file <strong>${a[0].name}</strong> ha un formato non supportato!`),v.length&&i.push(v.length>1?`I file <strong>${v.map(x=>x.name).join(", ")}</strong> sono troppo pesanti!`:`Il file <strong>${v[0].name}</strong> \xe8 troppo pesante!`),i.join("<br><br>")}ngOnDestroy(){this.startExternalUploadSubscription?.unsubscribe(),this.clipboardPasteEventSubscription.unsubscribe(),this.uploaderService.clearPendingRequests()}}return p.\u0275fac=function(a){return new(a||p)(e.Y36(o.F),e.Y36(O.C),e.Y36(u.r),e.Y36(M.q),e.Y36(c.k),e.Y36(e.Qsj),e.Y36(e.R0b))},p.\u0275cmp=e.Xpm({type:p,selectors:[["app-uploader"]],viewQuery:function(a,v){if(1&a&&e.Gf(K,5),2&a){let i;e.iGM(i=e.CRH())&&(v.fileInputRef=i.first)}},inputs:{loading:"loading",currentFolderPath:"currentFolderPath",isWidget:"isWidget"},outputs:{fileUploadedEvent:"fileUploadedEvent",openInfoModal:"openInfoModal"},decls:30,vars:10,consts:[[1,"uploader","rounded","h-100","position-relative",3,"ngClass"],["type","file",1,"d-none",3,"multiple","disabled","change"],["fileInput",""],[4,"ngIf","ngIfElse"],["uploading",""],["title","Opzioni di caricamento"],["optionsModal",""],[1,"mb-1"],[1,"mb-3"],[1,"mb-1","list-unstyled"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","speed-upload",1,"form-check-input",3,"ngModel","ngModelChange"],["for","speed-upload",1,"form-check-label","me-auto"],["type","checkbox","role","switch","id","show-link-modal",1,"form-check-input",3,"ngModel","ngModelChange"],["for","show-link-modal",1,"form-check-label","me-auto"],[1,"rounded","upload-area",3,"ngClass","dragenter","drop","click"],["uploadArea",""],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16",4,"ngIf","ngIfElse"],["appLogo",""],[1,"description","text-center",3,"ngClass"],[4,"ngIf"],[1,"small","text-center",3,"ngClass"],["widgetFolder",""],["class","fs-xs fst-italic d-block px-2 py-1 text-reset cursor-pointer position-absolute",3,"ngStyle","click",4,"ngIf"],["class","material-icons-outlined d-block cursor-pointer fs-xl position-absolute options-icon",3,"click",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16"],["fill-rule","evenodd","d","M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"],["d","M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"],["svgSize","xl","subtext","Upload",1,"d-block","mb-3","py-1",3,"svgClass","responsive"],[1,"text-break",3,"innerText"],[1,"d-flex","min-w-0"],[1,"me-1"],["class","fst-italic text-truncate mw-100",3,"innerText",4,"ngIf"],[1,"fst-italic","text-nowrap",3,"innerText"],[1,"fst-italic","text-truncate","mw-100",3,"innerText"],[1,"fs-xs","fst-italic","d-block","px-2","py-1","text-reset","cursor-pointer","position-absolute",3,"ngStyle","click"],[1,"material-icons-outlined","d-block","cursor-pointer","fs-xl","position-absolute","options-icon",3,"click"],[1,"p-4","rounded",3,"ngClass"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","viewBox","0 0 16 16",1,"overflow-visible"],["d","M 4.406 3.342 A 5.53 5.53 0 0 1 8 2 c 2.69 0 4.923 2 5.166 4.579 C 14.758 6.804 16 8.137 16 9.773 C 16 11.569 14.502 13 12.687 13 H 3.781 C 1.708 13 0 11.366 0 9.318 c 0 -1.763 1.266 -3.223 2.942 -3.593 c 0.143 -0.863 0.698 -1.723 1.464 -2.383 z",1,"cloud"],[3,"onlyMessage","message"],[1,"small","text-center"]],template:function(a,v){if(1&a&&(e.TgZ(0,"div",0)(1,"input",1,2),e.NdJ("change",function(x){return v.handleSelectionEvent(x)}),e.qZA(),e.YNc(3,B,17,21,"ng-container",3),e.YNc(4,H,6,6,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(6,"app-modal",5,6)(8,"p",7),e._uU(9,"Tramite questo modal \xe8 possibile gestire le opzioni di caricamento al momento disponibili:"),e.qZA(),e.TgZ(10,"ul",8)(11,"li")(12,"em"),e._uU(13,"caricamento veloce"),e.qZA(),e._uU(14,": abilitando questa opzione, l'immagine da caricare verr\xe0 adattata per terminare l'operazione di upload nel minor tempo possibile. "),e.qZA(),e.TgZ(15,"li")(16,"em"),e._uU(17,"mostra link dopo l'upload"),e.qZA(),e._uU(18,": abilitando questa opzione, una volta terminato il caricamento verr\xe0 aperto il modal contenente i link utili dei file caricati. "),e.qZA()(),e.TgZ(19,"ul",9)(20,"li")(21,"div",10)(22,"input",11),e.NdJ("ngModelChange",function(x){return v.options.compress=x})("ngModelChange",function(){return v.saveOptions()}),e.qZA(),e.TgZ(23,"label",12),e._uU(24,"Caricamento veloce"),e.qZA()()(),e.TgZ(25,"li")(26,"div",10)(27,"input",13),e.NdJ("ngModelChange",function(x){return v.options.openLinkModalAfterUpload=x})("ngModelChange",function(){return v.saveOptions()}),e.qZA(),e.TgZ(28,"label",14),e._uU(29,"Mostra link dopo l'upload"),e.qZA()()()()()),2&a){const i=e.MAs(5);e.Q6J("ngClass",e.WLB(7,z,v.isUploading,v.isWidget)),e.xp6(1),e.Q6J("multiple",!0)("disabled",v.loading||v.isUploading),e.xp6(2),e.Q6J("ngIf",!v.isUploading)("ngIfElse",i),e.xp6(19),e.Q6J("ngModel",v.options.compress),e.xp6(5),e.Q6J("ngModel",v.options.openLinkModalAfterUpload)}},dependencies:[f.mk,f.O5,f.PC,S.Wl,S.JJ,S.On,W.R,m.R,g.z,w.J,f.OU],styles:[".uploader[_ngcontent-%COMP%]:not(.widget){margin:0 1rem;border:2px dashed #4864FE;box-shadow:0 .125rem .25rem #00000013;color:#2036ad}.uploader[_ngcontent-%COMP%]:not(.widget):not(.uploading)   svg[_ngcontent-%COMP%]{animation:bubble 4s linear infinite}.uploader[_ngcontent-%COMP%]:not(.widget)   .description[_ngcontent-%COMP%]{max-width:400px}.uploader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.options-icon){height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.uploader.uploading[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{fill:none;stroke:#2036ad;stroke-linecap:round;stroke-dasharray:50;stroke-dashoffset:100;animation:draw 3.5s linear infinite}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]{top:5px;right:5px;opacity:.7;transition:opacity .2s}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]:hover{opacity:1}.upload-area[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(app-logo){pointer-events:none}@media (min-width: 768px){.uploader[_ngcontent-%COMP%]{margin:initial}}@keyframes bubble{6%{transform:scale(1.3,.8)}9%{transform:scale(.8,1.3) translateY(-.5rem)}12%{transform:scale(1)}}@keyframes draw{0%{stroke-dashoffset:100}to{stroke-dashoffset:0}}"]}),p})()},1740:(Y,F,t)=>{"use strict";t.d(F,{M:()=>r});var h=t(8694),I=t(6895),e=t(433),U=t(6818),L=t(1043),l=t(582),P=t(4650);let r=(()=>{class b{}return b.\u0275fac=function(o){return new(o||b)},b.\u0275mod=P.oAB({type:b}),b.\u0275inj=P.cJS({imports:[h.r,I.ez,e.u5,U.q,L.h,l.z]}),b})()},2381:(Y,F,t)=>{"use strict";t.d(F,{y:()=>L});var h=t(5044),I=t(4650),e=t(5700),U=t(5123);let L=(()=>{class l{constructor(r,b){this.cookieConsentService=r,this.localStorageService=b,this.storage=null}getItem(r){return null===this.storage&&(this.storage=this.data),this.storage[r]}get data(){const r=this.localStorageService.getItem(h.dR.PREFERENCES);if(!r)return{};try{return JSON.parse(r)}catch{return{}}}setItem(r,b){null===this.storage&&(this.storage=this.data),b?this.storage[r]=b:delete this.storage[r],this.cookieConsentService.choice?.preferences&&this.localStorageService.setItem(h.dR.PREFERENCES,JSON.stringify(this.storage))}resetItemsOnProfileChange(){const r=this.getItem(h.Ye.UPLOAD);r&&(r.lastPath=[],this.setItem(h.Ye.UPLOAD,r))}}return l.\u0275fac=function(r){return new(r||l)(I.LFG(e.C),I.LFG(U.n))},l.\u0275prov=I.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},146:(Y,F,t)=>{"use strict";t.d(F,{r:()=>L});var h=t(7579),I=t(1135),e=t(4650),U=t(8745);let L=(()=>{class l{constructor(r){this.uploadPreferencesService=r,this.selectedFileListArray=[],this.actionSubject=new h.x,this.uploadingFileQueueSubject=new h.x,this.uploadingFileErrorSubject=new h.x,this.currentFolderPathSubject=new h.x,this.layoutOptionsSubject=new h.x,this.renameFileSubject=new h.x,this.entityPendingSubject=new h.x,this.deleteFileSubject=new h.x,this.uploadedFileSubject=new h.x,this.draggedFileListSubject=new h.x,this.startUploadSubject=new h.x,this.selectedFileListSubject=new I.X(this.selectedFileListArray)}get actionObservable(){return this.actionSubject.asObservable()}pushAction(r){this.actionSubject.next(r)}get layoutOptionsObservable(){return this.layoutOptionsSubject.asObservable()}pushLayoutOptions(r){this.uploadPreferencesService.layoutOptions=r,this.layoutOptionsSubject.next(r)}get currentFolderPathObservable(){return this.currentFolderPathSubject.asObservable()}pushCurrentFolderPath(r){this.uploadPreferencesService.lastFolderPath=r,this.currentFolderPathSubject.next(r)}get uploadingFileQueueObservable(){return this.uploadingFileQueueSubject.asObservable()}pushUploadingFileQueue(r){this.uploadingFileQueueSubject.next(r)}get uploadingFileErrorObservable(){return this.uploadingFileErrorSubject.asObservable()}pushUploadingFileError(r){this.uploadingFileErrorSubject.next(r)}get renameFileObservable(){return this.renameFileSubject.asObservable()}pushRenameFile(r){this.renameFileSubject.next(r)}get entityPendingObservable(){return this.entityPendingSubject.asObservable()}pushEntityPending(r){this.entityPendingSubject.next(r)}get deleteFileObservable(){return this.deleteFileSubject.asObservable()}pushDeleteFile(r){this.deleteFileSubject.next(r)}get uploadedFileObservable(){return this.uploadedFileSubject.asObservable()}pushUploadedFile(r){this.uploadedFileSubject.next(r)}get draggedFileListObservable(){return this.draggedFileListSubject.asObservable()}pushDraggedFileList(r){this.draggedFileListSubject.next(r)}get startUploadObservable(){return this.startUploadSubject.asObservable()}pushStartUpload(r){this.startUploadSubject.next(r)}get selectedFileListObservable(){return this.selectedFileListSubject.asObservable()}pushSelectedFile(r){if(Array.isArray(r)||(r=[r]),0===r.length)return void(this.selectedFileListArray.length>0&&(this.selectedFileListArray=[],this.selectedFileListSubject.next(this.selectedFileListArray)));let b=!1;for(const T of r){const o=this.selectedFileListArray.findIndex(O=>O.name===T.name);T.selected?-1===o&&(this.selectedFileListArray.push({name:T.name}),b=!0):o>-1&&(this.selectedFileListArray.splice(o,1),b=!0)}b&&this.selectedFileListSubject.next(this.selectedFileListArray)}}return l.\u0275fac=function(r){return new(r||l)(e.LFG(U.p))},l.\u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},8745:(Y,F,t)=>{"use strict";t.d(F,{p:()=>L});var h=t(5044),I=t(6986),e=t(4650),U=t(2381);let L=(()=>{class l{constructor(r){this.preferencesService=r}get preferences(){return this.preferencesService.getItem(h.Ye.UPLOAD)||I.p0}set preferences(r){this.preferencesService.setItem(h.Ye.UPLOAD,r)}get lastFolderPath(){return this.preferences.lastPath||I.p0.lastPath}set lastFolderPath(r){const b=this.preferences;b.lastPath=r,this.preferences=b}get layoutOptions(){const r=I.p0.layout,b=this.preferences.layout;return b&&0===Object.keys(r).filter(T=>!b.hasOwnProperty(T)).length?b:r}set layoutOptions(r){const b=this.preferences;b.layout=r,this.preferences=b}get uploader(){const r=this.preferences.uploader||I.p0.uploader;return!r.checkImage.active&&Date.now()-r.checkImage.time>6048e5&&(r.checkImage.active=!0,this.uploader=r),r.hasOwnProperty("showLinkModal")||(r.showLinkModal=!1),r}set uploader(r){const b=this.preferences;b.uploader=r,this.preferences=b}}return l.\u0275fac=function(r){return new(r||l)(e.LFG(U.y))},l.\u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},7320:(Y,F,t)=>{"use strict";t.d(F,{C:()=>g});var h=t(5861),I=t(7824),e=t(3905),U=t(3848),o=t(6986),O=t(1042),u=t(4650),M=t(5395),c=t(575),f=t(3138);let S=(()=>{class w{constructor(_){this.globalsService=_,this.ffuid="",this.cache={},this.profileSubscription=this.globalsService.profileObservable.subscribe(E=>{this.ffuid=E?E.user.ffuid:""})}getItem(_){const E=this.createKey(_);if(this.cache.hasOwnProperty(E))return this.cache[E]}setItem(_,E){this.cache[this.createKey(_)]=E}removeItem(_){const E=this.createKey(_);if(this.cache.hasOwnProperty(E)){if(this.cache[E].folders.length)for(const R of this.cache[E].folders)this.removeItem([..._,R.name]);return delete this.cache[E],!0}return!1}addEntities(_,E,R=c.VC.FILE){const A=this.createKey(_);return!!this.cache.hasOwnProperty(A)&&(Array.isArray(E)||(E=[E]),R===c.VC.FILE?this.cache[A].files.unshift(...E):this.cache[A].folders.unshift(...E),!0)}removeEntities(_,E,R=c.VC.FILE){const A=this.createKey(_);if(!this.cache.hasOwnProperty(A))return!1;const Q=R===c.VC.FILE?"files":"folders";Array.isArray(E)||(E=[E]);let G=!1;for(const J of E){const q=this.cache[A][Q].findIndex(te=>te.name===J);q>-1&&(this.cache[A][Q].splice(q,1),G=!0)}return G}refactorFolderContent(_,E){const R=this.createKey(_);if(!this.cache.hasOwnProperty(R))return!1;E.endsWith("/")||(E+="/");for(const A of this.cache[R].folders)A.url=E+A.name;for(const A of this.cache[R].files)A.url=A.embedUrl=E+A.name,A.time=Date.now();return!0}createKey(_){return`${this.ffuid}/${_.join("/")}`}ngOnDestroy(){this.profileSubscription.unsubscribe()}}return w.\u0275fac=function(_){return new(_||w)(u.LFG(f.d))},w.\u0275prov=u.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})();var W=t(8745),m=t(529);let g=(()=>{class w{constructor(_,E,R,A){this.graphqlService=_,this.uploadCacheService=E,this.uploadPreferencesService=R,this.http=A}get cache(){return this.uploadCacheService}get preferences(){return this.uploadPreferencesService}setGqlIdHeader(){this.graphqlService.safeSetGlobalHeader(I._.HeaderKeys.UUID,(0,O.Z)())}removeGqlIdHeader(){this.graphqlService.removeGlobalHeader(I._.HeaderKeys.UUID)}getGqlIdHeader(){return this.graphqlService.getGlobalHeader(I._.HeaderKeys.UUID)||""}getFileList(_,E){var R=this;return(0,h.Z)(function*(){const A=R.uploadCacheService.getItem(_);if(A)return A;const Q=(yield R.graphqlService.query({query:"\nquery UploadEntitiesListToken($scope: String, $target: String!) {\n    uploadEntitiesListToken(scope: $scope, target: $target)\n}",variables:{scope:E,target:_.join("/")}})).data.uploadEntitiesListToken,G=yield R.sendRequest(Q),q={files:G.files.map(te=>{const ae=(0,U.Tb)(te.url);return{...te,time:1e3*te.time,filename:ae.filename,ext:ae.ext,isImage:(0,U.Or)(ae.ext),embedUrl:`${te.url}?t=${te.time}`}}),folders:G.folders};return R.uploadCacheService.setItem(_,q),q})()}createDirectory(_,E){var R=this;return(0,h.Z)(function*(){const A=(yield R.graphqlService.mutate({mutation:"\nquery UploadEntitiesCreateDirectoryToken($scope: String, $target: String!) {\n    uploadEntitiesCreateDirectoryToken(scope: $scope, target: $target)\n}",variables:{scope:E,target:_.join("/")}})).data.uploadEntitiesCreateDirectoryToken;return yield R.sendRequest(A)})()}moveRenameEntity(_,E,R,A,Q){var G=this;return(0,h.Z)(function*(){A||(A=R);const J=(yield G.graphqlService.mutate({mutation:"\nquery UploadEntitiesMoveToken($scope: String, $source: String!, $target: String!) {\n    uploadEntitiesMoveToken(scope: $scope, source: $source, target: $target)\n}",variables:{scope:Q,source:(_.length?`${_.join("/")}/`:"")+R,target:(E.length?`${E.join("/")}/`:"")+A}})).data.uploadEntitiesMoveToken;return yield G.sendRequest(J)})()}deleteEntity(_,E,R){var A=this;return(0,h.Z)(function*(){const Q=(yield A.graphqlService.mutate({mutation:"\nquery UploadEntitiesDeleteToken($scope: String, $target: String!) {\n    uploadEntitiesDeleteToken(scope: $scope, target: $target)\n}",variables:{scope:R,target:(_.length?`${_.join("/")}/`:"")+E}})).data.uploadEntitiesDeleteToken;return yield A.sendRequest(Q),!0})()}getHostToken(_,E,R){var A=this;return(0,h.Z)(function*(){return(yield A.graphqlService.query({query:"\nquery UploadEntitiesHostToken($scope: String, $target: String!) {\n    uploadEntitiesHostToken(scope: $scope, target: $target)\n}",variables:{scope:R,target:(_.length?`${_.join("/")}/`:"")+E}})).data.uploadEntitiesHostToken})()}sendRequest(_){var E=this;return(0,h.Z)(function*(){return(yield(0,e.z)(E.http.post(o.C7,JSON.stringify({payload:_}),{headers:{"Content-Type":"application/json"}}))).success})()}subscribeForChanges(_,E){var R=this;return(0,h.Z)(function*(){return yield R.graphqlService.subscribe({query:"\nsubscription UploadEntities($scope: String) {\n    uploadEntities(scope: $scope) {\n        eventMessage\n        eventType\n        user {\n            avatar\n            host\n            id\n            nickname\n        }\n    }\n}",variables:{scope:E}},A=>{if(!A.data?.uploadEntities)return;const Q=JSON.parse(A.data.uploadEntities.eventMessage);if(!Q.payload.customHeaders||!Q.payload.customHeaders.hasOwnProperty(I._.HeaderKeys.UUID)||Q.payload.customHeaders[I._.HeaderKeys.UUID]===R.getGqlIdHeader())return;const G=(Q.payload.content.source||"").split("/"),J=(Q.payload.content.target||"").split("/"),q=J[J.length-1].indexOf(".")>-1;let te;try{te=JSON.parse(Q.output).success||""}catch{return}_({type:A.data.uploadEntities.eventType,sourceName:G[G.length-1],sourcePaths:G.slice(0,-1),targetName:J[J.length-1],targetPaths:J.slice(0,-1),isFile:q,output:te})})})()}getBlobFromUrl(_){var E=this;return(0,h.Z)(function*(){return yield(0,e.z)(E.http.get(_,{responseType:"blob"})).catch(()=>{})})()}}return w.\u0275fac=function(_){return new(_||w)(u.LFG(M.J),u.LFG(S),u.LFG(W.p),u.LFG(m.eN))},w.\u0275prov=u.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})()},3848:(Y,F,t)=>{"use strict";t.d(F,{$H:()=>u,JN:()=>b,Lv:()=>l,Or:()=>O,Tb:()=>U,jL:()=>o,rc:()=>M,sT:()=>P,zO:()=>L});var h=t(5861),I=t(575),e=t(6986);function U(c){let f=c;if(c.indexOf("/")>-1){const g=c.split("/");f=g[g.length-1]}const S=f.split("."),W=S[S.length-1].toLowerCase(),m=decodeURIComponent(S.slice(0,-1).join("."));return{ext:W,filename:m,name:`${m}.${W}`}}function L(c){const f=U(c),S=Date.now();return{name:f.name,size:0,time:S,url:c,ext:f.ext,filename:f.filename,isImage:O(f.ext),embedUrl:`${c}?t=${S}`}}function l(c){let f=c;f.endsWith("/")&&(f=f.slice(0,-1));const S=f.split("/");return{name:decodeURIComponent(S[S.length-1])}}function P(c){return r.apply(this,arguments)}function r(){return(r=(0,h.Z)(function*(c){const f=new FileReader,S=new Promise(W=>f.addEventListener("load",()=>W(f.result)));return f.readAsDataURL(c),S})).apply(this,arguments)}function b(c){return T.apply(this,arguments)}function T(){return(T=(0,h.Z)(function*(c){const f=new DataView(yield c.arrayBuffer());if(2303741511===f.getUint32(0)&&218765834===f.getUint32(4)){if(-1===[4,6].indexOf(f.getUint8(25)))return!1;const W=Object.assign(new Image,{src:yield P(c)});yield new Promise(w=>W.addEventListener("load",()=>w(!0)));const m=Object.assign(document.createElement("canvas"),{width:W.width,height:W.height}).getContext("2d");if(!m)return!1;m.imageSmoothingEnabled=!1,m.drawImage(W,0,0);const g=m?.getImageData(0,0,W.width,W.height);if(g)for(let w=0;w<g.data.length;w+=4)if(g.data[w+3]<255)return!0}return!1})).apply(this,arguments)}function o(c){return c.map(f=>({name:f.name,ext:f.ext,type:I.VC.FILE,url:f.url,embedUrl:f.embedUrl,isImage:f.isImage}))}function O(c,f=[]){return["png","apng","jpeg","jpg","jpe","gif","svg","webp"].includes(c)&&!f.includes(c)}function u(c){return O(c,["gif","svg"])}function M(c,f,S,W=[],m=""){let g={...e.xt};const w=c.trim();g.invalidLength=0===w.length;const K=(w+m).replace(/\s{2,}/g," ");return g.alreadyUsed=f!==w&&W.includes(K),g.invalidStartOrEnd=/(^(\s|\.))|((\s|\.)$)/.test(c),g.invalidCharacter=!(S===I.VC.FILE?e.Mi.test(c):e.er.test(c)),g}},3612:(Y,F,t)=>{"use strict";t.d(F,{q:()=>f});var h=t(5861),I=t(8896),e=t(6730),U=t.n(e),L=t(9969),l=t(3848),P=t(529),r=t(7579),b=t(7445),T=t(2722),o=t(6986);class O{static findApp1Marker(W){const m=new DataView(W),g=new Set([65498,65497,65476,65474,65472,65499,65501]);for(let w=0;w<W.byteLength-2;w+=2){const K=m.getUint16(w);if(65505===K)return{offset:w,size:m.getUint16(w+2),little:18761==m.getUint16(w+8,!1)};if(g.has(K))break}}static stripAndReturnExif(W){return(0,h.Z)(function*(){const m=yield W.arrayBuffer(),g=O.findApp1Marker(m);return g?{file:new File([m.slice(0,g.offset),m.slice(g.offset+g.size+2)],W.name,{type:W.type,lastModified:W.lastModified}),exif:m.slice(g.offset,g.offset+g.size)}:{file:W}})()}static checkImageOrientation(W){const m=new DataView(W);if(1165519206!=m.getUint32(4,!1))return-1;const g=18761==m.getUint16(10,!1);let w=10;w+=m.getUint32(w+4,g);const K=m.getUint16(w,g);w+=2;for(let _=0;_<K;_++)if(274==m.getUint16(w+12*_,g))return m.getUint16(w+12*_+8,g);return-1}}var u=t(4650),M=t(146),c=t(2020);let f=(()=>{class S{constructor(m,g,w){this.http=m,this.uploadObservablesService=g,this.loadImageService=w,this.requestSubscriptions=[],this.uploaderOptionsObject={compress:!0,openLinkModalAfterUpload:!1}}get uploaderOptions(){return{...this.uploaderOptionsObject}}set uploaderOptions(m){this.uploaderOptionsObject={...m}}compressFileIfNeeded(m,g){return(0,h.Z)(function*(){let w=["image/png","image/jpeg"],K={strict:!0,checkOrientation:!0,quality:.8,convertSize:1};g&&(w.push("image/webp"),K.width=g.width,K.height=g.height,K.resize="cover",K.strict=!1);const _=m.type.toLowerCase();return m.size<=4e6&&void 0===g||-1===w.indexOf(m.type.toLowerCase())?m:("image/png"===_&&(yield(0,l.JN)(m))&&(K.convertSize=1/0),new Promise((E,R)=>{new(U())(m,{...K,success:A=>{const Q=A instanceof Blob?new File([A],m.name,{type:m.type,lastModified:m.lastModified}):m;E(Q)},error:R})}))})()}orientFileIfNeeded(m){var g=this;return(0,h.Z)(function*(){if(-1===["image/jpeg"].indexOf(m.type.toLowerCase()))return m;const K=yield O.stripAndReturnExif(m);if(m=K.file,K.exif){const _=O.checkImageOrientation(K.exif);if(1!==_){let E=0;switch(_){case 3:case 4:E=180;break;case 5:case 6:E=90;break;case 7:case 8:E=270}const R=yield(0,l.sT)(m),A=yield new Promise((G,J)=>{const q=new Image;q.onload=()=>G({originalImage:q,originalBase64:R}),q.onerror=J,q.src=R}),Q=yield g.loadImageService.transformLoadedImage({original:{base64:A.originalBase64,image:A.originalImage,size:{width:A.originalImage.naturalWidth,height:A.originalImage.naturalHeight}},exifTransform:{flip:[2,4,5,7].includes(_),rotate:E/90}},new L.R);m=new File([(0,I.L)(Q.transformed.base64)],m.name,{type:m.type,lastModified:Date.now()})}}return m})()}upload(m,g,w,K=!1){const _=new r.x,E=new FormData;E.append("payload",w),E.append("upload",m,m.name),K&&E.append("allowOverwrite","1");const R=this.http.request(new P.aW("POST",o.C7,E,{reportProgress:!0,responseType:"json"}));return this.requestSubscriptions.push(R.subscribe({next:A=>{if(A.type===P.dt.UploadProgress){if(!A.total||(g.progress=Math.round(50*A.loaded/A.total)+20,g.progress<70))return;(0,b.F)(1e3).pipe((0,T.R)(_.asObservable())).subscribe(()=>{if(g.progress<95){const Q=Math.round(8*Math.random()+8);g.progress+Q>95?g.progress=95:g.progress+=Q}})}else if(A instanceof P.Zn){if(g.progress=100,g.completed=!0,A.body?.error||!A.body?.success)g.error=!0,this.uploadObservablesService.pushUploadingFileError(g);else{g.file.url=A.body.success.url,g.file.time=Date.now(),g.file.embedUrl=`${g.file.url}?t=${g.file.time}`;const Q=(0,l.Tb)(g.file.url);g.file.name=Q.name,g.file.filename=Q.filename}_.next(),_.complete()}},error:()=>{g.error=!0,this.uploadObservablesService.pushUploadingFileError(g),_.next(),_.complete()}})),_.asObservable()}clearPendingRequests(){for(const m of this.requestSubscriptions)m.unsubscribe();this.requestSubscriptions=[]}}return S.\u0275fac=function(m){return new(m||S)(u.LFG(P.eN),u.LFG(M.r),u.LFG(c.y))},S.\u0275prov=u.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})()},6730:function(Y){Y.exports=function(){"use strict";function F(y,n){var s=Object.keys(y);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(y);n&&(d=d.filter(function(B){return Object.getOwnPropertyDescriptor(y,B).enumerable})),s.push.apply(s,d)}return s}function t(y){for(var n=1;n<arguments.length;n++){var s=null!=arguments[n]?arguments[n]:{};n%2?F(Object(s),!0).forEach(function(d){U(y,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(s)):F(Object(s)).forEach(function(d){Object.defineProperty(y,d,Object.getOwnPropertyDescriptor(s,d))})}return y}function I(y,n){for(var s=0;s<n.length;s++){var d=n[s];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(y,d.key,d)}}function U(y,n,s){return n in y?Object.defineProperty(y,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):y[n]=s,y}function L(){return L=Object.assign||function(y){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(y[d]=s[d])}return y},L.apply(this,arguments)}var y,n,s,d,B,C,H,z,l={exports:{}};y=l,typeof window>"u"||(n=window,s=n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype,d=n.Blob&&function(){try{return Boolean(new Blob)}catch{return!1}}(),B=d&&n.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch{return!1}}(),C=n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder,H=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,z=(d||C)&&n.atob&&n.ArrayBuffer&&n.Uint8Array&&function(j){var p,D,a,v,i,x,$,Z,ee;if(!(p=j.match(H)))throw new Error("invalid data URI");for(D=p[2]?p[1]:"text/plain"+(p[3]||";charset=US-ASCII"),a=!!p[4],v=j.slice(p[0].length),i=a?atob(v):decodeURIComponent(v),x=new ArrayBuffer(i.length),$=new Uint8Array(x),Z=0;Z<i.length;Z+=1)$[Z]=i.charCodeAt(Z);return d?new Blob([B?$:x],{type:D}):((ee=new C).append(x),ee.getBlob(D))},n.HTMLCanvasElement&&!s.toBlob&&(s.mozGetAsFile?s.toBlob=function(j,p,D){var a=this;setTimeout(function(){j(D&&s.toDataURL&&z?z(a.toDataURL(p,D)):a.mozGetAsFile("blob",p))})}:s.toDataURL&&z&&(s.toBlob=s.msToBlob?function(j,p,D){var a=this;setTimeout(function(){j((p&&"image/png"!==p||D)&&s.toDataURL&&z?z(a.toDataURL(p,D)):a.msToBlob(p))})}:function(j,p,D){var a=this;setTimeout(function(){j(z(a.toDataURL(p,D)))})})),y.exports?y.exports=z:n.dataURLtoBlob=z);var P=l.exports,b={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},o=typeof window<"u"&&typeof window.document<"u"?window:{},O=function(n){return n>0&&n<1/0},u=Array.prototype.slice;function M(y){return Array.from?Array.from(y):u.call(y)}var c=/^image\/.+$/;function f(y){return c.test(y)}var W=String.fromCharCode;var g=o.btoa;function K(y){var s,n=new DataView(y);try{var d,B,C;if(255===n.getUint8(0)&&216===n.getUint8(1))for(var H=n.byteLength,z=2;z+1<H;){if(255===n.getUint8(z)&&225===n.getUint8(z+1)){B=z;break}z+=1}if(B){var p=B+10;if("Exif"===function m(y,n,s){var B,d="";for(s+=n,B=n;B<s;B+=1)d+=W(y.getUint8(B));return d}(n,B+4,4)){var D=n.getUint16(p);if(((d=18761===D)||19789===D)&&42===n.getUint16(p+2,d)){var a=n.getUint32(p+4,d);a>=8&&(C=p+a)}}}if(C){var i,x,v=n.getUint16(C,d);for(x=0;x<v;x+=1)if(274===n.getUint16(i=C+12*x+2,d)){s=n.getUint16(i+=8,d),n.setUint16(i,1,d);break}}}catch{s=1}return s}var E=/\.\d*(?:0|9){12}\d*$/;function R(y){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return E.test(y)?Math.round(y*n)/n:y}function A(y){var n=y.aspectRatio,s=y.height,d=y.width,B=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",C=O(d),H=O(s);if(C&&H){var z=s*n;("contain"===B||"none"===B)&&z>d||"cover"===B&&z<d?s=d/n:d=s*n}else C?s=d/n:H&&(d=s*n);return{width:d,height:s}}var Q=o.ArrayBuffer,G=o.FileReader,J=o.URL||o.webkitURL,q=/\.\w+$/,te=o.Compressor;return function(){function y(n,s){(function h(y,n){if(!(y instanceof n))throw new TypeError("Cannot call a class as a function")})(this,y),this.file=n,this.image=new Image,this.options=t(t({},b),s),this.aborted=!1,this.result=null,this.init()}return function e(y,n,s){return n&&I(y.prototype,n),s&&I(y,s),y}(y,[{key:"init",value:function(){var s=this,d=this.file,B=this.options;if(function(n){return!(typeof Blob>"u")&&(n instanceof Blob||"[object Blob]"===Object.prototype.toString.call(n))}(d)){var C=d.type;if(f(C))if(J&&G)if(Q||(B.checkOrientation=!1),J&&!B.checkOrientation)this.load({url:J.createObjectURL(d)});else{var H=new G,z=B.checkOrientation&&"image/jpeg"===C;this.reader=H,H.onload=function(j){var D=j.target.result,a={};if(z){var v=K(D);v>1||!J?(a.url=function w(y,n){for(var s=[],B=new Uint8Array(y);B.length>0;)s.push(W.apply(null,M(B.subarray(0,8192)))),B=B.subarray(8192);return"data:".concat(n,";base64,").concat(g(s.join("")))}(D,C),v>1&&L(a,function _(y){var n=0,s=1,d=1;switch(y){case 2:s=-1;break;case 3:n=-180;break;case 4:d=-1;break;case 5:n=90,d=-1;break;case 6:n=90;break;case 7:n=90,s=-1;break;case 8:n=-90}return{rotate:n,scaleX:s,scaleY:d}}(v))):a.url=J.createObjectURL(d)}else a.url=D;s.load(a)},H.onabort=function(){s.fail(new Error("Aborted to read the image with FileReader."))},H.onerror=function(){s.fail(new Error("Failed to read the image with FileReader."))},H.onloadend=function(){s.reader=null},z?H.readAsArrayBuffer(d):H.readAsDataURL(d)}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(s){var d=this,B=this.file,C=this.image;C.onload=function(){d.draw(t(t({},s),{},{naturalWidth:C.naturalWidth,naturalHeight:C.naturalHeight}))},C.onabort=function(){d.fail(new Error("Aborted to load the image."))},C.onerror=function(){d.fail(new Error("Failed to load the image."))},o.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(o.navigator.userAgent)&&(C.crossOrigin="anonymous"),C.alt=B.name,C.src=s.url}},{key:"draw",value:function(s){var d=this,B=s.naturalWidth,C=s.naturalHeight,H=s.rotate,z=void 0===H?0:H,j=s.scaleX,p=void 0===j?1:j,D=s.scaleY,a=void 0===D?1:D,v=this.file,i=this.image,x=this.options,$=document.createElement("canvas"),Z=$.getContext("2d"),ee=Math.abs(z)%180==90,re=("contain"===x.resize||"cover"===x.resize)&&O(x.width)&&O(x.height),oe=Math.max(x.maxWidth,0)||1/0,ie=Math.max(x.maxHeight,0)||1/0,k=Math.max(x.minWidth,0)||0,N=Math.max(x.minHeight,0)||0,ne=B/C,V=x.width,X=x.height;if(ee){var ue=[ie,oe];oe=ue[0],ie=ue[1];var de=[N,k];k=de[0],N=de[1];var pe=[X,V];V=pe[0],X=pe[1]}re&&(ne=V/X);var he=A({aspectRatio:ne,width:oe,height:ie},"contain");oe=he.width,ie=he.height;var fe=A({aspectRatio:ne,width:k,height:N},"cover");if(k=fe.width,N=fe.height,re){var ge=A({aspectRatio:ne,width:V,height:X},x.resize);V=ge.width,X=ge.height}else{var me=A({aspectRatio:ne,width:V,height:X}),ve=me.width;V=void 0===ve?B:ve;var _e=me.height;X=void 0===_e?C:_e}var Ue=-(V=Math.floor(R(Math.min(Math.max(V,k),oe))))/2,Me=-(X=Math.floor(R(Math.min(Math.max(X,N),ie))))/2,Ie=V,we=X,se=[];if(re){var le,ce,Ae=A({aspectRatio:ne,width:B,height:C},{contain:"cover",cover:"contain"}[x.resize]);se.push((B-(le=Ae.width))/2,(C-(ce=Ae.height))/2,le,ce)}if(se.push(Ue,Me,Ie,we),ee){var ye=[X,V];V=ye[0],X=ye[1]}$.width=V,$.height=X,f(x.mimeType)||(x.mimeType=v.type);var xe="transparent";if(v.size>x.convertSize&&x.convertTypes.indexOf(x.mimeType)>=0&&(x.mimeType="image/jpeg"),"image/jpeg"===x.mimeType&&(xe="#fff"),Z.fillStyle=xe,Z.fillRect(0,0,V,X),x.beforeDraw&&x.beforeDraw.call(this,Z,$),!this.aborted&&(Z.save(),Z.translate(V/2,X/2),Z.rotate(z*Math.PI/180),Z.scale(p,a),Z.drawImage.apply(Z,[i].concat(se)),Z.restore(),x.drew&&x.drew.call(this,Z,$),!this.aborted)){var Oe=function(Ce){d.aborted||d.done({naturalWidth:B,naturalHeight:C,result:Ce})};$.toBlob?$.toBlob(Oe,x.mimeType,x.quality):Oe(P($.toDataURL(x.mimeType,x.quality)))}}},{key:"done",value:function(s){var d=s.naturalWidth,B=s.naturalHeight,C=s.result,H=this.file,j=this.options;if(J&&!j.checkOrientation&&J.revokeObjectURL(this.image.src),C)if(j.strict&&C.size>H.size&&j.mimeType===H.type&&!(j.width>d||j.height>B||j.minWidth>d||j.minHeight>B||j.maxWidth<d||j.maxHeight<B))C=H;else{var p=new Date;C.lastModified=p.getTime(),C.lastModifiedDate=p,C.name=H.name,C.name&&C.type!==H.type&&(C.name=C.name.replace(q,function S(y){var n=f(y)?y.substr(6):"";return"jpeg"===n&&(n="jpg"),".".concat(n)}(C.type)))}else C=H;this.result=C,j.success&&j.success.call(this,C)}},{key:"fail",value:function(s){var d=this.options;if(!d.error)throw s;d.error.call(this,s)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=te,y}},{key:"setDefaults",value:function(s){L(b,s)}}]),y}()}()},7445:(Y,F,t)=>{"use strict";t.d(F,{F:()=>e});var h=t(4986),I=t(5963);function e(U=0,L=h.z){return U<0&&(U=0),(0,I.H)(U,U,L)}},1042:(Y,F,t)=>{"use strict";t.d(F,{Z:()=>O});var h,I=new Uint8Array(16);function e(){if(!h&&!(h=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(I)}const U=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,l=function L(u){return"string"==typeof u&&U.test(u)};for(var P=[],r=0;r<256;++r)P.push((r+256).toString(16).substr(1));const O=function o(u,M,c){var f=(u=u||{}).random||(u.rng||e)();if(f[6]=15&f[6]|64,f[8]=63&f[8]|128,M){c=c||0;for(var S=0;S<16;++S)M[c+S]=f[S];return M}return function b(u){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=(P[u[M+0]]+P[u[M+1]]+P[u[M+2]]+P[u[M+3]]+"-"+P[u[M+4]]+P[u[M+5]]+"-"+P[u[M+6]]+P[u[M+7]]+"-"+P[u[M+8]]+P[u[M+9]]+"-"+P[u[M+10]]+P[u[M+11]]+P[u[M+12]]+P[u[M+13]]+P[u[M+14]]+P[u[M+15]]).toLowerCase();if(!l(c))throw TypeError("Stringified UUID is invalid");return c}(f)}}}]);