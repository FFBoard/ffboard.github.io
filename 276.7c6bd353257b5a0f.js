"use strict";(self.webpackChunkboard=self.webpackChunkboard||[]).push([[276],{276:(j,u,i)=>{i.r(u),i.d(u,{UploadModule:()=>G});var h=i(8694),c=i(6895),C=i(6818),g=i(651),v=i(1048);const F=[{size:0,selected:!0,text:"Default"},{size:800,selected:!1,text:""},{size:600,selected:!1,text:""},{size:400,selected:!1,text:""},{size:200,selected:!1,text:""},{size:100,selected:!1,text:""}].map(o=>(o.size&&(o.text=`${o.size}px`),o));var x=i(1460),b=i(4323),e=i(4650),f=i(3207),O=i(146),T=i(3612),M=i(2636),P=i(7693),y=i(1891);let m=(()=>{class o{constructor(){this.selected=!1,this.value="",this.text="",this.classes=["p-2"],this.clickEvent=new e.vpe}ngOnInit(){}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-collapse-button"]],inputs:{selected:"selected",value:"value",text:"text",classes:"classes"},outputs:{clickEvent:"clickEvent"},decls:1,vars:4,consts:[["role","button",1,"rounded","text-reset","m-1","d-block",3,"ngClass","innerHTML","click"]],template:function(n,t){1&n&&(e.TgZ(0,"a",0),e.NdJ("click",function(){return t.clickEvent.emit(t.value)}),e.qZA()),2&n&&(e.ekj("selected",t.selected),e.Q6J("ngClass",t.classes)("innerHTML",t.text,e.oJD))},dependencies:[c.mk],styles:["a[_ngcontent-%COMP%]{transition:background-color .2s;-webkit-user-select:none;user-select:none}a.selected[_ngcontent-%COMP%]{background-color:#dae0ff}"]}),o})();var d=i(5861),Z=i(4029),k=i(8212);function E(o,s){1&o&&e._UZ(0,"app-loader",2),2&o&&e.Q6J("onlyMessage",!0)}function U(o,s){1&o&&(e.TgZ(0,"div",7)(1,"p",8),e._uU(2,"Nessuna cartella"),e.qZA(),e.TgZ(3,"p",9),e._uU(4,"Visita il "),e.TgZ(5,"a",10),e._uU(6,"portale"),e.qZA(),e._uU(7," per crearne una "),e.qZA()())}const J=function(){return["fst-italic","p-1"]};function S(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"li")(1,"app-collapse-button",14),e.NdJ("clickEvent",function(l){e.CHM(n);const a=e.oxw(3);return e.KtG(a.folderClickEvent(l))}),e.qZA()()}2&o&&(e.xp6(1),e.Q6J("classes",e.DdM(1,J)))}const A=function(){return["p-1"]};function z(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"li")(1,"app-collapse-button",15),e.NdJ("clickEvent",function(l){e.CHM(n);const a=e.oxw(3);return e.KtG(a.folderClickEvent(l))}),e.qZA()()}if(2&o){const n=s.$implicit;e.xp6(1),e.Q6J("classes",e.DdM(3,A))("text",n.name)("value",n.name)}}function B(o,s){if(1&o&&(e.TgZ(0,"ul",11),e.YNc(1,S,2,2,"li",12),e.YNc(2,z,2,4,"li",13),e.qZA()),2&o){const n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",n.depth),e.xp6(1),e.Q6J("ngForOf",n.folders)}}function I(o,s){if(1&o&&(e.TgZ(0,"div",3),e._uU(1,"Percorso attuale: "),e._UZ(2,"em",4),e.ALo(3,"arrayJoin"),e.qZA(),e.YNc(4,U,8,0,"div",5),e.YNc(5,B,3,2,"ng-template",null,6,e.W1O)),2&o){const n=e.MAs(6),t=e.oxw();e.xp6(2),e.Q6J("innerText",t.currentFolderPath.length?e.xi3(3,3,t.currentFolderPath,"/"):"root"),e.xp6(2),e.Q6J("ngIf",0===t.folders.length&&0===t.depth)("ngIfElse",n)}}let L=(()=>{class o{constructor(n){this.uploadService=n,this.currentFolderPath=[],this.firstOpened=!1,this.clickEvent=new e.vpe,this.loading=!0,this.folders=[],this.depth=0}ngOnInit(){this.depth=this.currentFolderPath.length}ngOnChanges(n){var t=this;return(0,d.Z)(function*(){n.firstOpened&&!n.firstOpened.firstChange&&t.firstOpened&&(t.folders=(yield t.uploadService.getFileList(t.currentFolderPath)).folders,t.loading=!1)})()}folderClickEvent(n){var t=this;return(0,d.Z)(function*(){let l=n.length?[...t.currentFolderPath,n]:t.currentFolderPath.slice(0,-1);t.clickEvent.emit(l),yield t.getFolders(l)})()}getFolders(n){var t=this;return(0,d.Z)(function*(){if(t.loading)return;t.loading=!0,t.depth=n.length;const l=yield t.uploadService.getFileList(n);t.folders=l.folders,t.loading=!1})()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(f.C))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-folder-list"]],inputs:{currentFolderPath:"currentFolderPath",firstOpened:"firstOpened"},outputs:{clickEvent:"clickEvent"},features:[e.TTD],decls:3,vars:2,consts:[["message","Recupero cartelle","class","d-block py-2",3,"onlyMessage",4,"ngIf","ngIfElse"],["content",""],["message","Recupero cartelle",1,"d-block","py-2",3,"onlyMessage"],[1,"small","text-center","mt-3","mb-2","text-muted"],[1,"text-break","text-primary",3,"innerText"],["class","alert alert-primary mb-0 p-2",4,"ngIf","ngIfElse"],["list",""],[1,"alert","alert-primary","mb-0","p-2"],[1,"text-center","fw-bold","mb-0"],[1,"text-center","small","mb-0"],["href","https://easy-innovation.github.io/upload","target","_blank",1,"fw-bold"],[1,"list-unstyled","mb-0","d-flex","flex-wrap","small","justify-content-center"],[4,"ngIf"],[4,"ngFor","ngForOf"],["text","Indietro","value","",3,"classes","clickEvent"],[3,"classes","text","value","clickEvent"]],template:function(n,t){if(1&n&&(e.YNc(0,E,1,1,"app-loader",0),e.YNc(1,I,7,6,"ng-template",null,1,e.W1O)),2&n){const l=e.MAs(2);e.Q6J("ngIf",t.loading)("ngIfElse",l)}},dependencies:[c.sg,c.O5,Z.R,m,k.J]}),o})();function N(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"li")(1,"app-collapse-button",15),e.NdJ("clickEvent",function(l){e.CHM(n);const a=e.oxw();return e.KtG(a.selectDimension(l))}),e.qZA()()}if(2&o){const n=s.$implicit;e.xp6(1),e.Q6J("text",n.text)("selected",n.selected)("value",n.size)}}const Q=function(o,s){return{"touch-device":o,uploading:s}},_=function(o){return{expanded:o}};let w=(()=>{class o{constructor(n,t,l,a,r){this.uploadService=n,this.uploadObservablesService=t,this.uploaderService=l,this.loadingBarService=a,this.postMessageService=r,this.touchDevice=x.eX,this.isSizeCollapsed=!0,this.isSizeButtonExpanded=!1,this.isFolderCollapsed=!0,this.isFolderButtonExpanded=!1,this.isFolderButtonFirstClicked=!0,this.dimensions=F,this.currentFolderPath=[],this.isUploading=!1,this.loadingBarService.useRef("http").disable()}ngOnInit(){this.uploadService.setGqlIdHeader(),this.currentFolderPath=this.uploadService.preferences.lastFolderPath,this.uploadingSubscription=this.uploadObservablesService.uploadingFileQueueObservable.subscribe(n=>{this.isUploading=n.length>0})}toggleCollapse(n,t,l){if(l)return void n.toggle();const a=t.hidden.subscribe(()=>{a.unsubscribe(),n.toggle()});t.toggle()}selectDimension(n){for(const l of this.dimensions)l.selected=l.size===n;const t=this.uploaderService.uploaderOptions;n?(t.compress=!0,t.imageDimensions={width:n}):delete t.imageDimensions,this.uploaderService.uploaderOptions=t}setFolderPath(n){this.currentFolderPath=[...n],this.postMessageService.send(b.l.UPLOAD_NAVIGATION,{paths:n})}closeAllCollapse(){this.isFolderCollapsed=this.isSizeCollapsed=!0}ngOnDestroy(){this.uploadingSubscription?.unsubscribe(),this.uploadService.removeGqlIdHeader()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(f.C),e.Y36(O.r),e.Y36(T.q),e.Y36(M.dL),e.Y36(P.F))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:24,vars:20,consts:[[1,"flex-grow-1","rounded-0","position-relative","w-cont","mw-100","d-flex","flex-column",3,"ngClass"],[1,"d-flex","buttons","align-items-stretch","justify-content-center","overflow-hidden","small"],["href","https://easy-innovation.github.io/upload","target","_blank"],[1,"long"],[1,"short"],[1,"border-start","border-end",3,"ngClass","click"],[3,"ngClass","click"],[1,"c-collapse","position-absolute","w-100","bg-white","border-bottom",3,"ngbCollapse","ngbCollapseChange","shown","hidden"],["sizeCollapse","ngbCollapse"],[1,"px-2","py-1","border-top","c-content"],[1,"list-unstyled","mb-0","d-flex","flex-wrap","small","justify-content-center"],[4,"ngFor","ngForOf"],["folderCollapse","ngbCollapse"],[3,"currentFolderPath","firstOpened","clickEvent"],[1,"d-flex","align-items-stretch","flex-grow-1",3,"loading","isWidget","currentFolderPath","click"],[3,"text","selected","value","clickEvent"]],template:function(n,t){if(1&n){const l=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"a",2)(3,"span",3),e._uU(4,"Gestione file"),e.qZA(),e.TgZ(5,"span",4),e._uU(6,"Immagini"),e.qZA()(),e.TgZ(7,"div",5),e.NdJ("click",function(){e.CHM(l);const r=e.MAs(15),p=e.MAs(20);return e.KtG(t.toggleCollapse(r,p,t.isFolderCollapsed))}),e._uU(8,"Dimensioni"),e.qZA(),e.TgZ(9,"div",6),e.NdJ("click",function(){e.CHM(l);const r=e.MAs(20),p=e.MAs(15);return t.isFolderButtonFirstClicked=!1,e.KtG(t.toggleCollapse(r,p,t.isSizeCollapsed))}),e.TgZ(10,"span",3),e._uU(11,"Seleziona cartella"),e.qZA(),e.TgZ(12,"span",4),e._uU(13,"Cartella"),e.qZA()()(),e.TgZ(14,"div",7,8),e.NdJ("ngbCollapseChange",function(r){return t.isSizeCollapsed=r})("shown",function(){return t.isSizeButtonExpanded=!0})("hidden",function(){return t.isSizeButtonExpanded=!1}),e.TgZ(16,"div",9)(17,"ul",10),e.YNc(18,N,2,3,"li",11),e.qZA()()(),e.TgZ(19,"div",7,12),e.NdJ("ngbCollapseChange",function(r){return t.isFolderCollapsed=r})("shown",function(){return t.isFolderButtonExpanded=!0})("hidden",function(){return t.isFolderButtonExpanded=!1}),e.TgZ(21,"div",9)(22,"app-folder-list",13),e.NdJ("clickEvent",function(r){return t.setFolderPath(r)}),e.qZA()()(),e.TgZ(23,"app-uploader",14),e.NdJ("click",function(){return t.closeAllCollapse()}),e.qZA()()}2&n&&(e.Q6J("ngClass",e.WLB(13,Q,t.touchDevice,t.isUploading)),e.xp6(7),e.Q6J("ngClass",e.VKq(16,_,!t.isSizeCollapsed||t.isSizeButtonExpanded)),e.uIk("aria-expanded",!t.isSizeCollapsed),e.xp6(2),e.Q6J("ngClass",e.VKq(18,_,!t.isFolderCollapsed||t.isFolderButtonExpanded)),e.uIk("aria-expanded",!t.isFolderCollapsed),e.xp6(5),e.Q6J("ngbCollapse",t.isSizeCollapsed),e.xp6(4),e.Q6J("ngForOf",t.dimensions),e.xp6(1),e.Q6J("ngbCollapse",t.isFolderCollapsed),e.xp6(3),e.Q6J("currentFolderPath",t.currentFolderPath)("firstOpened",!t.isFolderButtonFirstClicked),e.xp6(1),e.Q6J("loading",!1)("isWidget",!0)("currentFolderPath",t.currentFolderPath))},dependencies:[c.mk,c.sg,g._D,y.B,m,L],styles:["[_nghost-%COMP%]{display:flex;align-items:flex-start;justify-content:center;background:#fff}[_nghost-%COMP%], .w-cont[_ngcontent-%COMP%]{min-height:100vh}.uploading[_ngcontent-%COMP%], .uploading[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{pointer-events:none!important}.buttons[_ngcontent-%COMP%]{height:40px}.buttons[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1 1 0;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:color .2s;color:var(--bs-gray-600)}.buttons[_ngcontent-%COMP%]   .expanded[_ngcontent-%COMP%]{background:#fff;z-index:2;color:inherit}.w-cont[_ngcontent-%COMP%]:not(.touch-device)   .buttons[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:hover{color:inherit}.c-collapse[_ngcontent-%COMP%]{top:39px;left:0;z-index:1;max-height:calc(100% - 50px)}.c-collapse.collapsing[_ngcontent-%COMP%], .c-collapse.show[_ngcontent-%COMP%]{display:flex;flex-direction:column}.c-collapse[_ngcontent-%COMP%]:not(.collapsing)   .c-content[_ngcontent-%COMP%]{overflow-y:auto}.c-collapse.collapsing[_ngcontent-%COMP%]   .c-content[_ngcontent-%COMP%]{overflow:hidden}.long[_ngcontent-%COMP%]{display:none}@media (min-width: 400px){.short[_ngcontent-%COMP%]{display:none}.long[_ngcontent-%COMP%]{display:inline}}"]}),o})();var D=i(1197);const Y=[{path:"",component:w}];let G=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[h.r,c.ez,C.q,g.lQ,v.Bz.forChild(Y),D.M]}),o})()}}]);