(self.webpackChunkboard=self.webpackChunkboard||[]).push([[969],{9969:($,F,r)=>{"use strict";r.d(F,{R:()=>f});class f{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(e){Object.keys(e).filter(M=>M in this).forEach(M=>this[M]=e[M]),this.validateOptions()}setOptionsFromChanges(e){Object.keys(e).filter(M=>M in this).forEach(M=>this[M]=e[M].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}},2020:($,F,r)=>{"use strict";r.d(F,{y:()=>n});var f=r(5861);var C=r(4650);let n=(()=>{class y{constructor(){this.autoRotateSupported=function e(){return new Promise(y=>{const S=new Image;S.onload=()=>{y(1===S.width&&2===S.height)},S.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(l,x){return new Promise((p,O)=>{const u=new FileReader;u.onload=h=>{this.loadImage(h.target.result,l.type,x).then(p).catch(O)},u.readAsDataURL(l)})}loadImage(l,x,p){return this.isValidImageType(x)?this.loadBase64Image(l,p):Promise.reject(new Error("Invalid image type"))}isValidImageType(l){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(l)}loadImageFromURL(l,x){return new Promise((p,O)=>{const u=new Image;u.onerror=()=>O,u.onload=()=>{const h=document.createElement("canvas"),T=h.getContext("2d");h.width=u.width,h.height=u.height,T?.drawImage(u,0,0),this.loadBase64Image(h.toDataURL(),x).then(p)},u.crossOrigin="anonymous",u.src=l})}loadBase64Image(l,x){return new Promise((p,O)=>{const u=new Image;u.onload=()=>p({originalImage:u,originalBase64:l}),u.onerror=O,u.src=l}).then(p=>this.transformImageBase64(p,x))}transformImageBase64(l,x){var p=this;return(0,f.Z)(function*(){const O=yield p.autoRotateSupported,u=yield function M(y){switch("string"==typeof y&&(y=function R(y){const S=new DataView(function d(y){y=y.replace(/^data\:([^\;]+)\;base64,/gim,"");const S=atob(y),l=S.length,x=new Uint8Array(l);for(let p=0;p<l;p++)x[p]=S.charCodeAt(p);return x.buffer}(y));if(65496!==S.getUint16(0,!1))return-2;const l=S.byteLength;let x=2;for(;x<l;){if(S.getUint16(x+2,!1)<=8)return-1;const p=S.getUint16(x,!1);if(x+=2,65505==p){if(1165519206!==S.getUint32(x+=2,!1))return-1;const O=18761==S.getUint16(x+=6,!1);x+=S.getUint32(x+4,O);const u=S.getUint16(x,O);x+=2;for(let h=0;h<u;h++)if(274==S.getUint16(x+12*h,O))return S.getUint16(x+12*h+8,O)}else{if(65280!=(65280&p))break;x+=S.getUint16(x,!1)}}return-1}(y)),y){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(O?-1:l.originalBase64);return l.originalImage&&l.originalImage.complete?p.transformLoadedImage({original:{base64:l.originalBase64,image:l.originalImage,size:{width:l.originalImage.naturalWidth,height:l.originalImage.naturalHeight}},exifTransform:u},x):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(l,x){var p=this;return(0,f.Z)(function*(){const O=x.canvasRotation+l.exifTransform.rotate,u={width:l.original.image.naturalWidth,height:l.original.image.naturalHeight};if(0===O&&!l.exifTransform.flip&&!x.containWithinAspectRatio)return{original:{base64:l.original.base64,image:l.original.image,size:{...u}},transformed:{base64:l.original.base64,image:l.original.image,size:{...u}},exifTransform:l.exifTransform};const h=p.getTransformedSize(u,l.exifTransform,x),T=document.createElement("canvas");T.width=h.width,T.height=h.height;const B=T.getContext("2d");B?.setTransform(l.exifTransform.flip?-1:1,0,0,1,T.width/2,T.height/2),B?.rotate(Math.PI*(O/2)),B?.drawImage(l.original.image,-u.width/2,-u.height/2);const m=T.toDataURL(),g=yield p.loadImageFromBase64(m);return{original:{base64:l.original.base64,image:l.original.image,size:{...u}},transformed:{base64:m,image:g,size:{width:g.width,height:g.height}},exifTransform:l.exifTransform}})()}loadImageFromBase64(l){return new Promise((x,p)=>{const O=new Image;O.onload=()=>x(O),O.onerror=p,O.src=l})}getTransformedSize(l,x,p){const O=p.canvasRotation+x.rotate;if(p.containWithinAspectRatio){if(O%2){const h=l.height/p.aspectRatio;return{width:Math.max(l.height,l.width*p.aspectRatio),height:Math.max(l.width,h)}}{const h=l.width/p.aspectRatio;return{width:Math.max(l.width,l.height*p.aspectRatio),height:Math.max(l.height,h)}}}return O%2?{height:l.width,width:l.height}:{width:l.width,height:l.height}}}return y.\u0275fac=function(l){return new(l||y)},y.\u0275prov=C.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()},8896:($,F,r)=>{"use strict";function f(P){const e=P.split(","),M=e[0].replace("data:","").replace(";base64",""),R=atob(e[1]),d=new ArrayBuffer(R.length),C=new Uint8Array(d);for(let n=0;n<R.length;n+=1)C[n]=R.charCodeAt(n);return new Blob([d],{type:M})}r.d(F,{L:()=>f})},575:($,F,r)=>{"use strict";r.d(F,{In:()=>f,Ky:()=>R,VC:()=>P,c5:()=>M,gG:()=>e});var f=(()=>{return(d=f||(f={})).FILE_SHOW_LINKS="fileLinks",d.FILE_EDIT="fileEdit",d.DELETE="delete",d.RENAME="rename",d.MOVE="move",f;var d})(),P=(()=>{return(d=P||(P={})).FILE="file",d.FOLDER="folder",P;var d})(),e=(()=>{return(d=e||(e={})).FILENAME="filename",d.SIZE="size",d.TIME="time",d.EXTENSION="ext",e;var d})(),M=(()=>{return(d=M||(M={})).GRID="grid",d.LIST="list",M;var d})(),R=(()=>{return(d=R||(R={})).W_768_I_1="(max-width: 767.98px)",d.W_933_I_2="(min-width: 768px) and (max-width: 933.98px)",d.W_960_I_3="(min-width: 934px) and (max-width: 959.98px)",d.W_1226_I_2="(min-width: 960px) and (max-width: 1225.98px)",d.W_1540_I_3="(min-width: 1226px) and (max-width: 1539.98px)",d.W_1854_I_4="(min-width: 1540px) and (max-width: 1853.98px)",d.W_2168_I_5="(min-width: 1854px) and (max-width: 2167.98px)",d.W_2482_I_6="(min-width: 2168px) and (max-width: 2481.98px)",d.W_2796_I_7="(min-width: 2482px) and (max-width: 2795.98px)",d.W_3110_I_8="(min-width: 2796px) and (max-width: 3109.98px)",d.W_3424_I_9="(min-width: 3110px) and (max-width: 3423.98px)",d.W_3738_I_10="(min-width: 3424px)",R;var d})()},6986:($,F,r)=>{"use strict";r.d(F,{C7:()=>M,Mi:()=>R,O8:()=>P,er:()=>d,p0:()=>e,xt:()=>C});var f=r(575);const P=[{ext:["png","apng"],maxSize:15},{ext:["jpeg","jpg","jpe"],maxSize:10},{ext:["gif"],maxSize:15},{ext:["bmp"],maxSize:10},{ext:["webp","webm"],maxSize:10},{ext:["psd","xcf"],maxSize:150},{ext:["svg"],maxSize:30}].map(n=>(n.maxSize*=1048576,n)),e={lastPath:[],layout:{asc:!0,orderBy:f.gG.FILENAME,type:f.c5.GRID},uploader:{checkImage:{time:0,active:!0},showLinkModal:!1}},M="https://upload.forumfree.net/api/",R=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-.\s])*$/,d=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-\s])*$/,C={invalidLength:!1,alreadyUsed:!1,invalidStartOrEnd:!1,invalidCharacter:!1}},8375:($,F,r)=>{"use strict";r.d(F,{B:()=>c});var f=r(5861),P=r(1309),e=r(4650),M=r(4968),R=r(3905),d=r(3848),C=r(1460),n=r(6986),y=r(575),S=r(7320),l=r(146),x=r(3612),p=r(6378),O=r(6895),u=r(433),h=r(4029),T=r(8279),B=r(3450);const m=["fileInput"];function g(t,A){1&t&&(e.O4$(),e.TgZ(0,"svg",25),e._UZ(1,"path",26)(2,"path",27),e.qZA())}const w=function(){return["text-primary"]};function K(t,A){1&t&&e._UZ(0,"app-logo",28),2&t&&e.Q6J("svgClass",e.DdM(2,w))("responsive",!1)}function v(t,A){1&t&&(e.TgZ(0,"span"),e._uU(1,"Trascina i file da caricare oppure c"),e.qZA())}function _(t,A){1&t&&(e.TgZ(0,"span"),e._uU(1,"C"),e.qZA())}const I=function(){return{bottom:0,left:0}};function b(t,A){if(1&t){const i=e.EpF();e.TgZ(0,"a",29),e.NdJ("click",function(){e.CHM(i);const s=e.oxw(2);return e.KtG(s.openInfoModal.emit())}),e._uU(1,"Informazioni"),e.qZA()}2&t&&e.Q6J("ngStyle",e.DdM(1,I))}function Z(t,A){if(1&t){const i=e.EpF();e.TgZ(0,"div",30),e.NdJ("click",function(){e.CHM(i),e.oxw(2);const s=e.MAs(7);return e.KtG(s.open())}),e._uU(1,"settings"),e.qZA()}}const H=function(t,A,i){return{"cursor-pointer":t,"p-4":A,"py-3 mt-1":i}},z=function(t){return{"fw-bold fs-lg":t}},G=function(t,A){return{"my-2":t,"mb-2":A}};function X(t,A){if(1&t){const i=e.EpF();e.ynx(0),e.TgZ(1,"div",15,16),e.NdJ("dragenter",function(){e.CHM(i);const s=e.MAs(2),U=e.oxw();return e.KtG(U.setDragOverEvent(s))})("drop",function(s){e.CHM(i);const U=e.oxw();return e.KtG(U.handleDropEvent(s))})("click",function(){e.CHM(i),e.oxw();const s=e.MAs(2);return e.KtG(s.click())}),e.YNc(3,g,3,0,"svg",17),e.YNc(4,K,1,3,"ng-template",null,18,e.W1O),e.TgZ(6,"div",19),e.YNc(7,v,2,0,"span",20),e.YNc(8,_,2,0,"span",20),e.TgZ(9,"span"),e._uU(10,"licca per scegliere da memoria"),e.qZA()(),e.TgZ(11,"div",21),e._uU(12,"I file verranno caricati nella cartella "),e._UZ(13,"em",22),e.qZA()(),e.YNc(14,b,2,2,"a",23),e.YNc(15,Z,2,0,"div",24),e.BQk()}if(2&t){const i=e.MAs(5),o=e.oxw();e.xp6(1),e.Q6J("ngClass",e.kEZ(10,H,!o.loading,!o.isWidget,o.isWidget)),e.xp6(2),e.Q6J("ngIf",!o.isWidget)("ngIfElse",i),e.xp6(3),e.Q6J("ngClass",e.VKq(14,z,!o.isWidget)),e.xp6(1),e.Q6J("ngIf",!o.touchDevice),e.xp6(1),e.Q6J("ngIf",o.touchDevice),e.xp6(3),e.Q6J("ngClass",e.WLB(16,G,!o.isWidget&&!o.touchDevice,!o.isWidget&&o.touchDevice)),e.xp6(2),e.Q6J("innerText",o.currentFolderPath.length?o.currentFolderPath.join("/"):"root"),e.xp6(1),e.Q6J("ngIf",!o.isWidget),e.xp6(1),e.Q6J("ngIf",!o.isWidget)}}const ee=function(t,A){return{"p-4":t,"pt-2 pb-3":A}};function E(t,A){if(1&t&&(e.TgZ(0,"div",31),e.O4$(),e.TgZ(1,"svg",32),e._UZ(2,"path",33),e.qZA(),e.kcU(),e._UZ(3,"app-loader",34),e.TgZ(4,"div",35),e._uU(5,"Attendi il completamento dell'upload per caricare altre immagini."),e.qZA()()),2&t){const i=e.oxw();e.Q6J("ngClass",e.WLB(3,ee,!i.isWidget,i.isWidget)),e.xp6(3),e.Q6J("onlyMessage",!0)("message",i.loadingMessage)}}const a=function(t,A){return{uploading:t,widget:A}};let c=(()=>{class t{constructor(i,o,s,U,D,W){this.uploadService=i,this.uploadObservablesService=o,this.uploaderService=s,this.toastService=U,this.renderer=D,this.ngZone=W,this.loading=!0,this.currentFolderPath=[],this.isWidget=!1,this.fileUploadedEvent=new e.vpe,this.openInfoModal=new e.vpe,this.isUploading=!1,this.loadingMessage="Controllo dei file in corso",this.touchDevice=C.eX,this.dragOverEvent=!1,this.options=this.uploaderService.uploaderOptions;const j=this.uploadService.preferences.uploader;j.checkImage.active||(this.options.compress=!1),j.showLinkModal&&(this.options.openLinkModalAfterUpload=!0)}ngOnInit(){this.handleClipboardPasteEvent(),this.handleExternalUpload()}handleClipboardPasteEvent(){var i=this;this.clipboardPasteEventSubscription=(0,M.R)(document.body,"paste").subscribe(function(){var o=(0,f.Z)(function*(s){if(!i.canUpload)return;const U=Array.from((s.clipboardData||s.originalEvent.clipboardData).items);let D=[];for(const W of U)if(0===W.type.indexOf("image")){const j=W.getAsFile();j&&D.push(j)}D.length>0?yield i.preUpload(D):i.reset()});return function(s){return o.apply(this,arguments)}}())}handleExternalUpload(){var i=this;this.startExternalUploadSubscription=this.uploadObservablesService.startUploadObservable.subscribe(function(){var o=(0,f.Z)(function*(s){if(s)return i.canUpload?void(yield i.preUpload([s.file],s.options)):void i.reset();i.fileInputRef.nativeElement.click()});return function(s){return o.apply(this,arguments)}}())}handleSelectionEvent(i){var o=this;return(0,f.Z)(function*(){if(!o.canUpload)return;const s=i.target;if(s.files&&s.files.length){const U=Array.from(s.files);return s.value="",o.preUpload(U)}o.reset()})()}handleDropEvent(i){var o=this;return(0,f.Z)(function*(){if(!o.canUpload)return;i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation();const s=i.dataTransfer?.files?Array.from(i.dataTransfer.files):[];if(s.length)return o.preUpload(s);o.reset()})()}saveOptions(i=!0){this.uploaderService.uploaderOptions=this.options,i&&this.savePreferences()}savePreferences(){this.uploadService.preferences.uploader={checkImage:{active:this.options.compress,time:Date.now()},showLinkModal:this.options.openLinkModalAfterUpload}}setDragOverEvent(i){this.dragOverEvent||(this.dragOverEvent=!0,this.ngZone.runOutsideAngular(()=>{this.renderer.listen(i,"dragover",o=>{o.preventDefault()})}))}get canUpload(){return!this.loading&&!this.isUploading&&(this.isUploading=!0,!0)}reset(){this.isUploading=!1,this.loadingMessage="Controllo dei file da caricare",this.options.allowOverwrite=!1,this.saveOptions(!1)}preUpload(i,o){var s=this;return(0,f.Z)(function*(){const U=[...s.currentFolderPath];let D=[],W=[],j=[],N=[];o?o.allowOverwrite=o.allowOverwrite||!1:(o=s.uploaderService.uploaderOptions).allowOverwrite=!1;for(let k=0;k<i.length;k++){let Q=o.compress?yield s.uploaderService.compressFileIfNeeded(i[k],o.imageDimensions):i[k];if(Q=yield s.uploaderService.orientFileIfNeeded(Q),Q){const q=(0,d.Tb)(Q.name),re=n.O8.find(te=>-1!==te.ext.indexOf(q.ext));if(!re){j.push(Q);continue}if(Q.size>re.maxSize){N.push(Q);continue}D.push({file:{name:Q.name,size:Q.size,time:0,url:"",ext:q.ext,filename:q.filename,isImage:(0,d.Or)(q.ext),embedUrl:""},progress:0,completed:!1}),W.push(Q)}}if((j.length||N.length)&&s.toastService.show({content:s.createToastMessage(j,N),level:P.m.ERROR}),0===W.length)return void s.reset();const Y=`Caricamento file {{fileNumber}} di ${W.length} in corso`;s.uploadObservablesService.pushUploadingFileQueue(D);for(let k=0;k<W.length;++k){s.loadingMessage="Creazione del pacchetto da inviare";const Q=yield s.uploadService.getHostToken(U,W[k].name);D[k].progress+=20,s.loadingMessage=Y.replace("{{fileNumber}}",`${k+1}`),yield(0,R.z)(s.uploaderService.upload(W[k],D[k],Q,o.allowOverwrite))}s.uploadObservablesService.pushUploadingFileQueue([]);const L=D.filter(k=>!k.error).map(k=>k.file);L.length>0&&(s.fileUploadedEvent.emit({fileList:L,rewrite:o.allowOverwrite,paths:U}),o.openLinkModalAfterUpload&&s.uploadObservablesService.pushAction({name:y.In.FILE_SHOW_LINKS,payload:{entities:(0,d.jL)(L)}})),s.reset()})()}createToastMessage(i,o){let s=[];return i.length&&s.push(i.length>1?`I file <strong>${i.map(U=>U.name).join(", ")}</strong> hanno un formato non supportato!`:`Il file <strong>${i[0].name}</strong> ha un formato non supportato!`),o.length&&s.push(o.length>1?`I file <strong>${o.map(U=>U.name).join(", ")}</strong> sono troppo pesanti!`:`Il file <strong>${o[0].name}</strong> \xe8 troppo pesante!`),s.join("<br><br>")}ngOnDestroy(){this.startExternalUploadSubscription?.unsubscribe(),this.clipboardPasteEventSubscription.unsubscribe(),this.uploaderService.clearPendingRequests()}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(S.C),e.Y36(l.r),e.Y36(x.q),e.Y36(p.k),e.Y36(e.Qsj),e.Y36(e.R0b))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-uploader"]],viewQuery:function(i,o){if(1&i&&e.Gf(m,5),2&i){let s;e.iGM(s=e.CRH())&&(o.fileInputRef=s.first)}},inputs:{loading:"loading",currentFolderPath:"currentFolderPath",isWidget:"isWidget"},outputs:{fileUploadedEvent:"fileUploadedEvent",openInfoModal:"openInfoModal"},decls:30,vars:10,consts:[[1,"uploader","rounded","h-100","position-relative",3,"ngClass"],["type","file",1,"d-none",3,"multiple","disabled","change"],["fileInput",""],[4,"ngIf","ngIfElse"],["uploading",""],["title","Opzioni di caricamento"],["optionsModal",""],[1,"mb-1"],[1,"mb-3"],[1,"mb-1","list-unstyled"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","speed-upload",1,"form-check-input",3,"ngModel","ngModelChange"],["for","speed-upload",1,"form-check-label","me-auto"],["type","checkbox","role","switch","id","show-link-modal",1,"form-check-input",3,"ngModel","ngModelChange"],["for","show-link-modal",1,"form-check-label","me-auto"],[1,"rounded","upload-area",3,"ngClass","dragenter","drop","click"],["uploadArea",""],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16",4,"ngIf","ngIfElse"],["appLogo",""],[1,"description","text-center",3,"ngClass"],[4,"ngIf"],[1,"small","text-center",3,"ngClass"],[1,"text-break",3,"innerText"],["class","fs-xs fst-italic d-block px-2 py-1 text-reset cursor-pointer position-absolute",3,"ngStyle","click",4,"ngIf"],["class","material-icons-outlined d-block cursor-pointer fs-xl position-absolute options-icon",3,"click",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16"],["fill-rule","evenodd","d","M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"],["d","M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"],["svgSize","xl","subtext","Upload",1,"d-block","mb-3","py-1",3,"svgClass","responsive"],[1,"fs-xs","fst-italic","d-block","px-2","py-1","text-reset","cursor-pointer","position-absolute",3,"ngStyle","click"],[1,"material-icons-outlined","d-block","cursor-pointer","fs-xl","position-absolute","options-icon",3,"click"],[1,"p-4","rounded",3,"ngClass"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","viewBox","0 0 16 16",1,"overflow-visible"],["d","M 4.406 3.342 A 5.53 5.53 0 0 1 8 2 c 2.69 0 4.923 2 5.166 4.579 C 14.758 6.804 16 8.137 16 9.773 C 16 11.569 14.502 13 12.687 13 H 3.781 C 1.708 13 0 11.366 0 9.318 c 0 -1.763 1.266 -3.223 2.942 -3.593 c 0.143 -0.863 0.698 -1.723 1.464 -2.383 z",1,"cloud"],[3,"onlyMessage","message"],[1,"small","text-center"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0)(1,"input",1,2),e.NdJ("change",function(U){return o.handleSelectionEvent(U)}),e.qZA(),e.YNc(3,X,16,19,"ng-container",3),e.YNc(4,E,6,6,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(6,"app-modal",5,6)(8,"p",7),e._uU(9,"Tramite questo modal \xe8 possibile gestire le opzioni di caricamento al momento disponibili:"),e.qZA(),e.TgZ(10,"ul",8)(11,"li")(12,"em"),e._uU(13,"caricamento veloce"),e.qZA(),e._uU(14,": abilitando questa opzione, l'immagine da caricare verr\xe0 adattata per terminare l'operazione di upload nel minor tempo possibile. "),e.qZA(),e.TgZ(15,"li")(16,"em"),e._uU(17,"mostra link dopo l'upload"),e.qZA(),e._uU(18,": abilitando questa opzione, una volta terminato il caricamento verr\xe0 aperto il modal contenente i link utili dei file caricati. "),e.qZA()(),e.TgZ(19,"ul",9)(20,"li")(21,"div",10)(22,"input",11),e.NdJ("ngModelChange",function(U){return o.options.compress=U})("ngModelChange",function(){return o.saveOptions()}),e.qZA(),e.TgZ(23,"label",12),e._uU(24,"Caricamento veloce"),e.qZA()()(),e.TgZ(25,"li")(26,"div",10)(27,"input",13),e.NdJ("ngModelChange",function(U){return o.options.openLinkModalAfterUpload=U})("ngModelChange",function(){return o.saveOptions()}),e.qZA(),e.TgZ(28,"label",14),e._uU(29,"Mostra link dopo l'upload"),e.qZA()()()()()),2&i){const s=e.MAs(5);e.Q6J("ngClass",e.WLB(7,a,o.isUploading,o.isWidget)),e.xp6(1),e.Q6J("multiple",!0)("disabled",o.loading||o.isUploading),e.xp6(2),e.Q6J("ngIf",!o.isUploading)("ngIfElse",s),e.xp6(19),e.Q6J("ngModel",o.options.compress),e.xp6(5),e.Q6J("ngModel",o.options.openLinkModalAfterUpload)}},dependencies:[O.mk,O.O5,O.PC,u.Wl,u.JJ,u.On,h.R,T.R,B.z],styles:[".uploader[_ngcontent-%COMP%]:not(.widget){margin:0 1rem;border:2px dashed #4864FE;box-shadow:0 .125rem .25rem #00000013;color:#2036ad}.uploader[_ngcontent-%COMP%]:not(.widget):not(.uploading)   svg[_ngcontent-%COMP%]{animation:bubble 4s linear infinite}.uploader[_ngcontent-%COMP%]:not(.widget)   .description[_ngcontent-%COMP%]{max-width:400px}.uploader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.options-icon){height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.uploader.uploading[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{fill:none;stroke:#2036ad;stroke-linecap:round;stroke-dasharray:50;stroke-dashoffset:100;animation:draw 3.5s linear infinite}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]{top:5px;right:5px;opacity:.7;transition:opacity .2s}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]:hover{opacity:1}.upload-area[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(app-logo){pointer-events:none}@media (min-width: 768px){.uploader[_ngcontent-%COMP%]{margin:initial}}@keyframes bubble{6%{transform:scale(1.3,.8)}9%{transform:scale(.8,1.3) translateY(-.5rem)}12%{transform:scale(1)}}@keyframes draw{0%{stroke-dashoffset:100}to{stroke-dashoffset:0}}"]}),t})()},1740:($,F,r)=>{"use strict";r.d(F,{M:()=>C});var f=r(6895),P=r(433),e=r(6818),M=r(1043),R=r(582),d=r(4650);let C=(()=>{class n{}return n.\u0275fac=function(S){return new(S||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[f.ez,P.u5,e.q,M.h,R.z]}),n})()},2381:($,F,r)=>{"use strict";r.d(F,{y:()=>R});var f=r(5044),P=r(4650),e=r(5700),M=r(5123);let R=(()=>{class d{constructor(n,y){this.cookieConsentService=n,this.localStorageService=y,this.storage=null}getItem(n){return null===this.storage&&(this.storage=this.data),this.storage[n]}get data(){const n=this.localStorageService.getItem(f.dR.PREFERENCES);if(!n)return{};try{return JSON.parse(n)}catch{return{}}}setItem(n,y){null===this.storage&&(this.storage=this.data),y?this.storage[n]=y:delete this.storage[n],this.cookieConsentService.choice?.preferences&&this.localStorageService.setItem(f.dR.PREFERENCES,JSON.stringify(this.storage))}resetItemsOnProfileChange(){const n=this.getItem(f.Ye.UPLOAD);n&&(n.lastPath=[],this.setItem(f.Ye.UPLOAD,n))}}return d.\u0275fac=function(n){return new(n||d)(P.LFG(e.C),P.LFG(M.n))},d.\u0275prov=P.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},146:($,F,r)=>{"use strict";r.d(F,{r:()=>R});var f=r(7579),P=r(1135),e=r(4650),M=r(8745);let R=(()=>{class d{constructor(n){this.uploadPreferencesService=n,this.selectedFileListArray=[],this.actionSubject=new f.x,this.uploadingFileQueueSubject=new f.x,this.uploadingFileErrorSubject=new f.x,this.currentFolderPathSubject=new f.x,this.layoutOptionsSubject=new f.x,this.renameFileSubject=new f.x,this.entityPendingSubject=new f.x,this.deleteFileSubject=new f.x,this.uploadedFileSubject=new f.x,this.draggedFileListSubject=new f.x,this.startUploadSubject=new f.x,this.selectedFileListSubject=new P.X(this.selectedFileListArray)}get actionObservable(){return this.actionSubject.asObservable()}pushAction(n){this.actionSubject.next(n)}get layoutOptionsObservable(){return this.layoutOptionsSubject.asObservable()}pushLayoutOptions(n){this.uploadPreferencesService.layoutOptions=n,this.layoutOptionsSubject.next(n)}get currentFolderPathObservable(){return this.currentFolderPathSubject.asObservable()}pushCurrentFolderPath(n){this.uploadPreferencesService.lastFolderPath=n,this.currentFolderPathSubject.next(n)}get uploadingFileQueueObservable(){return this.uploadingFileQueueSubject.asObservable()}pushUploadingFileQueue(n){this.uploadingFileQueueSubject.next(n)}get uploadingFileErrorObservable(){return this.uploadingFileErrorSubject.asObservable()}pushUploadingFileError(n){this.uploadingFileErrorSubject.next(n)}get renameFileObservable(){return this.renameFileSubject.asObservable()}pushRenameFile(n){this.renameFileSubject.next(n)}get entityPendingObservable(){return this.entityPendingSubject.asObservable()}pushEntityPending(n){this.entityPendingSubject.next(n)}get deleteFileObservable(){return this.deleteFileSubject.asObservable()}pushDeleteFile(n){this.deleteFileSubject.next(n)}get uploadedFileObservable(){return this.uploadedFileSubject.asObservable()}pushUploadedFile(n){this.uploadedFileSubject.next(n)}get draggedFileListObservable(){return this.draggedFileListSubject.asObservable()}pushDraggedFileList(n){this.draggedFileListSubject.next(n)}get startUploadObservable(){return this.startUploadSubject.asObservable()}pushStartUpload(n){this.startUploadSubject.next(n)}get selectedFileListObservable(){return this.selectedFileListSubject.asObservable()}pushSelectedFile(n){if(Array.isArray(n)||(n=[n]),0===n.length)return void(this.selectedFileListArray.length>0&&(this.selectedFileListArray=[],this.selectedFileListSubject.next(this.selectedFileListArray)));let y=!1;for(const S of n){const l=this.selectedFileListArray.findIndex(x=>x.name===S.name);S.selected?-1===l&&(this.selectedFileListArray.push({name:S.name}),y=!0):l>-1&&(this.selectedFileListArray.splice(l,1),y=!0)}y&&this.selectedFileListSubject.next(this.selectedFileListArray)}}return d.\u0275fac=function(n){return new(n||d)(e.LFG(M.p))},d.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},8745:($,F,r)=>{"use strict";r.d(F,{p:()=>R});var f=r(5044),P=r(6986),e=r(4650),M=r(2381);let R=(()=>{class d{constructor(n){this.preferencesService=n}get preferences(){return this.preferencesService.getItem(f.Ye.UPLOAD)||P.p0}set preferences(n){this.preferencesService.setItem(f.Ye.UPLOAD,n)}get lastFolderPath(){return this.preferences.lastPath||P.p0.lastPath}set lastFolderPath(n){const y=this.preferences;y.lastPath=n,this.preferences=y}get layoutOptions(){const n=P.p0.layout,y=this.preferences.layout;return y&&0===Object.keys(n).filter(S=>!y.hasOwnProperty(S)).length?y:n}set layoutOptions(n){const y=this.preferences;y.layout=n,this.preferences=y}get uploader(){const n=this.preferences.uploader||P.p0.uploader;return!n.checkImage.active&&Date.now()-n.checkImage.time>6048e5&&(n.checkImage.active=!0,this.uploader=n),n.hasOwnProperty("showLinkModal")||(n.showLinkModal=!1),n}set uploader(n){const y=this.preferences;y.uploader=n,this.preferences=y}}return d.\u0275fac=function(n){return new(n||d)(e.LFG(M.y))},d.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},7320:($,F,r)=>{"use strict";r.d(F,{C:()=>g});var f=r(5861),P=r(7824),e=r(3905),M=r(3848),l=r(6986),x=r(1042),p=r(4650),O=r(5395),u=r(575),h=r(3138);let T=(()=>{class w{constructor(v){this.globalsService=v,this.ffuid="",this.cache={},this.profileSubscription=this.globalsService.profileObservable.subscribe(_=>{this.ffuid=_?_.user.ffuid:""})}getItem(v){const _=this.createKey(v);if(this.cache.hasOwnProperty(_))return this.cache[_]}setItem(v,_){this.cache[this.createKey(v)]=_}removeItem(v){const _=this.createKey(v);if(this.cache.hasOwnProperty(_)){if(this.cache[_].folders.length)for(const I of this.cache[_].folders)this.removeItem([...v,I.name]);return delete this.cache[_],!0}return!1}addEntities(v,_,I=u.VC.FILE){const b=this.createKey(v);return!!this.cache.hasOwnProperty(b)&&(Array.isArray(_)||(_=[_]),I===u.VC.FILE?this.cache[b].files.unshift(..._):this.cache[b].folders.unshift(..._),!0)}removeEntities(v,_,I=u.VC.FILE){const b=this.createKey(v);if(!this.cache.hasOwnProperty(b))return!1;const Z=I===u.VC.FILE?"files":"folders";Array.isArray(_)||(_=[_]);let H=!1;for(const z of _){const G=this.cache[b][Z].findIndex(X=>X.name===z);G>-1&&(this.cache[b][Z].splice(G,1),H=!0)}return H}refactorFolderContent(v,_){const I=this.createKey(v);if(!this.cache.hasOwnProperty(I))return!1;_.endsWith("/")||(_+="/");for(const b of this.cache[I].folders)b.url=_+b.name;for(const b of this.cache[I].files)b.url=b.embedUrl=_+b.name,b.time=Date.now();return!0}createKey(v){return`${this.ffuid}/${v.join("/")}`}ngOnDestroy(){this.profileSubscription.unsubscribe()}}return w.\u0275fac=function(v){return new(v||w)(p.LFG(h.d))},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})();var B=r(8745),m=r(529);let g=(()=>{class w{constructor(v,_,I,b){this.graphqlService=v,this.uploadCacheService=_,this.uploadPreferencesService=I,this.http=b}get cache(){return this.uploadCacheService}get preferences(){return this.uploadPreferencesService}setGqlIdHeader(){this.graphqlService.safeSetGlobalHeader(P._.HeaderKeys.UUID,(0,x.Z)())}removeGqlIdHeader(){this.graphqlService.removeGlobalHeader(P._.HeaderKeys.UUID)}getGqlIdHeader(){return this.graphqlService.getGlobalHeader(P._.HeaderKeys.UUID)||""}getFileList(v,_){var I=this;return(0,f.Z)(function*(){const b=I.uploadCacheService.getItem(v);if(b)return b;const Z=(yield I.graphqlService.query({query:"\nquery UploadEntitiesListToken($scope: String, $target: String!) {\n    uploadEntitiesListToken(scope: $scope, target: $target)\n}",variables:{scope:_,target:v.join("/")}})).data.uploadEntitiesListToken,H=yield I.sendRequest(Z),G={files:H.files.map(X=>{const ee=(0,M.Tb)(X.url);return{...X,time:1e3*X.time,filename:ee.filename,ext:ee.ext,isImage:(0,M.Or)(ee.ext),embedUrl:`${X.url}?t=${X.time}`}}),folders:H.folders};return I.uploadCacheService.setItem(v,G),G})()}createDirectory(v,_){var I=this;return(0,f.Z)(function*(){const b=(yield I.graphqlService.mutate({mutation:"\nquery UploadEntitiesCreateDirectoryToken($scope: String, $target: String!) {\n    uploadEntitiesCreateDirectoryToken(scope: $scope, target: $target)\n}",variables:{scope:_,target:v.join("/")}})).data.uploadEntitiesCreateDirectoryToken;return yield I.sendRequest(b)})()}moveRenameEntity(v,_,I,b,Z){var H=this;return(0,f.Z)(function*(){b||(b=I);const z=(yield H.graphqlService.mutate({mutation:"\nquery UploadEntitiesMoveToken($scope: String, $source: String!, $target: String!) {\n    uploadEntitiesMoveToken(scope: $scope, source: $source, target: $target)\n}",variables:{scope:Z,source:(v.length?`${v.join("/")}/`:"")+I,target:(_.length?`${_.join("/")}/`:"")+b}})).data.uploadEntitiesMoveToken;return yield H.sendRequest(z)})()}deleteEntity(v,_,I){var b=this;return(0,f.Z)(function*(){const Z=(yield b.graphqlService.mutate({mutation:"\nquery UploadEntitiesDeleteToken($scope: String, $target: String!) {\n    uploadEntitiesDeleteToken(scope: $scope, target: $target)\n}",variables:{scope:I,target:(v.length?`${v.join("/")}/`:"")+_}})).data.uploadEntitiesDeleteToken;return yield b.sendRequest(Z),!0})()}getHostToken(v,_,I){var b=this;return(0,f.Z)(function*(){return(yield b.graphqlService.query({query:"\nquery UploadEntitiesHostToken($scope: String, $target: String!) {\n    uploadEntitiesHostToken(scope: $scope, target: $target)\n}",variables:{scope:I,target:(v.length?`${v.join("/")}/`:"")+_}})).data.uploadEntitiesHostToken})()}sendRequest(v){return(0,f.Z)(function*(){const I=yield(yield fetch(l.C7,{method:"POST",referrer:document.URL+"-google",referrerPolicy:"unsafe-url",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:v})})).json();if(I.error&&0!==I.error.trim().length)throw new Error(I.error);return I.success})()}subscribeForChanges(v,_){var I=this;return(0,f.Z)(function*(){return yield I.graphqlService.subscribe({query:"\nsubscription UploadEntities($scope: String) {\n    uploadEntities(scope: $scope) {\n        eventMessage\n        eventType\n        user {\n            avatar\n            host\n            id\n            nickname\n        }\n    }\n}",variables:{scope:_}},b=>{if(!b.data?.uploadEntities)return;const Z=JSON.parse(b.data.uploadEntities.eventMessage);if(!Z.payload.customHeaders||!Z.payload.customHeaders.hasOwnProperty(P._.HeaderKeys.UUID)||Z.payload.customHeaders[P._.HeaderKeys.UUID]===I.getGqlIdHeader())return;const H=(Z.payload.content.source||"").split("/"),z=(Z.payload.content.target||"").split("/"),G=z[z.length-1].indexOf(".")>-1;let X;try{X=JSON.parse(Z.output).success||""}catch{return}v({type:b.data.uploadEntities.eventType,sourceName:H[H.length-1],sourcePaths:H.slice(0,-1),targetName:z[z.length-1],targetPaths:z.slice(0,-1),isFile:G,output:X})})})()}getBlobFromUrl(v){var _=this;return(0,f.Z)(function*(){return yield(0,e.z)(_.http.get(v,{responseType:"blob"})).catch(()=>{})})()}}return w.\u0275fac=function(v){return new(v||w)(p.LFG(O.J),p.LFG(T),p.LFG(B.p),p.LFG(m.eN))},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})()},3848:($,F,r)=>{"use strict";r.d(F,{$H:()=>p,JN:()=>y,Lv:()=>d,Or:()=>x,Tb:()=>M,jL:()=>l,rc:()=>O,sT:()=>C,zO:()=>R});var f=r(5861),P=r(575),e=r(6986);function M(u){let h=u;if(u.indexOf("/")>-1){const g=u.split("/");h=g[g.length-1]}const T=h.split("."),B=T[T.length-1].toLowerCase(),m=decodeURIComponent(T.slice(0,-1).join("."));return{ext:B,filename:m,name:`${m}.${B}`}}function R(u){const h=M(u),T=Date.now();return{name:h.name,size:0,time:T,url:u,ext:h.ext,filename:h.filename,isImage:x(h.ext),embedUrl:`${u}?t=${T}`}}function d(u){let h=u;h.endsWith("/")&&(h=h.slice(0,-1));const T=h.split("/");return{name:decodeURIComponent(T[T.length-1])}}function C(u){return n.apply(this,arguments)}function n(){return(n=(0,f.Z)(function*(u){const h=new FileReader,T=new Promise(B=>h.addEventListener("load",()=>B(h.result)));return h.readAsDataURL(u),T})).apply(this,arguments)}function y(u){return S.apply(this,arguments)}function S(){return(S=(0,f.Z)(function*(u){const h=new DataView(yield u.arrayBuffer());if(2303741511===h.getUint32(0)&&218765834===h.getUint32(4)){if(-1===[4,6].indexOf(h.getUint8(25)))return!1;const B=Object.assign(new Image,{src:yield C(u)});yield new Promise(w=>B.addEventListener("load",()=>w(!0)));const m=Object.assign(document.createElement("canvas"),{width:B.width,height:B.height}).getContext("2d");if(!m)return!1;m.imageSmoothingEnabled=!1,m.drawImage(B,0,0);const g=m?.getImageData(0,0,B.width,B.height);if(g)for(let w=0;w<g.data.length;w+=4)if(g.data[w+3]<255)return!0}return!1})).apply(this,arguments)}function l(u){return u.map(h=>({name:h.name,ext:h.ext,type:P.VC.FILE,url:h.url,embedUrl:h.embedUrl,isImage:h.isImage}))}function x(u,h=[]){return["png","apng","jpeg","jpg","jpe","gif","svg","webp"].includes(u)&&!h.includes(u)}function p(u){return x(u,["gif","svg"])}function O(u,h,T,B=[],m=""){let g={...e.xt};const w=u.trim();g.invalidLength=0===w.length;const K=(w+m).replace(/\s{2,}/g," ");return g.alreadyUsed=h!==w&&B.includes(K),g.invalidStartOrEnd=/(^(\s|\.))|((\s|\.)$)/.test(u),g.invalidCharacter=!(T===P.VC.FILE?e.Mi.test(u):e.er.test(u)),g}},3612:($,F,r)=>{"use strict";r.d(F,{q:()=>h});var f=r(5861),P=r(8896),e=r(6730),M=r.n(e),R=r(9969),d=r(3848),C=r(529),n=r(7579),y=r(7445),S=r(2722),l=r(6986);class x{static findApp1Marker(B){const m=new DataView(B),g=new Set([65498,65497,65476,65474,65472,65499,65501]);for(let w=0;w<B.byteLength-2;w+=2){const K=m.getUint16(w);if(65505===K)return{offset:w,size:m.getUint16(w+2),little:18761==m.getUint16(w+8,!1)};if(g.has(K))break}}static stripAndReturnExif(B){return(0,f.Z)(function*(){const m=yield B.arrayBuffer(),g=x.findApp1Marker(m);return g?{file:new File([m.slice(0,g.offset),m.slice(g.offset+g.size+2)],B.name,{type:B.type,lastModified:B.lastModified}),exif:m.slice(g.offset,g.offset+g.size)}:{file:B}})()}static checkImageOrientation(B){const m=new DataView(B);if(1165519206!=m.getUint32(4,!1))return-1;const g=18761==m.getUint16(10,!1);let w=10;w+=m.getUint32(w+4,g);const K=m.getUint16(w,g);w+=2;for(let v=0;v<K;v++)if(274==m.getUint16(w+12*v,g))return m.getUint16(w+12*v+8,g);return-1}}var p=r(4650),O=r(146),u=r(2020);let h=(()=>{class T{constructor(m,g,w){this.http=m,this.uploadObservablesService=g,this.loadImageService=w,this.requestSubscriptions=[],this.uploaderOptionsObject={compress:!0,openLinkModalAfterUpload:!1}}get uploaderOptions(){return{...this.uploaderOptionsObject}}set uploaderOptions(m){this.uploaderOptionsObject={...m}}compressFileIfNeeded(m,g){return(0,f.Z)(function*(){let w=["image/png","image/jpeg"],K={strict:!0,checkOrientation:!0,quality:.8,convertSize:1};g&&(w.push("image/webp"),K.width=g.width,K.height=g.height,K.resize="cover",K.strict=!1);const v=m.type.toLowerCase();return m.size<=4e6&&void 0===g||-1===w.indexOf(m.type.toLowerCase())?m:("image/png"===v&&(yield(0,d.JN)(m))&&(K.convertSize=1/0),new Promise((_,I)=>{new(M())(m,{...K,success:b=>{const Z=b instanceof Blob?new File([b],m.name,{type:m.type,lastModified:m.lastModified}):m;_(Z)},error:I})}))})()}orientFileIfNeeded(m){var g=this;return(0,f.Z)(function*(){if(-1===["image/jpeg"].indexOf(m.type.toLowerCase()))return m;const K=yield x.stripAndReturnExif(m);if(m=K.file,K.exif){const v=x.checkImageOrientation(K.exif);if(1!==v){let _=0;switch(v){case 3:case 4:_=180;break;case 5:case 6:_=90;break;case 7:case 8:_=270}const I=yield(0,d.sT)(m),b=yield new Promise((H,z)=>{const G=new Image;G.onload=()=>H({originalImage:G,originalBase64:I}),G.onerror=z,G.src=I}),Z=yield g.loadImageService.transformLoadedImage({original:{base64:b.originalBase64,image:b.originalImage,size:{width:b.originalImage.naturalWidth,height:b.originalImage.naturalHeight}},exifTransform:{flip:[2,4,5,7].includes(v),rotate:_/90}},new R.R);m=new File([(0,P.L)(Z.transformed.base64)],m.name,{type:m.type,lastModified:Date.now()})}}return m})()}upload(m,g,w,K=!1){const v=new n.x,_=new FormData;_.append("payload",w),_.append("upload",m,m.name),K&&_.append("allowOverwrite","1");const I=this.http.request(new C.aW("POST",l.C7,_,{reportProgress:!0,responseType:"json"}));return this.requestSubscriptions.push(I.subscribe({next:b=>{if(b.type===C.dt.UploadProgress){if(!b.total||(g.progress=Math.round(50*b.loaded/b.total)+20,g.progress<70))return;(0,y.F)(1e3).pipe((0,S.R)(v.asObservable())).subscribe(()=>{if(g.progress<95){const Z=Math.round(8*Math.random()+8);g.progress+Z>95?g.progress=95:g.progress+=Z}})}else if(b instanceof C.Zn){if(g.progress=100,g.completed=!0,b.body?.error||!b.body?.success)g.error=!0,this.uploadObservablesService.pushUploadingFileError(g);else{g.file.url=b.body.success.url,g.file.time=Date.now(),g.file.embedUrl=`${g.file.url}?t=${g.file.time}`;const Z=(0,d.Tb)(g.file.url);g.file.name=Z.name,g.file.filename=Z.filename}v.next(),v.complete()}},error:()=>{g.error=!0,this.uploadObservablesService.pushUploadingFileError(g),v.next(),v.complete()}})),v.asObservable()}clearPendingRequests(){for(const m of this.requestSubscriptions)m.unsubscribe();this.requestSubscriptions=[]}}return T.\u0275fac=function(m){return new(m||T)(p.LFG(C.eN),p.LFG(O.r),p.LFG(u.y))},T.\u0275prov=p.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})()},6730:function($){$.exports=function(){"use strict";function F(E,a){var c=Object.keys(E);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(E);a&&(t=t.filter(function(A){return Object.getOwnPropertyDescriptor(E,A).enumerable})),c.push.apply(c,t)}return c}function r(E){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{};a%2?F(Object(c),!0).forEach(function(t){M(E,t,c[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(c)):F(Object(c)).forEach(function(t){Object.defineProperty(E,t,Object.getOwnPropertyDescriptor(c,t))})}return E}function P(E,a){for(var c=0;c<a.length;c++){var t=a[c];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(E,t.key,t)}}function M(E,a,c){return a in E?Object.defineProperty(E,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):E[a]=c,E}function R(){return R=Object.assign||function(E){for(var a=1;a<arguments.length;a++){var c=arguments[a];for(var t in c)Object.prototype.hasOwnProperty.call(c,t)&&(E[t]=c[t])}return E},R.apply(this,arguments)}var E,a,c,t,A,i,o,s,d={exports:{}};E=d,typeof window>"u"||(a=window,c=a.HTMLCanvasElement&&a.HTMLCanvasElement.prototype,t=a.Blob&&function(){try{return Boolean(new Blob)}catch{return!1}}(),A=t&&a.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch{return!1}}(),i=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,s=(t||i)&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&function(U){var D,W,j,N,Y,L,k,Q,q;if(!(D=U.match(o)))throw new Error("invalid data URI");for(W=D[2]?D[1]:"text/plain"+(D[3]||";charset=US-ASCII"),j=!!D[4],N=U.slice(D[0].length),Y=j?atob(N):decodeURIComponent(N),L=new ArrayBuffer(Y.length),k=new Uint8Array(L),Q=0;Q<Y.length;Q+=1)k[Q]=Y.charCodeAt(Q);return t?new Blob([A?k:L],{type:W}):((q=new i).append(L),q.getBlob(W))},a.HTMLCanvasElement&&!c.toBlob&&(c.mozGetAsFile?c.toBlob=function(U,D,W){var j=this;setTimeout(function(){U(W&&c.toDataURL&&s?s(j.toDataURL(D,W)):j.mozGetAsFile("blob",D))})}:c.toDataURL&&s&&(c.toBlob=c.msToBlob?function(U,D,W){var j=this;setTimeout(function(){U((D&&"image/png"!==D||W)&&c.toDataURL&&s?s(j.toDataURL(D,W)):j.msToBlob(D))})}:function(U,D,W){var j=this;setTimeout(function(){U(s(j.toDataURL(D,W)))})})),E.exports?E.exports=s:a.dataURLtoBlob=s);var C=d.exports,y={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},l=typeof window<"u"&&typeof window.document<"u"?window:{},x=function(a){return a>0&&a<1/0},p=Array.prototype.slice;function O(E){return Array.from?Array.from(E):p.call(E)}var u=/^image\/.+$/;function h(E){return u.test(E)}var B=String.fromCharCode;var g=l.btoa;function K(E){var c,a=new DataView(E);try{var t,A,i;if(255===a.getUint8(0)&&216===a.getUint8(1))for(var o=a.byteLength,s=2;s+1<o;){if(255===a.getUint8(s)&&225===a.getUint8(s+1)){A=s;break}s+=1}if(A){var D=A+10;if("Exif"===function m(E,a,c){var A,t="";for(c+=a,A=a;A<c;A+=1)t+=B(E.getUint8(A));return t}(a,A+4,4)){var W=a.getUint16(D);if(((t=18761===W)||19789===W)&&42===a.getUint16(D+2,t)){var j=a.getUint32(D+4,t);j>=8&&(i=D+j)}}}if(i){var Y,L,N=a.getUint16(i,t);for(L=0;L<N;L+=1)if(274===a.getUint16(Y=i+12*L+2,t)){c=a.getUint16(Y+=8,t),a.setUint16(Y,1,t);break}}}catch{c=1}return c}var _=/\.\d*(?:0|9){12}\d*$/;function I(E){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return _.test(E)?Math.round(E*a)/a:E}function b(E){var a=E.aspectRatio,c=E.height,t=E.width,A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",i=x(t),o=x(c);if(i&&o){var s=c*a;("contain"===A||"none"===A)&&s>t||"cover"===A&&s<t?c=t/a:t=c*a}else i?c=t/a:o&&(t=c*a);return{width:t,height:c}}var Z=l.ArrayBuffer,H=l.FileReader,z=l.URL||l.webkitURL,G=/\.\w+$/,X=l.Compressor;return function(){function E(a,c){(function f(E,a){if(!(E instanceof a))throw new TypeError("Cannot call a class as a function")})(this,E),this.file=a,this.image=new Image,this.options=r(r({},y),c),this.aborted=!1,this.result=null,this.init()}return function e(E,a,c){return a&&P(E.prototype,a),c&&P(E,c),E}(E,[{key:"init",value:function(){var c=this,t=this.file,A=this.options;if(function(a){return!(typeof Blob>"u")&&(a instanceof Blob||"[object Blob]"===Object.prototype.toString.call(a))}(t)){var i=t.type;if(h(i))if(z&&H)if(Z||(A.checkOrientation=!1),z&&!A.checkOrientation)this.load({url:z.createObjectURL(t)});else{var o=new H,s=A.checkOrientation&&"image/jpeg"===i;this.reader=o,o.onload=function(U){var W=U.target.result,j={};if(s){var N=K(W);N>1||!z?(j.url=function w(E,a){for(var c=[],A=new Uint8Array(E);A.length>0;)c.push(B.apply(null,O(A.subarray(0,8192)))),A=A.subarray(8192);return"data:".concat(a,";base64,").concat(g(c.join("")))}(W,i),N>1&&R(j,function v(E){var a=0,c=1,t=1;switch(E){case 2:c=-1;break;case 3:a=-180;break;case 4:t=-1;break;case 5:a=90,t=-1;break;case 6:a=90;break;case 7:a=90,c=-1;break;case 8:a=-90}return{rotate:a,scaleX:c,scaleY:t}}(N))):j.url=z.createObjectURL(t)}else j.url=W;c.load(j)},o.onabort=function(){c.fail(new Error("Aborted to read the image with FileReader."))},o.onerror=function(){c.fail(new Error("Failed to read the image with FileReader."))},o.onloadend=function(){c.reader=null},s?o.readAsArrayBuffer(t):o.readAsDataURL(t)}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(c){var t=this,A=this.file,i=this.image;i.onload=function(){t.draw(r(r({},c),{},{naturalWidth:i.naturalWidth,naturalHeight:i.naturalHeight}))},i.onabort=function(){t.fail(new Error("Aborted to load the image."))},i.onerror=function(){t.fail(new Error("Failed to load the image."))},l.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(l.navigator.userAgent)&&(i.crossOrigin="anonymous"),i.alt=A.name,i.src=c.url}},{key:"draw",value:function(c){var t=this,A=c.naturalWidth,i=c.naturalHeight,o=c.rotate,s=void 0===o?0:o,U=c.scaleX,D=void 0===U?1:U,W=c.scaleY,j=void 0===W?1:W,N=this.file,Y=this.image,L=this.options,k=document.createElement("canvas"),Q=k.getContext("2d"),q=Math.abs(s)%180==90,re=("contain"===L.resize||"cover"===L.resize)&&x(L.width)&&x(L.height),te=Math.max(L.maxWidth,0)||1/0,ie=Math.max(L.maxHeight,0)||1/0,ae=Math.max(L.minWidth,0)||0,oe=Math.max(L.minHeight,0)||0,ne=A/i,V=L.width,J=L.height;if(q){var ue=[ie,te];te=ue[0],ie=ue[1];var de=[oe,ae];ae=de[0],oe=de[1];var pe=[J,V];V=pe[0],J=pe[1]}re&&(ne=V/J);var he=b({aspectRatio:ne,width:te,height:ie},"contain");te=he.width,ie=he.height;var fe=b({aspectRatio:ne,width:ae,height:oe},"cover");if(ae=fe.width,oe=fe.height,re){var ge=b({aspectRatio:ne,width:V,height:J},L.resize);V=ge.width,J=ge.height}else{var me=b({aspectRatio:ne,width:V,height:J}),ve=me.width;V=void 0===ve?A:ve;var _e=me.height;J=void 0===_e?i:_e}var Ue=-(V=Math.floor(I(Math.min(Math.max(V,ae),te))))/2,we=-(J=Math.floor(I(Math.min(Math.max(J,oe),ie))))/2,Me=V,Ie=J,se=[];if(re){var le,ce,Ae=b({aspectRatio:ne,width:A,height:i},{contain:"cover",cover:"contain"}[L.resize]);se.push((A-(le=Ae.width))/2,(i-(ce=Ae.height))/2,le,ce)}if(se.push(Ue,we,Me,Ie),q){var ye=[J,V];V=ye[0],J=ye[1]}k.width=V,k.height=J,h(L.mimeType)||(L.mimeType=N.type);var xe="transparent";if(N.size>L.convertSize&&L.convertTypes.indexOf(L.mimeType)>=0&&(L.mimeType="image/jpeg"),"image/jpeg"===L.mimeType&&(xe="#fff"),Q.fillStyle=xe,Q.fillRect(0,0,V,J),L.beforeDraw&&L.beforeDraw.call(this,Q,k),!this.aborted&&(Q.save(),Q.translate(V/2,J/2),Q.rotate(s*Math.PI/180),Q.scale(D,j),Q.drawImage.apply(Q,[Y].concat(se)),Q.restore(),L.drew&&L.drew.call(this,Q,k),!this.aborted)){var Oe=function(Ce){t.aborted||t.done({naturalWidth:A,naturalHeight:i,result:Ce})};k.toBlob?k.toBlob(Oe,L.mimeType,L.quality):Oe(C(k.toDataURL(L.mimeType,L.quality)))}}},{key:"done",value:function(c){var t=c.naturalWidth,A=c.naturalHeight,i=c.result,o=this.file,U=this.options;if(z&&!U.checkOrientation&&z.revokeObjectURL(this.image.src),i)if(U.strict&&i.size>o.size&&U.mimeType===o.type&&!(U.width>t||U.height>A||U.minWidth>t||U.minHeight>A||U.maxWidth<t||U.maxHeight<A))i=o;else{var D=new Date;i.lastModified=D.getTime(),i.lastModifiedDate=D,i.name=o.name,i.name&&i.type!==o.type&&(i.name=i.name.replace(G,function T(E){var a=h(E)?E.substr(6):"";return"jpeg"===a&&(a="jpg"),".".concat(a)}(i.type)))}else i=o;this.result=i,U.success&&U.success.call(this,i)}},{key:"fail",value:function(c){var t=this.options;if(!t.error)throw c;t.error.call(this,c)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=X,E}},{key:"setDefaults",value:function(c){R(y,c)}}]),E}()}()},7445:($,F,r)=>{"use strict";r.d(F,{F:()=>e});var f=r(4986),P=r(5963);function e(M=0,R=f.z){return M<0&&(M=0),(0,P.H)(M,M,R)}},1042:($,F,r)=>{"use strict";r.d(F,{Z:()=>x});var f,P=new Uint8Array(16);function e(){if(!f&&!(f=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return f(P)}const M=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,d=function R(p){return"string"==typeof p&&M.test(p)};for(var C=[],n=0;n<256;++n)C.push((n+256).toString(16).substr(1));const x=function l(p,O,u){var h=(p=p||{}).random||(p.rng||e)();if(h[6]=15&h[6]|64,h[8]=63&h[8]|128,O){u=u||0;for(var T=0;T<16;++T)O[u+T]=h[T];return O}return function y(p){var O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=(C[p[O+0]]+C[p[O+1]]+C[p[O+2]]+C[p[O+3]]+"-"+C[p[O+4]]+C[p[O+5]]+"-"+C[p[O+6]]+C[p[O+7]]+"-"+C[p[O+8]]+C[p[O+9]]+"-"+C[p[O+10]]+C[p[O+11]]+C[p[O+12]]+C[p[O+13]]+C[p[O+14]]+C[p[O+15]]).toLowerCase();if(!d(u))throw TypeError("Stringified UUID is invalid");return u}(h)}}}]);