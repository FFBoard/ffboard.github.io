"use strict";(self.webpackChunkpages=self.webpackChunkpages||[]).push([[581],{7429:(me,B,p)=>{p.d(B,{d:()=>k});var y=p(9212),Z=p(6306);let v=(()=>{var D;class U{constructor(){this.allowedProps={$ref:{validator:this.isString},anyOf:{validator:this.validateAnyOf},default:{validator:this.isNestedOfPrimitives},definitions:null,description:null,enum:{validator:this.validateEnum},items:{child:"allProps"},maximum:null,maxItems:null,maxLength:null,minimum:null,minItems:null,minLength:null,multipleOf:null,oneOf:{validator:this.validateOneOf},properties:null,required:{validator:this.validateRequired},title:null,type:{validator:this.isNestedOfPrimitives},uniqueItems:null,widget:{child:{formlyConfig:{child:{props:{child:{placeholder:{validator:this.isString},multiple:{validator:this.isBoolean},pattern:{validator:this.isString},type:{validator:function(c){return"hidden"===c}},minLength:{validator:this.isNumber},maxLength:{validator:this.isNumber},rows:{validator:this.isNumber},keepGroupsWithoutId:{validator:this.isBoolean},fieldsetTemplate:{validator:this.isBoolean},startDate:{child:{year:null,month:null,day:null}},endDate:{child:{year:null,month:null,day:null}},minDate:{child:{year:null,month:null,day:null}},maxDate:{child:{year:null,month:null,day:null}},selectDomain:{validator:this.isBoolean},resetButton:{validator:this.isBoolean},height:{validator:this.isString}}},type:{validator:function(c){return"radio"===c}}}}}}},this.fieldListKeys=["properties","definitions"]}validateSchema(c){this.isObject(c)&&((!(0,Z.o8)(c,"type")||!(0,Z.o8)(c,"properties")||"object"!==c.type)&&(c.type="object",c.properties={}),this.validate(c))}validate(c,m){m||(m=this.allowedProps);for(const[M,l]of Object.entries(c))if((0,Z.o8)(m,M)){if((0,Z.o8)(m[M]||{},"validator"))m[M].validator.call(this,l)||delete c[M];else if(this.fieldListKeys.includes(M))for(const C of Object.keys(c[M]))this.validate(c[M][C]);else if(!this.isPrimitive(l)){if(!(0,Z.o8)(m[M]||{},"child")||!this.isObject(l)){delete c[M];continue}this.validate(c[M],"allProps"===m[M].child?this.allowedProps:m[M].child)}}else delete c[M]}isObject(c){return null!=c&&"object"==typeof c&&!Array.isArray(c)}isPrimitive(c){return this.isString(c)||this.isNumber(c)||this.isBoolean(c)||null==c}isString(c){return"string"==typeof c}isBoolean(c){return"boolean"==typeof c}isNumber(c){return"number"==typeof c}validateRequired(c){if(!Array.isArray(c))return!1;for(const m of c)if(!this.isString(m))return!1;return!0}validateEnum(c){if(!Array.isArray(c))return!1;for(const m of c)if(!this.isString(m)&&!this.isNumber(m))return!1;return!0}validateOneOf(c){if(Array.isArray(c)&&(0,Z.o8)(c[0]||{},"const")){for(const m of c){if(!this.isObject(m))return!1;this.validate(m,{const:null,title:null})}return!0}return this.validateAnyOf(c)}validateAnyOf(c){if(!Array.isArray(c))return!1;for(const m of c){if(!this.isObject(m))return!1;this.validate(m)}return!0}isNestedOfPrimitives(c){if(this.isPrimitive(c))return!0;if(Array.isArray(c)||this.isObject(c)){for(const m of Object.values(c))if(!this.isNestedOfPrimitives(m))return!1;return!0}return!1}}return(D=U).\u0275fac=function(c){return new(c||D)},D.\u0275prov=y.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),U})();var S=p(6223),e=p(1993),A=p(5661),z=p(336),W=p(5545);const $=["app-custom-form",""],K=[[["","buttons",""]]],L=["[buttons]"];let k=(()=>{var D;class U{constructor(c,m,M,l){this.formlyJsonschema=c,this.customFormSchemaService=m,this.toastService=M,this.destroyRef=l,this.model={},this.validateSchema=!1,this.enableModelChangeEvent=!1,this.defaultModel={},this.showFieldValidationOnInit=!1,this.cancelEvent=new y.vpe,this.submitEvent=new y.vpe,this.validityChangeEvent=new y.vpe,this.modelChangeEvent=new y.vpe,this.form=new S.nJ({}),this.fields=[],this.options={},this.isFormCurrentlyValid=!0}ngAfterViewInit(){this.validityChangeEvent.emit(this.isFormCurrentlyValid=this.form.valid)}ngOnInit(){this.createFields(),this.form.statusChanges.pipe((0,e.sL)(this.destroyRef)).subscribe(()=>{this.form.valid!==this.isFormCurrentlyValid&&this.validityChangeEvent.emit(this.isFormCurrentlyValid=this.form.valid)})}ngOnChanges(c){c.schema&&!c.schema.firstChange&&this.createFields()}createFields(){this.customFormSchemaService.isObject(this.schema)||(this.schema={}),this.validateSchema&&this.customFormSchemaService.validateSchema(this.schema),this.fields=[this.formlyJsonschema.toFieldConfig(this.schema)],this.showFieldValidationOnInit&&this.showFieldValidation()}showFieldValidation(){this.cycleFields(this.fields)}showFieldValidationWithMessage(){this.showFieldValidation(),this.toastService.show({content:"Tutti i campi sono stati <strong>validati</strong>: quelli con errore sono evidenziati da un <strong>bordo rosso</strong>!"})}cycleFields(c){c.forEach(m=>{this.forceValidation(m),m.fieldGroup&&this.cycleFields(m.fieldGroup)})}forceValidation(c){c.validation||(c.validation={}),c.validation.show=!0}reset(){this.options.resetModel&&this.options.resetModel({})}cancel(){this.cancelEvent.emit()}submit(){this.form.valid&&(this.log(),this.submitEvent.emit(this.model))}onModelChange(c){this.enableModelChangeEvent&&this.modelChangeEvent.emit(c||{})}log(){}}return(D=U).\u0275fac=function(c){return new(c||D)(y.Y36(z.c),y.Y36(v),y.Y36(A.k),y.Y36(y.ktI))},D.\u0275cmp=y.Xpm({type:D,selectors:[["","app-custom-form",""]],inputs:{schema:"schema",model:"model",validateSchema:"validateSchema",enableModelChangeEvent:"enableModelChangeEvent",defaultModel:"defaultModel",showFieldValidationOnInit:"showFieldValidationOnInit"},outputs:{cancelEvent:"cancelEvent",submitEvent:"submitEvent",validityChangeEvent:"validityChangeEvent",modelChangeEvent:"modelChangeEvent"},features:[y.TTD],attrs:$,ngContentSelectors:L,decls:3,vars:5,consts:[[3,"formGroup","ngSubmit"],[3,"model","fields","form","options","modelChange"]],template:function(c,m){1&c&&(y.F$t(K),y.TgZ(0,"form",0),y.NdJ("ngSubmit",function(){return m.submit()}),y.TgZ(1,"formly-form",1),y.NdJ("modelChange",function(l){return m.onModelChange(l)}),y.qZA(),y.Hsn(2),y.qZA()),2&c&&(y.Q6J("formGroup",m.form),y.xp6(),y.Q6J("model",m.model)("fields",m.fields)("form",m.form)("options",m.options))},dependencies:[W.T7,S._Y,S.JL,S.sg]}),U})()},1049:(me,B,p)=>{p.d(B,{I:()=>Qi});var y=p(6814),Z=p(259),v=p(6306),S=p(5545),e=p(9212),A=p(8595);function z(t,s){1&t&&e.GkF(0)}function W(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"div",13),e.TgZ(2,"div",14),e._uU(3," ("),e.YNc(4,z,1,0,"ng-container",15),e._uU(5,") "),e.qZA(),e.BQk()),2&t){const n=e.oxw(),i=e.MAs(15);e.xp6(),e.Q6J("innerHTML",n.parsedTitle,e.oJD),e.xp6(3),e.Q6J("ngTemplateOutlet",i)}}function $(t,s){1&t&&e.GkF(0)}function K(t,s){if(1&t&&(e.TgZ(0,"div",16),e._uU(1," Lista di "),e.YNc(2,$,1,0,"ng-container",15),e.qZA()),2&t){e.oxw();const n=e.MAs(15);e.xp6(2),e.Q6J("ngTemplateOutlet",n)}}function L(t,s){if(1&t&&e._UZ(0,"div",17),2&t){const n=e.oxw();e.Q6J("innerHTML",n.parsedDescription,e.oJD)}}const k=t=>({"mt-3":t});function D(t,s){if(1&t&&(e.TgZ(0,"div",18),e._UZ(1,"formly-validation-message",19),e.qZA()),2&t){const n=e.oxw();e.Q6J("ngClass",e.VKq(2,k,n.parsedDescription.length)),e.xp6(),e.Q6J("field",n.field)}}function U(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"li")(1,"div",30),e.NdJ("click",function(){e.CHM(n);const o=e.oxw().index,r=e.oxw(2);return e.KtG(r.move(o,o-1))}),e._uU(2," arrow_circle_up "),e.qZA()()}2&t&&(e.xp6(),e.Q6J("disableOnTouchDevice",!0))}const P=t=>({"ms-1":t});function c(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"li",31)(1,"div",32),e.NdJ("click",function(){e.CHM(n);const o=e.oxw().index,r=e.oxw(2);return e.KtG(r.move(o,o+1))}),e._uU(2," arrow_circle_down "),e.qZA()()}if(2&t){const n=e.oxw().first;e.Q6J("ngClass",e.VKq(2,P,!n)),e.xp6(),e.Q6J("disableOnTouchDevice",!0)}}function m(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"li",31)(1,"div",33),e.NdJ("click",function(){e.CHM(n);const o=e.oxw().index,r=e.oxw(2);return e.KtG(r.remove(o))}),e._uU(2," highlight_off "),e.qZA()()}if(2&t){const n=e.oxw();e.Q6J("ngClass",e.VKq(2,P,!(n.first&&n.last))),e.xp6(),e.Q6J("disableOnTouchDevice",!0)}}const M=t=>({"mb-3":t}),l=t=>({"has-error":t});function C(t,s){if(1&t&&(e.TgZ(0,"li",22)(1,"fieldset",23)(2,"legend",24)(3,"div",25)(4,"div",26),e._uU(5),e.qZA(),e.TgZ(6,"ul",27),e.YNc(7,U,3,1,"li",28)(8,c,3,4,"li",29)(9,m,3,4,"li",29),e.qZA()()(),e._UZ(10,"formly-field",19),e.qZA()()),2&t){const n=s.$implicit,i=s.index,o=s.first,r=s.last;e.Q6J("ngClass",e.VKq(7,M,!r)),e.xp6(),e.Q6J("ngClass",e.VKq(9,l,null==n.formControl?null:n.formControl.invalid)),e.xp6(4),e.hij("#",i+1,""),e.xp6(2),e.Q6J("ngIf",!o),e.xp6(),e.Q6J("ngIf",!r),e.xp6(),e.Q6J("ngIf",n.props&&!1!==n.props.removable),e.xp6(),e.Q6J("field",n)}}function E(t,s){if(1&t&&(e.TgZ(0,"ul",20),e.YNc(1,C,11,11,"li",21),e.qZA()),2&t){const n=e.oxw();e.xp6(),e.Q6J("ngForOf",n.field.fieldGroup)}}const O=t=>({"d-none d-md-inline":t});function h(t,s){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA(),e.TgZ(2,"span",31),e._uU(3),e.qZA()),2&t){const n=e.oxw();e.xp6(),e.Oqu(n.field.fieldGroup?n.field.fieldGroup.length:0),e.xp6(),e.Q6J("ngClass",e.VKq(3,O,n.props.label)),e.xp6(),e.hij(" element",n.field.fieldGroup&&1===n.field.fieldGroup.length?"o":"i","")}}const T=()=>[10,10],d=t=>({placement:"top-end",offset:t});let g=(()=>{var t;class s extends S.hv{constructor(i){super(),this.customFormUtilsService=i,this.parsedTitle="",this.parsedDescription=""}ngOnInit(){this.parsedDescription=this.props.description?this.customFormUtilsService.parseBBCode(this.props.description):"",this.parsedTitle=this.props.label?this.customFormUtilsService.parseBBCode(this.props.label):""}get maxLengthExceeded(){return this.props.maxItems&&this.model&&this.model.length>=this.props.maxItems}move(i,o){const r=this.model[i];this.remove(i),this.add(o,r)}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(v.d6))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-array"]],features:[e.qOj],decls:16,vars:14,consts:[[1,"rounded","px-3","pb-3","pt-2","mb-3","formly-fieldset",3,"ngClass"],[1,"legend-reset","pb-1","px-2","mb-0","mw-100"],[1,"d-flex","align-items-center","mw-100"],[4,"ngIf","ngIfElse"],["nolabel",""],["class","mb-2 text-justify",3,"innerHTML",4,"ngIf"],["class","alert alert-danger formly-field-array-error text-center","role","alert",3,"ngClass",4,"ngIf"],["class","list-unstyled mb-3",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["appTippy","Hai aggiunto il numero massimo di elementi!",3,"disableInstance","tippyProps"],["type","button",1,"btn","btn-primary","d-flex","align-items-center",3,"disabled","click"],[1,"material-icons"],["itemscount",""],[1,"fs-lg","text-truncate","mw-100",3,"innerHTML"],[1,"ms-2","fs-reset","lh-1","fst-italic","list-counter","text-nowrap"],[4,"ngTemplateOutlet"],[1,"fs-xl","text-truncate","mw-10"],[1,"mb-2","text-justify",3,"innerHTML"],["role","alert",1,"alert","alert-danger","formly-field-array-error","text-center",3,"ngClass"],[3,"field"],[1,"list-unstyled","mb-3"],["class","item",3,"ngClass",4,"ngFor","ngForOf"],[1,"item",3,"ngClass"],[1,"rounded","formly-fieldset","dashed","show-success","px-3",3,"ngClass"],[1,"legend-reset","ms-auto","mb-0","px-2"],[1,"d-flex","align-items-center"],[1,"fs-xl","ms-1"],[1,"ms-2","mb-0","item-icons","list-unstyled","d-flex","align-items-center"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["appTippy","Sposta in alto",1,"d-block","material-icons","cursor-pointer",3,"disableOnTouchDevice","click"],[3,"ngClass"],["appTippy","Sposta in basso",1,"d-block","material-icons","cursor-pointer",3,"disableOnTouchDevice","click"],["appTippy","Rimuovi",1,"d-block","material-icons","cursor-pointer","text-danger",3,"disableOnTouchDevice","click"]],template:function(i,o){if(1&i&&(e.TgZ(0,"fieldset",0)(1,"legend",1)(2,"div",2),e.YNc(3,W,6,2,"ng-container",3)(4,K,3,1,"ng-template",null,4,e.W1O),e.qZA()(),e.YNc(6,L,1,1,"div",5)(7,D,2,4,"div",6)(8,E,2,1,"ul",7),e.TgZ(9,"div",8)(10,"div",9)(11,"button",10),e.NdJ("click",function(){return!o.maxLengthExceeded&&o.add()}),e.TgZ(12,"span",11),e._uU(13,"add"),e.qZA()()()(),e.YNc(14,h,4,5,"ng-template",null,12,e.W1O),e.qZA()),2&i){const r=e.MAs(5);e.Q6J("ngClass",e.VKq(9,l,o.formControl.invalid)),e.xp6(3),e.Q6J("ngIf",o.parsedTitle)("ngIfElse",r),e.xp6(3),e.Q6J("ngIf",o.parsedDescription),e.xp6(),e.Q6J("ngIf",o.showError&&o.formControl.errors),e.xp6(),e.Q6J("ngIf",o.field.fieldGroup&&o.field.fieldGroup.length),e.xp6(2),e.Q6J("disableInstance",!o.maxLengthExceeded)("tippyProps",e.VKq(12,d,e.DdM(11,T))),e.xp6(),e.Q6J("disabled",o.maxLengthExceeded)}},dependencies:[y.mk,y.sg,y.O5,y.tP,S.cw,S.M2,A.$],styles:["legend[_ngcontent-%COMP%]   .item-icons[_ngcontent-%COMP%]{padding-top:.1rem}"]}),s})();var x=p(1413),_=p(4020),f=p(6223),q=p(91),Q=p(2181),w=p(8180),I=p(5619);const R=["language","theme"],X=["editor"];let Oe=(()=>{class t{constructor(n,i){this.ngZone=n,this.monacoPathConfig=i,this.isMonacoLoaded$=new I.X(!1),this._monacoPath="assets/monaco-editor/min/vs",window.monacoEditorAlreadyInitialized?n.run(()=>this.isMonacoLoaded$.next(!0)):(window.monacoEditorAlreadyInitialized=!0,this.monacoPathConfig&&(this.monacoPath=this.monacoPathConfig),this.loadMonaco())}set monacoPath(n){n&&(this._monacoPath=n)}loadMonaco(){const n=()=>{let a=this._monacoPath;window.amdRequire=window.require;const u=!!this.nodeRequire,b=a.includes("http");u&&(window.require=this.nodeRequire,b||(a=window.require("path").resolve(window.__dirname,this._monacoPath))),window.amdRequire.config({paths:{vs:a}}),window.amdRequire(["vs/editor/editor.main"],()=>{this.ngZone.run(()=>this.isMonacoLoaded$.next(!0))},F=>console.error("Error loading monaco-editor: ",F))};if(window.amdRequire)return n();window.require&&(this.addElectronFixScripts(),this.nodeRequire=window.require);const r=document.createElement("script");r.type="text/javascript",r.src="".concat(this._monacoPath,"/loader.js"),r.addEventListener("load",n),document.body.appendChild(r)}addElectronFixScripts(){const n=document.createElement("script"),i=document.createTextNode("self.module = undefined;"),o=document.createTextNode("self.process.browser = true;");n.appendChild(i),n.appendChild(o),document.body.appendChild(n)}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(e.R0b),e.LFG("MONACO_PATH",8))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Me=(()=>{class t{constructor(n){this.monacoLoader=n,this.init=new e.vpe,this.onTouched=()=>{},this.onErrorStatusChange=()=>{},this.propagateChange=()=>{}}get model(){return this.editor&&this.editor.getModel()}get modelMarkers(){return this.model&&monaco.editor.getModelMarkers({resource:this.model.uri})}ngOnInit(){this.monacoLoader.isMonacoLoaded$.pipe((0,Q.h)(n=>n),(0,w.q)(1)).subscribe(()=>{this.initEditor()})}ngOnChanges(n){if(this.editor&&n.options&&!n.options.firstChange){const i=n.options.currentValue,{language:o,theme:r}=i,a=(0,q.Z)(i,R),{language:u,theme:b}=n.options.previousValue;u!==o&&monaco.editor.setModelLanguage(this.editor.getModel(),this.options&&this.options.language?this.options.language:"text"),b!==r&&monaco.editor.setTheme(r),this.editor.updateOptions(a)}if(this.editor&&n.uri){const i=n.uri.currentValue,o=n.uri.previousValue;if(o&&!i||!o&&i||i&&o&&i.path!==o.path){const r=this.editor.getValue();let a;this.modelUriInstance&&this.modelUriInstance.dispose(),i&&(a=monaco.editor.getModels().find(u=>u.uri.path===i.path)),this.modelUriInstance=a||monaco.editor.createModel(r,this.options.language||"text",this.uri),this.editor.setModel(this.modelUriInstance)}}}writeValue(n){this.value=n,this.editor&&n?this.editor.setValue(n):this.editor&&this.editor.setValue("")}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){this.onTouched=n}validate(){return this.parsedError?{monaco:{value:this.parsedError.split("|")}}:null}registerOnValidatorChange(n){this.onErrorStatusChange=n}initEditor(){const n={value:[this.value].join("\n"),language:"text",automaticLayout:!0,scrollBeyondLastLine:!1,theme:"vc"};this.editor=monaco.editor.create(this.editorContent.nativeElement,this.options?(0,x.Z)((0,x.Z)({},n),this.options):n),this.registerEditorListeners(),this.init.emit(this.editor)}registerEditorListeners(){this.editor.onDidChangeModelContent(()=>{this.propagateChange(this.editor.getValue())}),this.editor.onDidChangeModelDecorations(()=>{const n=this.modelMarkers.map(({message:o})=>o).join("|");this.parsedError!==n&&(this.parsedError=n,this.onErrorStatusChange())}),this.editor.onDidBlurEditorText(()=>{this.onTouched()})}ngOnDestroy(){this.editor&&this.editor.dispose()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(Oe))},t.\u0275cmp=e.Xpm({type:t,selectors:[["ngx-monaco-editor"]],viewQuery:function(n,i){if(1&n&&e.Gf(X,7),2&n){let o;e.iGM(o=e.CRH())&&(i.editorContent=o.first)}},inputs:{options:"options",uri:"uri"},outputs:{init:"init"},features:[e._Bn([{provide:f.JU,useExisting:(0,e.Gpc)(()=>t),multi:!0},{provide:f.Cf,useExisting:(0,e.Gpc)(()=>t),multi:!0}]),e.TTD],decls:4,vars:0,consts:[["fxFlex","",1,"editor-container"],["container",""],[1,"monaco-editor"],["editor",""]],template:function(n,i){1&n&&(e.TgZ(0,"div",0,1),e._UZ(2,"div",2,3),e.qZA())},styles:[".monaco-editor[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}.editor-container[_ngcontent-%COMP%]{overflow:hidden;position:relative;display:table;width:100%;height:100%;min-width:0}"],changeDetection:0}),t})(),we=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[]]}),t})();function Se(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"textarea",2),e._uU(2,"            "),e.qZA(),e.BQk()),2&t){const n=e.oxw();e.xp6(),e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("cols",1)("rows",10)("formlyAttributes",n.field)}}function Ie(t,s){1&t&&(e.ynx(0),e.TgZ(1,"p",4),e._UZ(2,"span",5),e.qZA(),e.BQk())}function Ae(t,s){if(1&t&&e._UZ(0,"ngx-monaco-editor",6),2&t){const n=e.oxw(2);e.Udp("height",n.editorHeight),e.Q6J("options",n.editorOptions)("formControl",n.formControl)}}function Ze(t,s){if(1&t&&e.YNc(0,Ie,3,0,"ng-container",0)(1,Ae,1,4,"ng-template",null,3,e.W1O),2&t){const n=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.loading)("ngIfElse",n)}}let Le=(()=>{var t;class s extends S.fS{constructor(){super(...arguments),this.touchDevice=_.b1,this.editorOptions={theme:"vs-dark",language:"json"},this.loading=!0,this.editorHeight="350px"}ngOnInit(){this.touchDevice||(this.field.props.editorOptions&&(this.field.props.editorOptions.height&&(this.editorHeight=this.field.props.editorOptions.height,delete this.field.props.editorOptions.height),this.editorOptions=(0,x.Z)((0,x.Z)({},this.editorOptions),this.field.props.editorOptions)),this.loading=!1)}}return(t=s).\u0275fac=(()=>{let n;return function(o){return(n||(n=e.n5z(t)))(o||t)}})(),t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-code-editor-type"]],features:[e.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["notTouchDevice",""],[1,"form-control",3,"formControl","cols","rows","formlyAttributes"],["codeEditor",""],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],[1,"d-block","formly-code-editor",3,"options","formControl"]],template:function(i,o){if(1&i&&e.YNc(0,Se,3,6,"ng-container",0)(1,Ze,3,2,"ng-template",null,1,e.W1O),2&i){const r=e.MAs(2);e.Q6J("ngIf",o.touchDevice)("ngIfElse",r)}},dependencies:[y.O5,S.JD,f.Fj,f.JJ,f.oH,Me],encapsulation:2}),s})();var N=p(5861),oe=p(8784);function De(t,s){1&t&&(e.ynx(0),e.TgZ(1,"p",3),e._UZ(2,"span",4),e.qZA(),e.BQk())}function qe(t,s){if(1&t&&e._UZ(0,"option",8),2&t){const n=s.$implicit;e.Q6J("ngValue",n.id||n.name)("innerText",n.name)}}function Qe(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"select",6),e.YNc(2,qe,1,2,"option",7),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(),e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(),e.Q6J("ngForOf",n.groupsList)}}function Je(t,s){if(1&t&&e._UZ(0,"option",8),2&t){const n=s.$implicit;e.Q6J("ngValue",n.id||n.name)("innerText",n.name)}}function Ve(t,s){if(1&t&&(e.TgZ(0,"select",9),e.YNc(1,Je,1,2,"option",7),e.qZA()),2&t){const n=e.oxw(2);e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(),e.Q6J("ngForOf",n.groupsList)}}function Pe(t,s){if(1&t&&e.YNc(0,Qe,3,5,"ng-container",1)(1,Ve,2,5,"ng-template",null,5,e.W1O),2&t){const n=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.field.props.multiple)("ngIfElse",n)}}const Ue=t=>({"no-label":t});let ke=(()=>{var t;class s extends S.fS{constructor(i,o){super(),this.forumService=i,this.changeDetectorRef=o,this.loading=!0,this.groupsList=[]}prePopulate(i){i.props||(i.props={}),i.props.resetButton=!0}ngOnInit(){var i=this;return(0,N.Z)(function*(){i.field.defaultValue=void 0,(0,v.o8)(i.field.props,"multiple")||(i.field.props.multiple=!0),i.groupsList=(yield i.forumService.getGroups()).sort((o,r)=>o.name.localeCompare(r.name)),i.field.props.keepGroupsWithoutId||(i.groupsList=i.groupsList.filter(o=>o.id>0)),i.loading=!1,i.field.formControl.updateValueAndValidity(),i.changeDetectorRef.detectChanges()})()}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(oe._),e.Y36(e.sBO))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-groups"]],features:[e.qOj],decls:4,vars:5,consts:[[1,"position-relative","wrapper",3,"ngClass"],[4,"ngIf","ngIfElse"],["formSelect",""],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],["single",""],["multiple","",1,"form-select",3,"formControl","formlyAttributes"],[3,"ngValue","innerText",4,"ngFor","ngForOf"],[3,"ngValue","innerText"],[1,"form-select",3,"formControl","formlyAttributes"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,De,3,0,"ng-container",1)(2,Pe,3,2,"ng-template",null,2,e.W1O),e.qZA()),2&i){const r=e.MAs(3);e.Q6J("ngClass",e.VKq(3,Ue,!o.props.label)),e.xp6(),e.Q6J("ngIf",o.loading)("ngIfElse",r)}},dependencies:[y.mk,y.sg,y.O5,S.JD,f.YN,f.Kr,f.EJ,f.K7,f.JJ,f.oH],encapsulation:2}),s})();var Ne=p(1410),re=p(8645);const je=[{value:v.ig.FORUMFREE,placeholder:"ForumFree"},{value:v.ig.FORUMCOMMUNITY,placeholder:"ForumCommunity"},{value:v.ig.BLOGFREE,placeholder:"BlogFree"}];function Re(t,s){if(1&t&&e._UZ(0,"option",2),2&t){const n=s.$implicit;e.Q6J("ngValue",n.value)("innerText",n.placeholder)}}let He=(()=>{var t;class s{constructor(){this.model=v.ig.FORUMFREE,this.modelChange=new e.vpe,this.options=je}}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-domain-select"]],inputs:{model:"model"},outputs:{modelChange:"modelChange"},decls:2,vars:2,consts:[[1,"form-select",3,"ngModel","ngModelChange"],[3,"ngValue","innerText",4,"ngFor","ngForOf"],[3,"ngValue","innerText"]],template:function(i,o){1&i&&(e.TgZ(0,"select",0),e.NdJ("ngModelChange",function(a){return o.model=a})("ngModelChange",function(a){return o.modelChange.emit(a)}),e.YNc(1,Re,1,2,"option",1),e.qZA()),2&i&&(e.Q6J("ngModel",o.model),e.xp6(),e.Q6J("ngForOf",o.options))},dependencies:[y.sg,f.YN,f.Kr,f.EJ,f.JJ,f.On],encapsulation:2}),s})();var fe=p(7827),Ge=p(9473),Ye=p(7357);function Be(t,s){1&t&&(e.TgZ(0,"div",4),e._UZ(1,"app-loader",5),e.qZA())}function ze(t,s){1&t&&e._UZ(0,"div",8),2&t&&e.Q6J("innerText","Nessun elemento inserito!")}function We(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"li")(1,"a",11)(2,"div",12),e.NdJ("click",function(o){const a=e.CHM(n).index,u=e.oxw(3);return e.KtG(u.remove(a,o))}),e.TgZ(3,"div",13),e._uU(4," remove "),e.qZA()(),e._UZ(5,"img",14),e.ALo(6,"uploadsreplace"),e.qZA(),e._UZ(7,"a",15),e.qZA()}if(2&t){const n=s.$implicit,i=e.oxw(3);e.Gre("d-flex flex-column align-items-center item-",n.type,""),e.xp6(),e.Q6J("href",n.link,e.LSH),e.xp6(),e.Q6J("disableOnTouchDevice",!0),e.xp6(3),e.s9C("alt",n.title),e.Q6J("src",i.lazyImagePlaceholder,e.LSH)("lazyLoad",e.lcZ(6,12,n.image))("offset",100)("errorImage",i.defaultImage),e.xp6(2),e.Q6J("innerHTML",n.title,e.oJD)("href",n.link,e.LSH)}}function $e(t,s){if(1&t&&(e.TgZ(0,"ul",9),e.YNc(1,We,8,14,"li",10),e.qZA()),2&t){const n=e.oxw(2);e.xp6(),e.Q6J("ngForOf",n.list)}}function Ke(t,s){if(1&t&&e.YNc(0,ze,1,1,"div",6)(1,$e,2,1,"ng-template",null,7,e.W1O),2&t){const n=e.MAs(2),i=e.oxw();e.Q6J("ngIf",0===i.list.length)("ngIfElse",n)}}const Xe=t=>({"empty-list":t});let et=(()=>{var t;class s{constructor(){this.list=[],this.defaultImage="/assets/default_avatar.png",this.loading=!0,this.removeEvent=new e.vpe,this.lazyImagePlaceholder=_.Qi}remove(i,o){o.preventDefault(),o.stopPropagation();const r=this.list[i].id;this.list.splice(i,1),this.list=[...this.list],this.removeEvent.emit(r)}}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-formly-typeahead-content"]],inputs:{list:"list",listTitle:"listTitle",defaultImage:"defaultImage",loading:"loading"},outputs:{removeEvent:"removeEvent"},decls:5,vars:6,consts:[[1,"formly-list-container","rounded","px-3","pt-2","mt-2",3,"ngClass"],[1,"legend-reset","fs-reset","mb-0","px-2","pb-1",3,"innerText"],["class","d-flex justify-content-center",4,"ngIf","ngIfElse"],["content",""],[1,"d-flex","justify-content-center"],["message","Recupero dei dati"],["class","text-center mb-0 px-1 pb-1 fst-italic",3,"innerText",4,"ngIf","ngIfElse"],["noEmpty",""],[1,"text-center","mb-0","px-1","pb-1","fst-italic",3,"innerText"],[1,"formly-list","list-unstyled","mb-0","d-grid","px-2"],[3,"class",4,"ngFor","ngForOf"],["target","_blank",1,"preview","rounded-circle","d-block","position-relative",3,"href"],["appTippy","Rimuovi",1,"remove-btn","alert","alert-danger","position-absolute","cursor-pointer","mb-0","py-0","px-1",3,"disableOnTouchDevice","click"],[1,"material-icons","d-block","fs-reset"],[1,"d-block","image-cover","rounded-circle",3,"src","lazyLoad","offset","errorImage","alt"],["target","_blank",1,"d-block","fw-bold","mt-1","item-title","text-truncate","mw-100",3,"innerHTML","href"]],template:function(i,o){if(1&i&&(e.TgZ(0,"fieldset",0),e._UZ(1,"legend",1),e.YNc(2,Be,2,0,"div",2)(3,Ke,3,2,"ng-template",null,3,e.W1O),e.qZA()),2&i){const r=e.MAs(4);e.Q6J("ngClass",e.VKq(4,Xe,0===o.list.length)),e.xp6(),e.Q6J("innerText",o.listTitle),e.xp6(),e.Q6J("ngIf",o.loading)("ngIfElse",r)}},dependencies:[y.mk,y.sg,y.O5,fe.z1,Ge.R,A.$,Ye.g],styles:[".formly-list-container[_ngcontent-%COMP%]{border:1px dashed var(--bs-gray-500)}.formly-list-container[_ngcontent-%COMP%]:not(.empty-list){padding-bottom:.75rem}.formly-list-container.empty-list[_ngcontent-%COMP%]{padding-bottom:1rem}.formly-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(60px,1fr));gap:1rem}.formly-list[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{top:0;left:-8px}.formly-list[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:60px;height:60px;border:2px solid}.formly-list[_ngcontent-%COMP%]   .item-ff[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{border-color:#58a72e}.formly-list[_ngcontent-%COMP%]   .item-ff[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{color:#58a72e!important}.formly-list[_ngcontent-%COMP%]   .item-fc[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{border-color:#0082cd}.formly-list[_ngcontent-%COMP%]   .item-fc[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{color:#0082cd!important}.formly-list[_ngcontent-%COMP%]   .item-bf[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{border-color:#e67f22}.formly-list[_ngcontent-%COMP%]   .item-bf[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{color:#e67f22!important}@media (min-width: 960px){.formly-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(75px,1fr));gap:1.5rem}.formly-list[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{top:4px}.formly-list[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:75px;height:75px}}"]}),s})();var tt=p(1378),se=p(3620),nt=p(3997),ot=p(3019),he=p(9397),rt=p(4664),st=p(2096),ge=p(1993),lt=p(5661),G=p(8726);function at(t,s){1&t&&(e.TgZ(0,"span",8),e._uU(1,"*"),e.qZA())}function dt(t,s){if(1&t&&(e.TgZ(0,"legend",5)(1,"label",6),e._uU(2),e.YNc(3,at,2,0,"span",7),e.qZA()()),2&t){const n=e.oxw();e.xp6(),e.Q6J("for",n.field.id),e.xp6(),e.hij(" ",n.props.label," "),e.xp6(),e.Q6J("ngIf",n.props.required)}}function ct(t,s){1&t&&e.GkF(0)}function ut(t,s){1&t&&e.GkF(0)}function mt(t,s){if(1&t&&e._UZ(0,"div",9),2&t){const n=e.oxw();e.Q6J("innerHTML",n.parsedDescription,e.oJD)}}function pt(t,s){1&t&&(e.TgZ(0,"div",16)(1,"span",17),e._uU(2,"Loading..."),e.qZA()())}function ft(t,s){1&t&&e.GkF(0)}function ht(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"div",18),e.YNc(2,ft,1,0,"ng-container",2),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(2),e.Q6J("ngTemplateOutlet",n.additionalInputsTemplate)}}function gt(t,s){if(1&t&&(e.TgZ(0,"div",19),e._UZ(1,"formly-validation-message",20),e.qZA()),2&t){const n=e.oxw(2);e.Udp("display","block"),e.xp6(),e.Q6J("field",n.field)}}function yt(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"input",12),e.NdJ("ngModelChange",function(o){e.CHM(n);const r=e.oxw();return e.KtG(r.inputValue=o)})("selectItem",function(o){e.CHM(n);const r=e.oxw();return e.KtG(r.selectEntity(o))})("focus",function(o){e.CHM(n);const r=e.oxw();return e.KtG(r.focusSubject.next(o.target.value))}),e.qZA(),e.YNc(3,pt,3,0,"div",13),e.qZA(),e.YNc(4,ht,3,1,"ng-container",14),e.qZA(),e.YNc(5,gt,2,3,"div",15)}if(2&t){const n=e.oxw();e.xp6(2),e.ekj("is-invalid",n.showError),e.Q6J("ngModel",n.inputValue)("formlyAttributes",n.field)("ngbTypeahead",n.search)("editable",!1)("inputFormatter",n.inputFormatter)("resultFormatter",n.resultFormatter),e.xp6(),e.Q6J("ngIf",n.searching),e.xp6(),e.Q6J("ngIf",n.additionalInputsTemplate),e.xp6(),e.Q6J("ngIf",n.showError)}}let _t=(()=>{var t;class s{constructor(i,o,r,a){this.customFormUtilsService=i,this.changeDetectorRef=o,this.toastService=r,this.destroyRef=a,this.showError=!1,this.selectItemEvent=new e.vpe,this.populateListEvent=new e.vpe,this.inputValue="",this.inputFormatter=u=>u.name,this.focusSubject=new re.x,this.searching=!1,this.formlyFieldValues=[],this.search=u=>{const b=u.pipe((0,se.b)(700),(0,nt.x)());return(0,ot.T)(b,this.focusSubject).pipe((0,he.b)(()=>this.setSearching(!0)),(0,rt.w)(F=>F.length<3?(0,st.of)([]):this.searchFunction(F)),(0,he.b)(()=>this.setSearching(!1)))}}ngOnInit(){this.formControl=this.field.formControl,this.props=this.field.props,this.parsedDescription=this.props.description?this.customFormUtilsService.parseBBCode(this.props.description):void 0,this.formlyFieldValues=Array.isArray(this.formControl.value)?this.formControl.value:Array.isArray(this.field.defaultValue)?this.field.defaultValue:[],this.populateListEvent.emit(this.formlyFieldValues),this.formControl.updateValueAndValidity(),this.removeItemObservable.pipe((0,ge.sL)(this.destroyRef)).subscribe(i=>{const o=this.formlyFieldValues.indexOf(i);o>-1&&(this.formlyFieldValues.splice(o,1),this.formControl.setValue([...this.formlyFieldValues]))})}resultFormatter(i){return i.name.indexOf("&")>-1?function it(t){const s=document.createElement("TEXTAREA");return s.innerHTML=t,s.value}(i.name):i.name}setSearching(i){this.searching=i,this.changeDetectorRef.detectChanges()}selectEntity(i){const o=i.item;if(i.preventDefault(),this.formlyFieldValues.includes(o.id))return this.toastService.show({content:"L'elemento <strong>".concat(o.name,"</strong> \xe8 gi\xe0 stato aggiunto alla lista!"),level:tt.m.ERROR}),void(this.inputValue="");this.formlyFieldValues.push(o.id),this.selectItemEvent.emit(i.item),this.inputValue="",this.updateFieldValue()}updateFieldValue(){this.formControl.setValue([...this.formlyFieldValues])}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(v.d6),e.Y36(e.sBO),e.Y36(lt.k),e.Y36(e.ktI))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-formly-typeahead"]],inputs:{field:"field",showError:"showError",removeItemObservable:"removeItemObservable",searchFunction:"searchFunction",resultsTemplate:"resultsTemplate",additionalInputsTemplate:"additionalInputsTemplate"},outputs:{selectItemEvent:"selectItemEvent",populateListEvent:"populateListEvent"},decls:7,vars:6,consts:[[1,"mb-3","rounded","px-3","pt-2","pb-3","formly-fieldset"],["class","legend-reset fs-reset mb-0 px-2 mw-100 lh-1 py-1",4,"ngIf"],[4,"ngTemplateOutlet"],["class","form-text text-muted",3,"innerHTML",4,"ngIf"],["typeaheadTemplate",""],[1,"legend-reset","fs-reset","mb-0","px-2","mw-100","lh-1","py-1"],[1,"form-label","mb-0","mw-100","text-truncate",3,"for"],["aria-hidden","true",4,"ngIf"],["aria-hidden","true"],[1,"form-text","text-muted",3,"innerHTML"],[1,"d-flex","flex-column","flex-sm-row"],[1,"position-relative","flex-grow-1"],["type","text","placeholder","Cerca...","container","body",1,"form-control",3,"ngModel","formlyAttributes","ngbTypeahead","editable","inputFormatter","resultFormatter","ngModelChange","selectItem","focus"],["class","spinner-border spinner-border-sm text-primary position-absolute","role","status",4,"ngIf"],[4,"ngIf"],["class","invalid-feedback",3,"display",4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm","text-primary","position-absolute"],[1,"visually-hidden"],[1,"ms-sm-3","mt-3","mt-sm-0"],[1,"invalid-feedback"],[3,"field"]],template:function(i,o){if(1&i&&(e.TgZ(0,"fieldset",0),e.YNc(1,dt,4,3,"legend",1)(2,ct,1,0,"ng-container",2)(3,ut,1,0,"ng-container",2)(4,mt,1,1,"div",3),e.qZA(),e.YNc(5,yt,6,11,"ng-template",null,4,e.W1O)),2&i){const r=e.MAs(6);e.ekj("has-error",o.formControl.invalid),e.xp6(),e.Q6J("ngIf",o.props.label),e.xp6(),e.Q6J("ngTemplateOutlet",r),e.xp6(),e.Q6J("ngTemplateOutlet",o.resultsTemplate),e.xp6(),e.Q6J("ngIf",o.parsedDescription)}},dependencies:[y.O5,y.tP,S.JD,S.M2,f.Fj,f.JJ,f.On,G.dR],styles:[".spinner-border[_ngcontent-%COMP%]{top:calc(50% - 8px);right:10px}"],changeDetection:0}),s})();function vt(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"app-formly-typeahead-content",3),e.NdJ("removeEvent",function(o){e.CHM(n);const r=e.oxw();return e.KtG(r.removeItemSubject.next(o))}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("listTitle",n.listTitle)("list",n.list)("loading",n.loading)("defaultImage",n.defaultThumb)}}function Ct(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"app-domain-select",4),e.NdJ("modelChange",function(o){e.CHM(n);const r=e.oxw();return e.KtG(r.selectedDomain=o)}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("model",n.selectedDomain)}}let ye=(()=>{var t;class s{constructor(i,o){var a,r=this;this.globalsService=i,this.changeDetectorRef=o,this.showError=!1,this.listTitle="",this.defaultThumb="/assets/default_avatar.png",this.removeItemSubject=new re.x,this.list=[],this.hasDomainSelect=!1,this.loading=!0,this.lastResults=[],this.search=function(){var u=(0,N.Z)(function*(b){return r.lastDomain===r.selectedDomain&&r.lastSearchedValueWithoutResult&&b.startsWith(r.lastSearchedValueWithoutResult)?[]:(r.lastDomain=r.selectedDomain,r.lastResults=yield r.searchFunction(b,(0,v.vV)(r.selectedDomain)),r.lastSearchedValueWithoutResult=r.lastResults.length?void 0:b,r.lastResults.map(J=>({id:J.id,name:J.title})))});return function(b){return u.apply(this,arguments)}}(),this.selectedDomain=this.lastDomain=(null===(a=this.globalsService.credentials)||void 0===a?void 0:a.site.domain)||v.ig.FORUMFREE}ngOnInit(){this.hasDomainSelect=!0===this.field.props.selectDomain}populateListEvent(i){var o=this;return(0,N.Z)(function*(){o.list=(yield o.populateFunction(i)).sort((r,a)=>r.title.localeCompare(a.title)),o.loading=!1,o.changeDetectorRef.detectChanges()})()}selectItemEvent(i){const o=this.lastResults.find(r=>r.id===i.id);o&&(this.list=[...this.list,this.createEntityFunction(o)])}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(Ne.d),e.Y36(e.sBO))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-formly-forum-typeahead"]],inputs:{field:"field",showError:"showError",listTitle:"listTitle",defaultThumb:"defaultThumb",searchFunction:"searchFunction",populateFunction:"populateFunction",createEntityFunction:"createEntityFunction"},decls:5,vars:6,consts:[[3,"field","showError","removeItemObservable","searchFunction","resultsTemplate","additionalInputsTemplate","populateListEvent","selectItemEvent"],["contentList",""],["circuitSelect",""],[3,"listTitle","list","loading","defaultImage","removeEvent"],[3,"model","modelChange"]],template:function(i,o){if(1&i&&(e.TgZ(0,"app-formly-typeahead",0),e.NdJ("populateListEvent",function(a){return o.populateListEvent(a)})("selectItemEvent",function(a){return o.selectItemEvent(a)}),e.qZA(),e.YNc(1,vt,1,4,"ng-template",null,1,e.W1O)(3,Ct,1,1,"ng-template",null,2,e.W1O)),2&i){const r=e.MAs(2),a=e.MAs(4);e.Q6J("field",o.field)("showError",o.showError)("removeItemObservable",o.removeItemSubject)("searchFunction",o.search)("resultsTemplate",r)("additionalInputsTemplate",o.hasDomainSelect?a:void 0)}},dependencies:[He,et,_t],encapsulation:2,changeDetection:0}),s})(),bt=(()=>{var t;class s extends S.fS{constructor(i){var o;super(),o=this,this.forumService=i,this.defaultThumb="/assets/default_forum.jpg",this.search=function(){var r=(0,N.Z)(function*(a,u){const b=(0,v.$t)(u);return b?(yield o.forumService.searchForumByName(a,u)).map(F=>({id:"".concat(b.shortdomain).concat(F.id),title:F.domain,preview:F.preview})):[]});return function(a,u){return r.apply(this,arguments)}}(),this.populateList=function(){var r=(0,N.Z)(function*(a){const u=yield o.forumService.getForumDetailsFromCids(a),b=(0,v.tX)(a,u.map(F=>F.cid));return[...u.map(F=>o.generateTypeaheadContentEntity(F.cid,F.domain,F.preview)),...b.map(F=>o.generateTypeaheadContentEntity(F,F,o.defaultThumb,!0))]});return function(a){return r.apply(this,arguments)}}(),this.searchToTypeaheadContentEntity=r=>this.generateTypeaheadContentEntity(r.id,r.title,r.preview)}generateTypeaheadContentEntity(i,o,r,a=!1){const u=(0,v.$t)(i);if(!u)throw new Error("Invalid cid ".concat(i,"!"));return{id:i,title:o,image:r,type:u.shortdomain,link:"https://"+(a?"".concat(u.domain,"/?cid=").concat(u.id):"".concat(o,".").concat(u.domain))}}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(oe._))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-list"]],features:[e.qOj],decls:1,vars:6,consts:[["listTitle","Lista forum",3,"field","showError","defaultThumb","searchFunction","populateFunction","createEntityFunction"]],template:function(i,o){1&i&&e._UZ(0,"app-formly-forum-typeahead",0),2&i&&e.Q6J("field",o.field)("showError",o.showError)("defaultThumb",o.defaultThumb)("searchFunction",o.search)("populateFunction",o.populateList)("createEntityFunction",o.searchToTypeaheadContentEntity)},dependencies:[ye],encapsulation:2,changeDetection:0}),s})();function Ft(t,s){1&t&&(e.ynx(0),e.TgZ(1,"p",3),e._UZ(2,"span",4),e.qZA(),e.BQk())}function xt(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",9),e.BQk()),2&t){const n=s.$implicit;e.xp6(),e.Q6J("ngValue",n.id)("innerHTML"," - "+n.name,e.oJD)}}function Tt(t,s){if(1&t&&(e.ynx(0),e.YNc(1,xt,2,2,"ng-container",7),e.BQk()),2&t){const n=e.oxw().$implicit;e.xp6(),e.Q6J("ngForOf",n.subsections)}}function Et(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",9),e.YNc(2,Tt,2,1,"ng-container",8),e.BQk()),2&t){const n=s.$implicit;e.xp6(),e.Q6J("ngValue",n.id)("innerHTML",n.name,e.oJD),e.xp6(),e.Q6J("ngIf",n.subsections&&n.subsections.length)}}function Ot(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",9),e.BQk()),2&t){const n=s.$implicit;e.xp6(),e.Q6J("ngValue",n)("innerHTML"," -- Sezione ristretta -- #"+n,e.oJD)}}function Mt(t,s){if(1&t&&(e.ynx(0),e.YNc(1,Ot,2,2,"ng-container",7),e.BQk()),2&t){const n=e.oxw(3);e.xp6(),e.Q6J("ngForOf",n.restrictedOrDeletedSections)}}function wt(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"select",6),e.YNc(2,Et,3,3,"ng-container",7)(3,Mt,2,1,"ng-container",8),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(),e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(),e.Q6J("ngForOf",n.sectionsList),e.xp6(),e.Q6J("ngIf",n.restrictedOrDeletedSections.length>0)}}function St(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",9),e.BQk()),2&t){const n=s.$implicit;e.xp6(),e.Q6J("ngValue",n.id)("innerHTML"," - "+n.name,e.oJD)}}function It(t,s){if(1&t&&(e.ynx(0),e.YNc(1,St,2,2,"ng-container",7),e.BQk()),2&t){const n=e.oxw().$implicit;e.xp6(),e.Q6J("ngForOf",n.subsections)}}function At(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",9),e.YNc(2,It,2,1,"ng-container",8),e.BQk()),2&t){const n=s.$implicit;e.xp6(),e.Q6J("ngValue",n.id)("innerHTML",n.name,e.oJD),e.xp6(),e.Q6J("ngIf",n.subsections&&n.subsections.length)}}function Zt(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"option",9),e.BQk()),2&t){const n=s.$implicit;e.xp6(),e.Q6J("ngValue",n)("innerHTML"," -- Sezione ristretta -- #"+n,e.oJD)}}function Lt(t,s){if(1&t&&(e.ynx(0),e.YNc(1,Zt,2,2,"ng-container",7),e.BQk()),2&t){const n=e.oxw(3);e.xp6(),e.Q6J("ngForOf",n.restrictedOrDeletedSections)}}function Dt(t,s){if(1&t&&(e.TgZ(0,"select",10),e.YNc(1,At,3,3,"ng-container",7)(2,Lt,2,1,"ng-container",8),e.qZA()),2&t){const n=e.oxw(2);e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(),e.Q6J("ngForOf",n.sectionsList),e.xp6(),e.Q6J("ngIf",n.restrictedOrDeletedSections.length>0)}}function qt(t,s){if(1&t&&e.YNc(0,wt,4,6,"ng-container",1)(1,Dt,3,6,"ng-template",null,5,e.W1O),2&t){const n=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.field.props.multiple)("ngIfElse",n)}}const Qt=t=>({"no-label":t});let Jt=(()=>{var t;class s extends S.fS{constructor(i,o){super(),this.forumService=i,this.changeDetectorRef=o,this.loading=!0,this.sectionsList=[],this.restrictedOrDeletedSections=[]}prePopulate(i){i.props||(i.props={}),i.props.resetButton=!0}ngOnInit(){var i=this;return(0,N.Z)(function*(){i.field.defaultValue=void 0,(0,v.o8)(i.field.props,"multiple")||(i.field.props.multiple=!0),i.restrictedOrDeletedSections=Array.isArray(i.field.formControl.value)?[...i.field.formControl.value]:[];const o=yield i.forumService.getSections();i.sectionsList=o.map(r=>{const a=i.restrictedOrDeletedSections.indexOf(r.id);return a>-1&&i.restrictedOrDeletedSections.splice(a,1),(0,x.Z)((0,x.Z)({},r),{subsections:i.flattenSubsections(r)})}),i.loading=!1,i.field.formControl.updateValueAndValidity(),i.changeDetectorRef.detectChanges()})()}flattenSubsections(i){let o=[],r=-1;if(i.subsections&&i.subsections.length)for(const a of i.subsections)r=this.restrictedOrDeletedSections.indexOf(a.id),r>-1&&this.restrictedOrDeletedSections.splice(r,1),o.push(a),a.subsections&&(o=[...o,...this.flattenSubsections(a)]);return o}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(oe._),e.Y36(e.sBO))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-sections"]],features:[e.qOj],decls:4,vars:5,consts:[[1,"position-relative","wrapper",3,"ngClass"],[4,"ngIf","ngIfElse"],["formSelect",""],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],["single",""],["multiple","",1,"form-select",3,"formControl","formlyAttributes"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ngValue","innerHTML"],[1,"form-select",3,"formControl","formlyAttributes"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,Ft,3,0,"ng-container",1)(2,qt,3,2,"ng-template",null,2,e.W1O),e.qZA()),2&i){const r=e.MAs(3);e.Q6J("ngClass",e.VKq(3,Qt,!o.props.label)),e.xp6(),e.Q6J("ngIf",o.loading)("ngIfElse",r)}},dependencies:[y.mk,y.sg,y.O5,S.JD,f.YN,f.Kr,f.EJ,f.K7,f.JJ,f.oH],encapsulation:2}),s})();var Vt=p(8418);let Pt=(()=>{var t;class s extends S.fS{constructor(i){var o;super(),o=this,this.userService=i,this.defaultThumb="/assets/default_avatar.png",this.search=function(){var r=(0,N.Z)(function*(a,u){return(yield o.userService.searchUserByName(a,u)).map(b=>({id:b.uid,title:b.nickname,preview:b.avatar}))});return function(a,u){return r.apply(this,arguments)}}(),this.populateList=function(){var r=(0,N.Z)(function*(a){const u=yield o.userService.getDetailsFromUids(a),b=(0,v.tX)(a,u.map(F=>F.uid));return[...u.map(F=>o.generateTypeaheadContentEntity(F.uid,F.nickname,F.avatar)),...b.map(F=>o.generateTypeaheadContentEntity(F,F,o.defaultThumb))]});return function(a){return r.apply(this,arguments)}}(),this.searchToTypeaheadContentEntity=r=>this.generateTypeaheadContentEntity(r.id,r.title,r.preview)}generateTypeaheadContentEntity(i,o,r){const a=i.substring(0,2),u=(0,v.A)(a);if(!u)throw new Error("Invalid uid ".concat(i,"!"));return{id:i,title:o,image:r,type:a,link:"".concat(u,"/?act=Profile&MID=").concat(i.substring(2))}}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(Vt.K))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-users"]],features:[e.qOj],decls:1,vars:6,consts:[["listTitle","Lista utenti",3,"field","showError","defaultThumb","searchFunction","populateFunction","createEntityFunction"]],template:function(i,o){1&i&&e._UZ(0,"app-formly-forum-typeahead",0),2&i&&e.Q6J("field",o.field)("showError",o.showError)("defaultThumb",o.defaultThumb)("searchFunction",o.search)("populateFunction",o.populateList)("createEntityFunction",o.searchToTypeaheadContentEntity)},dependencies:[ye],encapsulation:2,changeDetection:0}),s})(),Ut=(()=>{var t;class s extends S.fS{constructor(){super(...arguments),this.defaultOptions={props:{label:""}}}}return(t=s).\u0275fac=(()=>{let n;return function(o){return(n||(n=e.n5z(t)))(o||t)}})(),t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-label"]],features:[e.qOj],decls:2,vars:1,template:function(i,o){1&i&&(e.TgZ(0,"h5"),e._uU(1),e.qZA()),2&i&&(e.xp6(),e.Oqu(o.props.label))},encapsulation:2,changeDetection:0}),s})(),kt=(()=>{var t;class s{constructor(i){this.domPurifyService=i,this.purifyInlineCssHook=(0,v._H)(["background-color","color"],!0)}sanitizeHtml(i){this.domPurifyService.instance.addHook(this.purifyInlineCssHook.name,this.purifyInlineCssHook.callback);const o=this.domPurifyService.sanitizeAsString(i,v.CO.WYSIWYG);return this.domPurifyService.instance.removeHook(this.purifyInlineCssHook.name),o}}return(t=s).\u0275fac=function(i){return new(i||t)(e.LFG(v.WB))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),s})();const le={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]},ae=new e.OlP("config",{providedIn:"root",factory:()=>({modules:le})});var de=p(6593),Nt=p(4911),jt=p(2664),Rt=p(4036),Ht=p(7394),ce=p(2438),Gt=p(304),_e=p(9769);function Yt(t,s){1&t&&e._UZ(0,"pre",0)}function Bt(t,s){1&t&&e._UZ(0,"div",0)}function zt(t,s){if(1&t&&e.YNc(0,Yt,1,0,"pre",0)(1,Bt,1,0),2&t){const n=e.oxw();e.um2(0,n.preserve?0:1)}}function Wt(t,s){1&t&&e._UZ(0,"pre",0)}function $t(t,s){1&t&&e._UZ(0,"div",0)}function Kt(t,s){if(1&t&&e.YNc(0,Wt,1,0,"pre",0)(1,$t,1,0),2&t){const n=e.oxw();e.um2(0,n.preserve?0:1)}}const Xt=[[["","above-quill-editor-toolbar",""]],[["","quill-editor-toolbar",""]],[["","below-quill-editor-toolbar",""]]],ei=["[above-quill-editor-toolbar]","[quill-editor-toolbar]","[below-quill-editor-toolbar]"];function ti(t,s){1&t&&e._UZ(0,"pre",0)}function ii(t,s){1&t&&e._UZ(0,"div",0)}const ee=(t,s)=>t||s||"html";let ue=(()=>{var t;class s{constructor(i,o){var r=this;this.config=o,this.quill$=(0,Nt.P)((0,N.Z)(function*(){var a;if(!r.Quill){const u=r.document.addEventListener;r.document.addEventListener=r.document.__zone_symbol__addEventListener||r.document.addEventListener;const b=yield p.e(125).then(p.t.bind(p,7536,19));r.document.addEventListener=u,r.Quill=b.default?b.default:b}return null===(a=r.config.customOptions)||void 0===a||a.forEach(u=>{const b=r.Quill.import(u.import);b.whitelist=u.whitelist,r.Quill.register(b,!0,r.config.suppressGlobalRegisterWarning)}),yield r.registerCustomModules(r.Quill,r.config.customModules,r.config.suppressGlobalRegisterWarning)})).pipe((0,Gt.d)({bufferSize:1,refCount:!0})),this.document=i.get(y.K0),this.config||(this.config={modules:le})}getQuill(){return this.quill$}registerCustomModules(i,o,r){return(0,N.Z)(function*(){if(Array.isArray(o))for(let{implementation:a,path:u}of o)(0,jt.b)(a)&&(a=yield(0,Rt.z)(a)),i.register(u,a,r);return i})()}}return(t=s).\u0275fac=function(i){return new(i||t)(e.LFG(e.zs3),e.LFG(ae,8))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),s})(),ni=(()=>{var t;class s{constructor(){this.required=!1,this.customToolbarPosition="top",this.styles=null,this.strict=!0,this.customOptions=[],this.customModules=[],this.preserveWhitespace=!1,this.trimOnValidation=!1,this.compareValues=!1,this.filterNull=!1,this.defaultEmptyValue=null,this.onEditorCreated=new e.vpe,this.onEditorChanged=new e.vpe,this.onContentChanged=new e.vpe,this.onSelectionChanged=new e.vpe,this.onFocus=new e.vpe,this.onBlur=new e.vpe,this.onNativeFocus=new e.vpe,this.onNativeBlur=new e.vpe,this.disabled=!1,this.preserve=!1,this.toolbarPosition="top",this.subscription=null,this.quillSubscription=null,this.elementRef=(0,e.f3M)(e.SBq),this.document=(0,e.f3M)(y.K0),this.cd=(0,e.f3M)(e.sBO),this.domSanitizer=(0,e.f3M)(de.H7),this.platformId=(0,e.f3M)(e.Lbi),this.renderer=(0,e.f3M)(e.Qsj),this.zone=(0,e.f3M)(e.R0b),this.service=(0,e.f3M)(ue),this.valueGetter=(i,o)=>{let r=o.querySelector(".ql-editor").innerHTML;("<p><br></p>"===r||"<div><br></div>"===r)&&(r=this.defaultEmptyValue);let a=r;const u=ee(this.format,this.service.config.format);if("text"===u)a=i.getText();else if("object"===u)a=i.getContents();else if("json"===u)try{a=JSON.stringify(i.getContents())}catch(b){a=i.getText()}return a},this.valueSetter=(i,o)=>{const r=ee(this.format,this.service.config.format);if("html"===r)return([!0,!1].includes(this.sanitize)?this.sanitize:this.service.config.sanitize||!1)&&(o=this.domSanitizer.sanitize(e.q3G.HTML,o)),i.clipboard.convert(o);if("json"===r)try{return JSON.parse(o)}catch(a){return[{insert:o}]}return o},this.selectionChangeHandler=(i,o,r)=>{const a=this.trackChanges||this.service.config.trackChanges,u=!i&&!!this.onModelTouched&&("user"===r||a&&"all"===a);!this.onBlur.observed&&!this.onFocus.observed&&!this.onSelectionChanged.observed&&!u||this.zone.run(()=>{null===i?this.onBlur.emit({editor:this.quillEditor,source:r}):null===o&&this.onFocus.emit({editor:this.quillEditor,source:r}),this.onSelectionChanged.emit({editor:this.quillEditor,oldRange:o,range:i,source:r}),u&&this.onModelTouched(),this.cd.markForCheck()})},this.textChangeHandler=(i,o,r)=>{const a=this.quillEditor.getText(),u=this.quillEditor.getContents();let b=this.editorElem.querySelector(".ql-editor").innerHTML;("<p><br></p>"===b||"<div><br></div>"===b)&&(b=this.defaultEmptyValue);const F=this.trackChanges||this.service.config.trackChanges,J=("user"===r||F&&"all"===F)&&!!this.onModelChange;!this.onContentChanged.observed&&!J||this.zone.run(()=>{J&&this.onModelChange(this.valueGetter(this.quillEditor,this.editorElem)),this.onContentChanged.emit({content:u,delta:i,editor:this.quillEditor,html:b,oldDelta:o,source:r,text:a}),this.cd.markForCheck()})},this.editorChangeHandler=(i,o,r,a)=>{if(this.onEditorChanged.observed)if("text-change"===i){const u=this.quillEditor.getText(),b=this.quillEditor.getContents();let F=this.editorElem.querySelector(".ql-editor").innerHTML;("<p><br></p>"===F||"<div><br></div>"===F)&&(F=this.defaultEmptyValue),this.zone.run(()=>{this.onEditorChanged.emit({content:b,delta:o,editor:this.quillEditor,event:i,html:F,oldDelta:r,source:a,text:u}),this.cd.markForCheck()})}else this.zone.run(()=>{this.onEditorChanged.emit({editor:this.quillEditor,event:i,oldRange:r,range:o,source:a}),this.cd.markForCheck()})}}static normalizeClassNames(i){return i.trim().split(" ").reduce((r,a)=>{const u=a.trim();return u&&r.push(u),r},[])}ngOnInit(){this.preserve=this.preserveWhitespace,this.toolbarPosition=this.customToolbarPosition}ngAfterViewInit(){(0,y.PM)(this.platformId)||(this.quillSubscription=this.service.getQuill().pipe((0,_e.z)(i=>{var o;const r=[this.service.registerCustomModules(i,this.customModules)],a=null!==(o=this.beforeRender)&&void 0!==o?o:this.service.config.beforeRender;return a&&r.push(a()),Promise.all(r).then(()=>i)})).subscribe(i=>{this.editorElem=this.elementRef.nativeElement.querySelector("[quill-editor-element]");const o=this.elementRef.nativeElement.querySelector("[quill-editor-toolbar]"),r=Object.assign({},this.modules||this.service.config.modules);o?r.toolbar=o:void 0===r.toolbar&&(r.toolbar=le.toolbar);let a=void 0!==this.placeholder?this.placeholder:this.service.config.placeholder;void 0===a&&(a="Insert text here ..."),this.styles&&Object.keys(this.styles).forEach(V=>{this.renderer.setStyle(this.editorElem,V,this.styles[V])}),this.classes&&this.addClasses(this.classes),this.customOptions.forEach(V=>{const H=i.import(V.import);H.whitelist=V.whitelist,i.register(H,!0)});let u=this.bounds&&"self"===this.bounds?this.editorElem:this.bounds;u||(u=this.service.config.bounds?this.service.config.bounds:this.document.body);let b=this.debug;!b&&!1!==b&&this.service.config.debug&&(b=this.service.config.debug);let F=this.readOnly;!F&&!1!==this.readOnly&&(F=void 0!==this.service.config.readOnly&&this.service.config.readOnly);let J=this.defaultEmptyValue;this.service.config.hasOwnProperty("defaultEmptyValue")&&(J=this.service.config.defaultEmptyValue);let Y=this.scrollingContainer;!Y&&null!==this.scrollingContainer&&(Y=null===this.service.config.scrollingContainer||this.service.config.scrollingContainer?this.service.config.scrollingContainer:null);let j=this.formats;if(!j&&void 0===j&&(j=this.service.config.formats?[...this.service.config.formats]:null===this.service.config.formats?null:void 0),this.zone.runOutsideAngular(()=>{if(this.quillEditor=new i(this.editorElem,{bounds:u,debug:b,formats:j,modules:r,placeholder:a,readOnly:F,defaultEmptyValue:J,scrollingContainer:Y,strict:this.strict,theme:this.theme||(this.service.config.theme?this.service.config.theme:"snow")}),this.onNativeBlur.observed&&(this.quillEditor.scroll.domNode.addEventListener("blur",()=>this.onNativeBlur.next({editor:this.quillEditor,source:"dom"})),this.quillEditor.getModule("toolbar").container.addEventListener("mousedown",te=>te.preventDefault())),this.onNativeFocus.observed&&this.quillEditor.scroll.domNode.addEventListener("focus",()=>this.onNativeFocus.next({editor:this.quillEditor,source:"dom"})),this.linkPlaceholder){var V,H;const te=null===(V=this.quillEditor)||void 0===V||null===(V=V.theme)||void 0===V?void 0:V.tooltip,ie=null==te||null===(H=te.root)||void 0===H?void 0:H.querySelector("input[data-link]");null!=ie&&ie.dataset&&(ie.dataset.link=this.linkPlaceholder)}}),this.content){if("text"===ee(this.format,this.service.config.format))this.quillEditor.setText(this.content,"silent");else{const H=this.valueSetter(this.quillEditor,this.content);this.quillEditor.setContents(H,"silent")}this.quillEditor.getModule("history").clear()}this.setDisabledState(),this.addQuillEventListeners(),(this.onEditorCreated.observed||this.onValidatorChanged)&&requestAnimationFrame(()=>{this.onValidatorChanged&&this.onValidatorChanged(),this.onEditorCreated.emit(this.quillEditor),this.onEditorCreated.complete()})}))}ngOnDestroy(){var i;this.dispose(),null===(i=this.quillSubscription)||void 0===i||i.unsubscribe(),this.quillSubscription=null}ngOnChanges(i){if(this.quillEditor){if(i.readOnly&&this.quillEditor.enable(!i.readOnly.currentValue),i.placeholder&&(this.quillEditor.root.dataset.placeholder=i.placeholder.currentValue),i.defaultEmptyValue&&(this.quillEditor.root.dataset.defaultEmptyValue=i.defaultEmptyValue.currentValue),i.styles){const o=i.styles.currentValue,r=i.styles.previousValue;r&&Object.keys(r).forEach(a=>{this.renderer.removeStyle(this.editorElem,a)}),o&&Object.keys(o).forEach(a=>{this.renderer.setStyle(this.editorElem,a,this.styles[a])})}if(i.classes){const o=i.classes.currentValue,r=i.classes.previousValue;r&&this.removeClasses(r),o&&this.addClasses(o)}i.debounceTime&&this.addQuillEventListeners()}}addClasses(i){s.normalizeClassNames(i).forEach(o=>{this.renderer.addClass(this.editorElem,o)})}removeClasses(i){s.normalizeClassNames(i).forEach(o=>{this.renderer.removeClass(this.editorElem,o)})}writeValue(i){if(this.filterNull&&null===i||(this.content=i,!this.quillEditor))return;const o=ee(this.format,this.service.config.format),r=this.valueSetter(this.quillEditor,i);if(this.compareValues){const a=this.quillEditor.getContents();if(JSON.stringify(a)===JSON.stringify(r))return}i?"text"===o?this.quillEditor.setText(i):this.quillEditor.setContents(r):this.quillEditor.setText("")}setDisabledState(i=this.disabled){this.disabled=i,this.quillEditor&&(i?(this.quillEditor.disable(),this.renderer.setAttribute(this.elementRef.nativeElement,"disabled","disabled")):(this.readOnly||this.quillEditor.enable(),this.renderer.removeAttribute(this.elementRef.nativeElement,"disabled")))}registerOnChange(i){this.onModelChange=i}registerOnTouched(i){this.onModelTouched=i}registerOnValidatorChange(i){this.onValidatorChanged=i}validate(){if(!this.quillEditor)return null;const i={};let o=!0;const r=this.quillEditor.getText(),a=this.trimOnValidation?r.trim().length:1===r.length&&0===r.trim().length?0:r.length-1,u=this.quillEditor.getContents().ops,b=u&&1===u.length&&["\n",""].includes(u[0].insert);return this.minLength&&a&&a<this.minLength&&(i.minLengthError={given:a,minLength:this.minLength},o=!1),this.maxLength&&a>this.maxLength&&(i.maxLengthError={given:a,maxLength:this.maxLength},o=!1),this.required&&!a&&b&&(i.requiredError={empty:!0},o=!1),o?null:i}addQuillEventListeners(){this.dispose(),this.zone.runOutsideAngular(()=>{this.subscription=new Ht.w0,this.subscription.add((0,ce.R)(this.quillEditor,"selection-change").subscribe(([r,a,u])=>{this.selectionChangeHandler(r,a,u)}));let i=(0,ce.R)(this.quillEditor,"text-change"),o=(0,ce.R)(this.quillEditor,"editor-change");"number"==typeof this.debounceTime&&(i=i.pipe((0,se.b)(this.debounceTime)),o=o.pipe((0,se.b)(this.debounceTime))),this.subscription.add(i.subscribe(([r,a,u])=>{this.textChangeHandler(r,a,u)})),this.subscription.add(o.subscribe(([r,a,u,b])=>{this.editorChangeHandler(r,a,u,b)}))})}dispose(){null!==this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275dir=e.lG2({type:t,inputs:{format:"format",theme:"theme",modules:"modules",debug:"debug",readOnly:"readOnly",placeholder:"placeholder",maxLength:"maxLength",minLength:"minLength",required:"required",formats:"formats",customToolbarPosition:"customToolbarPosition",sanitize:"sanitize",beforeRender:"beforeRender",styles:"styles",strict:"strict",scrollingContainer:"scrollingContainer",bounds:"bounds",customOptions:"customOptions",customModules:"customModules",trackChanges:"trackChanges",preserveWhitespace:"preserveWhitespace",classes:"classes",trimOnValidation:"trimOnValidation",linkPlaceholder:"linkPlaceholder",compareValues:"compareValues",filterNull:"filterNull",debounceTime:"debounceTime",defaultEmptyValue:"defaultEmptyValue",valueGetter:"valueGetter",valueSetter:"valueSetter"},outputs:{onEditorCreated:"onEditorCreated",onEditorChanged:"onEditorChanged",onContentChanged:"onContentChanged",onSelectionChanged:"onSelectionChanged",onFocus:"onFocus",onBlur:"onBlur",onNativeFocus:"onNativeFocus",onNativeBlur:"onNativeBlur"},features:[e.TTD]}),s})(),ve=(()=>{var t;class s extends ni{}return(t=s).\u0275fac=(()=>{let n;return function(o){return(n||(n=e.n5z(t)))(o||t)}})(),t.\u0275cmp=e.Xpm({type:t,selectors:[["quill-editor"]],standalone:!0,features:[e._Bn([{multi:!0,provide:f.JU,useExisting:(0,e.Gpc)(()=>t)},{multi:!0,provide:f.Cf,useExisting:(0,e.Gpc)(()=>t)}]),e.qOj,e.jDz],ngContentSelectors:ei,decls:5,vars:2,consts:[["quill-editor-element",""]],template:function(i,o){1&i&&(e.F$t(Xt),e.YNc(0,zt,2,1),e.Hsn(1),e.Hsn(2,1),e.Hsn(3,2),e.YNc(4,Kt,2,1)),2&i&&(e.um2(0,"top"!==o.toolbarPosition?0:-1),e.xp6(4),e.um2(4,"top"===o.toolbarPosition?4:-1))},dependencies:[y.ez],styles:["[_nghost-%COMP%]{display:inline-block}"]}),s})(),oi=(()=>{var t;class s{constructor(i,o){this.sanitizer=i,this.service=o,this.content="",this.innerHTML="",this.themeClass="ql-snow"}ngOnChanges(i){if(i.theme?this.themeClass="ql-".concat(i.theme.currentValue||(this.service.config.theme?this.service.config.theme:"snow")," ngx-quill-view-html"):this.theme||(this.themeClass="ql-".concat(this.service.config.theme?this.service.config.theme:"snow"," ngx-quill-view-html")),i.content){const o=i.content.currentValue,r=[!0,!1].includes(this.sanitize)?this.sanitize:this.service.config.sanitize||!1;this.innerHTML=r?o:this.sanitizer.bypassSecurityTrustHtml(o)}}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(de.H7),e.Y36(ue))},t.\u0275cmp=e.Xpm({type:t,selectors:[["quill-view-html"]],inputs:{content:"content",theme:"theme",sanitize:"sanitize"},standalone:!0,features:[e.TTD,e.jDz],decls:2,vars:2,consts:[[1,"ql-container",3,"ngClass"],[1,"ql-editor",3,"innerHTML"]],template:function(i,o){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.qZA()),2&i&&(e.Q6J("ngClass",o.themeClass),e.xp6(),e.Q6J("innerHTML",o.innerHTML,e.oJD))},dependencies:[y.ez,y.mk],styles:[".ql-container.ngx-quill-view-html{border:0}\n"],encapsulation:2}),s})(),ri=(()=>{var t;class s{constructor(i,o,r,a,u,b){this.elementRef=i,this.renderer=o,this.zone=r,this.service=a,this.domSanitizer=u,this.platformId=b,this.strict=!0,this.customModules=[],this.customOptions=[],this.preserveWhitespace=!1,this.onEditorCreated=new e.vpe,this.preserve=!1,this.quillSubscription=null,this.valueSetter=(F,J)=>{const Y=ee(this.format,this.service.config.format);let j=J;if("text"===Y)F.setText(j);else{if("html"===Y)([!0,!1].includes(this.sanitize)?this.sanitize:this.service.config.sanitize||!1)&&(J=this.domSanitizer.sanitize(e.q3G.HTML,J)),j=F.clipboard.convert(J);else if("json"===Y)try{j=JSON.parse(J)}catch(V){j=[{insert:J}]}F.setContents(j)}}}ngOnInit(){this.preserve=this.preserveWhitespace}ngOnChanges(i){this.quillEditor&&i.content&&this.valueSetter(this.quillEditor,i.content.currentValue)}ngAfterViewInit(){(0,y.PM)(this.platformId)||(this.quillSubscription=this.service.getQuill().pipe((0,_e.z)(i=>{var o;const r=[this.service.registerCustomModules(i,this.customModules)],a=null!==(o=this.beforeRender)&&void 0!==o?o:this.service.config.beforeRender;return a&&r.push(a()),Promise.all(r).then(()=>i)})).subscribe(i=>{const o=Object.assign({},this.modules||this.service.config.modules);o.toolbar=!1,this.customOptions.forEach(b=>{const F=i.import(b.import);F.whitelist=b.whitelist,i.register(F,!0)});let r=this.debug;!r&&!1!==r&&this.service.config.debug&&(r=this.service.config.debug);let a=this.formats;!a&&void 0===a&&(a=this.service.config.formats?Object.assign({},this.service.config.formats):null===this.service.config.formats?null:void 0);const u=this.theme||(this.service.config.theme?this.service.config.theme:"snow");this.editorElem=this.elementRef.nativeElement.querySelector("[quill-view-element]"),this.zone.runOutsideAngular(()=>{this.quillEditor=new i(this.editorElem,{debug:r,formats:a,modules:o,readOnly:!0,strict:this.strict,theme:u})}),this.renderer.addClass(this.editorElem,"ngx-quill-view"),this.content&&this.valueSetter(this.quillEditor,this.content),this.onEditorCreated.observers.length&&requestAnimationFrame(()=>{this.onEditorCreated.emit(this.quillEditor),this.onEditorCreated.complete()})}))}ngOnDestroy(){var i;null===(i=this.quillSubscription)||void 0===i||i.unsubscribe(),this.quillSubscription=null}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(e.R0b),e.Y36(ue),e.Y36(de.H7),e.Y36(e.Lbi))},t.\u0275cmp=e.Xpm({type:t,selectors:[["quill-view"]],inputs:{format:"format",theme:"theme",modules:"modules",debug:"debug",formats:"formats",sanitize:"sanitize",beforeRender:"beforeRender",strict:"strict",content:"content",customModules:"customModules",customOptions:"customOptions",preserveWhitespace:"preserveWhitespace"},outputs:{onEditorCreated:"onEditorCreated"},standalone:!0,features:[e.TTD,e.jDz],decls:2,vars:1,consts:[["quill-view-element",""]],template:function(i,o){1&i&&e.YNc(0,ti,1,0,"pre",0)(1,ii,1,0),2&i&&e.um2(0,o.preserve?0:1)},dependencies:[y.ez],styles:[".ql-container.ngx-quill-view{border:0}\n"],encapsulation:2}),s})(),si=(()=>{var t;class s{static forRoot(i){return{ngModule:s,providers:[{provide:ae,useValue:i}]}}}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[ve,ri,oi]}),s})();const Ce=["#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"];function ai(t,s){const n=t.getSelection(!0);n&&(t.insertEmbed(n.index,"image",s,"user"),t.setSelection(n.index+1,0))}function di(t,s,n){const i=t.getSelection(!0);if(i){const o=n||s;t.insertText(i.index,o,"link",s,"user"),t.setSelection(i.index+o.length,0)}}var be=p(9054),ci=p(4464),ui=p(5487),Fe=p(9773),mi=p(8366),pi=p(9295);const fi=["uploadModal"],hi=["uploadDropdown"];function gi(t,s){1&t&&e._UZ(0,"app-upload-widget")}const yi=()=>["bottom-start","bottom","auto"],_i=()=>({centered:!0});let vi=(()=>{var t;class s{constructor(i){this.uploadObservablesService=i,this.imagesSelect=new e.vpe,this.filesSelect=new e.vpe,this.urlModel="",this.isUrlValid=!1,this.isUploading=!1,this.popoverMessage="",this.closeUploadModalSubject=new re.x}checkImageUrl(){this.isUrlValid=!!/^https:\/\//i.test(this.urlModel)}insertImageFromUrl(){var i;null===(i=this.uploadDropdownRef)||void 0===i||i.close(),this.isUrlValid&&((0,be.Or)((0,be.Tb)(this.urlModel).ext)?this.imagesSelect.emit([this.urlModel]):this.filesSelect.emit([this.urlModel])),this.urlModel="",this.isUrlValid=!1}showUploadModal(){var i,o;null===(i=this.uploadModalRef)||void 0===i||i.open(),null===(o=this.uploadDropdownRef)||void 0===o||o.close(),this.setUploadModalSubscriptions()}setUploadModalSubscriptions(){this.uploadObservablesService.uploadingFileQueueObservable.pipe((0,Fe.R)(this.closeUploadModalSubject)).subscribe(i=>{this.isUploading=i.length>0}),this.uploadObservablesService.uploadedFileObservable.pipe((0,Fe.R)(this.closeUploadModalSubject)).subscribe(i=>{var o;null===(o=this.uploadModalRef)||void 0===o||o.close();const r=[],a=[];for(const u of i)(u.isImage?r:a).push(u.url);this.imagesSelect.emit(r),this.filesSelect.emit(a)})}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(ui.r))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-wysiwyg-image-upload"]],viewQuery:function(i,o){if(1&i&&(e.Gf(fi,5),e.Gf(hi,5)),2&i){let r;e.iGM(r=e.CRH())&&(o.uploadModalRef=r.first),e.iGM(r=e.CRH())&&(o.uploadDropdownRef=r.first)}},outputs:{imagesSelect:"imagesSelect",filesSelect:"filesSelect"},decls:24,vars:12,consts:[["ngbDropdown","","container","body","display","dynamic",1,"dropdown-no-caret",3,"placement"],["uploadDropdown","ngbDropdown"],["type","button","ngbDropdownToggle","",3,"disabled"],["viewBox","0 0 18 18","xmlns","http://www.w3.org/2000/svg"],["height","10","width","12","x","3","y","4",1,"ql-stroke"],["cx","6","cy","7","r","1",1,"ql-fill"],["points","5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12",1,"ql-even","ql-fill"],["ngbDropdownMenu",""],[1,"d-flex","flex-column","px-2"],["for","wysiwyg-image-url",1,"small","text-muted","me-auto"],[1,"input-group"],["type","text","placeholder","URL","id","wysiwyg-image-url",1,"form-control","form-control-sm","fs-reset",3,"ngModel","ngModelChange"],["type","button",1,"input-group-text","btn","btn-sm","btn-outline-primary","text-center",3,"disabled","click"],[1,"small","text-muted","d-flex","separator","align-items-center","my-2"],[1,"px-3","pb-1"],["type","button",1,"btn","btn-sm","btn-primary","text-center","d-block",3,"disabled","click"],["bodyClass","p-0",3,"showHead","showFooter","options","hidden"],["uploadModal",""],["appModalBody",""]],template:function(i,o){1&i&&(e.TgZ(0,"div",0,1)(2,"button",2),e.O4$(),e.TgZ(3,"svg",3),e._UZ(4,"rect",4)(5,"circle",5)(6,"polyline",6),e.qZA()(),e.kcU(),e.TgZ(7,"div",7)(8,"div",8)(9,"div")(10,"label",9),e._uU(11,"Inserisci da url:"),e.qZA(),e.TgZ(12,"div",10)(13,"input",11),e.NdJ("ngModelChange",function(a){return o.urlModel=a})("ngModelChange",function(){return o.checkImageUrl()}),e.qZA(),e.TgZ(14,"button",12),e.NdJ("click",function(){return o.insertImageFromUrl()}),e._uU(15,"Salva"),e.qZA()()(),e.TgZ(16,"div",13)(17,"div",14),e._uU(18,"oppure"),e.qZA()(),e.TgZ(19,"button",15),e.NdJ("click",function(){return o.showUploadModal()}),e._uU(20,"Carica da locale!"),e.qZA()()()(),e.TgZ(21,"app-modal",16,17),e.NdJ("hidden",function(){return o.closeUploadModalSubject.next()}),e.YNc(23,gi,1,0,"ng-template",18),e.qZA()),2&i&&(e.Q6J("placement",e.DdM(10,yi)),e.xp6(2),e.ekj("pending",o.isUploading),e.Q6J("disabled",o.isUploading),e.xp6(11),e.Q6J("ngModel",o.urlModel),e.xp6(),e.Q6J("disabled",!o.isUrlValid),e.xp6(5),e.Q6J("disabled",o.isUploading),e.xp6(2),e.Q6J("showHead",!1)("showFooter",!1)("options",e.DdM(11,_i)))},dependencies:[f.Fj,f.JJ,f.On,ci.z,mi.J,G.jt,G.iD,G.Vi,pi.o],styles:['.separator[_ngcontent-%COMP%]:before, .separator[_ngcontent-%COMP%]:after{content:"";flex-grow:1;border-bottom:1px solid #dee2e6}.pending[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}#wysiwyg-image-url[_ngcontent-%COMP%]{max-width:100px}app-upload-widget[_ngcontent-%COMP%]{height:300px}@media (min-width: 300px){#wysiwyg-image-url[_ngcontent-%COMP%]{max-width:150px}}@media (min-width: 576px){#wysiwyg-image-url[_ngcontent-%COMP%]{min-width:230px;max-width:unset}}']}),s})();function Ci(t,s){if(1&t&&(e.TgZ(0,"option"),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.uIk("value",n.const)("selected",void 0===n.const?"selected":void 0),e.xp6(),e.Oqu(n.title||"")}}function bi(t,s){if(1&t&&(e.TgZ(0,"select"),e.YNc(1,Ci,2,3,"option",4),e.qZA()),2&t){const n=e.oxw().$implicit;e.Tol("ql-"+n.type),e.xp6(),e.Q6J("ngForOf",n.values)}}function Fi(t,s){if(1&t&&e._UZ(0,"button"),2&t){const n=e.oxw().$implicit;e.Tol("ql-"+n.type),e.uIk("value",n.value)}}function xi(t,s){if(1&t&&(e.ynx(0),e.YNc(1,bi,2,3,"select",5)(2,Fi,1,3,"ng-template",null,6,e.W1O),e.BQk()),2&t){const n=s.$implicit,i=e.MAs(3);e.xp6(),e.Q6J("ngIf",n.values)("ngIfElse",i)}}function Ti(t,s){if(1&t&&(e.TgZ(0,"span",1),e.YNc(1,xi,4,2,"ng-container",4),e.qZA()),2&t){const n=s.$implicit;e.xp6(),e.Q6J("ngForOf",n)}}let Ei=(()=>{var t;class s{constructor(){this.itemGroups=function li(){return[[{type:"bold"},{type:"italic"},{type:"underline"},{type:"strike"}],[{type:"blockquote"},{type:"code-block"}],[{type:"header",value:1},{type:"header",value:2}],[{type:"list",value:"ordered"},{type:"list",value:"bullet"}],[{type:"script",value:"sub"},{type:"script",value:"super"}],[{type:"header",values:[{const:1,title:"Titolo 1"},{const:2,title:"Titolo 2"},{const:3,title:"Titolo 3"},{const:4,title:"Titolo 4"},{const:5,title:"Titolo 5"},{const:6,title:"Titolo 6"},{const:void 0,title:"Normale"}]}],[{type:"color",values:[void 0,...Ce].map(t=>({const:t}))},{type:"background",values:[void 0,...Ce].map(t=>({const:t}))}],[{type:"align",values:[void 0,"center","right","justify"].map(t=>({const:t}))}],[{type:"clean"}]]}()}insertImages(i){for(const o of i)ai(this.quill,o)}insertLinks(i){for(const o of i)di(this.quill,o)}}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-wysiwyg-toolbar"]],inputs:{quill:"quill"},decls:4,vars:1,consts:[["class","ql-formats",4,"ngFor","ngForOf"],[1,"ql-formats"],[1,"ql-link"],[1,"d-inline-block",3,"imagesSelect","filesSelect"],[4,"ngFor","ngForOf"],[3,"class",4,"ngIf","ngIfElse"],["btnTemplate",""]],template:function(i,o){1&i&&(e.YNc(0,Ti,2,1,"span",0),e.TgZ(1,"span",1),e._UZ(2,"button",2),e.TgZ(3,"app-wysiwyg-image-upload",3),e.NdJ("imagesSelect",function(a){return o.insertImages(a)})("filesSelect",function(a){return o.insertLinks(a)}),e.qZA()()),2&i&&e.Q6J("ngForOf",o.itemGroups)},dependencies:[y.sg,y.O5,f.YN,f.Kr,vi]}),s})();const Oi=t=>({height:t});let Mi=(()=>{var t;class s extends S.fS{constructor(i,o){super(),this.wysiwygService=i,this.destroyRef=o,this.quillFormControl=new f.NI(""),this.isCustomUpdate=!1}ngOnInit(){this.field.validation=(0,x.Z)((0,x.Z)({},this.field.validation||{}),{},{show:!0}),this.setQuillContent(),this.field.formControl.valueChanges.pipe((0,ge.sL)(this.destroyRef)).subscribe(()=>{this.isCustomUpdate||this.setQuillContent()})}setQuillContent(){this.quillFormControl.setValue(this.wysiwygService.sanitizeHtml(this.field.formControl.value||"")),this.checkErrors()}quillContentChange(i){this.isCustomUpdate=!0,this.quillFormControl.markAsTouched(),this.formControl.setValue(i.html),this.checkErrors(),this.isCustomUpdate=!1}checkErrors(){let i;if(this.formControl.setErrors(null),this.quillFormControl.hasError("requiredError"))i=(0,Z.ke)();else if(this.quillFormControl.hasError("minLengthError")){const o=this.quillFormControl.getError("minLengthError");i=(0,Z.KR)(o.given,o.minLength)}else if(this.quillFormControl.hasError("maxLengthError")){const o=this.quillFormControl.getError("maxLengthError");i=(0,Z.S9)(o.given,o.maxLength)}i&&this.formControl.setErrors(i)}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(kt),e.Y36(e.ktI))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-wysiwyg"]],features:[e.qOj],decls:3,vars:12,consts:[["linkPlaceholder","URL","bounds","self",1,"w-100",3,"formControl","formlyAttributes","placeholder","debounceTime","minLength","maxLength","required","trimOnValidation","styles","onEditorCreated","onContentChanged"],["quill-editor-toolbar",""],[3,"quill"]],template:function(i,o){1&i&&(e.TgZ(0,"quill-editor",0),e.NdJ("onEditorCreated",function(a){return o.quill=a})("onContentChanged",function(a){return o.quillContentChange(a)}),e.TgZ(1,"div",1),e._UZ(2,"app-wysiwyg-toolbar",2),e.qZA()()),2&i&&(e.Q6J("formControl",o.quillFormControl)("formlyAttributes",o.field)("placeholder",o.field.props.placeholder||"")("debounceTime",300)("minLength",o.props.minLength)("maxLength",o.props.maxLength)("required",o.props.required||!1)("trimOnValidation",!0)("styles",e.VKq(10,Oi,o.props.height)),e.xp6(2),e.Q6J("quill",o.quill))},dependencies:[S.JD,f.JJ,f.Q7,ve,f.oH,Ei]}),s})();var wi=p(4610),Si=p(7174);let Ii=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,S.X0.forChild({types:[{name:"wysiwyg",component:Mi,wrappers:["form-field"]}]}),f.u5,wi.z,G.XC,si.forRoot(),f.UX,Si.UploadModule]}),s})(),Ai=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,f.u5]}),s})();var xe=p(3038),Te=p(5063);let Zi=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,fe.mZ,Z.q,xe.G,Te.g]}),s})(),Li=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,S.X0.forChild(),f.u5,G.ZS]}),s})(),Di=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,Ai,S.X0.forChild(),f.u5,f.UX,Zi,Li]}),s})();var qi=p(4295);let Qi=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,Z.Vy,Z.d3,Ii,Di,S.X0.forChild({types:[{name:"array",component:g},{name:"code-editor",component:Le,wrappers:["form-field"]},{name:"forum-groups",component:ke,wrappers:["form-field"]},{name:"forum-sections",component:Jt,wrappers:["form-field"]},{name:"label",component:Ut},{name:"forum-users",component:Pt},{name:"forum-list",component:bt}]}),f.u5,qi.$,Z.q,we,G.ZS,xe.G,Te.g]}),s})()},336:(me,B,p)=>{p.d(B,{c:()=>c});var y=p(9376),Z=p(91),v=p(1413),S=p(9212),e=p(6223),A=p(5545),z=p(9397);const W=["key"],$=["allOf"];function L(m){return""===m||null==m}function k(m){return null!=m&&"object"==typeof m&&!Array.isArray(m)}function D(m){return Number.isInteger?Number.isInteger(m):"number"==typeof m&&Math.floor(m)===m}function U(m){return"object"==typeof m&&(m.hasOwnProperty("const")||m.enum&&1===m.enum.length)}function P(m){if(!m.fieldGroup)return(0,A._S)(m)&&void 0!==(0,A.Hl)(m)?1:0;const M=m.fieldGroup.reduce((l,C)=>P(C)+l,0);if(0===M&&(0,A._S)(m)){const l=(0,A.Hl)(m);if(null===l||void 0!==l&&(m.fieldArray&&Array.isArray(l)||!m.fieldArray&&k(l)))return 1}return M}let c=(()=>{class m{toFieldConfig(l,C){return l=(0,A.kg)(l),this._toFieldConfig(l,(0,v.Z)({schema:l},C||{}))}_toFieldConfig(l,C){var E;let{key:O}=C,h=(0,Z.Z)(C,W);l=this.resolveSchema(l,h);const T=this.guessSchemaType(l);let d={type:T[0],defaultValue:l.default,props:{label:l.title,readonly:l.readOnly,description:l.description}};switch(null!=O&&(d.key=O),!h.ignoreDefault&&(l.readOnly||h.readOnly)&&(d.props.disabled=!0,h=(0,v.Z)((0,v.Z)({},h),{},{readOnly:!0})),h.resetOnHide&&(d.resetOnHide=!0),O&&h.strict&&this.addValidator(d,"type",(g,x)=>{const _=(0,A.Hl)(x);if(null!=_)switch(d.type){case"string":return"string"==typeof _;case"integer":return D(_);case"number":return"number"==typeof _;case"object":return k(_);case"array":return Array.isArray(_)}return!0}),!1===h.shareFormControl&&(d.shareFormControl=!1),h.ignoreDefault&&delete d.defaultValue,this.addValidator(d,"type",{schemaType:T,expression:({value:g})=>{if(void 0===g||null===g&&-1!==T.indexOf("null"))return!0;switch(T[0]){case"null":return null===typeof g;case"string":return"string"==typeof g;case"integer":return D(g);case"number":return"number"==typeof g;case"object":return k(g);case"array":return Array.isArray(g)}return!0}}),d.type){case"number":case"integer":d.parsers=[g=>L(g)?g:Number(g)],l.hasOwnProperty("minimum")&&(d.props.min=l.minimum),l.hasOwnProperty("maximum")&&(d.props.max=l.maximum),l.hasOwnProperty("exclusiveMinimum")&&(d.props.exclusiveMinimum=l.exclusiveMinimum,this.addValidator(d,"exclusiveMinimum",({value:g})=>L(g)||g>l.exclusiveMinimum)),l.hasOwnProperty("exclusiveMaximum")&&(d.props.exclusiveMaximum=l.exclusiveMaximum,this.addValidator(d,"exclusiveMaximum",({value:g})=>L(g)||g<l.exclusiveMaximum)),l.hasOwnProperty("multipleOf")&&(d.props.step=l.multipleOf,this.addValidator(d,"multipleOf",({value:g})=>{if(L(g)||"number"!=typeof g||0===g||l.multipleOf<=0)return!0;const x=Math.pow(10,function K(m){if(!isFinite(m))return 0;let M=1,l=0;for(;Math.round(m*M)/M!==m;)M*=10,l++;return l}(l.multipleOf));return Math.round(g*x)%Math.round(l.multipleOf*x)==0}));break;case"string":d.parsers=[g=>(-1!==T.indexOf("null")?g=L(g)?null:g:d.props.required||(g=""===g?void 0:g),g)],["minLength","maxLength","pattern"].forEach(g=>{l.hasOwnProperty(g)&&(d.props[g]=l[g])});break;case"object":{d.fieldGroup||(d.fieldGroup=[]);const{propDeps:g,schemaDeps:x}=this.resolveDependencies(l);Object.keys(l.properties||{}).forEach(_=>{const f=Array.isArray(l.required)&&-1!==l.required.indexOf(_),q=this._toFieldConfig(l.properties[_],(0,v.Z)((0,v.Z)({},h),{},{key:_,isOptional:h.isOptional||!f}));if(d.fieldGroup.push(q),(f||g[_])&&(q.expressions=(0,v.Z)((0,v.Z)({},q.expressions||{}),{},{"props.required":Q=>{let w=Q.parent;const I=Q.fieldGroup&&null!=Q.key?w.model:Q.model;for(;null==w.key&&w.parent;)w=w.parent;return!!(I||w&&w.props&&w.props.required)&&(!(!Array.isArray(l.required)||-1===l.required.indexOf(_))||g[_]&&Q.model&&g[_].some(X=>!L(Q.model[X])))}})),x[_]){const Q=I=>I.hasOwnProperty("const")?I.const:I.enum[0],w=x[_].oneOf;w&&w.every(I=>I.properties&&I.properties[_]&&U(I.properties[_]))?w.forEach(I=>{const R=I.properties,{[_]:X}=R,pe=(0,Z.Z)(R,[_].map(y.Z));d.fieldGroup.push((0,v.Z)((0,v.Z)({},this._toFieldConfig((0,v.Z)((0,v.Z)({},I),{},{properties:pe}),(0,v.Z)((0,v.Z)({},h),{},{shareFormControl:!1,resetOnHide:!0}))),{},{expressions:{hide:ne=>!ne.model||Q(X)!==ne.model[_]}}))}):d.fieldGroup.push((0,v.Z)((0,v.Z)({},this._toFieldConfig(x[_],h)),{},{expressions:{hide:I=>!I.model||L(I.model[_])}}))}}),l.oneOf&&d.fieldGroup.push(this.resolveMultiSchema("oneOf",l.oneOf,(0,v.Z)((0,v.Z)({},h),{},{shareFormControl:!1}))),l.anyOf&&d.fieldGroup.push(this.resolveMultiSchema("anyOf",l.anyOf,h));break}case"array":l.hasOwnProperty("minItems")&&(d.props.minItems=l.minItems,this.addValidator(d,"minItems",(g,x)=>{const _=(0,A.Hl)(x);return L(_)||_.length>=l.minItems}),!h.isOptional&&l.minItems>0&&void 0===d.defaultValue&&(d.defaultValue=Array.from(new Array(l.minItems)))),l.hasOwnProperty("maxItems")&&(d.props.maxItems=l.maxItems,this.addValidator(d,"maxItems",(g,x)=>{const _=(0,A.Hl)(x);return L(_)||_.length<=l.maxItems})),l.hasOwnProperty("uniqueItems")&&(d.props.uniqueItems=l.uniqueItems,this.addValidator(d,"uniqueItems",(g,x)=>{const _=(0,A.Hl)(x);return!(!L(_)&&l.uniqueItems)||Array.from(new Set(_.map(q=>JSON.stringify(q,(Q,w)=>k(w)?Object.keys(w).sort().reduce((I,R)=>(I[R]=w[R],I),{}):w)))).length===_.length})),l.items&&!Array.isArray(l.items)&&(l.items=this.resolveSchema(l.items,h)),this.isEnum(l)||(d.fieldArray=g=>{const x=l.items;if(!Array.isArray(x)){if(!x)return{};const Q=x.oneOf||x.anyOf,w=this._toFieldConfig(x,Q?(0,v.Z)((0,v.Z)({},h),{},{key:"".concat(g.fieldGroup.length)}):h);return Q&&!(0,A._S)(w)&&(w.key=null),w.props.required=!0,w}const _=g.fieldGroup?g.fieldGroup.length:0,f=x[_]?x[_]:l.additionalItems,q=f?this._toFieldConfig(f,h):{};return q.props&&(q.props.required=!0),x[_]&&(q.props.removable=!1),q})}if(l.hasOwnProperty("const")&&(d.props.const=l.const,this.addValidator(d,"const",({value:g})=>g===l.const),d.type||(d.defaultValue=l.const)),this.isEnum(l)){const g=this.toEnumOptions(l),x="array"===d.type;d.type="enum",d.props.multiple=x,d.props.options=g;const _=g.map(f=>f.value);this.addValidator(d,"enum",({value:f})=>void 0===f||(x?!!Array.isArray(f)&&f.every(q=>_.includes(q)):_.includes(f)))}return l.oneOf&&!d.type&&(delete d.key,d.fieldGroup=[this.resolveMultiSchema("oneOf",l.oneOf,(0,v.Z)((0,v.Z)({},h),{},{key:O,shareFormControl:!1}))]),l.oneOf&&!d.type&&(delete d.key,d.fieldGroup=[this.resolveMultiSchema("oneOf",l.oneOf,(0,v.Z)((0,v.Z)({},h),{},{key:O,shareFormControl:!1}))]),null!==(E=l.widget)&&void 0!==E&&E.formlyConfig&&(d=this.mergeFields(d,l.widget.formlyConfig)),d.templateOptions=d.props,h.map?h.map(d,l):d}resolveSchema(l,C){return l&&l.$ref&&(l=this.resolveDefinition(l,C)),l&&l.allOf&&(l=this.resolveAllOf(l,C)),l}resolveAllOf(l,C){let{allOf:E}=l,O=(0,Z.Z)(l,$);if(!E.length)throw Error("allOf array can not be empty ".concat(E,"."));return E.reduce((h,T)=>(T=this.resolveSchema(T,C),h.required&&T.required&&(h.required=[...h.required,...T.required]),T.uniqueItems&&(h.uniqueItems=T.uniqueItems),["maxLength","maximum","exclusiveMaximum","maxItems","maxProperties"].forEach(d=>{!L(h[d])&&!L(T[d])&&(h[d]=h[d]<T[d]?h[d]:T[d])}),["minLength","minimum","exclusiveMinimum","minItems","minProperties"].forEach(d=>{!L(h[d])&&!L(T[d])&&(h[d]=h[d]>T[d]?h[d]:T[d])}),(0,A.Du)(h,T)),O)}resolveMultiSchema(l,C,E){return{type:"multischema",fieldGroup:[{type:"enum",defaultValue:-1,props:{multiple:"anyOf"===l,options:C.map((O,h)=>({label:O.title,value:h,disabled:O.readOnly}))},hooks:{onInit:O=>O.formControl.valueChanges.pipe((0,z.b)(()=>O.options.detectChanges(O.parent)))}},{fieldGroup:C.map((O,h)=>(0,v.Z)((0,v.Z)({},this._toFieldConfig(O,(0,v.Z)((0,v.Z)({},E),{},{resetOnHide:!0}))),{},{expressions:{hide:(T,d)=>{const g=T.parent.parent.fieldGroup[0].formControl;if(-1===g.value||d){let x=T.parent.fieldGroup.map((_,f)=>[_,f,this.isFieldValid(_,f,C,E)]).sort(([_,,f],[q,,Q])=>{if(f!==Q)return Q?1:-1;const w=P(_),I=P(q);return w===I&&_.props.disabled===q.props.disabled?0:I>w?1:-1}).map(([,_])=>_);if("anyOf"===l){const _=x.filter(f=>P(T.parent.fieldGroup[f]));x=_.length>0?_:[x[0]||0]}x=x.length>0?x:[0],g.setValue("anyOf"===l?x:x[0])}return Array.isArray(g.value)?-1===g.value.indexOf(h):g.value!==h}}}))}]}}resolveDefinition(l,C){const[E,O]=l.$ref.split("#/");if(E)throw Error("Remote schemas for ".concat(l.$ref," not supported yet."));const h=O?O.split("/").reduce((T,d)=>null!=T&&T.hasOwnProperty(d)?T[d]:null,C.schema):null;if(!h)throw Error("Cannot find a definition for ".concat(l.$ref,"."));return h.$ref?this.resolveDefinition(h,C):(0,v.Z)((0,v.Z)({},h),["title","description","default","widget"].reduce((T,d)=>(l.hasOwnProperty(d)&&(T[d]=l[d]),T),{}))}resolveDependencies(l){const C={},E={};return Object.keys(l.dependencies||{}).forEach(O=>{const h=l.dependencies[O];Array.isArray(h)?h.forEach(T=>{C[T]?C[T].push(O):C[T]=[O]}):E[O]=h}),{propDeps:C,schemaDeps:E}}guessSchemaType(l){const C=null==l?void 0:l.type;return!C&&null!=l&&l.properties?["object"]:Array.isArray(C)?1===C.length?C:2===C.length&&-1!==C.indexOf("null")?C.sort(E=>"null"==E?1:-1):C:C?[C]:[]}addValidator(l,C,E){l.validators=l.validators||{},l.validators[C]=E}isEnum(l){return!!l.enum||l.anyOf&&l.anyOf.every(U)||l.oneOf&&l.oneOf.every(U)||l.uniqueItems&&l.items&&!Array.isArray(l.items)&&this.isEnum(l.items)}toEnumOptions(l){if(l.enum)return l.enum.map(E=>({value:E,label:E}));const C=E=>{const O=E.hasOwnProperty("const")?E.const:E.enum[0],h={value:O,label:E.title||O};return E.readOnly&&(h.disabled=!0),h};return l.anyOf?l.anyOf.map(C):l.oneOf?l.oneOf.map(C):this.toEnumOptions(l.items)}isFieldValid(l,C,E,O){const h=E[C];h._field||Object.defineProperty(h,"_field",{enumerable:!1,writable:!0,configurable:!0});let T=h._field,d=l.model?(0,A.kg)(l.model):l.fieldArray?[]:{};return l.model&&(0,A._S)(l)&&(d={[Array.isArray(l.key)?l.key.join("."):l.key]:(0,A.Hl)(l)}),T?(T.model=d,l.options.build(T)):T=h._field=l.options.build({form:Array.isArray(d)?new e.Oe([]):new e.cw({}),fieldGroup:[this._toFieldConfig(h,(0,v.Z)((0,v.Z)({},O),{},{resetOnHide:!0,ignoreDefault:!0,map:null,strict:!0}))],model:d,options:{}}),T.form.valid}mergeFields(l,C){for(let E in C){const O="templateOptions"===E?"props":E;k(l[O])&&k(C[E])?l[O]=this.mergeFields(l[O],C[E]):null!=C[E]&&(l[O]=C[E])}return l}}return m.\u0275fac=function(l){return new(l||m)},m.\u0275prov=S.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);