"use strict";(self.webpackChunkboard=self.webpackChunkboard||[]).push([[243],{6243:(x,h,l)=>{l.r(h),l.d(h,{AdminPanelModule:()=>H});var e=l(5e3),b=l(8053),c=l(5861),p=l(7876),m=l(8139),q=l(3011),u=l(5787),v=l(8882);let S=(()=>{class o{constructor(t){this.graphqlService=t,this.apolloIntrospectionStatusMutation="\n        mutation ApolloIntrospectionStatus($status: Boolean!) {\n            apolloIntrospectionStatus(status: $status)\n        }",this.apolloIntrospectionRequestTime=0}get isApolloIntrospectionEnabled(){return Date.now()<this.apolloIntrospectionRequestTime+3e4}setApolloIntrospection(t){var n=this;return(0,c.Z)(function*(){const i=(yield n.graphqlService.mutate({mutation:n.apolloIntrospectionStatusMutation,variables:{status:t}})).data.apolloIntrospectionStatus;return i&&(n.apolloIntrospectionRequestTime=t?Date.now():0),i})()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(u.J))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var A=l(406),f=l(9287),_=l(3068),s=l(2382),M=l(4090);const Z=["app-admin-panel-graphql",""],C=function(){return[10,10]},E=function(o,a){return{placement:"top-end",offset:o,hideOnClick:a}},P=function(o,a){return{hideOnClick:o,placement:"top-end",offset:a}};let I=(()=>{class o{constructor(t,n,i,r,Y){var g;this.globalsService=t,this.graphqlService=n,this.toastService=i,this.adminPanelService=r,this.loginService=Y,this.touchDevice=m.eX,this.pendingRequest=!1,this.requestLogs=[],this.tokenCopyTimeout=0,this.tokenCopyMessage="Copia il token",this.tokenCopiedMessage="Token copiato!",this.graphql={localUrlLinked:!0,localEnvBasepaths:m._V,useLocalEnvForJwt:!1,storage:(null===(g=this.globalsService.adminSettings)||void 0===g?void 0:g.graphql)||{useLocalEnv:!1,urlHttpLocalEnv:this.graphqlService.localEnvUrls.http,urlWsLocalEnv:this.graphqlService.localEnvUrls.ws,loggerEnabled:this.graphqlService.loggerEnabled}},this.token=this.graphqlService.params.token||"",this.tokenTippyMessage=this.touchDevice?this.tokenCopiedMessage:this.tokenCopyMessage,this.apolloInstrospectionEnabled=this.adminPanelService.isApolloIntrospectionEnabled,this.requestLogs=this.graphqlService.requestLogs,this.setApolloUrl()}ngOnInit(){}setApolloUrl(){this.apolloUrl=`https://studio.apollographql.com/sandbox/explorer?endpoint=${this.graphqlService.urlHttp}&headers=${JSON.stringify({Authorization:this.token})}`}setUrlWs(){this.graphql.localUrlLinked&&(this.graphql.storage.urlWsLocalEnv=this.graphql.storage.urlHttpLocalEnv)}saveAdminSettings(){this.globalsService.adminSettings=Object.assign(Object.assign({},this.globalsService.adminSettings||{}),{graphql:this.graphql.storage})}saveLocalEnv(){this.saveAdminSettings(),this.graphqlService.localEnvEnabled=this.graphql.storage.useLocalEnv,this.graphqlService.loggerEnabled=this.graphql.storage.loggerEnabled,this.graphql.storage.useLocalEnv&&(this.graphqlService.localEnvUrls={http:this.graphql.storage.urlHttpLocalEnv,ws:this.graphql.storage.urlWsLocalEnv}),this.loginService.localEnvEnabled=this.graphql.useLocalEnvForJwt,this.setApolloUrl(),this.toastService.show({content:"Impostazioni dell'<strong>ambiente locale</strong> aggionate!",level:p.m.NOTICE},{duration:5e3})}tokenCopiedCallback(){this.touchDevice||(window.clearTimeout(this.tokenCopyTimeout),this.tokenTippyMessage=this.tokenCopiedMessage,this.tokenCopyTimeout=window.setTimeout(()=>{this.tokenTippyMessage=this.tokenCopyMessage},3e3))}setApolloIntrospection(){var t=this;return(0,c.Z)(function*(){t.pendingRequest?t.toastService.advice(p.V.REQUEST_PENDING):t.apolloInstrospectionEnabled&&t.adminPanelService.isApolloIntrospectionEnabled?t.toastService.show({content:"L'introspection di Apollo \xe8 <strong>gi\xe0 attiva</strong>!",level:p.m.ERROR}):(t.pendingRequest=!0,(yield t.adminPanelService.setApolloIntrospection(t.apolloInstrospectionEnabled))?t.toastService.show({content:`Introspection di Apollo\n                <strong>${t.apolloInstrospectionEnabled?"abilitata":"disabilitata"}</strong> con successo!`}):t.toastService.advice(p.V.GENERIC),t.pendingRequest=!1)})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(q.d),e.Y36(u.J),e.Y36(v.k),e.Y36(S),e.Y36(A.r))},o.\u0275cmp=e.Xpm({type:o,selectors:[["","app-admin-panel-graphql",""]],attrs:Z,decls:57,vars:29,consts:[[1,"h6","px-md-1","container-fluid"],[1,"flat-container","p-3"],[1,"mb-4","d-flex","align-items-end"],[1,"flex-grow-1","me-3"],["for","profile-token",1,"fs-sm"],["type","text","id","profile-token","readonly","",1,"form-control",3,"value"],[1,"d-block","ms-auto","btn","btn-primary",3,"cdkCopyToClipboard","appTippy","tippyProps","click"],[1,"material-icons","d-block"],[1,"px-3","pb-3","pt-2","rounded","mb-4"],[1,"legend-reset","fs-reset","px-2","mb-0"],[1,"d-flex","align-items-end","mb-3"],["for","graphql-url-http",1,"fs-sm"],[1,"input-group"],["readonly","",1,"form-control",3,"value"],["type","text","id","graphql-url-http",1,"form-control",3,"ngModel","ngModelChange"],[1,"d-block","ms-auto","btn","btn-success",3,"click"],[1,"mb-3"],["for","graphql-url-ws",1,"fs-sm"],["type","text","id","graphql-url-ws",1,"form-control",3,"disabled","ngModel","ngModelChange"],[1,"input-group-text","cursor-pointer",3,"appTippy","tippyProps","disableOnTouchDevice","click"],[1,"material-icons",3,"innerText"],[1,"form-check","form-switch","mb-2"],["type","checkbox","role","switch","id","enable-local-env",1,"form-check-input",3,"ngModel","ngModelChange"],["for","enable-local-env",1,"form-check-label"],[1,"form-check","form-switch","mb-0"],["type","checkbox","role","switch","id","enable-local-env-for-jwt",1,"form-check-input",3,"ngModel","ngModelChange"],["for","enable-local-env-for-jwt",1,"form-check-label"],[1,"px-3","pb-3","rounded","mb-4","pt-2"],[1,"form-check","form-switch","mb-3"],["type","checkbox","role","switch","id","enable-logs",1,"form-check-input",3,"ngModel","ngModelChange"],["for","enable-logs",1,"form-check-label"],[1,"logs-wrapper"],[3,"object"],["type","checkbox","role","switch","id","apollo-introspection",1,"form-check-input",3,"disabled","ngModel","ngModelChange"],["for","apollo-introspection",1,"form-check-label"],[1,"d-flex","justify-content-end"],[1,"d-block"],["target","_blank",3,"href"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._uU(1,"GraphQL"),e.qZA(),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"label",4),e._uU(6,"Token attuale:"),e.qZA(),e._UZ(7,"input",5),e.qZA(),e.TgZ(8,"button",6),e.NdJ("click",function(){return n.tokenCopiedCallback()}),e.TgZ(9,"span",7),e._uU(10,"content_copy"),e.qZA()()(),e.TgZ(11,"fieldset",8)(12,"legend",9),e._uU(13,"Ambiente locale"),e.qZA(),e.TgZ(14,"div",10)(15,"div",3)(16,"label",11),e._uU(17,"Url Locale HTTP:"),e.qZA(),e.TgZ(18,"div",12),e._UZ(19,"input",13),e.TgZ(20,"input",14),e.NdJ("ngModelChange",function(r){return n.graphql.storage.urlHttpLocalEnv=r})("ngModelChange",function(){return n.setUrlWs()}),e.qZA()()(),e.TgZ(21,"button",15),e.NdJ("click",function(){return n.graphql.storage.useLocalEnv=!0,n.saveLocalEnv()}),e._uU(22,"Salva"),e.qZA()(),e.TgZ(23,"div",16)(24,"label",17),e._uU(25,"Url Locale WebSoscket:"),e.qZA(),e.TgZ(26,"div",12),e._UZ(27,"input",13),e.TgZ(28,"input",18),e.NdJ("ngModelChange",function(r){return n.graphql.storage.urlWsLocalEnv=r}),e.qZA(),e.TgZ(29,"span",19),e.NdJ("click",function(){return n.graphql.localUrlLinked=!n.graphql.localUrlLinked}),e._UZ(30,"span",20),e.qZA()()(),e.TgZ(31,"div",21)(32,"input",22),e.NdJ("ngModelChange",function(r){return n.graphql.storage.useLocalEnv=r})("ngModelChange",function(){return n.saveLocalEnv()}),e.qZA(),e.TgZ(33,"label",23),e._uU(34,"Utilizza l'ambiente locale per le richieste"),e.qZA()(),e.TgZ(35,"div",24)(36,"input",25),e.NdJ("ngModelChange",function(r){return n.graphql.useLocalEnvForJwt=r})("ngModelChange",function(){return n.saveLocalEnv()}),e.qZA(),e.TgZ(37,"label",26),e._uU(38,"Utilizza l'ambiente locale per la generazione dei JWT"),e.qZA()()(),e.TgZ(39,"fieldset",27)(40,"legend",9),e._uU(41),e.qZA(),e.TgZ(42,"div",28)(43,"input",29),e.NdJ("ngModelChange",function(r){return n.graphql.storage.loggerEnabled=r})("ngModelChange",function(){return n.saveLocalEnv()}),e.qZA(),e.TgZ(44,"label",30),e._uU(45,"Abilita il salvataggio dei log"),e.qZA()(),e.TgZ(46,"div",31),e._UZ(47,"app-custom-pre",32),e.qZA()(),e.TgZ(48,"div",24)(49,"input",33),e.NdJ("ngModelChange",function(r){return n.apolloInstrospectionEnabled=r})("ngModelChange",function(){return n.setApolloIntrospection()}),e.qZA(),e.TgZ(50,"label",34),e._uU(51,"Abilita l'introspection di Apollo"),e.qZA()(),e.TgZ(52,"div",35)(53,"small",36),e._uU(54,"Vai alla "),e.TgZ(55,"a",37),e._uU(56,"sandbox"),e.qZA()()()()),2&t&&(e.xp6(7),e.Q6J("value",n.token),e.xp6(1),e.Q6J("cdkCopyToClipboard",n.token)("appTippy",n.tokenTippyMessage)("tippyProps",e.WLB(22,E,e.DdM(21,C),n.touchDevice)),e.xp6(11),e.Q6J("value",n.graphql.localEnvBasepaths.http),e.xp6(1),e.Q6J("ngModel",n.graphql.storage.urlHttpLocalEnv),e.xp6(7),e.Q6J("value",n.graphql.localEnvBasepaths.ws),e.xp6(1),e.Q6J("disabled",n.graphql.localUrlLinked)("ngModel",n.graphql.storage.urlWsLocalEnv),e.xp6(1),e.Q6J("appTippy",n.graphql.localUrlLinked?"Specifica un url diverso per WS":"Calcola automaticamente l'url WS")("tippyProps",e.WLB(26,P,n.touchDevice,e.DdM(25,C)))("disableOnTouchDevice",!0),e.xp6(1),e.Q6J("innerText",n.graphql.localUrlLinked?"link_off":"link"),e.xp6(2),e.Q6J("ngModel",n.graphql.storage.useLocalEnv),e.xp6(4),e.Q6J("ngModel",n.graphql.useLocalEnvForJwt),e.xp6(5),e.hij("Log delle richieste (#",n.requestLogs.length,")"),e.xp6(2),e.Q6J("ngModel",n.graphql.storage.loggerEnabled),e.xp6(4),e.Q6J("object",n.requestLogs),e.xp6(2),e.Q6J("disabled",n.pendingRequest)("ngModel",n.apolloInstrospectionEnabled),e.xp6(6),e.Q6J("href",n.apolloUrl,e.LSH))},directives:[f.i3,_.$,s.Fj,s.JJ,s.On,s.Wl,M.s],styles:["fieldset[_ngcontent-%COMP%]{border:1px dashed var(--bs-gray-500)}.logs-wrapper[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}"]}),o})();var k=l(3022),y=l(7205),d=l(9808),T=l(1420),L=l(7216),J=l(5056);const U=["cacheModal"],N=["deletionModal"],R=["app-admin-panel-script",""];function G(o,a){if(1&o&&e._UZ(0,"option",15),2&o){const t=a.$implicit;e.Q6J("ngValue",t.scriptId)("innerText",t.name)}}const Q=function(o){return{disabled:o}},O=function(o,a){return[o,a]};let w=(()=>{class o{constructor(t,n){this.scriptListService=t,this.toastService=n,this.scriptList=[],this.selectedScriptId=0,this.scriptSettingsPath=k.B2.SCRIPT_DEV_SETTINGS,this.cacheScriptId=0,this.deletionScriptId=0,this.pendingRequest=!1}ngOnInit(){var t=this;return(0,c.Z)(function*(){t.scriptList=(yield t.scriptListService.getAllScripts()).sort((n,i)=>n.name>i.name?1:i.name>n.name?-1:0)})()}findScriptName(t){var n;return(null===(n=this.scriptList.find(i=>i.scriptId===t))||void 0===n?void 0:n.name)||""}openCacheModal(){this.pendingRequest?this.toastService.advice(p.V.REQUEST_PENDING):(this.cacheScriptId=this.selectedScriptId,this.cacheModalRef.open())}openDeletionModal(){this.pendingRequest?this.toastService.advice(p.V.REQUEST_PENDING):(this.deletionScriptId=this.selectedScriptId,this.deletionModalRef.open())}setPendingRequest(t){this.pendingRequest=0!==t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(y.o),e.Y36(v.k))},o.\u0275cmp=e.Xpm({type:o,selectors:[["","app-admin-panel-script",""]],viewQuery:function(t,n){if(1&t&&(e.Gf(U,5),e.Gf(N,5)),2&t){let i;e.iGM(i=e.CRH())&&(n.cacheModalRef=i.first),e.iGM(i=e.CRH())&&(n.deletionModalRef=i.first)}},attrs:R,decls:17,vars:20,consts:[[1,"h6","px-md-1","container-fluid"],[1,"flat-container","p-3"],[1,"mb-2"],["for","script-select",1,"fs-sm"],["id","script-select",1,"form-select",3,"disabled","ngModel","ngModelChange"],["selected","",3,"ngValue"],[3,"ngValue","innerText",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","flex-wrap"],[1,"btn","btn-indigo","mx-2","mt-3",3,"disabled","innerText","click"],[1,"btn","btn-primary","mx-2","mt-3",3,"ngClass","innerText","routerLink"],[1,"btn","btn-danger","mx-2","mt-3",3,"disabled","innerText","click"],[3,"scriptId","scriptName","cachePendingEvent"],["cacheModal",""],[3,"scriptName","scriptId","deletionPendingEvent"],["deletionModal",""],[3,"ngValue","innerText"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._uU(1,"Script"),e.qZA(),e.TgZ(2,"div",1)(3,"div",2)(4,"label",3),e._uU(5,"Seleziona lo script da amministrare:"),e.qZA(),e.TgZ(6,"select",4),e.NdJ("ngModelChange",function(r){return n.selectedScriptId=r}),e._UZ(7,"option",5),e.YNc(8,G,1,2,"option",6),e.qZA()(),e.TgZ(9,"div",7)(10,"button",8),e.NdJ("click",function(){return n.openCacheModal()}),e.qZA(),e._UZ(11,"a",9),e.TgZ(12,"button",10),e.NdJ("click",function(){return n.openDeletionModal()}),e.qZA()()(),e.TgZ(13,"app-script-dev-cache",11,12),e.NdJ("cachePendingEvent",function(r){return n.setPendingRequest(r)}),e.qZA(),e.TgZ(15,"app-script-dev-deletion",13,14),e.NdJ("deletionPendingEvent",function(r){return n.setPendingRequest(r)}),e.qZA()),2&t&&(e.xp6(6),e.Q6J("disabled",0===n.scriptList.length)("ngModel",n.selectedScriptId),e.xp6(1),e.Q6J("ngValue",0),e.xp6(1),e.Q6J("ngForOf",n.scriptList),e.xp6(2),e.Q6J("disabled",0===n.selectedScriptId||n.pendingRequest)("innerText","Cache"),e.xp6(1),e.Q6J("ngClass",e.VKq(15,Q,0===n.selectedScriptId))("innerText","Impostazioni")("routerLink",e.WLB(17,O,n.scriptSettingsPath,n.selectedScriptId)),e.xp6(1),e.Q6J("disabled",0===n.selectedScriptId||n.pendingRequest)("innerText","Cancella"),e.xp6(1),e.Q6J("scriptId",n.cacheScriptId)("scriptName",n.cacheScriptId>0?n.findScriptName(n.cacheScriptId):""),e.xp6(2),e.Q6J("scriptName",n.deletionScriptId>0?n.findScriptName(n.deletionScriptId):"")("scriptId",n.deletionScriptId))},directives:[s.EJ,s.JJ,s.On,s.YN,s.Kr,d.sg,T.yS,d.mk,L.s,J.F],styles:[""]}),o})(),D=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:4,vars:0,consts:[["pageTitle","Pannello di amministrazione"],[1,"xxl-screen","d-grid","page-container"],["app-admin-panel-graphql",""],["app-admin-panel-script",""]],template:function(t,n){1&t&&(e._UZ(0,"app-breadcrumb",0),e.TgZ(1,"div",1),e._UZ(2,"div",2)(3,"div",3),e.qZA())},directives:[b.L,I,w],styles:[".page-container[_ngcontent-%COMP%]{gap:1rem}@media (min-width: 960px){.page-container[_ngcontent-%COMP%]{gap:1.5rem}}@media (min-width: 1500px){.page-container[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}"]}),o})();var F=l(8420),W=l(9373),z=l(4226),V=l(9165),j=l(9409);const B=[{path:"",component:D}];let H=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[F.w,f.Iq,d.ez,W.b,s.u5,T.Bz.forChild(B),z.U,V.a,j.G]]}),o})()}}]);