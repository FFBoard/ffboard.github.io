(self.webpackChunkboard=self.webpackChunkboard||[]).push([[969],{9969:(G,F,t)=>{"use strict";t.d(F,{R:()=>h});class h{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(e){Object.keys(e).filter(U=>U in this).forEach(U=>this[U]=e[U]),this.validateOptions()}setOptionsFromChanges(e){Object.keys(e).filter(U=>U in this).forEach(U=>this[U]=e[U].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}},2020:(G,F,t)=>{"use strict";t.d(F,{y:()=>r});var h=t(5861);var T=t(4650);let r=(()=>{class E{constructor(){this.autoRotateSupported=function e(){return new Promise(E=>{const L=new Image;L.onload=()=>{E(1===L.width&&2===L.height)},L.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(o,x){return new Promise((u,O)=>{const c=new FileReader;c.onload=g=>{this.loadImage(g.target.result,o.type,x).then(u).catch(O)},c.readAsDataURL(o)})}loadImage(o,x,u){return this.isValidImageType(x)?this.loadBase64Image(o,u):Promise.reject(new Error("Invalid image type"))}isValidImageType(o){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(o)}loadImageFromURL(o,x){return new Promise((u,O)=>{const c=new Image;c.onerror=()=>O,c.onload=()=>{const g=document.createElement("canvas"),R=g.getContext("2d");g.width=c.width,g.height=c.height,R?.drawImage(c,0,0),this.loadBase64Image(g.toDataURL(),x).then(u)},c.crossOrigin="anonymous",c.src=o})}loadBase64Image(o,x){return new Promise((u,O)=>{const c=new Image;c.onload=()=>u({originalImage:c,originalBase64:o}),c.onerror=O,c.src=o}).then(u=>this.transformImageBase64(u,x))}transformImageBase64(o,x){var u=this;return(0,h.Z)(function*(){const O=yield u.autoRotateSupported,c=yield function U(E){switch("string"==typeof E&&(E=function D(E){const L=new DataView(function l(E){E=E.replace(/^data\:([^\;]+)\;base64,/gim,"");const L=atob(E),o=L.length,x=new Uint8Array(o);for(let u=0;u<o;u++)x[u]=L.charCodeAt(u);return x.buffer}(E));if(65496!==L.getUint16(0,!1))return-2;const o=L.byteLength;let x=2;for(;x<o;){if(L.getUint16(x+2,!1)<=8)return-1;const u=L.getUint16(x,!1);if(x+=2,65505==u){if(1165519206!==L.getUint32(x+=2,!1))return-1;const O=18761==L.getUint16(x+=6,!1);x+=L.getUint32(x+4,O);const c=L.getUint16(x,O);x+=2;for(let g=0;g<c;g++)if(274==L.getUint16(x+12*g,O))return L.getUint16(x+12*g+8,O)}else{if(65280!=(65280&u))break;x+=L.getUint16(x,!1)}}return-1}(E)),E){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(O?-1:o.originalBase64);return o.originalImage&&o.originalImage.complete?u.transformLoadedImage({original:{base64:o.originalBase64,image:o.originalImage,size:{width:o.originalImage.naturalWidth,height:o.originalImage.naturalHeight}},exifTransform:c},x):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(o,x){var u=this;return(0,h.Z)(function*(){const O=x.canvasRotation+o.exifTransform.rotate,c={width:o.original.image.naturalWidth,height:o.original.image.naturalHeight};if(0===O&&!o.exifTransform.flip&&!x.containWithinAspectRatio)return{original:{base64:o.original.base64,image:o.original.image,size:{...c}},transformed:{base64:o.original.base64,image:o.original.image,size:{...c}},exifTransform:o.exifTransform};const g=u.getTransformedSize(c,o.exifTransform,x),R=document.createElement("canvas");R.width=g.width,R.height=g.height;const W=R.getContext("2d");W?.setTransform(o.exifTransform.flip?-1:1,0,0,1,R.width/2,R.height/2),W?.rotate(Math.PI*(O/2)),W?.drawImage(o.original.image,-c.width/2,-c.height/2);const v=R.toDataURL(),m=yield u.loadImageFromBase64(v);return{original:{base64:o.original.base64,image:o.original.image,size:{...c}},transformed:{base64:v,image:m,size:{width:m.width,height:m.height}},exifTransform:o.exifTransform}})()}loadImageFromBase64(o){return new Promise((x,u)=>{const O=new Image;O.onload=()=>x(O),O.onerror=u,O.src=o})}getTransformedSize(o,x,u){const O=u.canvasRotation+x.rotate;if(u.containWithinAspectRatio){if(O%2){const g=o.height/u.aspectRatio;return{width:Math.max(o.height,o.width*u.aspectRatio),height:Math.max(o.width,g)}}{const g=o.width/u.aspectRatio;return{width:Math.max(o.width,o.height*u.aspectRatio),height:Math.max(o.height,g)}}}return O%2?{height:o.width,width:o.height}:{width:o.width,height:o.height}}}return E.\u0275fac=function(o){return new(o||E)},E.\u0275prov=T.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})()},8896:(G,F,t)=>{"use strict";function h(M){const e=M.split(","),U=e[0].replace("data:","").replace(";base64",""),D=atob(e[1]),l=new ArrayBuffer(D.length),T=new Uint8Array(l);for(let r=0;r<D.length;r+=1)T[r]=D.charCodeAt(r);return new Blob([l],{type:U})}t.d(F,{L:()=>h})},8694:(G,F,t)=>{"use strict";t.d(F,{r:()=>e});var h=t(6895),M=t(4650);let e=(()=>{class U{}return U.\u0275fac=function(l){return new(l||U)},U.\u0275mod=M.oAB({type:U}),U.\u0275inj=M.cJS({imports:[h.ez]}),U})()},8212:(G,F,t)=>{"use strict";t.d(F,{J:()=>M});var h=t(4650);let M=(()=>{class e{transform(D,l){return D.join(l)}}return e.\u0275fac=function(D){return new(D||e)},e.\u0275pipe=h.Yjl({name:"arrayJoin",type:e,pure:!0}),e})()},575:(G,F,t)=>{"use strict";t.d(F,{In:()=>h,Ky:()=>D,VC:()=>M,c5:()=>U,gG:()=>e});var h=(()=>{return(l=h||(h={})).FILE_SHOW_LINKS="fileLinks",l.FILE_EDIT="fileEdit",l.DELETE="delete",l.RENAME="rename",l.MOVE="move",h;var l})(),M=(()=>{return(l=M||(M={})).FILE="file",l.FOLDER="folder",M;var l})(),e=(()=>{return(l=e||(e={})).FILENAME="filename",l.SIZE="size",l.TIME="time",l.EXTENSION="ext",e;var l})(),U=(()=>{return(l=U||(U={})).GRID="grid",l.LIST="list",U;var l})(),D=(()=>{return(l=D||(D={})).W_768_I_1="(max-width: 767.98px)",l.W_933_I_2="(min-width: 768px) and (max-width: 933.98px)",l.W_960_I_3="(min-width: 934px) and (max-width: 959.98px)",l.W_1226_I_2="(min-width: 960px) and (max-width: 1225.98px)",l.W_1540_I_3="(min-width: 1226px) and (max-width: 1539.98px)",l.W_1854_I_4="(min-width: 1540px) and (max-width: 1853.98px)",l.W_2168_I_5="(min-width: 1854px) and (max-width: 2167.98px)",l.W_2482_I_6="(min-width: 2168px) and (max-width: 2481.98px)",l.W_2796_I_7="(min-width: 2482px) and (max-width: 2795.98px)",l.W_3110_I_8="(min-width: 2796px) and (max-width: 3109.98px)",l.W_3424_I_9="(min-width: 3110px) and (max-width: 3423.98px)",l.W_3738_I_10="(min-width: 3424px)",D;var l})()},6986:(G,F,t)=>{"use strict";t.d(F,{C7:()=>U,Mi:()=>D,O8:()=>M,er:()=>l,p0:()=>e,xt:()=>T});var h=t(575);const M=[{ext:["png","apng"],maxSize:15},{ext:["jpeg","jpg","jpe"],maxSize:10},{ext:["gif"],maxSize:15},{ext:["bmp"],maxSize:10},{ext:["webp","webm"],maxSize:10},{ext:["psd","xcf"],maxSize:150},{ext:["svg"],maxSize:30}].map(r=>(r.maxSize*=1048576,r)),e={lastPath:[],layout:{asc:!0,orderBy:h.gG.FILENAME,type:h.c5.GRID},uploader:{checkImage:{time:0,active:!0},showLinkModal:!1}},U="https://upload.forumfree.net/api/",D=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-.\s])*$/,l=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-\s])*$/,T={invalidLength:!1,alreadyUsed:!1,invalidStartOrEnd:!1,invalidCharacter:!1}},8375:(G,F,t)=>{"use strict";t.d(F,{B:()=>Z});var h=t(5861),M=t(1309),e=t(4650),U=t(4968),D=t(3905),l=t(3848),T=t(1460),r=t(6986),E=t(575),L=t(7320),o=t(146),x=t(3612),u=t(6378),O=t(6895),c=t(433),g=t(4029),R=t(8279),W=t(3450),v=t(8212);const m=["fileInput"];function I(f,w){1&f&&(e.O4$(),e.TgZ(0,"svg",25),e._UZ(1,"path",26)(2,"path",27),e.qZA())}const k=function(){return["text-primary"]};function _(f,w){1&f&&e._UZ(0,"app-logo",28),2&f&&e.Q6J("svgClass",e.DdM(2,k))("responsive",!1)}function b(f,w){1&f&&(e.TgZ(0,"span"),e._uU(1,"Trascina i file da caricare oppure c"),e.qZA())}function S(f,w){1&f&&(e.TgZ(0,"span"),e._uU(1,"C"),e.qZA())}function A(f,w){if(1&f&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2,"I file verranno caricati nella cartella "),e.qZA(),e._UZ(3,"em",29),e.ALo(4,"arrayJoin"),e.BQk()),2&f){const n=e.oxw(2);e.xp6(3),e.Q6J("innerText",n.currentFolderPath.length?e.xi3(4,1,n.currentFolderPath,"/"):"root")}}function Q(f,w){if(1&f&&(e._UZ(0,"div",34),e.ALo(1,"arrayJoin"),e.ALo(2,"slice")),2&f){const n=e.oxw(3);e.Q6J("innerText",e.xi3(1,1,e.Dn7(2,4,n.currentFolderPath,0,-1),"/"))}}function N(f,w){if(1&f&&(e.TgZ(0,"div",30)(1,"div",31),e._uU(2,"Cartella:"),e.qZA(),e.YNc(3,Q,3,8,"div",32),e._UZ(4,"div",33),e.ALo(5,"arrayJoin"),e.ALo(6,"slice"),e.qZA()),2&f){const n=e.oxw(2);e.xp6(3),e.Q6J("ngIf",n.currentFolderPath.length>1),e.xp6(1),e.Q6J("innerText",(n.currentFolderPath.length>1?"/":"")+(n.currentFolderPath.length?e.xi3(5,2,e.xi3(6,5,n.currentFolderPath,n.currentFolderPath.length-1),"/"):"root"))}}const H=function(){return{bottom:0,left:0}};function Y(f,w){if(1&f){const n=e.EpF();e.TgZ(0,"a",35),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.openInfoModal.emit())}),e._uU(1,"Informazioni"),e.qZA()}2&f&&e.Q6J("ngStyle",e.DdM(1,H))}function ee(f,w){if(1&f){const n=e.EpF();e.TgZ(0,"div",36),e.NdJ("click",function(){e.CHM(n),e.oxw(2);const i=e.MAs(7);return e.KtG(i.open())}),e._uU(1,"settings"),e.qZA()}}const re=function(f,w,n){return{"cursor-pointer":f,"p-4":w,"py-3 mt-1":n}},y=function(f){return{"fw-bold fs-lg":f}},a=function(f,w,n){return{"my-2":f,"mb-2":w,"mw-100":n}};function s(f,w){if(1&f){const n=e.EpF();e.ynx(0),e.TgZ(1,"div",15,16),e.NdJ("dragenter",function(){e.CHM(n);const i=e.MAs(2),j=e.oxw();return e.KtG(j.setDragOverEvent(i))})("drop",function(i){e.CHM(n);const j=e.oxw();return e.KtG(j.handleDropEvent(i))})("click",function(){e.CHM(n),e.oxw();const i=e.MAs(2);return e.KtG(i.click())}),e.YNc(3,I,3,0,"svg",17),e.YNc(4,_,1,3,"ng-template",null,18,e.W1O),e.TgZ(6,"div",19),e.YNc(7,b,2,0,"span",20),e.YNc(8,S,2,0,"span",20),e.TgZ(9,"span"),e._uU(10,"licca per scegliere da memoria"),e.qZA()(),e.TgZ(11,"div",21),e.YNc(12,A,5,4,"ng-container",3),e.YNc(13,N,7,8,"ng-template",null,22,e.W1O),e.qZA()(),e.YNc(15,Y,2,2,"a",23),e.YNc(16,ee,2,0,"div",24),e.BQk()}if(2&f){const n=e.MAs(5),p=e.MAs(14),i=e.oxw();e.xp6(1),e.Q6J("ngClass",e.kEZ(11,re,!i.loading,!i.isWidget,i.isWidget)),e.xp6(2),e.Q6J("ngIf",!i.isWidget)("ngIfElse",n),e.xp6(3),e.Q6J("ngClass",e.VKq(15,y,!i.isWidget)),e.xp6(1),e.Q6J("ngIf",!i.touchDevice),e.xp6(1),e.Q6J("ngIf",i.touchDevice),e.xp6(3),e.Q6J("ngClass",e.kEZ(17,a,!i.isWidget&&!i.touchDevice,!i.isWidget&&i.touchDevice,i.isWidget)),e.xp6(1),e.Q6J("ngIf",!i.isWidget)("ngIfElse",p),e.xp6(3),e.Q6J("ngIf",!i.isWidget),e.xp6(1),e.Q6J("ngIf",!i.isWidget)}}const d=function(f,w){return{"p-4":f,"pt-2 pb-3":w}};function B(f,w){if(1&f&&(e.TgZ(0,"div",37),e.O4$(),e.TgZ(1,"svg",38),e._UZ(2,"path",39),e.qZA(),e.kcU(),e._UZ(3,"app-loader",40),e.TgZ(4,"div",41),e._uU(5,"Attendi il completamento dell'upload per caricare altre immagini."),e.qZA()()),2&f){const n=e.oxw();e.Q6J("ngClass",e.WLB(3,d,!n.isWidget,n.isWidget)),e.xp6(3),e.Q6J("onlyMessage",!0)("message",n.loadingMessage)}}const P=function(f,w){return{uploading:f,widget:w}};let Z=(()=>{class f{constructor(n,p,i,j,K,C){this.uploadService=n,this.uploadObservablesService=p,this.uploaderService=i,this.toastService=j,this.renderer=K,this.ngZone=C,this.loading=!0,this.currentFolderPath=[],this.isWidget=!1,this.fileUploadedEvent=new e.vpe,this.openInfoModal=new e.vpe,this.isUploading=!1,this.loadingMessage="Controllo dei file in corso",this.touchDevice=T.eX,this.dragOverEvent=!1,this.options=this.uploaderService.uploaderOptions;const z=this.uploadService.preferences.uploader;z.checkImage.active||(this.options.compress=!1),z.showLinkModal&&(this.options.openLinkModalAfterUpload=!0)}ngOnInit(){this.handleClipboardPasteEvent(),this.handleExternalUpload()}handleClipboardPasteEvent(){var n=this;this.clipboardPasteEventSubscription=(0,U.R)(document.body,"paste").subscribe(function(){var p=(0,h.Z)(function*(i){if(!n.canUpload)return;const j=Array.from((i.clipboardData||i.originalEvent.clipboardData).items);let K=[];for(const C of j)if(0===C.type.indexOf("image")){const z=C.getAsFile();z&&K.push(z)}K.length>0?yield n.preUpload(K):n.reset()});return function(i){return p.apply(this,arguments)}}())}handleExternalUpload(){var n=this;this.startExternalUploadSubscription=this.uploadObservablesService.startUploadObservable.subscribe(function(){var p=(0,h.Z)(function*(i){if(i)return n.canUpload?void(yield n.preUpload([i.file],i.options)):void n.reset();n.fileInputRef.nativeElement.click()});return function(i){return p.apply(this,arguments)}}())}handleSelectionEvent(n){var p=this;return(0,h.Z)(function*(){if(!p.canUpload)return;const i=n.target;if(i.files&&i.files.length){const j=Array.from(i.files);return i.value="",p.preUpload(j)}p.reset()})()}handleDropEvent(n){var p=this;return(0,h.Z)(function*(){if(!p.canUpload)return;n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation();const i=n.dataTransfer?.files?Array.from(n.dataTransfer.files):[];if(i.length)return p.preUpload(i);p.reset()})()}saveOptions(n=!0){this.uploaderService.uploaderOptions=this.options,n&&this.savePreferences()}savePreferences(){this.uploadService.preferences.uploader={checkImage:{active:this.options.compress,time:Date.now()},showLinkModal:this.options.openLinkModalAfterUpload}}setDragOverEvent(n){this.dragOverEvent||(this.dragOverEvent=!0,this.ngZone.runOutsideAngular(()=>{this.renderer.listen(n,"dragover",p=>{p.preventDefault()})}))}get canUpload(){return!this.loading&&!this.isUploading&&(this.isUploading=!0,!0)}reset(){this.isUploading=!1,this.loadingMessage="Controllo dei file da caricare",this.options.allowOverwrite=!1,this.saveOptions(!1)}preUpload(n,p){var i=this;return(0,h.Z)(function*(){const j=[...i.currentFolderPath];let K=[],C=[],z=[],J=[];p?p.allowOverwrite=p.allowOverwrite||!1:(p=i.uploaderService.uploaderOptions).allowOverwrite=!1;for(let $=0;$<n.length;$++){let V=p.compress?yield i.uploaderService.compressFileIfNeeded(n[$],p.imageDimensions):n[$];if(V=yield i.uploaderService.orientFileIfNeeded(V),V){const te=(0,l.Tb)(V.name),ie=r.O8.find(ae=>-1!==ae.ext.indexOf(te.ext));if(!ie){z.push(V);continue}if(V.size>ie.maxSize){J.push(V);continue}K.push({file:{name:V.name,size:V.size,time:0,url:"",ext:te.ext,filename:te.filename,isImage:(0,l.Or)(te.ext),embedUrl:""},progress:0,completed:!1}),C.push(V)}}if((z.length||J.length)&&i.toastService.show({content:i.createToastMessage(z,J),level:M.m.ERROR}),0===C.length)return void i.reset();const ne=`Caricamento file {{fileNumber}} di ${C.length} in corso`;i.uploadObservablesService.pushUploadingFileQueue(K);for(let $=0;$<C.length;++$){i.loadingMessage="Creazione del pacchetto da inviare";const V=yield i.uploadService.getHostToken(j,C[$].name);K[$].progress+=20,i.loadingMessage=ne.replace("{{fileNumber}}",`${$+1}`),yield(0,D.z)(i.uploaderService.upload(C[$],K[$],V,p.allowOverwrite))}i.uploadObservablesService.pushUploadingFileQueue([]);const oe=K.filter($=>!$.error).map($=>$.file);oe.length>0&&(i.fileUploadedEvent.emit({fileList:oe,rewrite:p.allowOverwrite,paths:j}),p.openLinkModalAfterUpload&&i.uploadObservablesService.pushAction({name:E.In.FILE_SHOW_LINKS,payload:{entities:(0,l.jL)(oe)}})),i.reset()})()}createToastMessage(n,p){let i=[];return n.length&&i.push(n.length>1?`I file <strong>${n.map(j=>j.name).join(", ")}</strong> hanno un formato non supportato!`:`Il file <strong>${n[0].name}</strong> ha un formato non supportato!`),p.length&&i.push(p.length>1?`I file <strong>${p.map(j=>j.name).join(", ")}</strong> sono troppo pesanti!`:`Il file <strong>${p[0].name}</strong> \xe8 troppo pesante!`),i.join("<br><br>")}ngOnDestroy(){this.startExternalUploadSubscription?.unsubscribe(),this.clipboardPasteEventSubscription.unsubscribe(),this.uploaderService.clearPendingRequests()}}return f.\u0275fac=function(n){return new(n||f)(e.Y36(L.C),e.Y36(o.r),e.Y36(x.q),e.Y36(u.k),e.Y36(e.Qsj),e.Y36(e.R0b))},f.\u0275cmp=e.Xpm({type:f,selectors:[["app-uploader"]],viewQuery:function(n,p){if(1&n&&e.Gf(m,5),2&n){let i;e.iGM(i=e.CRH())&&(p.fileInputRef=i.first)}},inputs:{loading:"loading",currentFolderPath:"currentFolderPath",isWidget:"isWidget"},outputs:{fileUploadedEvent:"fileUploadedEvent",openInfoModal:"openInfoModal"},decls:30,vars:10,consts:[[1,"uploader","rounded","h-100","position-relative",3,"ngClass"],["type","file",1,"d-none",3,"multiple","disabled","change"],["fileInput",""],[4,"ngIf","ngIfElse"],["uploading",""],["title","Opzioni di caricamento"],["optionsModal",""],[1,"mb-1"],[1,"mb-3"],[1,"mb-1","list-unstyled"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","speed-upload",1,"form-check-input",3,"ngModel","ngModelChange"],["for","speed-upload",1,"form-check-label","me-auto"],["type","checkbox","role","switch","id","show-link-modal",1,"form-check-input",3,"ngModel","ngModelChange"],["for","show-link-modal",1,"form-check-label","me-auto"],[1,"rounded","upload-area",3,"ngClass","dragenter","drop","click"],["uploadArea",""],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16",4,"ngIf","ngIfElse"],["appLogo",""],[1,"description","text-center",3,"ngClass"],[4,"ngIf"],[1,"small","text-center",3,"ngClass"],["widgetFolder",""],["class","fs-xs fst-italic d-block px-2 py-1 text-reset cursor-pointer position-absolute",3,"ngStyle","click",4,"ngIf"],["class","material-icons-outlined d-block cursor-pointer fs-xl position-absolute options-icon",3,"click",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16"],["fill-rule","evenodd","d","M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"],["d","M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"],["svgSize","xl","subtext","Upload",1,"d-block","mb-3","py-1",3,"svgClass","responsive"],[1,"text-break",3,"innerText"],[1,"d-flex","min-w-0"],[1,"me-1"],["class","fst-italic text-truncate mw-100",3,"innerText",4,"ngIf"],[1,"fst-italic","text-nowrap",3,"innerText"],[1,"fst-italic","text-truncate","mw-100",3,"innerText"],[1,"fs-xs","fst-italic","d-block","px-2","py-1","text-reset","cursor-pointer","position-absolute",3,"ngStyle","click"],[1,"material-icons-outlined","d-block","cursor-pointer","fs-xl","position-absolute","options-icon",3,"click"],[1,"p-4","rounded",3,"ngClass"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","viewBox","0 0 16 16",1,"overflow-visible"],["d","M 4.406 3.342 A 5.53 5.53 0 0 1 8 2 c 2.69 0 4.923 2 5.166 4.579 C 14.758 6.804 16 8.137 16 9.773 C 16 11.569 14.502 13 12.687 13 H 3.781 C 1.708 13 0 11.366 0 9.318 c 0 -1.763 1.266 -3.223 2.942 -3.593 c 0.143 -0.863 0.698 -1.723 1.464 -2.383 z",1,"cloud"],[3,"onlyMessage","message"],[1,"small","text-center"]],template:function(n,p){if(1&n&&(e.TgZ(0,"div",0)(1,"input",1,2),e.NdJ("change",function(j){return p.handleSelectionEvent(j)}),e.qZA(),e.YNc(3,s,17,21,"ng-container",3),e.YNc(4,B,6,6,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(6,"app-modal",5,6)(8,"p",7),e._uU(9,"Tramite questo modal \xe8 possibile gestire le opzioni di caricamento al momento disponibili:"),e.qZA(),e.TgZ(10,"ul",8)(11,"li")(12,"em"),e._uU(13,"caricamento veloce"),e.qZA(),e._uU(14,": abilitando questa opzione, l'immagine da caricare verr\xe0 adattata per terminare l'operazione di upload nel minor tempo possibile. "),e.qZA(),e.TgZ(15,"li")(16,"em"),e._uU(17,"mostra link dopo l'upload"),e.qZA(),e._uU(18,": abilitando questa opzione, una volta terminato il caricamento verr\xe0 aperto il modal contenente i link utili dei file caricati. "),e.qZA()(),e.TgZ(19,"ul",9)(20,"li")(21,"div",10)(22,"input",11),e.NdJ("ngModelChange",function(j){return p.options.compress=j})("ngModelChange",function(){return p.saveOptions()}),e.qZA(),e.TgZ(23,"label",12),e._uU(24,"Caricamento veloce"),e.qZA()()(),e.TgZ(25,"li")(26,"div",10)(27,"input",13),e.NdJ("ngModelChange",function(j){return p.options.openLinkModalAfterUpload=j})("ngModelChange",function(){return p.saveOptions()}),e.qZA(),e.TgZ(28,"label",14),e._uU(29,"Mostra link dopo l'upload"),e.qZA()()()()()),2&n){const i=e.MAs(5);e.Q6J("ngClass",e.WLB(7,P,p.isUploading,p.isWidget)),e.xp6(1),e.Q6J("multiple",!0)("disabled",p.loading||p.isUploading),e.xp6(2),e.Q6J("ngIf",!p.isUploading)("ngIfElse",i),e.xp6(19),e.Q6J("ngModel",p.options.compress),e.xp6(5),e.Q6J("ngModel",p.options.openLinkModalAfterUpload)}},dependencies:[O.mk,O.O5,O.PC,c.Wl,c.JJ,c.On,g.R,R.R,W.z,v.J,O.OU],styles:[".uploader[_ngcontent-%COMP%]:not(.widget){margin:0 1rem;border:2px dashed #4864FE;box-shadow:0 .125rem .25rem #00000013;color:#2036ad}.uploader[_ngcontent-%COMP%]:not(.widget):not(.uploading)   svg[_ngcontent-%COMP%]{animation:bubble 4s linear infinite}.uploader[_ngcontent-%COMP%]:not(.widget)   .description[_ngcontent-%COMP%]{max-width:400px}.uploader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.options-icon){height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.uploader.uploading[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{fill:none;stroke:#2036ad;stroke-linecap:round;stroke-dasharray:50;stroke-dashoffset:100;animation:draw 3.5s linear infinite}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]{top:5px;right:5px;opacity:.7;transition:opacity .2s}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]:hover{opacity:1}.upload-area[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(app-logo){pointer-events:none}@media (min-width: 768px){.uploader[_ngcontent-%COMP%]{margin:initial}}@keyframes bubble{6%{transform:scale(1.3,.8)}9%{transform:scale(.8,1.3) translateY(-.5rem)}12%{transform:scale(1)}}@keyframes draw{0%{stroke-dashoffset:100}to{stroke-dashoffset:0}}"]}),f})()},1740:(G,F,t)=>{"use strict";t.d(F,{M:()=>r});var h=t(8694),M=t(6895),e=t(433),U=t(6818),D=t(1043),l=t(582),T=t(4650);let r=(()=>{class E{}return E.\u0275fac=function(o){return new(o||E)},E.\u0275mod=T.oAB({type:E}),E.\u0275inj=T.cJS({imports:[h.r,M.ez,e.u5,U.q,D.h,l.z]}),E})()},2381:(G,F,t)=>{"use strict";t.d(F,{y:()=>D});var h=t(5044),M=t(4650),e=t(5700),U=t(5123);let D=(()=>{class l{constructor(r,E){this.cookieConsentService=r,this.localStorageService=E,this.storage=null}getItem(r){return null===this.storage&&(this.storage=this.data),this.storage[r]}get data(){const r=this.localStorageService.getItem(h.dR.PREFERENCES);if(!r)return{};try{return JSON.parse(r)}catch{return{}}}setItem(r,E){null===this.storage&&(this.storage=this.data),E?this.storage[r]=E:delete this.storage[r],this.cookieConsentService.choice?.preferences&&this.localStorageService.setItem(h.dR.PREFERENCES,JSON.stringify(this.storage))}resetItemsOnProfileChange(){const r=this.getItem(h.Ye.UPLOAD);r&&(r.lastPath=[],this.setItem(h.Ye.UPLOAD,r))}}return l.\u0275fac=function(r){return new(r||l)(M.LFG(e.C),M.LFG(U.n))},l.\u0275prov=M.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},146:(G,F,t)=>{"use strict";t.d(F,{r:()=>D});var h=t(7579),M=t(1135),e=t(4650),U=t(8745);let D=(()=>{class l{constructor(r){this.uploadPreferencesService=r,this.selectedFileListArray=[],this.actionSubject=new h.x,this.uploadingFileQueueSubject=new h.x,this.uploadingFileErrorSubject=new h.x,this.currentFolderPathSubject=new h.x,this.layoutOptionsSubject=new h.x,this.renameFileSubject=new h.x,this.entityPendingSubject=new h.x,this.deleteFileSubject=new h.x,this.uploadedFileSubject=new h.x,this.draggedFileListSubject=new h.x,this.startUploadSubject=new h.x,this.selectedFileListSubject=new M.X(this.selectedFileListArray)}get actionObservable(){return this.actionSubject.asObservable()}pushAction(r){this.actionSubject.next(r)}get layoutOptionsObservable(){return this.layoutOptionsSubject.asObservable()}pushLayoutOptions(r){this.uploadPreferencesService.layoutOptions=r,this.layoutOptionsSubject.next(r)}get currentFolderPathObservable(){return this.currentFolderPathSubject.asObservable()}pushCurrentFolderPath(r){this.uploadPreferencesService.lastFolderPath=r,this.currentFolderPathSubject.next(r)}get uploadingFileQueueObservable(){return this.uploadingFileQueueSubject.asObservable()}pushUploadingFileQueue(r){this.uploadingFileQueueSubject.next(r)}get uploadingFileErrorObservable(){return this.uploadingFileErrorSubject.asObservable()}pushUploadingFileError(r){this.uploadingFileErrorSubject.next(r)}get renameFileObservable(){return this.renameFileSubject.asObservable()}pushRenameFile(r){this.renameFileSubject.next(r)}get entityPendingObservable(){return this.entityPendingSubject.asObservable()}pushEntityPending(r){this.entityPendingSubject.next(r)}get deleteFileObservable(){return this.deleteFileSubject.asObservable()}pushDeleteFile(r){this.deleteFileSubject.next(r)}get uploadedFileObservable(){return this.uploadedFileSubject.asObservable()}pushUploadedFile(r){this.uploadedFileSubject.next(r)}get draggedFileListObservable(){return this.draggedFileListSubject.asObservable()}pushDraggedFileList(r){this.draggedFileListSubject.next(r)}get startUploadObservable(){return this.startUploadSubject.asObservable()}pushStartUpload(r){this.startUploadSubject.next(r)}get selectedFileListObservable(){return this.selectedFileListSubject.asObservable()}pushSelectedFile(r){if(Array.isArray(r)||(r=[r]),0===r.length)return void(this.selectedFileListArray.length>0&&(this.selectedFileListArray=[],this.selectedFileListSubject.next(this.selectedFileListArray)));let E=!1;for(const L of r){const o=this.selectedFileListArray.findIndex(x=>x.name===L.name);L.selected?-1===o&&(this.selectedFileListArray.push({name:L.name}),E=!0):o>-1&&(this.selectedFileListArray.splice(o,1),E=!0)}E&&this.selectedFileListSubject.next(this.selectedFileListArray)}}return l.\u0275fac=function(r){return new(r||l)(e.LFG(U.p))},l.\u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},8745:(G,F,t)=>{"use strict";t.d(F,{p:()=>D});var h=t(5044),M=t(6986),e=t(4650),U=t(2381);let D=(()=>{class l{constructor(r){this.preferencesService=r}get preferences(){return this.preferencesService.getItem(h.Ye.UPLOAD)||M.p0}set preferences(r){this.preferencesService.setItem(h.Ye.UPLOAD,r)}get lastFolderPath(){return this.preferences.lastPath||M.p0.lastPath}set lastFolderPath(r){const E=this.preferences;E.lastPath=r,this.preferences=E}get layoutOptions(){const r=M.p0.layout,E=this.preferences.layout;return E&&0===Object.keys(r).filter(L=>!E.hasOwnProperty(L)).length?E:r}set layoutOptions(r){const E=this.preferences;E.layout=r,this.preferences=E}get uploader(){const r=this.preferences.uploader||M.p0.uploader;return!r.checkImage.active&&Date.now()-r.checkImage.time>6048e5&&(r.checkImage.active=!0,this.uploader=r),r.hasOwnProperty("showLinkModal")||(r.showLinkModal=!1),r}set uploader(r){const E=this.preferences;E.uploader=r,this.preferences=E}}return l.\u0275fac=function(r){return new(r||l)(e.LFG(U.y))},l.\u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},7320:(G,F,t)=>{"use strict";t.d(F,{C:()=>m});var h=t(5861),M=t(7824),e=t(3905),U=t(3848),o=t(6986),x=t(1042),u=t(4650),O=t(5395),c=t(575),g=t(3138);let R=(()=>{class I{constructor(_){this.globalsService=_,this.ffuid="",this.cache={},this.profileSubscription=this.globalsService.profileObservable.subscribe(b=>{this.ffuid=b?b.user.ffuid:""})}getItem(_){const b=this.createKey(_);if(this.cache.hasOwnProperty(b))return this.cache[b]}setItem(_,b){this.cache[this.createKey(_)]=b}removeItem(_){const b=this.createKey(_);if(this.cache.hasOwnProperty(b)){if(this.cache[b].folders.length)for(const S of this.cache[b].folders)this.removeItem([..._,S.name]);return delete this.cache[b],!0}return!1}addEntities(_,b,S=c.VC.FILE){const A=this.createKey(_);return!!this.cache.hasOwnProperty(A)&&(Array.isArray(b)||(b=[b]),S===c.VC.FILE?this.cache[A].files.unshift(...b):this.cache[A].folders.unshift(...b),!0)}removeEntities(_,b,S=c.VC.FILE){const A=this.createKey(_);if(!this.cache.hasOwnProperty(A))return!1;const Q=S===c.VC.FILE?"files":"folders";Array.isArray(b)||(b=[b]);let N=!1;for(const H of b){const Y=this.cache[A][Q].findIndex(ee=>ee.name===H);Y>-1&&(this.cache[A][Q].splice(Y,1),N=!0)}return N}refactorFolderContent(_,b){const S=this.createKey(_);if(!this.cache.hasOwnProperty(S))return!1;b.endsWith("/")||(b+="/");for(const A of this.cache[S].folders)A.url=b+A.name;for(const A of this.cache[S].files)A.url=A.embedUrl=b+A.name,A.time=Date.now();return!0}createKey(_){return`${this.ffuid}/${_.join("/")}`}ngOnDestroy(){this.profileSubscription.unsubscribe()}}return I.\u0275fac=function(_){return new(_||I)(u.LFG(g.d))},I.\u0275prov=u.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"}),I})();var W=t(8745),v=t(529);let m=(()=>{class I{constructor(_,b,S,A){this.graphqlService=_,this.uploadCacheService=b,this.uploadPreferencesService=S,this.http=A}get cache(){return this.uploadCacheService}get preferences(){return this.uploadPreferencesService}setGqlIdHeader(){this.graphqlService.safeSetGlobalHeader(M._.HeaderKeys.UUID,(0,x.Z)())}removeGqlIdHeader(){this.graphqlService.removeGlobalHeader(M._.HeaderKeys.UUID)}getGqlIdHeader(){return this.graphqlService.getGlobalHeader(M._.HeaderKeys.UUID)||""}getFileList(_,b){var S=this;return(0,h.Z)(function*(){const A=S.uploadCacheService.getItem(_);if(A)return A;const Q=(yield S.graphqlService.query({query:"\nquery UploadEntitiesListToken($scope: String, $target: String!) {\n    uploadEntitiesListToken(scope: $scope, target: $target)\n}",variables:{scope:b,target:_.join("/")}})).data.uploadEntitiesListToken,N=yield S.sendRequest(Q),Y={files:N.files.map(ee=>{const re=(0,U.Tb)(ee.url);return{...ee,time:1e3*ee.time,filename:re.filename,ext:re.ext,isImage:(0,U.Or)(re.ext),embedUrl:`${ee.url}?t=${ee.time}`}}),folders:N.folders};return S.uploadCacheService.setItem(_,Y),Y})()}createDirectory(_,b){var S=this;return(0,h.Z)(function*(){const A=(yield S.graphqlService.mutate({mutation:"\nquery UploadEntitiesCreateDirectoryToken($scope: String, $target: String!) {\n    uploadEntitiesCreateDirectoryToken(scope: $scope, target: $target)\n}",variables:{scope:b,target:_.join("/")}})).data.uploadEntitiesCreateDirectoryToken;return yield S.sendRequest(A)})()}moveRenameEntity(_,b,S,A,Q){var N=this;return(0,h.Z)(function*(){A||(A=S);const H=(yield N.graphqlService.mutate({mutation:"\nquery UploadEntitiesMoveToken($scope: String, $source: String!, $target: String!) {\n    uploadEntitiesMoveToken(scope: $scope, source: $source, target: $target)\n}",variables:{scope:Q,source:(_.length?`${_.join("/")}/`:"")+S,target:(b.length?`${b.join("/")}/`:"")+A}})).data.uploadEntitiesMoveToken;return yield N.sendRequest(H)})()}deleteEntity(_,b,S){var A=this;return(0,h.Z)(function*(){const Q=(yield A.graphqlService.mutate({mutation:"\nquery UploadEntitiesDeleteToken($scope: String, $target: String!) {\n    uploadEntitiesDeleteToken(scope: $scope, target: $target)\n}",variables:{scope:S,target:(_.length?`${_.join("/")}/`:"")+b}})).data.uploadEntitiesDeleteToken;return yield A.sendRequest(Q),!0})()}getHostToken(_,b,S){var A=this;return(0,h.Z)(function*(){return(yield A.graphqlService.query({query:"\nquery UploadEntitiesHostToken($scope: String, $target: String!) {\n    uploadEntitiesHostToken(scope: $scope, target: $target)\n}",variables:{scope:S,target:(_.length?`${_.join("/")}/`:"")+b}})).data.uploadEntitiesHostToken})()}sendRequest(_){return(0,h.Z)(function*(){const S=yield(yield fetch(o.C7,{method:"POST",referrer:document.URL+"-google",referrerPolicy:"unsafe-url",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:_})})).json();if(S.error&&0!==S.error.trim().length)throw new Error(S.error);return S.success})()}subscribeForChanges(_,b){var S=this;return(0,h.Z)(function*(){return yield S.graphqlService.subscribe({query:"\nsubscription UploadEntities($scope: String) {\n    uploadEntities(scope: $scope) {\n        eventMessage\n        eventType\n        user {\n            avatar\n            host\n            id\n            nickname\n        }\n    }\n}",variables:{scope:b}},A=>{if(!A.data?.uploadEntities)return;const Q=JSON.parse(A.data.uploadEntities.eventMessage);if(!Q.payload.customHeaders||!Q.payload.customHeaders.hasOwnProperty(M._.HeaderKeys.UUID)||Q.payload.customHeaders[M._.HeaderKeys.UUID]===S.getGqlIdHeader())return;const N=(Q.payload.content.source||"").split("/"),H=(Q.payload.content.target||"").split("/"),Y=H[H.length-1].indexOf(".")>-1;let ee;try{ee=JSON.parse(Q.output).success||""}catch{return}_({type:A.data.uploadEntities.eventType,sourceName:N[N.length-1],sourcePaths:N.slice(0,-1),targetName:H[H.length-1],targetPaths:H.slice(0,-1),isFile:Y,output:ee})})})()}getBlobFromUrl(_){var b=this;return(0,h.Z)(function*(){return yield(0,e.z)(b.http.get(_,{responseType:"blob"})).catch(()=>{})})()}}return I.\u0275fac=function(_){return new(_||I)(u.LFG(O.J),u.LFG(R),u.LFG(W.p),u.LFG(v.eN))},I.\u0275prov=u.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"}),I})()},3848:(G,F,t)=>{"use strict";t.d(F,{$H:()=>u,JN:()=>E,Lv:()=>l,Or:()=>x,Tb:()=>U,jL:()=>o,rc:()=>O,sT:()=>T,zO:()=>D});var h=t(5861),M=t(575),e=t(6986);function U(c){let g=c;if(c.indexOf("/")>-1){const m=c.split("/");g=m[m.length-1]}const R=g.split("."),W=R[R.length-1].toLowerCase(),v=decodeURIComponent(R.slice(0,-1).join("."));return{ext:W,filename:v,name:`${v}.${W}`}}function D(c){const g=U(c),R=Date.now();return{name:g.name,size:0,time:R,url:c,ext:g.ext,filename:g.filename,isImage:x(g.ext),embedUrl:`${c}?t=${R}`}}function l(c){let g=c;g.endsWith("/")&&(g=g.slice(0,-1));const R=g.split("/");return{name:decodeURIComponent(R[R.length-1])}}function T(c){return r.apply(this,arguments)}function r(){return(r=(0,h.Z)(function*(c){const g=new FileReader,R=new Promise(W=>g.addEventListener("load",()=>W(g.result)));return g.readAsDataURL(c),R})).apply(this,arguments)}function E(c){return L.apply(this,arguments)}function L(){return(L=(0,h.Z)(function*(c){const g=new DataView(yield c.arrayBuffer());if(2303741511===g.getUint32(0)&&218765834===g.getUint32(4)){if(-1===[4,6].indexOf(g.getUint8(25)))return!1;const W=Object.assign(new Image,{src:yield T(c)});yield new Promise(I=>W.addEventListener("load",()=>I(!0)));const v=Object.assign(document.createElement("canvas"),{width:W.width,height:W.height}).getContext("2d");if(!v)return!1;v.imageSmoothingEnabled=!1,v.drawImage(W,0,0);const m=v?.getImageData(0,0,W.width,W.height);if(m)for(let I=0;I<m.data.length;I+=4)if(m.data[I+3]<255)return!0}return!1})).apply(this,arguments)}function o(c){return c.map(g=>({name:g.name,ext:g.ext,type:M.VC.FILE,url:g.url,embedUrl:g.embedUrl,isImage:g.isImage}))}function x(c,g=[]){return["png","apng","jpeg","jpg","jpe","gif","svg","webp"].includes(c)&&!g.includes(c)}function u(c){return x(c,["gif","svg"])}function O(c,g,R,W=[],v=""){let m={...e.xt};const I=c.trim();m.invalidLength=0===I.length;const k=(I+v).replace(/\s{2,}/g," ");return m.alreadyUsed=g!==I&&W.includes(k),m.invalidStartOrEnd=/(^(\s|\.))|((\s|\.)$)/.test(c),m.invalidCharacter=!(R===M.VC.FILE?e.Mi.test(c):e.er.test(c)),m}},3612:(G,F,t)=>{"use strict";t.d(F,{q:()=>g});var h=t(5861),M=t(8896),e=t(6730),U=t.n(e),D=t(9969),l=t(3848),T=t(529),r=t(7579),E=t(7445),L=t(2722),o=t(6986);class x{static findApp1Marker(W){const v=new DataView(W),m=new Set([65498,65497,65476,65474,65472,65499,65501]);for(let I=0;I<W.byteLength-2;I+=2){const k=v.getUint16(I);if(65505===k)return{offset:I,size:v.getUint16(I+2),little:18761==v.getUint16(I+8,!1)};if(m.has(k))break}}static stripAndReturnExif(W){return(0,h.Z)(function*(){const v=yield W.arrayBuffer(),m=x.findApp1Marker(v);return m?{file:new File([v.slice(0,m.offset),v.slice(m.offset+m.size+2)],W.name,{type:W.type,lastModified:W.lastModified}),exif:v.slice(m.offset,m.offset+m.size)}:{file:W}})()}static checkImageOrientation(W){const v=new DataView(W);if(1165519206!=v.getUint32(4,!1))return-1;const m=18761==v.getUint16(10,!1);let I=10;I+=v.getUint32(I+4,m);const k=v.getUint16(I,m);I+=2;for(let _=0;_<k;_++)if(274==v.getUint16(I+12*_,m))return v.getUint16(I+12*_+8,m);return-1}}var u=t(4650),O=t(146),c=t(2020);let g=(()=>{class R{constructor(v,m,I){this.http=v,this.uploadObservablesService=m,this.loadImageService=I,this.requestSubscriptions=[],this.uploaderOptionsObject={compress:!0,openLinkModalAfterUpload:!1}}get uploaderOptions(){return{...this.uploaderOptionsObject}}set uploaderOptions(v){this.uploaderOptionsObject={...v}}compressFileIfNeeded(v,m){return(0,h.Z)(function*(){let I=["image/png","image/jpeg"],k={strict:!0,checkOrientation:!0,quality:.8,convertSize:1};m&&(I.push("image/webp"),k.width=m.width,k.height=m.height,k.resize="cover",k.strict=!1);const _=v.type.toLowerCase();return v.size<=4e6&&void 0===m||-1===I.indexOf(v.type.toLowerCase())?v:("image/png"===_&&(yield(0,l.JN)(v))&&(k.convertSize=1/0),new Promise((b,S)=>{new(U())(v,{...k,success:A=>{const Q=A instanceof Blob?new File([A],v.name,{type:v.type,lastModified:v.lastModified}):v;b(Q)},error:S})}))})()}orientFileIfNeeded(v){var m=this;return(0,h.Z)(function*(){if(-1===["image/jpeg"].indexOf(v.type.toLowerCase()))return v;const k=yield x.stripAndReturnExif(v);if(v=k.file,k.exif){const _=x.checkImageOrientation(k.exif);if(1!==_){let b=0;switch(_){case 3:case 4:b=180;break;case 5:case 6:b=90;break;case 7:case 8:b=270}const S=yield(0,l.sT)(v),A=yield new Promise((N,H)=>{const Y=new Image;Y.onload=()=>N({originalImage:Y,originalBase64:S}),Y.onerror=H,Y.src=S}),Q=yield m.loadImageService.transformLoadedImage({original:{base64:A.originalBase64,image:A.originalImage,size:{width:A.originalImage.naturalWidth,height:A.originalImage.naturalHeight}},exifTransform:{flip:[2,4,5,7].includes(_),rotate:b/90}},new D.R);v=new File([(0,M.L)(Q.transformed.base64)],v.name,{type:v.type,lastModified:Date.now()})}}return v})()}upload(v,m,I,k=!1){const _=new r.x,b=new FormData;b.append("payload",I),b.append("upload",v,v.name),k&&b.append("allowOverwrite","1");const S=this.http.request(new T.aW("POST",o.C7,b,{reportProgress:!0,responseType:"json"}));return this.requestSubscriptions.push(S.subscribe({next:A=>{if(A.type===T.dt.UploadProgress){if(!A.total||(m.progress=Math.round(50*A.loaded/A.total)+20,m.progress<70))return;(0,E.F)(1e3).pipe((0,L.R)(_.asObservable())).subscribe(()=>{if(m.progress<95){const Q=Math.round(8*Math.random()+8);m.progress+Q>95?m.progress=95:m.progress+=Q}})}else if(A instanceof T.Zn){if(m.progress=100,m.completed=!0,A.body?.error||!A.body?.success)m.error=!0,this.uploadObservablesService.pushUploadingFileError(m);else{m.file.url=A.body.success.url,m.file.time=Date.now(),m.file.embedUrl=`${m.file.url}?t=${m.file.time}`;const Q=(0,l.Tb)(m.file.url);m.file.name=Q.name,m.file.filename=Q.filename}_.next(),_.complete()}},error:()=>{m.error=!0,this.uploadObservablesService.pushUploadingFileError(m),_.next(),_.complete()}})),_.asObservable()}clearPendingRequests(){for(const v of this.requestSubscriptions)v.unsubscribe();this.requestSubscriptions=[]}}return R.\u0275fac=function(v){return new(v||R)(u.LFG(T.eN),u.LFG(O.r),u.LFG(c.y))},R.\u0275prov=u.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})()},6730:function(G){G.exports=function(){"use strict";function F(y,a){var s=Object.keys(y);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(y);a&&(d=d.filter(function(B){return Object.getOwnPropertyDescriptor(y,B).enumerable})),s.push.apply(s,d)}return s}function t(y){for(var a=1;a<arguments.length;a++){var s=null!=arguments[a]?arguments[a]:{};a%2?F(Object(s),!0).forEach(function(d){U(y,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(s)):F(Object(s)).forEach(function(d){Object.defineProperty(y,d,Object.getOwnPropertyDescriptor(s,d))})}return y}function M(y,a){for(var s=0;s<a.length;s++){var d=a[s];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(y,d.key,d)}}function U(y,a,s){return a in y?Object.defineProperty(y,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):y[a]=s,y}function D(){return D=Object.assign||function(y){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(y[d]=s[d])}return y},D.apply(this,arguments)}var y,a,s,d,B,P,Z,f,l={exports:{}};y=l,typeof window>"u"||(a=window,s=a.HTMLCanvasElement&&a.HTMLCanvasElement.prototype,d=a.Blob&&function(){try{return Boolean(new Blob)}catch{return!1}}(),B=d&&a.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch{return!1}}(),P=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder,Z=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,f=(d||P)&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&function(w){var n,p,i,j,K,C,z,J,ne;if(!(n=w.match(Z)))throw new Error("invalid data URI");for(p=n[2]?n[1]:"text/plain"+(n[3]||";charset=US-ASCII"),i=!!n[4],j=w.slice(n[0].length),K=i?atob(j):decodeURIComponent(j),C=new ArrayBuffer(K.length),z=new Uint8Array(C),J=0;J<K.length;J+=1)z[J]=K.charCodeAt(J);return d?new Blob([B?z:C],{type:p}):((ne=new P).append(C),ne.getBlob(p))},a.HTMLCanvasElement&&!s.toBlob&&(s.mozGetAsFile?s.toBlob=function(w,n,p){var i=this;setTimeout(function(){w(p&&s.toDataURL&&f?f(i.toDataURL(n,p)):i.mozGetAsFile("blob",n))})}:s.toDataURL&&f&&(s.toBlob=s.msToBlob?function(w,n,p){var i=this;setTimeout(function(){w((n&&"image/png"!==n||p)&&s.toDataURL&&f?f(i.toDataURL(n,p)):i.msToBlob(n))})}:function(w,n,p){var i=this;setTimeout(function(){w(f(i.toDataURL(n,p)))})})),y.exports?y.exports=f:a.dataURLtoBlob=f);var T=l.exports,E={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},o=typeof window<"u"&&typeof window.document<"u"?window:{},x=function(a){return a>0&&a<1/0},u=Array.prototype.slice;function O(y){return Array.from?Array.from(y):u.call(y)}var c=/^image\/.+$/;function g(y){return c.test(y)}var W=String.fromCharCode;var m=o.btoa;function k(y){var s,a=new DataView(y);try{var d,B,P;if(255===a.getUint8(0)&&216===a.getUint8(1))for(var Z=a.byteLength,f=2;f+1<Z;){if(255===a.getUint8(f)&&225===a.getUint8(f+1)){B=f;break}f+=1}if(B){var n=B+10;if("Exif"===function v(y,a,s){var B,d="";for(s+=a,B=a;B<s;B+=1)d+=W(y.getUint8(B));return d}(a,B+4,4)){var p=a.getUint16(n);if(((d=18761===p)||19789===p)&&42===a.getUint16(n+2,d)){var i=a.getUint32(n+4,d);i>=8&&(P=n+i)}}}if(P){var K,C,j=a.getUint16(P,d);for(C=0;C<j;C+=1)if(274===a.getUint16(K=P+12*C+2,d)){s=a.getUint16(K+=8,d),a.setUint16(K,1,d);break}}}catch{s=1}return s}var b=/\.\d*(?:0|9){12}\d*$/;function S(y){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return b.test(y)?Math.round(y*a)/a:y}function A(y){var a=y.aspectRatio,s=y.height,d=y.width,B=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",P=x(d),Z=x(s);if(P&&Z){var f=s*a;("contain"===B||"none"===B)&&f>d||"cover"===B&&f<d?s=d/a:d=s*a}else P?s=d/a:Z&&(d=s*a);return{width:d,height:s}}var Q=o.ArrayBuffer,N=o.FileReader,H=o.URL||o.webkitURL,Y=/\.\w+$/,ee=o.Compressor;return function(){function y(a,s){(function h(y,a){if(!(y instanceof a))throw new TypeError("Cannot call a class as a function")})(this,y),this.file=a,this.image=new Image,this.options=t(t({},E),s),this.aborted=!1,this.result=null,this.init()}return function e(y,a,s){return a&&M(y.prototype,a),s&&M(y,s),y}(y,[{key:"init",value:function(){var s=this,d=this.file,B=this.options;if(function(a){return!(typeof Blob>"u")&&(a instanceof Blob||"[object Blob]"===Object.prototype.toString.call(a))}(d)){var P=d.type;if(g(P))if(H&&N)if(Q||(B.checkOrientation=!1),H&&!B.checkOrientation)this.load({url:H.createObjectURL(d)});else{var Z=new N,f=B.checkOrientation&&"image/jpeg"===P;this.reader=Z,Z.onload=function(w){var p=w.target.result,i={};if(f){var j=k(p);j>1||!H?(i.url=function I(y,a){for(var s=[],B=new Uint8Array(y);B.length>0;)s.push(W.apply(null,O(B.subarray(0,8192)))),B=B.subarray(8192);return"data:".concat(a,";base64,").concat(m(s.join("")))}(p,P),j>1&&D(i,function _(y){var a=0,s=1,d=1;switch(y){case 2:s=-1;break;case 3:a=-180;break;case 4:d=-1;break;case 5:a=90,d=-1;break;case 6:a=90;break;case 7:a=90,s=-1;break;case 8:a=-90}return{rotate:a,scaleX:s,scaleY:d}}(j))):i.url=H.createObjectURL(d)}else i.url=p;s.load(i)},Z.onabort=function(){s.fail(new Error("Aborted to read the image with FileReader."))},Z.onerror=function(){s.fail(new Error("Failed to read the image with FileReader."))},Z.onloadend=function(){s.reader=null},f?Z.readAsArrayBuffer(d):Z.readAsDataURL(d)}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(s){var d=this,B=this.file,P=this.image;P.onload=function(){d.draw(t(t({},s),{},{naturalWidth:P.naturalWidth,naturalHeight:P.naturalHeight}))},P.onabort=function(){d.fail(new Error("Aborted to load the image."))},P.onerror=function(){d.fail(new Error("Failed to load the image."))},o.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(o.navigator.userAgent)&&(P.crossOrigin="anonymous"),P.alt=B.name,P.src=s.url}},{key:"draw",value:function(s){var d=this,B=s.naturalWidth,P=s.naturalHeight,Z=s.rotate,f=void 0===Z?0:Z,w=s.scaleX,n=void 0===w?1:w,p=s.scaleY,i=void 0===p?1:p,j=this.file,K=this.image,C=this.options,z=document.createElement("canvas"),J=z.getContext("2d"),ne=Math.abs(f)%180==90,oe=("contain"===C.resize||"cover"===C.resize)&&x(C.width)&&x(C.height),$=Math.max(C.maxWidth,0)||1/0,V=Math.max(C.maxHeight,0)||1/0,te=Math.max(C.minWidth,0)||0,ie=Math.max(C.minHeight,0)||0,ae=B/P,X=C.width,q=C.height;if(ne){var ue=[V,$];$=ue[0],V=ue[1];var de=[ie,te];te=de[0],ie=de[1];var pe=[q,X];X=pe[0],q=pe[1]}oe&&(ae=X/q);var he=A({aspectRatio:ae,width:$,height:V},"contain");$=he.width,V=he.height;var fe=A({aspectRatio:ae,width:te,height:ie},"cover");if(te=fe.width,ie=fe.height,oe){var ge=A({aspectRatio:ae,width:X,height:q},C.resize);X=ge.width,q=ge.height}else{var me=A({aspectRatio:ae,width:X,height:q}),ve=me.width;X=void 0===ve?B:ve;var _e=me.height;q=void 0===_e?P:_e}var Ue=-(X=Math.floor(S(Math.min(Math.max(X,te),$))))/2,we=-(q=Math.floor(S(Math.min(Math.max(q,ie),V))))/2,Me=X,Ie=q,se=[];if(oe){var le,ce,Ae=A({aspectRatio:ae,width:B,height:P},{contain:"cover",cover:"contain"}[C.resize]);se.push((B-(le=Ae.width))/2,(P-(ce=Ae.height))/2,le,ce)}if(se.push(Ue,we,Me,Ie),ne){var ye=[q,X];X=ye[0],q=ye[1]}z.width=X,z.height=q,g(C.mimeType)||(C.mimeType=j.type);var xe="transparent";if(j.size>C.convertSize&&C.convertTypes.indexOf(C.mimeType)>=0&&(C.mimeType="image/jpeg"),"image/jpeg"===C.mimeType&&(xe="#fff"),J.fillStyle=xe,J.fillRect(0,0,X,q),C.beforeDraw&&C.beforeDraw.call(this,J,z),!this.aborted&&(J.save(),J.translate(X/2,q/2),J.rotate(f*Math.PI/180),J.scale(n,i),J.drawImage.apply(J,[K].concat(se)),J.restore(),C.drew&&C.drew.call(this,J,z),!this.aborted)){var Oe=function(Ce){d.aborted||d.done({naturalWidth:B,naturalHeight:P,result:Ce})};z.toBlob?z.toBlob(Oe,C.mimeType,C.quality):Oe(T(z.toDataURL(C.mimeType,C.quality)))}}},{key:"done",value:function(s){var d=s.naturalWidth,B=s.naturalHeight,P=s.result,Z=this.file,w=this.options;if(H&&!w.checkOrientation&&H.revokeObjectURL(this.image.src),P)if(w.strict&&P.size>Z.size&&w.mimeType===Z.type&&!(w.width>d||w.height>B||w.minWidth>d||w.minHeight>B||w.maxWidth<d||w.maxHeight<B))P=Z;else{var n=new Date;P.lastModified=n.getTime(),P.lastModifiedDate=n,P.name=Z.name,P.name&&P.type!==Z.type&&(P.name=P.name.replace(Y,function R(y){var a=g(y)?y.substr(6):"";return"jpeg"===a&&(a="jpg"),".".concat(a)}(P.type)))}else P=Z;this.result=P,w.success&&w.success.call(this,P)}},{key:"fail",value:function(s){var d=this.options;if(!d.error)throw s;d.error.call(this,s)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=ee,y}},{key:"setDefaults",value:function(s){D(E,s)}}]),y}()}()},7445:(G,F,t)=>{"use strict";t.d(F,{F:()=>e});var h=t(4986),M=t(5963);function e(U=0,D=h.z){return U<0&&(U=0),(0,M.H)(U,U,D)}},1042:(G,F,t)=>{"use strict";t.d(F,{Z:()=>x});var h,M=new Uint8Array(16);function e(){if(!h&&!(h=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(M)}const U=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,l=function D(u){return"string"==typeof u&&U.test(u)};for(var T=[],r=0;r<256;++r)T.push((r+256).toString(16).substr(1));const x=function o(u,O,c){var g=(u=u||{}).random||(u.rng||e)();if(g[6]=15&g[6]|64,g[8]=63&g[8]|128,O){c=c||0;for(var R=0;R<16;++R)O[c+R]=g[R];return O}return function E(u){var O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=(T[u[O+0]]+T[u[O+1]]+T[u[O+2]]+T[u[O+3]]+"-"+T[u[O+4]]+T[u[O+5]]+"-"+T[u[O+6]]+T[u[O+7]]+"-"+T[u[O+8]]+T[u[O+9]]+"-"+T[u[O+10]]+T[u[O+11]]+T[u[O+12]]+T[u[O+13]]+T[u[O+14]]+T[u[O+15]]).toLowerCase();if(!l(c))throw TypeError("Stringified UUID is invalid");return c}(g)}}}]);