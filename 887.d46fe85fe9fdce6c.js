(self.webpackChunkpages=self.webpackChunkpages||[]).push([[887],{5172:(Y,C,o)=>{"use strict";o.d(C,{In:()=>f,Ky:()=>w,VC:()=>y,c5:()=>F,gG:()=>O});var f=function(n){return n.FILE_SHOW_LINKS="fileLinks",n.FILE_EDIT="fileEdit",n.DELETE="delete",n.RENAME="rename",n.MOVE="move",n}(f||{}),y=function(n){return n.FILE="file",n.FOLDER="folder",n}(y||{}),O=function(n){return n.FILENAME="filename",n.SIZE="size",n.TIME="time",n.EXTENSION="ext",n}(O||{}),F=function(n){return n.GRID="grid",n.LIST="list",n}(F||{}),w=function(n){return n.W_768_I_1="(max-width: 767.98px)",n.W_933_I_2="(min-width: 768px) and (max-width: 933.98px)",n.W_960_I_3="(min-width: 934px) and (max-width: 959.98px)",n.W_1226_I_2="(min-width: 960px) and (max-width: 1225.98px)",n.W_1540_I_3="(min-width: 1226px) and (max-width: 1539.98px)",n.W_1854_I_4="(min-width: 1540px) and (max-width: 1853.98px)",n.W_2168_I_5="(min-width: 1854px) and (max-width: 2167.98px)",n.W_2482_I_6="(min-width: 2168px) and (max-width: 2481.98px)",n.W_2796_I_7="(min-width: 2482px) and (max-width: 2795.98px)",n.W_3110_I_8="(min-width: 2796px) and (max-width: 3109.98px)",n.W_3424_I_9="(min-width: 3110px) and (max-width: 3423.98px)",n.W_3738_I_10="(min-width: 3424px)",n}(w||{})},1990:(Y,C,o)=>{"use strict";o.d(C,{JJ:()=>w,KK:()=>y,b3:()=>n,ql:()=>F,uJ:()=>A,vV:()=>O});var f=o(5172);const y=[{ext:["png","apng"],maxSize:15},{ext:["jpeg","jpg","jpe"],maxSize:10},{ext:["gif"],maxSize:15},{ext:["bmp"],maxSize:10},{ext:["webp","webm"],maxSize:10},{ext:["psd","xcf"],maxSize:150},{ext:["svg"],maxSize:30}].map(W=>(W.maxSize*=1048576,W)),O={lastPath:[],layout:{asc:!0,orderBy:f.gG.FILENAME,type:f.c5.GRID},uploader:{checkImage:{time:0,active:!0},showLinkModal:!1}},F="https://upload.forumfree.net/api/",w=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-.\s])*$/,n=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-\s])*$/,A={invalidLength:!1,alreadyUsed:!1,invalidStartOrEnd:!1,invalidCharacter:!1}},5983:(Y,C,o)=>{"use strict";o.d(C,{B:()=>w});var f=o(5172),y=o(6306),O=o(1410),F=o(5879);let w=(()=>{var n;class A{constructor(c){this.globalsService=c,this.cache={},this.profileSubscription=this.globalsService.profileObservable.subscribe(g=>{this.ffuid=null==g?void 0:g.user.ffuid})}getItem(c){const g=this.createKey(c);if((0,y.o8)(this.cache,g))return this.cache[g]}setItem(c,g){this.cache[this.createKey(c)]=g}removeItem(c){const g=this.createKey(c);if((0,y.o8)(this.cache,g)){if(this.cache[g].folders.length)for(const h of this.cache[g].folders)this.removeItem([...c,h.name]);return delete this.cache[g],!0}return!1}getEntities(c,g){const h={},a=this.createKey(c);if(!(0,y.o8)(this.cache,a))return h;for(const m of g){const L=(m.type===f.VC.FILE?this.cache[a].files:this.cache[a].folders).find(M=>M.name===m.name);L&&(h[L.name]=L)}return h}addEntities(c,g,h=f.VC.FILE){const a=this.createKey(c);return!!(0,y.o8)(this.cache,a)&&(Array.isArray(g)||(g=[g]),h===f.VC.FILE?this.cache[a].files.unshift(...g):this.cache[a].folders.unshift(...g),!0)}removeEntities(c,g,h=f.VC.FILE){if(Array.isArray(g)||(g=[g]),h===f.VC.FOLDER)for(const M of g)this.removeItem([...c,M]);const a=this.createKey(c);if(!(0,y.o8)(this.cache,a))return[];const m=h===f.VC.FILE?"files":"folders",L=[];for(const M of g){const B=this.cache[a][m].findIndex(X=>X.name===M);B>-1&&(this.cache[a][m].splice(B,1),L.push(M))}return L}refactorFolderContent(c,g){const h=this.createKey(c);if(!(0,y.o8)(this.cache,h))return!1;g.endsWith("/")||(g+="/");for(const a of this.cache[h].folders)a.url=g+a.name;for(const a of this.cache[h].files)a.url=a.embedUrl=g+a.name,a.time=Date.now();return!0}createKey(c){return`${this.ffuid}/${c.join("/")}`}ngOnDestroy(){this.profileSubscription.unsubscribe()}}return(n=A).\u0275fac=function(c){return new(c||n)(F.LFG(O.d))},n.\u0275prov=F.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),A})()},5571:(Y,C,o)=>{"use strict";o.d(C,{He:()=>n,jt:()=>F,oT:()=>y,pf:()=>w,vJ:()=>A,wm:()=>f,xj:()=>O});const f="\nquery UploadEntitiesListToken($scope: String, $target: String!) {\n    uploadEntitiesListToken(scope: $scope, target: $target)\n}",y="\nquery UploadEntitiesHostToken($scope: String, $target: String!) {\n    uploadEntitiesHostToken(scope: $scope, target: $target)\n}",O="\nquery UploadEntitiesCreateDirectoryToken($scope: String, $target: String!) {\n    uploadEntitiesCreateDirectoryToken(scope: $scope, target: $target)\n}",F="\nquery UploadEntitiesMoveToken($scope: String, $source: String!, $target: String!) {\n    uploadEntitiesMoveToken(scope: $scope, source: $source, target: $target)\n}",w="\nquery UploadEntitiesDeleteToken($scope: String, $target: String!) {\n    uploadEntitiesDeleteToken(scope: $scope, target: $target)\n}",n="\nquery UploadHistoryAvailableDateRange {\n    uploadHistoryAvailableDateRange {\n        start\n        end\n    }\n}",A="\nsubscription UploadEntities($scope: String) {\n    uploadEntities(scope: $scope) {\n        eventMessage\n        eventType\n        user {\n            avatar\n            host\n            id\n            nickname\n        }\n    }\n}"},5487:(Y,C,o)=>{"use strict";o.d(C,{r:()=>w});var f=o(8645),y=o(5619),O=o(446),F=o(5879);let w=(()=>{var n;class A{constructor(c){this.uploadPreferencesService=c,this.selectedFileListArray=[],this.actionSubject=new f.x,this.uploadingFileQueueSubject=new f.x,this.uploadingFileErrorSubject=new f.x,this.currentFolderPathSubject=new f.x,this.layoutOptionsSubject=new f.x,this.renameEntitySubject=new f.x,this.entityPendingSubject=new f.x,this.deleteFileSubject=new f.x,this.uploadedFileSubject=new f.x,this.draggedFileListSubject=new f.x,this.startUploadSubject=new f.x,this.startMoveSubject=new f.x,this.selectedFileListSubject=new y.X(this.selectedFileListArray)}get actionObservable(){return this.actionSubject.asObservable()}pushAction(c){this.actionSubject.next(c)}get layoutOptionsObservable(){return this.layoutOptionsSubject.asObservable()}pushLayoutOptions(c){this.uploadPreferencesService.layoutOptions=c,this.layoutOptionsSubject.next(c)}get currentFolderPathObservable(){return this.currentFolderPathSubject.asObservable()}pushCurrentFolderPath(c){this.uploadPreferencesService.lastFolderPath=c,this.currentFolderPathSubject.next(c)}get uploadingFileQueueObservable(){return this.uploadingFileQueueSubject.asObservable()}pushUploadingFileQueue(c){this.uploadingFileQueueSubject.next(c)}get uploadingFileErrorObservable(){return this.uploadingFileErrorSubject.asObservable()}pushUploadingFileError(c){this.uploadingFileErrorSubject.next(c)}get renameEntityObservable(){return this.renameEntitySubject.asObservable()}pushRenameEntity(c){this.renameEntitySubject.next(c)}get entityPendingObservable(){return this.entityPendingSubject.asObservable()}pushEntityPending(c){this.entityPendingSubject.next(c)}get deleteFileObservable(){return this.deleteFileSubject.asObservable()}pushDeleteFile(c){this.deleteFileSubject.next(c)}get uploadedFileObservable(){return this.uploadedFileSubject.asObservable()}pushUploadedFile(c){this.uploadedFileSubject.next(c)}get draggedFileListObservable(){return this.draggedFileListSubject.asObservable()}pushDraggedFileList(c){this.draggedFileListSubject.next(c)}get startUploadObservable(){return this.startUploadSubject.asObservable()}pushStartUpload(c){this.startUploadSubject.next(c)}get startMoveObservable(){return this.startMoveSubject.asObservable()}pushStartMove(c){this.startMoveSubject.next(c)}get selectedFileListObservable(){return this.selectedFileListSubject.asObservable()}pushSelectedFile(c){if(Array.isArray(c)||(c=[c]),0===c.length)return void(this.selectedFileListArray.length>0&&(this.selectedFileListArray=[],this.selectedFileListSubject.next(this.selectedFileListArray)));let g=!1;for(const h of c){const a=this.selectedFileListArray.findIndex(m=>m.name===h.name);h.selected?-1===a&&(this.selectedFileListArray.push({name:h.name}),g=!0):a>-1&&(this.selectedFileListArray.splice(a,1),g=!0)}g&&this.selectedFileListSubject.next(this.selectedFileListArray)}}return(n=A).\u0275fac=function(c){return new(c||n)(F.LFG(O.p))},n.\u0275prov=F.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),A})()},446:(Y,C,o)=>{"use strict";o.d(C,{p:()=>A});var f=o(6306),y=o(7165),O=o(463),F=o(1990),w=o(2986),n=o(5879);let A=(()=>{var W;class c{constructor(h,a){this.preferencesService=h,this.urlQueryParamsService=a;const m=this.urlQueryParamsService.getAndDeleteParam(y.RT.UPLOAD_PATH);m&&(this.lastFolderPath=m.split("/").filter(L=>L.length>0))}get preferences(){return this.preferencesService.getItem(y.Ye.UPLOAD)||F.vV}set preferences(h){this.preferencesService.setItem(y.Ye.UPLOAD,h)}get lastFolderPath(){return(this.preferences.lastPath||F.vV.lastPath).filter(h=>h.length>0)}set lastFolderPath(h){const a=this.preferences;a.lastPath=h,this.preferences=a}get layoutOptions(){const h=F.vV.layout,a=this.preferences.layout;return a&&0===Object.keys(h).filter(m=>!(0,f.o8)(a,m)).length?a:h}set layoutOptions(h){const a=this.preferences;a.layout=h,this.preferences=a}get uploader(){const h=this.preferences.uploader||F.vV.uploader;return!h.checkImage.active&&Date.now()-h.checkImage.time>6048e5&&(h.checkImage.active=!0,this.uploader=h),(0,f.o8)(h,"showLinkModal")||(h.showLinkModal=!1),h}set uploader(h){const a=this.preferences;a.uploader=h,this.preferences=a}}return(W=c).\u0275fac=function(h){return new(h||W)(n.LFG(O.y),n.LFG(w.J))},W.\u0275prov=n.Yz7({token:W,factory:W.\u0275fac,providedIn:"root"}),c})()},658:(Y,C,o)=>{"use strict";o.d(C,{C:()=>L});var f=o(1413),y=o(5861),O=o(6306),F=o(4036),w=o(5172),n=o(9054),A=o(5571),W=o(5983),c=o(1990),g=o(446),h=o(4004),a=o(5879),m=o(9862);let L=(()=>{var M;class B{constructor(x,P,I,s){this.graphqlService=x,this.uploadCacheService=P,this.uploadPreferencesService=I,this.http=s}get cache(){return this.uploadCacheService}get preferences(){return this.uploadPreferencesService}setGqlIdHeader(){this.graphqlService.safeSetGlobalHeader(O._3.UUID,(0,h.Z)())}removeGqlIdHeader(){this.graphqlService.removeGlobalHeader(O._3.UUID)}getGqlIdHeader(){return this.graphqlService.getGlobalHeader(O._3.UUID)||""}getFileList(x,P){var I=this;return(0,y.Z)(function*(){const s=I.uploadCacheService.getItem(x);if(s)return s;const _=(yield I.graphqlService.query({query:A.wm,variables:{scope:P,target:x.join("/")}})).data.uploadEntitiesListToken,t=yield I.sendRequest(_),d={files:t.files.map(v=>{const R=(0,n.Tb)(v.url);return(0,f.Z)((0,f.Z)({},v),{time:1e3*v.time,filename:R.filename,ext:R.ext,isImage:(0,n.Or)(R.ext),embedUrl:`${v.url}?t=${v.time}`,type:w.VC.FILE})}),folders:t.folders.map(v=>(0,f.Z)((0,f.Z)({},v),{},{type:w.VC.FOLDER}))};return I.uploadCacheService.setItem(x,d),d})()}createDirectory(x,P){var I=this;return(0,y.Z)(function*(){const s=(yield I.graphqlService.mutate({mutation:A.xj,variables:{scope:P,target:x.join("/")}})).data.uploadEntitiesCreateDirectoryToken;return yield I.sendRequest(s)})()}moveRenameEntity(x,P,I,s,_){var t=this;return(0,y.Z)(function*(){s||(s=I);const u=(yield t.graphqlService.mutate({mutation:A.jt,variables:{scope:_,source:(x.length?`${x.join("/")}/`:"")+I,target:(P.length?`${P.join("/")}/`:"")+s}})).data.uploadEntitiesMoveToken,d=yield t.sendRequest(u);return(0,f.Z)((0,f.Z)({},d),{},{time:1e3*d.time})})()}deleteEntity(x,P,I){var s=this;return(0,y.Z)(function*(){const _=(yield s.graphqlService.mutate({mutation:A.pf,variables:{scope:I,target:(x.length?`${x.join("/")}/`:"")+P}})).data.uploadEntitiesDeleteToken;return yield s.sendRequest(_),!0})()}getHostToken(x,P,I){var s=this;return(0,y.Z)(function*(){return(yield s.graphqlService.query({query:A.oT,variables:{scope:I,target:(x.length?`${x.join("/")}/`:"")+P}})).data.uploadEntitiesHostToken})()}sendRequest(x){var P=this;return(0,y.Z)(function*(){return(yield(0,F.z)(P.http.post(c.ql,JSON.stringify({payload:x}),{headers:{"Content-Type":"application/json"}}))).success})()}subscribeForChanges(x,P){var I=this;return(0,y.Z)(function*(){return yield I.graphqlService.subscribe({query:A.vJ,variables:{scope:P}},s=>{var _;if(null===(_=s.data)||void 0===_||!_.uploadEntities)return;const t=JSON.parse(s.data.uploadEntities.eventMessage);!t.payload.customHeaders||!(0,O.o8)(t.payload.customHeaders,O._3.UUID)||t.payload.customHeaders[O._3.UUID]===I.getGqlIdHeader()||x({type:s.data.uploadEntities.eventType,message:t})})})()}}return(M=B).\u0275fac=function(x){return new(x||M)(a.LFG(O.Jk),a.LFG(W.B),a.LFG(g.p),a.LFG(m.eN))},M.\u0275prov=a.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),B})()},9054:(Y,C,o)=>{"use strict";o.d(C,{$H:()=>X,JN:()=>h,LZ:()=>m,Lv:()=>A,Or:()=>B,Tb:()=>w,g0:()=>_,g8:()=>s,jL:()=>M,lY:()=>W,ok:()=>P,rQ:()=>I,rc:()=>x,zO:()=>n});var f=o(5861),y=o(1413),O=o(5172),F=o(1990);function w(t){let u=t;if(t.indexOf("/")>-1){const U=t.split("/");u=U[U.length-1]}const d=u.replace(/\?.*$/,"").split("."),v=d.length>1?d[d.length-1].toLowerCase():"",R=decodeURIComponent(d.slice(0,-1).join("."));return{ext:v,filename:R,name:v?`${R}.${v}`:""}}function n(t,u={}){const d=w(t),v=Date.now();return(0,y.Z)({name:d.name,size:0,time:v,url:t,ext:d.ext,filename:d.filename,isImage:B(d.ext),embedUrl:`${t}?t=${v}`,type:O.VC.FILE},u)}function A(t){let u=t;u.endsWith("/")&&(u=u.slice(0,-1));const d=u.split("/");return{name:decodeURIComponent(d[d.length-1])}}function W(t){return{name:A(t).name,url:t,type:O.VC.FOLDER}}function c(t){return g.apply(this,arguments)}function g(){return(g=(0,f.Z)(function*(t){const u=new FileReader,d=new Promise(v=>u.addEventListener("load",()=>v(u.result)));return u.readAsDataURL(t),d})).apply(this,arguments)}function h(t){return a.apply(this,arguments)}function a(){return(a=(0,f.Z)(function*(t){const u=new DataView(yield t.arrayBuffer());if(2303741511===u.getUint32(0)&&218765834===u.getUint32(4)){if(-1===[4,6].indexOf(u.getUint8(25)))return!1;const v=Object.assign(new Image,{src:yield c(t)});yield new Promise(j=>v.addEventListener("load",()=>j(!0)));const R=Object.assign(document.createElement("canvas"),{width:v.width,height:v.height}).getContext("2d");if(!R)return!1;R.imageSmoothingEnabled=!1,R.drawImage(v,0,0);const U=null==R?void 0:R.getImageData(0,0,v.width,v.height);if(U)for(let j=0;j<U.data.length;j+=4)if(U.data[j+3]<255)return!0}return!1})).apply(this,arguments)}function m(t){return L.apply(this,arguments)}function L(){return(L=(0,f.Z)(function*(t){const u=Object.assign(new Image,{src:yield c(t)});return yield new Promise(d=>u.addEventListener("load",()=>d(!0))),u})).apply(this,arguments)}function M(t){return t.map(u=>({name:u.name,ext:u.ext,type:O.VC.FILE,url:u.url,embedUrl:u.embedUrl,isImage:u.isImage}))}function B(t,u=[]){return["png","apng","jpeg","jpg","jpe","gif","svg","webp"].includes(t)&&!u.includes(t)}function X(t){return B(t,["gif","svg"])}function x(t,u,d,v=[],R=""){const U=(0,y.Z)({},F.uJ),j=t.trim();U.invalidLength=0===j.length;const G=(j+R).replace(/\s{2,}/g," ");return U.alreadyUsed=u!==j&&v.includes(G),U.invalidStartOrEnd=/(^(\s|\.))|((\s|\.)$)/.test(t),U.invalidCharacter=!(d===O.VC.FILE?F.JJ.test(t):F.b3.test(t)),U}function P(t,u){return t.join("/")===u.join("/")}function I(t){const u=[],d=[];for(const v of t)v.type===O.VC.FILE?u.push(v):d.push(v);return{[O.VC.FILE]:u,[O.VC.FOLDER]:d}}function s(t){return F.KK.find(u=>-1!==u.ext.indexOf(t))}function _(t,u){return u=u||w(t.name),{file:{name:t.name,size:t.size,time:0,url:"",ext:u.ext,filename:u.filename,isImage:B(u.ext),embedUrl:"",type:O.VC.FILE},progress:0,completed:!1}}},4887:(Y,C,o)=>{"use strict";o.d(C,{q:()=>X});var f=o(5861),y=o(1413),O=o(4315),F=o.n(O),w=o(9054),n=o(9862),A=o(8645),W=o(1687),c=o(9773),g=o(4036),h=o(1990),a=o(5487),m=o(658),L=function(x){return x[x.ORIENTATION=0]="ORIENTATION",x[x.CAMERA_MODEL=1]="CAMERA_MODEL",x}(L||{});class M{static findApp1Marker(P){const I=new DataView(P),s=new Set([65498,65497,65476,65474,65472,65499,65501]);for(let _=0;_<P.byteLength-2;_+=2){const t=I.getUint16(_);if(65505===t)return{offset:_,size:I.getUint16(_+2),little:18761==I.getUint16(_+8,!1)};if(s.has(t))break}}static stripAndReturnExif(P){return(0,f.Z)(function*(){const I=yield P.arrayBuffer(),s=M.findApp1Marker(I);return s?{file:new File([I.slice(0,s.offset),I.slice(s.offset+s.size+2)],P.name,{type:P.type,lastModified:P.lastModified}),exif:I.slice(s.offset,s.offset+s.size)}:{file:P}})()}static checkExifTagValue(P,I){const s=new DataView(P);if(1165519206!==s.getUint32(4,!1))return;const _=18761===s.getUint16(10,!1);let t=10;t+=s.getUint32(t+4,_);const u=s.getUint16(t,_);t+=2;for(let d=0;d<u;d++){const v=s.getUint16(t+12*d,_);if(I===L.ORIENTATION&&274===v)return s.getUint16(t+12*d+8,_);if(I===L.CAMERA_MODEL&&272===v){const R=s.getUint32(t+12*d+4,_),U=s.getUint32(t+12*d+8,_),j=new Uint8Array(P,U,R),G=Array.from(j);return String.fromCharCode.apply(null,G)}}}}var B=o(5879);let X=(()=>{var x;class P{constructor(s,_,t){this.http=s,this.uploadObservablesService=_,this.uploadService=t,this.requestSubscriptions=[],this.uploaderOptionsObject={compress:!0,openLinkModalAfterUpload:!1}}get uploaderOptions(){return(0,y.Z)({},this.uploaderOptionsObject)}set uploaderOptions(s){this.uploaderOptionsObject=(0,y.Z)({},s)}prepareFile(s,_){var t=this;return(0,f.Z)(function*(){const u=yield t.orientAndCompressFileIfNeeded(s);return u.compressorCheck?u.file:_.compress?yield t.compressFileIfNeeded(s,_.imageDimensions?{width:_.imageDimensions.width,height:_.imageDimensions.height}:{}):s})()}compressFileIfNeeded(s,_={},t=!1){return(0,f.Z)(function*(){const u=["image/png","image/jpeg"],d=(0,y.Z)({strict:!0,checkOrientation:!0,quality:.8,convertSize:1},_),v=void 0!==d.width||void 0!==d.height;v&&(u.push("image/webp"),d.resize="cover",d.strict=_.strict||!1);const R=s.type.toLowerCase();return s.size<=1e6&&!v&&!t||-1===u.indexOf(s.type.toLowerCase())?s:("image/png"===R&&(yield(0,w.JN)(s))&&(d.convertSize=1/0),new Promise((U,j)=>{new(F())(s,(0,y.Z)((0,y.Z)({},d),{},{success:G=>{const Q=G instanceof Blob?new File([G],s.name,{type:s.type,lastModified:s.lastModified}):s;U(Q)},error:j}))}))})()}getDimensionsForForcedResize(s){return(0,f.Z)(function*(){const t=yield(0,w.LZ)(s),u=t.width>t.height?"width":"height";if(t[u]>1e3)return{[u]:1e3}})()}orientAndCompressFileIfNeeded(s){var _=this;return(0,f.Z)(function*(){if(-1===["image/jpeg"].indexOf(s.type.toLowerCase()))return{file:s,compressorCheck:!1};const u=yield M.stripAndReturnExif(s),d=u.file;if(u.exif){if(void 0!==M.checkExifTagValue(u.exif,L.CAMERA_MODEL)){const j=yield _.getDimensionsForForcedResize(s);if(j)return{file:yield _.compressFileIfNeeded(s,(0,y.Z)({strict:!0,quality:.7},j)),compressorCheck:!0}}if(1!==M.checkExifTagValue(u.exif,L.ORIENTATION))return{file:yield _.compressFileIfNeeded(s,{},!0),compressorCheck:!0}}return{file:d,compressorCheck:!1}})()}upload(s,_,t,u=!1){const d=new A.x,v=new FormData;v.append("payload",_),v.append("upload",s,s.name),u&&v.append("allowOverwrite","1");const R=this.http.request(new n.aW("POST",h.ql,v,{reportProgress:!0,responseType:"json"}));return this.requestSubscriptions.push(R.subscribe({next:U=>{if(U.type===n.dt.UploadProgress){if(!U.total||(t.progress=Math.round(50*U.loaded/U.total)+20,t.progress<70))return;(0,W.F)(1e3).pipe((0,c.R)(d.asObservable())).subscribe(()=>{if(t.progress<95){const Q=Math.round(8*Math.random()+8);t.progress+Q>95?t.progress=95:t.progress+=Q}})}else if(U instanceof n.Zn){var j,G;if(t.progress=100,t.completed=!0,null!==(j=U.body)&&void 0!==j&&j.error||null===(G=U.body)||void 0===G||!G.success)t.error=!0,this.uploadObservablesService.pushUploadingFileError(t);else{t.file.url=U.body.success.url,t.file.time=Date.now(),t.file.embedUrl=`${t.file.url}?t=${t.file.time}`;const Q=(0,w.Tb)(t.file.url);t.file.name=Q.name,t.file.filename=Q.filename}d.next(t),d.complete()}},error:()=>{t.error=!0,this.uploadObservablesService.pushUploadingFileError(t),d.next(t),d.complete()}})),d.asObservable()}uploadFromList(s,_=[],t){var u=this;return(0,f.Z)(function*(){const d=[];for(const v of s){const R=(0,w.Tb)(v.name),U=(0,w.g8)(R.ext);if(!U||v.size>U.maxSize||t&&!t(R))continue;const j=yield u.prepareFile(v,{compress:!0}),G=yield u.uploadService.getHostToken(_,v.name);d.push(yield(0,g.z)(u.upload(j,G,(0,w.g0)(j,R))))}return d})()}clearPendingRequests(){for(const s of this.requestSubscriptions)s.unsubscribe();this.requestSubscriptions=[]}}return(x=P).\u0275fac=function(s){return new(s||x)(B.LFG(n.eN),B.LFG(a.r),B.LFG(m.C))},x.\u0275prov=B.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"}),P})()},4315:function(Y){Y.exports=function(){"use strict";function C(l,e){var r=Object.keys(l);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(l);e&&(i=i.filter(function(p){return Object.getOwnPropertyDescriptor(l,p).enumerable})),r.push.apply(r,i)}return r}function o(l){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?C(Object(r),!0).forEach(function(i){F(l,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach(function(i){Object.defineProperty(l,i,Object.getOwnPropertyDescriptor(r,i))})}return l}function y(l,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(l,A(i.key),i)}}function F(l,e,r){return(e=A(e))in l?Object.defineProperty(l,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):l[e]=r,l}function w(){return w=Object.assign?Object.assign.bind():function(l){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(l[i]=r[i])}return l},w.apply(this,arguments)}function A(l){var e=function n(l,e){if("object"!=typeof l||null===l)return l;var r=l[Symbol.toPrimitive];if(void 0!==r){var i=r.call(l,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(l)}(l,"string");return"symbol"==typeof e?e:String(e)}var l,e,r,i,p,b,K,T,W={exports:{}};l=W,typeof window>"u"||(e=window,r=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,i=e.Blob&&function(){try{return!!new Blob}catch(D){return!1}}(),p=i&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(D){return!1}}(),b=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,K=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,T=(i||b)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(D){var S,z,k,N,V,E,J,H,ee;if(!(S=D.match(K)))throw new Error("invalid data URI");for(z=S[2]?S[1]:"text/plain"+(S[3]||";charset=US-ASCII"),k=!!S[4],N=D.slice(S[0].length),V=k?atob(N):decodeURIComponent(N),E=new ArrayBuffer(V.length),J=new Uint8Array(E),H=0;H<V.length;H+=1)J[H]=V.charCodeAt(H);return i?new Blob([p?J:E],{type:z}):((ee=new b).append(E),ee.getBlob(z))},e.HTMLCanvasElement&&!r.toBlob&&(r.mozGetAsFile?r.toBlob=function(D,S,z){var k=this;setTimeout(function(){D(z&&r.toDataURL&&T?T(k.toDataURL(S,z)):k.mozGetAsFile("blob",S))})}:r.toDataURL&&T&&(r.toBlob=r.msToBlob?function(D,S,z){var k=this;setTimeout(function(){D((S&&"image/png"!==S||z)&&r.toDataURL&&T?T(k.toDataURL(S,z)):k.msToBlob(S))})}:function(D,S,z){var k=this;setTimeout(function(){D(T(k.toDataURL(S,z)))})})),l.exports?l.exports=T:e.dataURLtoBlob=T);var c=W.exports,h={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},m=typeof window<"u"&&typeof window.document<"u"?window:{},L=function(e){return e>0&&e<1/0},M=Array.prototype.slice;function B(l){return Array.from?Array.from(l):M.call(l)}var X=/^image\/.+$/;function x(l){return X.test(l)}var I=String.fromCharCode;var _=m.btoa;function t(l,e){for(var r=[],p=new Uint8Array(l);p.length>0;)r.push(I.apply(null,B(p.subarray(0,8192)))),p=p.subarray(8192);return"data:".concat(e,";base64,").concat(_(r.join("")))}function u(l){var r,e=new DataView(l);try{var i,p,b;if(255===e.getUint8(0)&&216===e.getUint8(1))for(var K=e.byteLength,T=2;T+1<K;){if(255===e.getUint8(T)&&225===e.getUint8(T+1)){p=T;break}T+=1}if(p){var S=p+10;if("Exif"===function s(l,e,r){var p,i="";for(r+=e,p=e;p<r;p+=1)i+=I(l.getUint8(p));return i}(e,p+4,4)){var z=e.getUint16(S);if(((i=18761===z)||19789===z)&&42===e.getUint16(S+2,i)){var k=e.getUint32(S+4,i);k>=8&&(b=S+k)}}}if(b){var V,E,N=e.getUint16(b,i);for(E=0;E<N;E+=1)if(274===e.getUint16(V=b+12*E+2,i)){r=e.getUint16(V+=8,i),e.setUint16(V,1,i);break}}}catch(J){r=1}return r}var v=/\.\d*(?:0|9){12}\d*$/;function R(l){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return v.test(l)?Math.round(l*e)/e:l}function U(l){var e=l.aspectRatio,r=l.height,i=l.width,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",b=L(i),K=L(r);if(b&&K){var T=r*e;("contain"===p||"none"===p)&&T>i||"cover"===p&&T<i?r=i/e:i=r*e}else b?r=i/e:K&&(i=r*e);return{width:i,height:r}}var Q=m.ArrayBuffer,ce=m.FileReader,q=m.URL||m.webkitURL,Te=/\.\w+$/,Ae=m.Compressor,Re=function(){function l(e,r){(function f(l,e){if(!(l instanceof e))throw new TypeError("Cannot call a class as a function")})(this,l),this.file=e,this.exif=[],this.image=new Image,this.options=o(o({},h),r),this.aborted=!1,this.result=null,this.init()}return function O(l,e,r){return e&&y(l.prototype,e),r&&y(l,r),Object.defineProperty(l,"prototype",{writable:!1}),l}(l,[{key:"init",value:function(){var r=this,i=this.file,p=this.options;if(function(e){return!(typeof Blob>"u")&&(e instanceof Blob||"[object Blob]"===Object.prototype.toString.call(e))}(i)){var b=i.type;if(x(b))if(q&&ce){Q||(p.checkOrientation=!1,p.retainExif=!1);var K="image/jpeg"===b,T=K&&p.checkOrientation,D=K&&p.retainExif;if(!q||T||D){var S=new ce;this.reader=S,S.onload=function(z){var N=z.target.result,V={},E=1;T&&(E=u(N))>1&&w(V,function d(l){var e=0,r=1,i=1;switch(l){case 2:r=-1;break;case 3:e=-180;break;case 4:i=-1;break;case 5:e=90,i=-1;break;case 6:e=90;break;case 7:e=90,r=-1;break;case 8:e=-90}return{rotate:e,scaleX:r,scaleY:i}}(E)),D&&(r.exif=function j(l){for(var e=B(new Uint8Array(l)),r=e.length,i=[],p=0;p+3<r;){var b=e[p],K=e[p+1];if(255===b&&218===K)break;if(255===b&&216===K)p+=2;else{var D=p+(256*e[p+2]+e[p+3])+2,S=e.slice(p,D);i.push(S),p=D}}return i.reduce(function(z,k){return 255===k[0]&&225===k[1]?z.concat(k):z},[])}(N)),V.url=T||D?!q||E>1?t(N,b):q.createObjectURL(i):N,r.load(V)},S.onabort=function(){r.fail(new Error("Aborted to read the image with FileReader."))},S.onerror=function(){r.fail(new Error("Failed to read the image with FileReader."))},S.onloadend=function(){r.reader=null},T||D?S.readAsArrayBuffer(i):S.readAsDataURL(i)}else this.load({url:q.createObjectURL(i)})}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(r){var i=this,p=this.file,b=this.image;b.onload=function(){i.draw(o(o({},r),{},{naturalWidth:b.naturalWidth,naturalHeight:b.naturalHeight}))},b.onabort=function(){i.fail(new Error("Aborted to load the image."))},b.onerror=function(){i.fail(new Error("Failed to load the image."))},m.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(m.navigator.userAgent)&&(b.crossOrigin="anonymous"),b.alt=p.name,b.src=r.url}},{key:"draw",value:function(r){var i=this,p=r.naturalWidth,b=r.naturalHeight,K=r.rotate,T=void 0===K?0:K,D=r.scaleX,S=void 0===D?1:D,z=r.scaleY,k=void 0===z?1:z,N=this.file,V=this.image,E=this.options,J=document.createElement("canvas"),H=J.getContext("2d"),ee=Math.abs(T)%180==90,ue=("contain"===E.resize||"cover"===E.resize)&&L(E.width)&&L(E.height),ie=Math.max(E.maxWidth,0)||1/0,ne=Math.max(E.maxHeight,0)||1/0,ae=Math.max(E.minWidth,0)||0,se=Math.max(E.minHeight,0)||0,te=p/b,$=E.width,Z=E.height;if(ee){var me=[ne,ie];ie=me[0],ne=me[1];var ge=[se,ae];ae=ge[0],se=ge[1];var ve=[Z,$];$=ve[0],Z=ve[1]}ue&&(te=$/Z);var be=U({aspectRatio:te,width:ie,height:ne},"contain");ie=be.width,ne=be.height;var _e=U({aspectRatio:te,width:ae,height:se},"cover");if(ae=_e.width,se=_e.height,ue){var ye=U({aspectRatio:te,width:$,height:Z},E.resize);$=ye.width,Z=ye.height}else{var Ee=U({aspectRatio:te,width:$,height:Z}),xe=Ee.width;$=void 0===xe?p:xe;var Oe=Ee.height;Z=void 0===Oe?b:Oe}var Ce=-($=Math.floor(R(Math.min(Math.max($,ae),ie))))/2,je=-(Z=Math.floor(R(Math.min(Math.max(Z,se),ne))))/2,Be=$,We=Z,de=[];if(ue){var he,fe,Se=U({aspectRatio:te,width:p,height:b},{contain:"cover",cover:"contain"}[E.resize]);de.push((p-(he=Se.width))/2,(b-(fe=Se.height))/2,he,fe)}if(de.push(Ce,je,Be,We),ee){var Ue=[Z,$];$=Ue[0],Z=Ue[1]}J.width=$,J.height=Z,x(E.mimeType)||(E.mimeType=N.type);var Fe="transparent";N.size>E.convertSize&&E.convertTypes.indexOf(E.mimeType)>=0&&(E.mimeType="image/jpeg");var we="image/jpeg"===E.mimeType;if(we&&(Fe="#fff"),H.fillStyle=Fe,H.fillRect(0,0,$,Z),E.beforeDraw&&E.beforeDraw.call(this,H,J),!this.aborted&&(H.save(),H.translate($/2,Z/2),H.rotate(T*Math.PI/180),H.scale(S,k),H.drawImage.apply(H,[V].concat(de)),H.restore(),E.drew&&E.drew.call(this,H,J),!this.aborted)){var Pe=function(oe){if(!i.aborted){var Le=function(le){return i.done({naturalWidth:p,naturalHeight:b,result:le})};if(oe&&we&&E.retainExif&&i.exif&&i.exif.length>0){var Me=function(le){return Le(c(t(function G(l,e){var r=B(new Uint8Array(l));if(255!==r[2]||224!==r[3])return l;var p=[255,216].concat(e,r.slice(4+(256*r[4]+r[5])));return new Uint8Array(p)}(le,i.exif),E.mimeType)))};if(oe.arrayBuffer)oe.arrayBuffer().then(Me).catch(function(){i.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var re=new ce;i.reader=re,re.onload=function(pe){Me(pe.target.result)},re.onabort=function(){i.fail(new Error("Aborted to read the compressed image with FileReader."))},re.onerror=function(){i.fail(new Error("Failed to read the compressed image with FileReader."))},re.onloadend=function(){i.reader=null},re.readAsArrayBuffer(oe)}}else Le(oe)}};J.toBlob?J.toBlob(Pe,E.mimeType,E.quality):Pe(c(J.toDataURL(E.mimeType,E.quality)))}}},{key:"done",value:function(r){var i=r.naturalWidth,p=r.naturalHeight,b=r.result,K=this.file,T=this.image,D=this.options;if(q&&0===T.src.indexOf("blob:")&&q.revokeObjectURL(T.src),b)if(D.strict&&!D.retainExif&&b.size>K.size&&D.mimeType===K.type&&!(D.width>i||D.height>p||D.minWidth>i||D.minHeight>p||D.maxWidth<i||D.maxHeight<p))b=K;else{var S=new Date;b.lastModified=S.getTime(),b.lastModifiedDate=S,b.name=K.name,b.name&&b.type!==K.type&&(b.name=b.name.replace(Te,function P(l){var e=x(l)?l.substr(6):"";return"jpeg"===e&&(e="jpg"),".".concat(e)}(b.type)))}else b=K;this.result=b,D.success&&D.success.call(this,b)}},{key:"fail",value:function(r){var i=this.options;if(!i.error)throw r;i.error.call(this,r)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=Ae,l}},{key:"setDefaults",value:function(r){w(h,r)}}]),l}();return Re}()},1687:(Y,C,o)=>{"use strict";o.d(C,{F:()=>O});var f=o(6321),y=o(4825);function O(F=0,w=f.z){return F<0&&(F=0),(0,y.H)(F,F,w)}},4004:(Y,C,o)=>{"use strict";o.d(C,{Z:()=>h});const y={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let O;const F=new Uint8Array(16);function w(){if(!O&&(O=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!O))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return O(F)}const n=[];for(let a=0;a<256;++a)n.push((a+256).toString(16).slice(1));const h=function g(a,m,L){if(y.randomUUID&&!m&&!a)return y.randomUUID();const M=(a=a||{}).random||(a.rng||w)();if(M[6]=15&M[6]|64,M[8]=63&M[8]|128,m){L=L||0;for(let B=0;B<16;++B)m[L+B]=M[B];return m}return function A(a,m=0){return n[a[m+0]]+n[a[m+1]]+n[a[m+2]]+n[a[m+3]]+"-"+n[a[m+4]]+n[a[m+5]]+"-"+n[a[m+6]]+n[a[m+7]]+"-"+n[a[m+8]]+n[a[m+9]]+"-"+n[a[m+10]]+n[a[m+11]]+n[a[m+12]]+n[a[m+13]]+n[a[m+14]]+n[a[m+15]]}(M)}}}]);