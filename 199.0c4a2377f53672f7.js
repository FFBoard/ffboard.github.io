"use strict";(self.webpackChunkpages=self.webpackChunkpages||[]).push([[199],{1199:(We,x,s)=>{s.r(x),s.d(x,{UploadComponent:()=>qe});var p=s(5861),h=s(6814),e=s(9212),u=s(1993),A=s(9344),m=s(4020),b=s(529),Z=s(3845),D=s(9093),f=s(148),g=s(7595),L=s(5487),T=s(658),y=s(7398),F=s(8645),P=s(2181),_=s(8726),r=s(9515),I=s(578),J=s(4243);let U=(()=>{var t;class l{constructor(){this.text=e.qHZ.required(),this.value=e.qHZ.required(),this.selected=(0,e.qHZ)(!1),this.classes=(0,e.qHZ)(["p-2"]),this.clickEvent=new e.vpe}}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-upload-menu-button"]],inputs:{text:[e.lbL.SignalBased,"text"],value:[e.lbL.SignalBased,"value"],selected:[e.lbL.SignalBased,"selected"],classes:[e.lbL.SignalBased,"classes"]},outputs:{clickEvent:"clickEvent"},standalone:!0,features:[e.jDz],decls:1,vars:4,consts:[["role","button",1,"upload-menu-btn","rounded","text-reset","m-1","d-block",3,"ngClass","innerHTML","click"]],template:function(n,i){1&n&&(e.TgZ(0,"a",0),e.NdJ("click",function(){return i.clickEvent.emit(i.value())}),e.qZA()),2&n&&(e.ekj("selected",i.selected()),e.Q6J("ngClass",i.classes())("innerHTML",i.text(),e.oJD))},dependencies:[h.mk],styles:[".upload-menu-btn[_ngcontent-%COMP%]{transition:background-color .2s;-webkit-user-select:none;-moz-user-select:none;user-select:none}.upload-menu-btn.selected[_ngcontent-%COMP%]{background-color:#dae0ff}"],changeDetection:0}),l})(),N=(()=>{var t;class l{constructor(){this.uploadService=(0,e.f3M)(T.C)}getLastFolders(){return this.uploadService.cache.getWidgetFolders(this.uploadService.preferences.lastFolderPath)}getFolders(n){var i=this;return(0,p.Z)(function*(){const a=i.uploadService.cache.getWidgetFolders(n),d=a||(yield i.uploadService.getFileList(n)).folders.sort((C,S)=>C.name.localeCompare(S.name));return a||i.uploadService.cache.setWidgetFolders(n,d),d})()}}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),l})();var c=s(7165),k=s(4228),w=s(9473);const H=t=>({url:t});function G(t,l){if(1&t&&(e.TgZ(0,"div",3)(1,"p",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"p",5),e.ALo(5,"translate"),e.qZA()),2&t){const o=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"ROUTES.WIDGETS.UPLOAD.NO_FOLDER")," "),e.xp6(2),e.Q6J("innerHTML",e.xi3(5,4,"ROUTES.WIDGETS.UPLOAD.CREATE_FOLDER",e.VKq(7,H,o.siteUrl())),e.oJD)}}function Q(t,l){1&t&&(e.TgZ(0,"li"),e._UZ(1,"app-loader",7),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(),e.Q6J("onlyMessage",!0)("message",e.lcZ(2,2,"ROUTES.WIDGETS.UPLOAD.LOADING_FOLDERS")))}const j=()=>["fst-italic","p-1"];function z(t,l){if(1&t){const o=e.EpF();e.TgZ(0,"li")(1,"app-upload-menu-button",8),e.NdJ("clickEvent",function(i){e.CHM(o);const a=e.oxw(3);return e.KtG(a.folderClickEvent(i))}),e.ALo(2,"translate"),e.qZA()()}2&t&&(e.xp6(),e.Q6J("text",e.lcZ(2,2,"SHARED.BACK"))("classes",e.DdM(4,j)))}const B=()=>["p-1"];function q(t,l){if(1&t){const o=e.EpF();e.TgZ(0,"li")(1,"app-upload-menu-button",9),e.NdJ("clickEvent",function(i){e.CHM(o);const a=e.oxw(3);return e.KtG(a.folderClickEvent(i))}),e.qZA()()}if(2&t){const o=l.$implicit;e.xp6(),e.Q6J("classes",e.DdM(3,B))("text",o.name)("value",o.name)}}const W=()=>[];function $(t,l){if(1&t&&(e.YNc(0,z,3,5,"li"),e.SjG(1,q,2,4,"li",null,e.ikw)),2&t){const o=e.oxw(2);e.um2(0,o.depth()?0:-1),e.xp6(),e.wJu(o.folders()||e.DdM(1,W))}}function K(t,l){if(1&t&&(e.TgZ(0,"ul",6),e.YNc(1,Q,3,4,"li")(2,$,3,2),e.qZA()),2&t){const o=e.oxw();e.xp6(),e.um2(1,o.loading()?1:2)}}let V=(()=>{var t;class l{constructor(){this.uploadService=(0,e.f3M)(T.C),this.uploadObservablesService=(0,e.f3M)(L.r),this.uploadWidgetService=(0,e.f3M)(N),this.uploadEndpointsService=(0,e.f3M)(g.r),this.siteBaseUrl=e.qHZ.required(),this.currentFolderPath=(0,e.tdS)(this.uploadService.preferences.lastFolderPath),this.depth=(0,e.Flj)(()=>this.currentFolderPath().length),this.loading=(0,e.tdS)(!1),this.folders=(0,e.tdS)(this.uploadWidgetService.getLastFolders()),this.showEmptyFolderAdvice=(0,e.Flj)(()=>{const n=this.folders();return!this.loading()&&n&&0===n.length&&0===this.depth()}),this.siteUrl=(0,e.Flj)(()=>this.siteBaseUrl()+"&".concat(c.RT.UPLOAD_REMOTE,"=").concat(this.uploadEndpointsService.requiredActiveRemote.id))}ngOnInit(){var n=this;return(0,p.Z)(function*(){n.folders()||(yield n.getFolders())})()}getFolders(){var n=this;return(0,p.Z)(function*(){n.loading()||(n.loading.set(!0),n.folders.set(yield n.uploadWidgetService.getFolders(n.currentFolderPath())),n.loading.set(!1))})()}folderClickEvent(n){var i=this;return(0,p.Z)(function*(){const a=n.length?[...i.currentFolderPath(),n]:i.currentFolderPath().slice(0,-1);i.currentFolderPath.set(a),i.uploadObservablesService.pushCurrentFolderPath(a),yield i.getFolders()})()}}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-upload-menu-folder"]],inputs:{siteBaseUrl:[e.lbL.SignalBased,"siteBaseUrl"]},standalone:!0,features:[e.jDz],decls:7,vars:8,consts:[[1,"small","text-center","mt-3","mb-2","text-muted"],[1,"text-break","text-primary",3,"innerText"],["class","alert alert-primary mb-2 p-2"],[1,"alert","alert-primary","mb-2","p-2"],[1,"text-center","fw-bold","mb-0"],[1,"text-center","small","mb-0",3,"innerHTML"],[1,"list-unstyled","mb-0","d-flex","flex-wrap","small","justify-content-center","folder-list"],[1,"d-block",3,"onlyMessage","message"],["value","",1,"d-block",3,"text","classes","clickEvent"],[1,"d-block",3,"classes","text","value","clickEvent"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0),e._uU(1),e.ALo(2,"translate"),e._UZ(3,"em",1),e.ALo(4,"arrayJoin"),e.qZA(),e.YNc(5,G,6,9,"div",2)(6,K,3,1)),2&n&&(e.xp6(),e.hij(" ",e.lcZ(2,3,"ROUTES.WIDGETS.UPLOAD.CURRENT_PATH")," "),e.xp6(2),e.Q6J("innerText",i.currentFolderPath().length?e.xi3(4,5,i.currentFolderPath(),"/"):"root"),e.xp6(2),e.um2(5,i.showEmptyFolderAdvice()?5:6))},dependencies:[r.aw,r.X$,J.r,k.J,I.q,w.R,U],styles:[".folder-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{height:37px;display:flex;align-items:center}"],changeDetection:0}),l})();var Y=s(6355),O=s(2330),v=s(2002),X=s(7795);const ee=t=>({defaultEndpoint:t});function te(t,l){if(1&t&&(e._UZ(0,"p",5),e.ALo(1,"translate")),2&t){const o=e.oxw(2);e.Q6J("innerHTML",e.xi3(1,1,"ROUTES.WIDGETS.UPLOAD.REMOTES_MENU.DEFAULT_REMOTE",e.VKq(4,ee,o.uploadEndpointsService.remotesList().linked[0].name)),e.oJD)}}const ne=(t,l)=>({profileUrl:t,mail:l});function oe(t,l){if(1&t&&(e._UZ(0,"p",5),e.ALo(1,"translate"),e.ALo(2,"ffuidToLink")),2&t){const o=e.oxw(2);e.Q6J("innerHTML",e.xi3(1,1,"ROUTES.WIDGETS.UPLOAD.REMOTES_MENU.EXTERNAL_REMOTE",e.WLB(6,ne,e.lcZ(2,4,o.uploadEndpointsService.requiredActiveRemote.owner),"mailto:"+o.uploadEndpointsService.requiredActiveRemote.email)),e.oJD)}}const ie=(t,l,o)=>({appName:t,managerUrl:l,privacyUrl:o});function le(t,l){if(1&t&&(e.YNc(0,te,2,6,"p",3)(1,oe,3,9),e._UZ(2,"p",4),e.ALo(3,"translate")),2&t){const o=e.oxw();e.um2(0,o.uploadEndpointsService.requiredActiveRemote.default?0:1),e.xp6(2),e.Q6J("innerHTML",e.xi3(3,2,"ROUTES.WIDGETS.UPLOAD.REMOTES_MENU.USEFUL_LINKS",e.kEZ(5,ie,o.appName,o.managerUrl(),o.privacyUrl())),e.oJD)}}const ae=t=>({url:t});function se(t,l){if(1&t&&(e._UZ(0,"p",6),e.ALo(1,"translate")),2&t){const o=e.oxw();e.Q6J("innerHTML",e.xi3(1,1,"ROUTES.WIDGETS.UPLOAD.REMOTES_MENU.NO_REMOTES",e.VKq(4,ae,o.managerUrl())),e.oJD)}}function re(t,l){if(1&t){const o=e.EpF();e.TgZ(0,"li")(1,"app-upload-menu-button",7),e.NdJ("clickEvent",function(i){e.CHM(o);const a=e.oxw();return e.KtG(a.setRemote(i))}),e.qZA()()}if(2&t){const o=l.$implicit,n=e.oxw();e.xp6(),e.Q6J("selected",o.id===n.uploadEndpointsService.activeRemoteId())("text",o.name)("value",o.id)}}let de=(()=>{var t;class l{constructor(){this.uploadEndpointsService=(0,e.f3M)(g.r),this.fileManagerUrl=e.qHZ.required(),this.remoteFilter=n=>!n.deleted,this.appName=m.DJ,this.privacyUrl=(0,e.Flj)(()=>"".concat(this.fileManagerUrl(),"&").concat(c.RT.MODAL,"=").concat(v.u.PRIVACY)),this.managerUrl=(0,e.Flj)(()=>"".concat(this.fileManagerUrl(),"&").concat(c.RT.MODAL,"=").concat(v.u.UPLOAD_ENDPOINTS))}setRemote(n){this.uploadEndpointsService.setActiveRemote(n)}}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-upload-menu-endpoint"]],inputs:{fileManagerUrl:[e.lbL.SignalBased,"fileManagerUrl"]},standalone:!0,features:[e.jDz],decls:7,vars:4,consts:[[1,"small"],["class","mb-1",3,"innerHTML"],[1,"list-unstyled","mb-1","d-flex","flex-wrap","justify-content-center"],["class","text-justify mt-1 mb-0",3,"innerHTML"],[1,"mb-1",3,"innerHTML"],[1,"text-justify","mt-1","mb-0",3,"innerHTML"],[1,"text-justify","my-1",3,"innerHTML"],[3,"selected","text","value","clickEvent"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0),e.YNc(1,le,4,9,"p",1)(2,se,2,6),e.TgZ(3,"ul",2),e.SjG(4,re,2,3,"li",null,e.ikw),e.ALo(6,"arrayFilter"),e.qZA()()),2&n&&(e.xp6(),e.um2(1,i.uploadEndpointsService.remotesList().linked.length?1:2),e.xp6(3),e.wJu(e.xi3(6,1,i.uploadEndpointsService.remotesList().linked,i.remoteFilter)))},dependencies:[U,Y.E,X.H,O.H,r.aw,r.X$],changeDetection:0}),l})();var M=function(t){return t.ENDPOINT="endpoint",t.SETTING="setting",t.FOLDER="folder",t}(M||{});const ce=[{size:0,selected:!0,text:"Default"},{size:800,selected:!1,text:""},{size:600,selected:!1,text:""},{size:400,selected:!1,text:""},{size:200,selected:!1,text:""},{size:100,selected:!1,text:""}].map(t=>(t.size&&(t.text="".concat(t.size,"px")),t));var pe=s(4887);function ue(t,l){if(1&t){const o=e.EpF();e.TgZ(0,"li")(1,"app-upload-menu-button",2),e.NdJ("clickEvent",function(i){e.CHM(o);const a=e.oxw();return e.KtG(a.selectDimension(i))}),e.qZA()()}if(2&t){const o=l.$implicit;e.xp6(),e.Q6J("selected",o.selected)("text",o.text)("value",o.size)}}const me=()=>["fst-italic","p-2"];let _e=(()=>{var t;class l{constructor(){this.uploaderService=(0,e.f3M)(pe.q),this.backEvent=new e.vpe,this.dimensions=(0,e.tdS)(ce)}selectDimension(n){const i=this.dimensions();for(const d of i)d.selected=d.size===n;this.dimensions.set(i);const a=this.uploaderService.uploaderOptions;n?(a.compress=!0,a.imageDimensions={width:n}):delete a.imageDimensions,this.uploaderService.uploaderOptions=a}}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-upload-menu-size"]],outputs:{backEvent:"backEvent"},standalone:!0,features:[e.jDz],decls:6,vars:5,consts:[[1,"list-unstyled","mb-0","d-flex","flex-wrap","small","justify-content-center"],["value","back",1,"d-block",3,"text","classes","clickEvent"],[3,"selected","text","value","clickEvent"]],template:function(n,i){1&n&&(e.TgZ(0,"ul",0),e.SjG(1,ue,2,3,"li",null,e.ikw),e.TgZ(3,"li")(4,"app-upload-menu-button",1),e.NdJ("clickEvent",function(){return i.backEvent.emit()}),e.ALo(5,"translate"),e.qZA()()()),2&n&&(e.xp6(),e.wJu(i.dimensions()),e.xp6(3),e.Q6J("text",e.lcZ(5,2,"SHARED.BACK"))("classes",e.DdM(4,me)))},dependencies:[U,r.aw,r.X$],encapsulation:2,changeDetection:0}),l})();function fe(t,l){if(1&t){const o=e.EpF();e.TgZ(0,"app-upload-menu-size",0),e.NdJ("backEvent",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.showSizeMenu.set(!1))}),e.qZA()}}function ge(t,l){if(1&t){const o=e.EpF();e.TgZ(0,"ul",1)(1,"li")(2,"a",2),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.showSizeMenu.set(!0))}),e.ALo(3,"translate"),e.qZA()(),e.TgZ(4,"li"),e._UZ(5,"a",3),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"li"),e._UZ(8,"a",3),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"li"),e._UZ(11,"a",3),e.ALo(12,"translate"),e.qZA()()}if(2&t){const o=e.oxw();e.xp6(2),e.Q6J("innerText",e.lcZ(3,7,"ROUTES.WIDGETS.UPLOAD.SIZE")),e.xp6(3),e.Q6J("href",o.fileManagerUrl(),e.LSH)("innerText",e.lcZ(6,9,"ROUTES.WIDGETS.UPLOAD.FILE_MANAGER")),e.xp6(3),e.Q6J("href",o.tosUrl(),e.LSH)("innerText",e.lcZ(9,11,"SHARED.TOS")),e.xp6(3),e.Q6J("href",o.privacyUrl(),e.LSH)("innerText",e.lcZ(12,13,"SHARED.PRIVACY_POLICY"))}}let ve=(()=>{var t;class l{constructor(){this.fileManagerUrl=e.qHZ.required(),this.showSizeMenu=(0,e.tdS)(!1),this.tosUrl=(0,e.Flj)(()=>"".concat(this.fileManagerUrl(),"&").concat(c.RT.MODAL,"=").concat(v.u.TOS)),this.privacyUrl=(0,e.Flj)(()=>"".concat(this.fileManagerUrl(),"&").concat(c.RT.MODAL,"=").concat(v.u.PRIVACY))}}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-upload-menu-settings"]],inputs:{fileManagerUrl:[e.lbL.SignalBased,"fileManagerUrl"]},standalone:!0,features:[e.jDz],decls:2,vars:1,consts:[[3,"backEvent"],[1,"mb-0","list-unstyled","d-flex","flex-column","align-items-center","upload-settings","small"],["role","button",3,"innerText","click"],["target","_blank",3,"href","innerText"]],template:function(n,i){1&n&&e.YNc(0,fe,1,0,"app-upload-menu-size")(1,ge,13,15),2&n&&e.um2(0,i.showSizeMenu()?0:1)},dependencies:[_e,r.aw,r.X$],styles:[".upload-settings[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{max-width:100%}.upload-settings[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:.25rem}.upload-settings[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:inherit;display:block;padding:.5rem;width:160px;max-width:100%;text-align:center;transition:background-color .1s;border-radius:.25rem}.upload-settings[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#dae0ff}"],changeDetection:0}),l})();const Ce=["accordion"];function he(t,l){if(1&t&&e._UZ(0,"app-upload-menu-endpoint",14),2&t){const o=e.oxw(2);e.Q6J("fileManagerUrl",o.fileManagerUrl())}}function Te(t,l){if(1&t&&e._UZ(0,"app-upload-menu-folder",15),2&t){const o=e.oxw(2);e.Q6J("siteBaseUrl",o.fileManagerUrl())}}function Ue(t,l){if(1&t&&e._UZ(0,"app-upload-menu-settings",14),2&t){const o=e.oxw(2);e.Q6J("fileManagerUrl",o.fileManagerUrl())}}function Me(t,l){}function Ee(t,l){if(1&t&&e.YNc(0,he,1,1)(1,Te,1,1)(2,Ue,1,1)(3,Me,0,0),2&t){const o=e.oxw();let n;e.um2(0,(n=o.menuActive())===o.menuTypes.ENDPOINT?0:n===o.menuTypes.FOLDER?1:n===o.menuTypes.SETTING?2:3)}}const Se=t=>({"touch-device":t}),E=t=>({expanded:t}),xe=t=>({"border-bottom border-top":t});let Le=(()=>{var t;class l{constructor(){this.destroyRef=(0,e.f3M)(e.ktI),this.uploadEndpointsService=(0,e.f3M)(g.r),this.fileManagerUrl=e.qHZ.required(),this.toggleMenuObservable=e.qHZ.required(),this.folderChange=new e.vpe,this.touchDevice=m.b1,this.accordionId="upload-accordion-item",this.menuTypes=M,this.menuActive=(0,e.tdS)(void 0)}ngOnInit(){this.toggleMenuObservable().pipe((0,u.sL)(this.destroyRef)).subscribe(n=>this.toggleCollapse(n))}toggleCollapse(n){if(this.accordionRef){if(!n||this.accordionRef.isExpanded(this.accordionId)&&this.menuActive()===n)return void this.accordionRef.collapse(this.accordionId);this.menuActive.set(n),this.accordionRef.isExpanded(this.accordionId)||this.accordionRef.expand(this.accordionId)}}}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-upload-menu"]],viewQuery:function(n,i){if(1&n&&e.Gf(Ce,5),2&n){let a;e.iGM(a=e.CRH())&&(i.accordionRef=a.first)}},inputs:{fileManagerUrl:[e.lbL.SignalBased,"fileManagerUrl"],toggleMenuObservable:[e.lbL.SignalBased,"toggleMenuObservable"]},outputs:{folderChange:"folderChange"},standalone:!0,features:[e.jDz],decls:22,vars:29,consts:[[1,"upload-menu","d-flex","align-items-stretch","justify-content-center","overflow-hidden","small",3,"ngClass"],[1,"upload-menu-btn","min-w-0",3,"ngClass","click"],[3,"innerText"],[1,"d-none","d-sm-block"],[1,"d-none","d-sm-block","ms-1","text-truncate",3,"innerText"],[1,"upload-menu-btn","border-start","border-end",3,"ngClass","click"],[1,"long"],[1,"short"],[1,"upload-menu-btn",3,"ngClass","innerText","click"],["ngbAccordion","",1,"upload-menu-content","position-absolute","w-100","bg-white",3,"ngClass"],["accordion","ngbAccordion"],[3,"ngbAccordionItem","hidden"],["ngbAccordionCollapse",""],["ngbAccordionBody","",1,"px-2","py-1"],[3,"fileManagerUrl"],[3,"siteBaseUrl"]],template:function(n,i){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return i.toggleCollapse(i.menuTypes.ENDPOINT)}),e._UZ(2,"div",2),e.ALo(3,"translate"),e.TgZ(4,"div",3),e._uU(5,":"),e.qZA(),e._UZ(6,"div",4),e.qZA(),e.TgZ(7,"div",5),e.NdJ("click",function(){return i.toggleCollapse(i.menuTypes.FOLDER)}),e.TgZ(8,"span",6),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"span",7),e._uU(12),e.ALo(13,"translate"),e.qZA()(),e.TgZ(14,"div",8),e.NdJ("click",function(){return i.toggleCollapse(i.menuTypes.SETTING)}),e.ALo(15,"translate"),e.qZA()(),e.TgZ(16,"div",9,10)(18,"div",11),e.NdJ("hidden",function(){return i.menuActive.set(void 0)}),e.TgZ(19,"div",12)(20,"div",13),e.YNc(21,Ee,4,1,"ng-template"),e.qZA()()()()),2&n){let a;e.Q6J("ngClass",e.VKq(19,Se,i.touchDevice)),e.xp6(),e.Q6J("ngClass",e.VKq(21,E,i.menuActive()===i.menuTypes.ENDPOINT)),e.xp6(),e.Q6J("innerText",e.lcZ(3,11,"SHARED.SERVER")),e.xp6(4),e.Q6J("innerText",null==(a=i.uploadEndpointsService.activeRemote())?null:a.name),e.xp6(),e.Q6J("ngClass",e.VKq(23,E,i.menuActive()===i.menuTypes.FOLDER)),e.xp6(2),e.Oqu(e.lcZ(10,13,"ROUTES.WIDGETS.UPLOAD.SELECT_FOLDER.LONG")),e.xp6(3),e.Oqu(e.lcZ(13,15,"ROUTES.WIDGETS.UPLOAD.SELECT_FOLDER.SHORT")),e.xp6(2),e.Q6J("ngClass",e.VKq(25,E,i.menuActive()===i.menuTypes.SETTING))("innerText",e.lcZ(15,17,"SHARED.SETTINGS")),e.xp6(2),e.Q6J("ngClass",e.VKq(27,xe,void 0!==i.menuActive())),e.xp6(2),e.Q6J("ngbAccordionItem",i.accordionId)}},dependencies:[r.aw,r.X$,h.mk,_.Gs,_.QQ,_.VE,_.fA,_.ud,V,de,ve],styles:[".long[_ngcontent-%COMP%]{display:none}.upload-menu[_ngcontent-%COMP%]{height:40px;margin-bottom:10px}.upload-menu[_ngcontent-%COMP%]:not(.touch-device)   .upload-menu-btn[_ngcontent-%COMP%]:hover{color:inherit}.upload-menu-btn[_ngcontent-%COMP%]{flex:1 1 0;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:color .2s;color:var(--bs-gray-600);padding:0 1rem}.upload-menu-btn.expanded[_ngcontent-%COMP%]{background:#fff;z-index:2;color:inherit}.upload-menu-content[_ngcontent-%COMP%]{top:39px;left:0;z-index:1;max-height:calc(100% - 50px);overflow-y:auto;--bs-accordion-border-color: transparent;--bs-accordion-border-width: 0}@media (min-width: 450px){.short[_ngcontent-%COMP%]{display:none}.long[_ngcontent-%COMP%]{display:inline}}"],changeDetection:0}),l})();var Oe=s(469),Re=s(1745),Ae=s(1410),be=s(2986),Ze=s(2740),De=s(554);const R=t=>({name:t});function ye(t,l){if(1&t&&(e._UZ(0,"p",6),e.ALo(1,"translate")),2&t){const o=e.oxw();e.Q6J("innerHTML",e.xi3(1,1,"ROUTES.WIDGETS.UPLOAD.REMOTE_SUGGESTION.CONFIRM",e.VKq(4,R,o.remote().name)),e.oJD)}}function Fe(t,l){if(1&t&&(e._UZ(0,"p",6),e.ALo(1,"translate")),2&t){const o=e.oxw();e.Q6J("innerHTML",e.xi3(1,1,"ROUTES.WIDGETS.UPLOAD.REMOTE_SUGGESTION.EXISTING_CONFIRM",e.VKq(4,R,o.remote().name)),e.oJD)}}const Pe=()=>["text-primary"],Ie=(t,l,o,n)=>({endpointName:t,profileUrl:l,email:o,readMoreUrl:n});let Je=(()=>{var t;class l{constructor(){this.remote=e.qHZ.required(),this.siteBaseUrl=e.qHZ.required(),this.isRemoteInList=e.qHZ.required(),this.acceptRemote=new e.vpe,this.declineRemote=new e.vpe,this.isAppEmbedded=m.II,this.siteUrl=(0,e.Flj)(()=>this.siteBaseUrl()+"&".concat(c.RT.UPLOAD_REMOTE,"=").concat(this.remote().id))}}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-upload-endpoint-confirm"]],inputs:{remote:[e.lbL.SignalBased,"remote"],siteBaseUrl:[e.lbL.SignalBased,"siteBaseUrl"],isRemoteInList:[e.lbL.SignalBased,"isRemoteInList"]},outputs:{acceptRemote:"acceptRemote",declineRemote:"declineRemote"},standalone:!0,features:[e.jDz],decls:12,vars:21,consts:[[1,"px-3","py-2","advice"],["svgSize","xl",3,"svgClass","svgResponsive"],[1,"text-justify","mt-2","mt-sm-3",3,"innerHTML"],["class","text-center",3,"innerHTML"],[1,"text-center"],[1,"btn","btn-primary","mx-2",3,"innerText","click"],[1,"text-center",3,"innerHTML"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"app-logo",1)(2,"p",2),e.ALo(3,"translate"),e.ALo(4,"ffuidToLink"),e.YNc(5,ye,2,6,"p",3)(6,Fe,2,6),e.TgZ(7,"div",4)(8,"button",5),e.NdJ("click",function(){return i.acceptRemote.emit(i.remote().id)}),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",5),e.NdJ("click",function(){return i.declineRemote.emit()}),e.ALo(11,"translate"),e.qZA()()()),2&n&&(e.xp6(),e.Q6J("svgClass",e.DdM(15,Pe))("svgResponsive",!0),e.xp6(),e.Q6J("innerHTML",e.xi3(3,6,"ROUTES.WIDGETS.UPLOAD.REMOTE_SUGGESTION.MESSAGE",e.l5B(16,Ie,i.remote().name,e.lcZ(4,9,i.remote().owner),"mailto:"+i.remote().email,i.siteUrl())),e.oJD),e.xp6(3),e.um2(5,i.isRemoteInList?6:5),e.xp6(3),e.Q6J("innerText",e.lcZ(9,11,"SHARED.YES")),e.xp6(2),e.Q6J("innerText",e.lcZ(11,13,"SHARED.NO")))},dependencies:[Ze.h,De.R,O.H,r.aw,r.X$],styles:[".btn[_ngcontent-%COMP%]{width:47px}.advice[_ngcontent-%COMP%]{font-size:.875em}app-logo[_ngcontent-%COMP%]{display:none}@media (min-width: 340px){app-logo[_ngcontent-%COMP%]{display:block}}@media (min-width: 768px){.advice[_ngcontent-%COMP%]{font-size:unset}}"],changeDetection:0}),l})();var Ne=s(5851),ke=s(4733);function we(t,l){if(1&t){const o=e.EpF();e.TgZ(0,"app-upload-endpoint-confirm",2),e.NdJ("acceptRemote",function(i){e.CHM(o);const a=e.oxw(2);return e.KtG(a.setSuggestedRemote(i))})("declineRemote",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.refuseSuggestedRemote())}),e.qZA()}if(2&t){const o=e.oxw(2);e.Q6J("remote",l)("isRemoteInList",o.isRemoteToConfirmInList())("siteBaseUrl",o.fileManagerUrl)}}function He(t,l){if(1&t&&e._UZ(0,"app-upload-no-storage-advice",5),2&t){const o=e.oxw(3);e.Q6J("storageToFree",l)("compact",!0)("adviceUrl",o.fileManagerUrl)}}const Ge=t=>({name:t});function Qe(t,l){if(1&t){const o=e.EpF();e.TgZ(0,"div",7),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.openEndpointMenu())}),e.ALo(1,"translate"),e.qZA()}if(2&t){const o=e.oxw(3);let n;e.Q6J("innerHTML",e.xi3(1,1,"ROUTES.WIDGETS.UPLOAD.REMOTE_ADVICE",e.VKq(4,Ge,null==(n=o.uploadEndpointsService.activeRemote())?null:n.name)),e.oJD)}}function je(t,l){if(1&t){const o=e.EpF();e._UZ(0,"app-upload-menu",3),e.TgZ(1,"app-uploader",4),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.toggleMenuSubject.next(void 0))}),e.qZA(),e.YNc(2,He,1,3,"app-upload-no-storage-advice",5)(3,Qe,2,6,"div",6)}if(2&t){const o=e.oxw(2);let n,i,a;e.Q6J("fileManagerUrl",o.fileManagerUrl)("toggleMenuObservable",o.toggleMenuSubject),e.xp6(),e.Q6J("loading",!1)("isWidget",!0)("currentFolderPath",o.currentFolderPath())("disabled",(null==(n=o.userStorage())?null:n.exceeded)||!1)("disabledLoading",o.loading()),e.xp6(),e.um2(2,(i=o.userStorageToFree())?2:-1,i),e.xp6(),e.um2(3,!o.uploadEndpointsService.activeRemote()||null!=(a=o.uploadEndpointsService.activeRemote())&&a.default?-1:3)}}function ze(t,l){if(1&t&&e.YNc(0,we,1,3,"app-upload-endpoint-confirm",1)(1,je,4,9),2&t){const o=e.oxw();let n;e.um2(0,(n=o.remoteToConfirm())?0:1,n)}}const Be=t=>({loading:t});let qe=(()=>{var t;class l{constructor(){var n;this.uploadEndpointsService=(0,e.f3M)(g.r),this.loadingBarService=(0,e.f3M)(A.dL),this.uploadService=(0,e.f3M)(T.C),this.uploadObservablesService=(0,e.f3M)(L.r),this.destroyRef=(0,e.f3M)(e.ktI),this.postMessageService=(0,e.f3M)(D.F),this.globalsService=(0,e.f3M)(Ae.d),this.urlQueryParamsService=(0,e.f3M)(be.J),this.render=(0,e.tdS)(!1),this.loading=(0,e.tdS)(!1),this.remoteToConfirm=(0,e.tdS)(void 0),this.isRemoteToConfirmInList=(0,e.tdS)(!1),this.isUploading=(0,u.O4)(this.uploadObservablesService.uploadingFileQueueObservable.pipe((0,y.U)(i=>i.length>0)),{initialValue:!1}),this.currentFolderPath=(0,e.tdS)(this.uploadService.preferences.lastFolderPath),this.userStorage=(0,e.tdS)(void 0),this.userStorageToFree=(0,e.Flj)(()=>{const i=this.userStorage();return i&&i.exceeded?i.used-i.max:0}),this.fileManagerUrl="".concat(Re.y1).concat(c.B2.UPLOAD,"?")+"".concat(c.RT.PROFILE,"=").concat(null===(n=this.globalsService.credentials)||void 0===n?void 0:n.site.short),this.toggleMenuSubject=new F.x,this.loadingCounter=0,m.II&&this.loadingBarService.useRef("http").disable()}ngOnInit(){var n=this;return(0,p.Z)(function*(){n.uploadService.setGqlIdHeader();const i=n.urlQueryParamsService.getAndDeleteParam(c.RT.UPLOAD_REMOTE),a=n.urlQueryParamsService.getAndDeleteParam(c.RT.UPLOAD_REMOTE_SUGGESTED);let d;const C=yield n.uploadEndpointsService.setRemoteList(i,{size:{}});C.activeRemoteChangedId&&(m.II?C.activeRemoteChangedId!==i&&n.folderPathChangeCallback([]):n.folderPathChangeCallback([])),a&&(d=n.uploadEndpointsService.remotesList().linked.find(S=>S.id===a),d?n.isRemoteToConfirmInList.set(!0):d=yield n.uploadEndpointsService.getRemoteInfo(a)),d&&!d.deleted?n.remoteToConfirm.set(d):(yield n.setUserStorage(),n.sendActiveRemoteToParentWindow()),n.subscribe(),n.postMessageService.send(f.l.UPLOAD_READY),n.render.set(!0)})()}setUserStorage(){var n=this;return(0,p.Z)(function*(){n.setLoading(!0),n.userStorage.set(yield n.uploadService.getUserStorage()),n.setLoading(!1)})()}subscribe(){var n=this;this.uploadObservablesService.uploadingFileErrorObservable.pipe((0,u.sL)(this.destroyRef)).subscribe(i=>{this.postMessageService.send(f.l.UPLOAD_ERROR,{filename:i.file.name,error:Z.S.UPLOAD_FAILED})}),this.uploadObservablesService.currentFolderPathObservable.pipe((0,u.sL)(this.destroyRef)).subscribe(i=>this.folderPathChangeCallback(i)),this.uploadObservablesService.activeRemoteObservable.pipe((0,u.sL)(this.destroyRef),(0,P.h)(i=>!!i)).subscribe((0,p.Z)(function*(){n.uploadEndpointsService.disableActiveRemoteChange(),n.uploadObservablesService.pushCurrentFolderPath([]),yield n.setUserStorage(),n.uploadEndpointsService.enableActiveRemoteChange(),n.sendActiveRemoteToParentWindow()}))}folderPathChangeCallback(n){this.currentFolderPath.set(n),this.postMessageService.send(f.l.UPLOAD_NAVIGATION,{paths:n}),this.uploadService.preferences.lastFolderPath=[...n]}openEndpointMenu(){this.toggleMenuSubject.next(M.ENDPOINT)}setSuggestedRemote(n){var i=this;return(0,p.Z)(function*(){i.setLoading(!0),i.uploadEndpointsService.disableActiveRemoteChange(),i.remoteToConfirm.set(void 0);const a=!!i.isRemoteToConfirmInList()||(yield i.uploadEndpointsService.linkRemote(n));i.uploadEndpointsService.enableActiveRemoteChange(),a&&i.uploadEndpointsService.setActiveRemote(n),i.setLoading(!1)})()}refuseSuggestedRemote(){var n=this;return(0,p.Z)(function*(){n.remoteToConfirm.set(void 0),yield n.setUserStorage(),n.sendActiveRemoteToParentWindow()})()}setLoading(n){if(n)return++this.loadingCounter,void this.loading.set(!0);--this.loadingCounter,this.loadingCounter<=0&&this.loading.set(!1)}sendActiveRemoteToParentWindow(){this.postMessageService.send(f.l.UPLOAD_REMOTE,{id:this.uploadEndpointsService.activeRemoteId()})}}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["ng-component"]],standalone:!0,features:[e.jDz],decls:2,vars:4,consts:[[1,"d-flex","flex-column","flex-grow-1","position-relative","mw-100",3,"ngClass"],["class","d-flex flex-grow-1 flex-column justify-content-center align-items-center",3,"remote","isRemoteInList","siteBaseUrl"],[1,"d-flex","flex-grow-1","flex-column","justify-content-center","align-items-center",3,"remote","isRemoteInList","siteBaseUrl","acceptRemote","declineRemote"],[3,"fileManagerUrl","toggleMenuObservable"],[1,"d-flex","flex-grow-1",3,"loading","isWidget","currentFolderPath","disabled","disabledLoading","click"],[3,"storageToFree","compact","adviceUrl"],["class","alert alert-primary mb-0 small rounded-0 border-0 py-1 text-center cursor-pointer",3,"innerHTML"],[1,"alert","alert-primary","mb-0","small","rounded-0","border-0","py-1","text-center","cursor-pointer",3,"innerHTML","click"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0),e.YNc(1,ze,2,1),e.qZA()),2&n&&(e.Q6J("ngClass",e.VKq(2,Be,i.isUploading()||i.loading())),e.xp6(),e.um2(1,i.render()?1:-1))},dependencies:[b.M,Ne.B,h.mk,Le,Oe.n,ke.P,Je,r.aw,r.X$],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;background:#fff;flex-grow:1}.loading[_ngcontent-%COMP%], .loading[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{pointer-events:none!important}"],changeDetection:0}),l})()}}]);