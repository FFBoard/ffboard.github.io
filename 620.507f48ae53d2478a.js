(self.webpackChunkboard=self.webpackChunkboard||[]).push([[620],{9969:(q,F,t)=>{"use strict";t.d(F,{R:()=>h});class h{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(e){Object.keys(e).filter(y=>y in this).forEach(y=>this[y]=e[y]),this.validateOptions()}setOptionsFromChanges(e){Object.keys(e).filter(y=>y in this).forEach(y=>this[y]=e[y].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}},2020:(q,F,t)=>{"use strict";t.d(F,{y:()=>i});var h=t(5861);var A=t(4650);let i=(()=>{class l{constructor(){this.autoRotateSupported=function e(){return new Promise(l=>{const d=new Image;d.onload=()=>{l(1===d.width&&2===d.height)},d.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(r,v){return new Promise((p,O)=>{const T=new FileReader;T.onload=L=>{this.loadImage(L.target.result,r.type,v).then(p).catch(O)},T.readAsDataURL(r)})}loadImage(r,v,p){return this.isValidImageType(v)?this.loadBase64Image(r,p):Promise.reject(new Error("Invalid image type"))}isValidImageType(r){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(r)}loadImageFromURL(r,v){return new Promise((p,O)=>{const T=new Image;T.onerror=()=>O,T.onload=()=>{const L=document.createElement("canvas"),N=L.getContext("2d");L.width=T.width,L.height=T.height,N?.drawImage(T,0,0),this.loadBase64Image(L.toDataURL(),v).then(p)},T.crossOrigin="anonymous",T.src=r})}loadBase64Image(r,v){return new Promise((p,O)=>{const T=new Image;T.onload=()=>p({originalImage:T,originalBase64:r}),T.onerror=O,T.src=r}).then(p=>this.transformImageBase64(p,v))}transformImageBase64(r,v){var p=this;return(0,h.Z)(function*(){const O=yield p.autoRotateSupported,T=yield function y(l){switch("string"==typeof l&&(l=function C(l){const d=new DataView(function _(l){l=l.replace(/^data\:([^\;]+)\;base64,/gim,"");const d=atob(l),r=d.length,v=new Uint8Array(r);for(let p=0;p<r;p++)v[p]=d.charCodeAt(p);return v.buffer}(l));if(65496!==d.getUint16(0,!1))return-2;const r=d.byteLength;let v=2;for(;v<r;){if(d.getUint16(v+2,!1)<=8)return-1;const p=d.getUint16(v,!1);if(v+=2,65505==p){if(1165519206!==d.getUint32(v+=2,!1))return-1;const O=18761==d.getUint16(v+=6,!1);v+=d.getUint32(v+4,O);const T=d.getUint16(v,O);v+=2;for(let L=0;L<T;L++)if(274==d.getUint16(v+12*L,O))return d.getUint16(v+12*L+8,O)}else{if(65280!=(65280&p))break;v+=d.getUint16(v,!1)}}return-1}(l)),l){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(O?-1:r.originalBase64);return r.originalImage&&r.originalImage.complete?p.transformLoadedImage({original:{base64:r.originalBase64,image:r.originalImage,size:{width:r.originalImage.naturalWidth,height:r.originalImage.naturalHeight}},exifTransform:T},v):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(r,v){var p=this;return(0,h.Z)(function*(){const O=v.canvasRotation+r.exifTransform.rotate,T={width:r.original.image.naturalWidth,height:r.original.image.naturalHeight};if(0===O&&!r.exifTransform.flip&&!v.containWithinAspectRatio)return{original:{base64:r.original.base64,image:r.original.image,size:{...T}},transformed:{base64:r.original.base64,image:r.original.image,size:{...T}},exifTransform:r.exifTransform};const L=p.getTransformedSize(T,r.exifTransform,v),N=document.createElement("canvas");N.width=L.width,N.height=L.height;const E=N.getContext("2d");E?.setTransform(r.exifTransform.flip?-1:1,0,0,1,N.width/2,N.height/2),E?.rotate(Math.PI*(O/2)),E?.drawImage(r.original.image,-T.width/2,-T.height/2);const a=N.toDataURL(),u=yield p.loadImageFromBase64(a);return{original:{base64:r.original.base64,image:r.original.image,size:{...T}},transformed:{base64:a,image:u,size:{width:u.width,height:u.height}},exifTransform:r.exifTransform}})()}loadImageFromBase64(r){return new Promise((v,p)=>{const O=new Image;O.onload=()=>v(O),O.onerror=p,O.src=r})}getTransformedSize(r,v,p){const O=p.canvasRotation+v.rotate;if(p.containWithinAspectRatio){if(O%2){const L=r.height/p.aspectRatio;return{width:Math.max(r.height,r.width*p.aspectRatio),height:Math.max(r.width,L)}}{const L=r.width/p.aspectRatio;return{width:Math.max(r.width,r.height*p.aspectRatio),height:Math.max(r.height,L)}}}return O%2?{height:r.width,width:r.height}:{width:r.width,height:r.height}}}return l.\u0275fac=function(r){return new(r||l)},l.\u0275prov=A.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},8896:(q,F,t)=>{"use strict";function h(M){const e=M.split(","),y=e[0].replace("data:","").replace(";base64",""),C=atob(e[1]),_=new ArrayBuffer(C.length),A=new Uint8Array(_);for(let i=0;i<C.length;i+=1)A[i]=C.charCodeAt(i);return new Blob([_],{type:y})}t.d(F,{L:()=>h})},1891:(q,F,t)=>{"use strict";t.d(F,{B:()=>R});var h=t(5861),M=t(1309),e=t(4650),y=t(8896),C=t(3905),_=t(4968),A=t(3848),i=t(1460),l=t(4323),d=t(6986),r=t(575),v=t(7693),p=t(3207),O=t(146),T=t(3612),L=t(6378),N=t(9383),E=t(6895),a=t(4006),u=t(4029),P=t(8279),x=t(3450),U=t(8212);const I=["fileInput"];function W(m,w){1&m&&(e.O4$(),e.TgZ(0,"svg",30),e._UZ(1,"path",31)(2,"path",32),e.qZA())}const Q=function(){return["text-primary"]};function $(m,w){1&m&&e._UZ(0,"app-logo",33),2&m&&e.Q6J("svgClass",e.DdM(2,Q))("responsive",!1)}function oe(m,w){1&m&&(e._UZ(0,"span",36),e.ALo(1,"translate")),2&m&&e.Q6J("innerHTML",e.lcZ(1,1,"COMPONENTS.UPLOADER.DESCRIPTION.DESKTOP"),e.oJD)}function ee(m,w){1&m&&(e._UZ(0,"span",36),e.ALo(1,"translate")),2&m&&e.Q6J("innerHTML",e.lcZ(1,1,"COMPONENTS.UPLOADER.DESCRIPTION.TOUCH"),e.oJD)}const ne=function(m){return{"fw-bold fs-md-lg":m}};function se(m,w){if(1&m&&(e.TgZ(0,"div",34),e.YNc(1,oe,2,3,"span",35),e.YNc(2,ee,2,3,"span",35),e.qZA()),2&m){const n=e.oxw(2);e.Q6J("ngClass",e.VKq(3,ne,!n.isWidget)),e.xp6(1),e.Q6J("ngIf",!n.touchDevice),e.xp6(1),e.Q6J("ngIf",n.touchDevice)}}function he(m,w){1&m&&e.GkF(0)}function b(m,w){if(1&m){const n=e.EpF();e.TgZ(0,"div",37),e.YNc(1,he,1,0,"ng-container",16),e.TgZ(2,"button",38),e.NdJ("click",function(o){e.CHM(n);const B=e.oxw(2);return e.KtG(B.handleRemoteUrlUpload(o))}),e.TgZ(3,"span",39),e._uU(4,"check"),e.qZA()(),e.TgZ(5,"button",40),e.NdJ("click",function(o){e.CHM(n);const B=e.oxw(2);return e.KtG(B.toggleRemoteUrlForm(o))}),e.TgZ(6,"span",39),e._uU(7,"clear"),e.qZA()()()}if(2&m){const n=e.oxw(2),f=e.MAs(34);e.xp6(1),e.Q6J("ngTemplateOutlet",f),e.xp6(1),e.Q6J("disabled",0===n.remoteUrl.length||!n.isRemoteUrlValid)}}function s(m,w){if(1&m&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"em",41),e.ALo(5,"arrayJoin"),e.BQk()),2&m){const n=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"COMPONENTS.UPLOADER.PATH.LONG")," "),e.xp6(2),e.Q6J("innerText",n.currentFolderPath.length?e.xi3(5,4,n.currentFolderPath,"/"):"root")}}function c(m,w){if(1&m&&(e._UZ(0,"div",46),e.ALo(1,"arrayJoin"),e.ALo(2,"slice")),2&m){const n=e.oxw(3);e.Q6J("innerText",e.xi3(1,1,e.Dn7(2,4,n.currentFolderPath,0,-1),"/"))}}function g(m,w){if(1&m&&(e.TgZ(0,"div",42)(1,"div",43),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,c,3,8,"div",44),e._UZ(5,"div",45),e.ALo(6,"arrayJoin"),e.ALo(7,"slice"),e.qZA()),2&m){const n=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,3,"COMPONENTS.UPLOADER.PATH.SHORT")),e.xp6(2),e.Q6J("ngIf",n.currentFolderPath.length>1),e.xp6(1),e.Q6J("innerText",(n.currentFolderPath.length>1?"/":"")+(n.currentFolderPath.length?e.xi3(6,5,e.xi3(7,8,n.currentFolderPath,n.currentFolderPath.length-1),"/"):"root"))}}const S=function(){return{bottom:0,left:0}};function D(m,w){if(1&m){const n=e.EpF();e.ynx(0),e.TgZ(1,"a",47),e.NdJ("click",function(){e.CHM(n);const o=e.oxw(2);return e.KtG(o.openInfoModal.emit())}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",48),e.NdJ("click",function(){e.CHM(n),e.oxw(2);const o=e.MAs(7);return e.KtG(o.open())}),e._uU(5,"settings"),e.qZA(),e.BQk()}2&m&&(e.xp6(1),e.Q6J("ngStyle",e.DdM(4,S)),e.xp6(1),e.Oqu(e.lcZ(3,2,"COMPONENTS.UPLOADER.INFO")))}const K=function(m,w,n){return{"cursor-pointer":m,"py-4 px-3 px-sm-4":w,"p-2 pb-3":n}},k=function(m,w,n){return{"my-2":m,"mb-2":w,"mw-100 mt-1":n}};function j(m,w){if(1&m){const n=e.EpF();e.ynx(0),e.TgZ(1,"div",21,22),e.NdJ("dragenter",function(){e.CHM(n);const o=e.MAs(2),B=e.oxw();return e.KtG(B.setDragOverEvent(o))})("drop",function(o){e.CHM(n);const B=e.oxw();return e.KtG(B.handleDropEvent(o))})("click",function(){e.CHM(n);const o=e.oxw(),B=e.MAs(2);return e.KtG(!o.isWaitingRemoteUrl&&B.click())}),e.YNc(3,W,3,0,"svg",23),e.YNc(4,$,1,3,"ng-template",null,24,e.W1O),e.YNc(6,se,3,5,"div",25),e.YNc(7,b,8,2,"div",26),e.TgZ(8,"div",27),e.YNc(9,s,6,7,"ng-container",3),e.YNc(10,g,8,11,"ng-template",null,28,e.W1O),e.qZA()(),e.YNc(12,D,6,5,"ng-container",29),e.BQk()}if(2&m){const n=e.MAs(5),f=e.MAs(11),o=e.oxw();e.xp6(1),e.Q6J("ngClass",e.kEZ(9,K,!o.loading&&!o.isWaitingRemoteUrl,!o.isWidget,o.isWidget)),e.xp6(2),e.Q6J("ngIf",!o.isWidget)("ngIfElse",n),e.xp6(3),e.Q6J("ngIf",!o.isWidget||!o.isWaitingRemoteUrl),e.xp6(1),e.Q6J("ngIf",o.isWidget&&o.isWaitingRemoteUrl),e.xp6(1),e.Q6J("ngClass",e.kEZ(13,k,!o.isWidget&&!o.touchDevice,!o.isWidget&&o.touchDevice,o.isWidget)),e.xp6(1),e.Q6J("ngIf",!o.isWidget)("ngIfElse",f),e.xp6(3),e.Q6J("ngIf",!o.isWidget)}}const Z=function(m,w){return{"p-4":m,"p-2":w}};function G(m,w){if(1&m&&(e.TgZ(0,"div",49),e.O4$(),e.TgZ(1,"svg",50),e._UZ(2,"path",51),e.qZA(),e.kcU(),e._UZ(3,"app-loader",52),e.TgZ(4,"div",53),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&m){const n=e.oxw();e.Q6J("ngClass",e.WLB(6,Z,!n.isWidget,n.isWidget)),e.xp6(3),e.Q6J("onlyMessage",!0)("message",n.loadingMessage),e.xp6(2),e.Oqu(e.lcZ(6,4,"COMPONENTS.UPLOADER.LOADING.SUBTEXT"))}}function V(m,w){1&m&&e.GkF(0)}function ae(m,w){if(1&m){const n=e.EpF();e.TgZ(0,"input",54,55),e.NdJ("ngModelChange",function(o){e.CHM(n);const B=e.oxw();return e.KtG(B.remoteUrl=o)})("ngModelChange",function(){e.CHM(n);const o=e.MAs(1),B=e.oxw();return e.KtG(B.isRemoteUrlValid=!o.invalid)}),e.ALo(2,"translate"),e.qZA()}if(2&m){const n=e.oxw();e.Q6J("placeholder",e.lcZ(2,3,"COMPONENTS.UPLOADER.REMOTE_URL_INPUT_PLACEHOLDER"))("ngModel",n.remoteUrl)("pattern","^https?://[^.]+\\.(.+)")}}const ie=function(m,w){return{uploading:m,"widget flex-grow-1 min-w-0":w}};let R=(()=>{class m{constructor(n,f,o,B,H,Y,re,z){this.postMessageService=n,this.uploadService=f,this.uploadObservablesService=o,this.uploaderService=B,this.toastService=H,this.renderer=Y,this.ngZone=re,this.translateService=z,this.loading=!0,this.currentFolderPath=[],this.isWidget=!1,this.fileUploadedEvent=new e.vpe,this.openInfoModal=new e.vpe,this.isUploading=!1,this.loadingMessage="",this.touchDevice=i.eX,this.isWaitingRemoteUrl=!1,this.remoteUrl="",this.isRemoteUrlValid=!1,this.dragOverEvent=!1,this.checkingFileMessage="",this.options=this.uploaderService.uploaderOptions;const X=this.uploadService.preferences.uploader;X.checkImage.active||(this.options.compress=!1),X.showLinkModal&&(this.options.openLinkModalAfterUpload=!0),this.uploaderService.uploaderOptions=this.options}ngOnInit(){var n=this;return(0,h.Z)(function*(){n.handleClipboardPasteEvent(),n.handleExternalUpload(),n.checkingFileMessage=yield(0,C.z)(n.translateService.get("COMPONENTS.UPLOADER.LOADING.MESSAGE.CHECK")),n.loadingMessage=n.checkingFileMessage})()}handleClipboardPasteEvent(){var n=this;this.clipboardPasteEventSubscription=(0,_.R)(document.body,"paste").subscribe(function(){var f=(0,h.Z)(function*(o){if(!n.canUpload)return;const B=Array.from((o.clipboardData||o.originalEvent.clipboardData).items);let H=[];for(const Y of B)if(0===Y.type.indexOf("image")){const re=Y.getAsFile();re&&H.push(re)}H.length>0?yield n.preUpload(H):n.reset()});return function(o){return f.apply(this,arguments)}}())}handleExternalUpload(){var n=this;this.startExternalUploadSubscription=this.uploadObservablesService.startUploadObservable.subscribe(function(){var f=(0,h.Z)(function*(o){if(o){if(!n.canUpload)return;yield n.preUpload([o.file],o.options)}else n.fileInputRef.nativeElement.click()});return function(o){return f.apply(this,arguments)}}())}handleSelectionEvent(n){var f=this;return(0,h.Z)(function*(){if(!f.canUpload)return;const o=n.target;if(o.files&&o.files.length){const B=Array.from(o.files);return o.value="",f.preUpload(B)}f.reset()})()}handleDropEvent(n){var f=this;return(0,h.Z)(function*(){if(n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),!f.canUpload)return;const o=n.dataTransfer?.files?Array.from(n.dataTransfer.files):[];if(o.length)return f.preUpload(o);f.reset()})()}handleRemoteUrlUpload(n){var f=this;return(0,h.Z)(function*(){if(!f.canUpload)return;const o=f.remoteUrl;f.loadingMessage=f.translateService.instant("COMPONENTS.UPLOADER.LOADING.MESSAGE.GETTING_REMOTE_FILE"),f.toggleRemoteUrlForm(n),yield new Promise(Y=>window.setTimeout(Y,3e3));const B=(0,A.Tb)(o),H=(0,y.L)("data:image/jpeg;base64,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");return f.preUpload([new File([H],B.name,{type:H.type,lastModified:Date.now()})])})()}saveOptions(n=!0){this.uploaderService.uploaderOptions=this.options,n&&this.savePreferences()}savePreferences(){this.uploadService.preferences.uploader={checkImage:{active:this.options.compress,time:Date.now()},showLinkModal:this.options.openLinkModalAfterUpload}}setDragOverEvent(n){this.dragOverEvent||(this.dragOverEvent=!0,this.ngZone.runOutsideAngular(()=>{this.renderer.listen(n,"dragover",f=>{f.preventDefault()})}))}get canUpload(){return!this.loading&&!this.isUploading&&(this.isUploading=!0,this.dragOverEvent=!1,!0)}reset(){this.isUploading=!1,this.loadingMessage=this.checkingFileMessage,this.postMessageService.send(l.l.UPLOAD_END,{}),this.options.allowOverwrite=!1,this.saveOptions(!1)}preUpload(n,f){var o=this;return(0,h.Z)(function*(){const B=[...o.currentFolderPath];let H=[],Y=[],re=[],z=[];f?f.allowOverwrite=f.allowOverwrite||!1:(f=o.uploaderService.uploaderOptions).allowOverwrite=!1;for(let J=0;J<n.length;J++){let te=f.compress?yield o.uploaderService.compressFileIfNeeded(n[J],f.imageDimensions):n[J];if(te=yield o.uploaderService.orientFileIfNeeded(te),te){const ce=(0,A.Tb)(te.name),ue=d.O8.find(pe=>-1!==pe.ext.indexOf(ce.ext));if(!ue){re.push(te.name);continue}if(te.size>ue.maxSize){z.push(te.name);continue}H.push({file:{name:te.name,size:te.size,time:0,url:"",ext:ce.ext,filename:ce.filename,isImage:(0,A.Or)(ce.ext),embedUrl:"",type:r.VC.FILE},progress:0,completed:!1}),Y.push(te)}}if((re.length||z.length)&&(o.isWidget||o.toastService.show({content:o.createToastMessage(re,z),level:M.m.ERROR}),[["UNSUPPORTED",re],["OVERSIZED",z]].forEach(J=>{J[1].forEach(te=>{o.postMessageService.send(l.l.UPLOAD_ERROR,{filename:te,error:J[0]})})})),0===Y.length)return void o.reset();const X=yield(0,C.z)(o.translateService.get("COMPONENTS.UPLOADER.LOADING.MESSAGE.UPLOADING",{total:Y.length})),de=yield(0,C.z)(o.translateService.get("COMPONENTS.UPLOADER.LOADING.MESSAGE.CREATING_PACKAGE",{total:Y.length}));o.uploadObservablesService.pushUploadingFileQueue(H);for(let J=0;J<Y.length;++J){o.loadingMessage=de;const te=yield o.uploadService.getHostToken(B,Y[J].name);H[J].progress+=20,o.loadingMessage=X.replace("{{current}}",`${J+1}`),yield(0,C.z)(o.uploaderService.upload(Y[J],H[J],te,f.allowOverwrite))}o.uploadObservablesService.pushUploadingFileQueue([]);const le=H.filter(J=>!J.error).map(J=>J.file);le.length>0&&(o.fileUploadedEvent.emit({list:le,rewrite:f.allowOverwrite,destPath:B}),o.postMessageService.send(l.l.UPLOAD_SUCCESS,{fileList:le.map(J=>({filename:J.name,isImage:J.isImage,url:J.url}))}),f.openLinkModalAfterUpload&&o.uploadObservablesService.pushAction({name:r.In.FILE_SHOW_LINKS,payload:{entities:(0,A.jL)(le)}})),o.reset()})()}createToastMessage(n,f){let o=[];return n.length&&o.push(n.length>1?`I file <strong>${n.join(", ")}</strong> hanno un formato non supportato!`:`Il file <strong>${n[0]}</strong> ha un formato non supportato!`),f.length&&o.push(f.length>1?`I file <strong>${f.join(", ")}</strong> sono troppo pesanti!`:`Il file <strong>${f[0]}</strong> \xe8 troppo pesante!`),o.join("<br><br>")}toggleRemoteUrlForm(n,f){n.stopPropagation(),this.isWidget?this.isWaitingRemoteUrl=!this.isWaitingRemoteUrl:f?.open(),this.remoteUrl=""}ngOnDestroy(){this.startExternalUploadSubscription?.unsubscribe(),this.clipboardPasteEventSubscription.unsubscribe(),this.uploaderService.clearPendingRequests()}}return m.\u0275fac=function(n){return new(n||m)(e.Y36(v.F),e.Y36(p.C),e.Y36(O.r),e.Y36(T.q),e.Y36(L.k),e.Y36(e.Qsj),e.Y36(e.R0b),e.Y36(N.sK))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-uploader"]],viewQuery:function(n,f){if(1&n&&e.Gf(I,5),2&n){let o;e.iGM(o=e.CRH())&&(f.fileInputRef=o.first)}},inputs:{loading:"loading",currentFolderPath:"currentFolderPath",isWidget:"isWidget"},outputs:{fileUploadedEvent:"fileUploadedEvent",openInfoModal:"openInfoModal"},decls:35,vars:37,consts:[[1,"uploader","rounded","position-relative",3,"ngClass"],["type","file",1,"d-none",3,"multiple","disabled","change"],["fileInput",""],[4,"ngIf","ngIfElse"],["uploading",""],[3,"title"],["optionsModal",""],[3,"innerHtml"],[1,"mb-1","list-unstyled"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","speed-upload",1,"form-check-input",3,"ngModel","ngModelChange"],["for","speed-upload",1,"form-check-label","me-auto",3,"innerHTML"],["type","checkbox","role","switch","id","show-link-modal",1,"form-check-input",3,"ngModel","ngModelChange"],["for","show-link-modal",1,"form-check-label","me-auto",3,"innerHTML"],["size","md",3,"title","disableCloseButton"],["remoteUrlModal",""],[4,"ngTemplateOutlet"],["footer",""],["type","button",1,"btn","btn-secondary",3,"innerText","click"],["type","button",1,"btn","btn-primary",3,"disabled","innerText","click"],["remoteUrlInput",""],[1,"rounded","upload-area",3,"ngClass","dragenter","drop","click"],["uploadArea",""],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16",4,"ngIf","ngIfElse"],["appLogo",""],["class","description text-center",3,"ngClass",4,"ngIf"],["class","input-group input-group-sm remote-url-form justify-content-center mb-1",4,"ngIf"],[1,"small","text-center",3,"ngClass"],["widgetFolder",""],[4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16"],["fill-rule","evenodd","d","M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"],["d","M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"],["svgSize","xl","subtext","Upload",1,"d-block","my-auto","py-1",3,"svgClass","responsive"],[1,"description","text-center",3,"ngClass"],[3,"innerHTML",4,"ngIf"],[3,"innerHTML"],[1,"input-group","input-group-sm","remote-url-form","justify-content-center","mb-1"],[1,"input-group-text","bg-light",3,"disabled","click"],[1,"material-icons-outlined","icon-small"],[1,"input-group-text","bg-light",3,"click"],[1,"text-break",3,"innerText"],[1,"d-flex","min-w-0"],[1,"me-1"],["class","fst-italic text-truncate mw-100",3,"innerText",4,"ngIf"],[1,"fst-italic","text-nowrap",3,"innerText"],[1,"fst-italic","text-truncate","mw-100",3,"innerText"],[1,"fs-xs","fst-italic","d-block","px-2","py-1","text-reset","cursor-pointer","position-absolute",3,"ngStyle","click"],[1,"material-icons-outlined","d-block","cursor-pointer","fs-xl","position-absolute","icon","options-icon",3,"click"],[1,"p-4","rounded",3,"ngClass"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","viewBox","0 0 16 16",1,"overflow-visible"],["d","M 4.406 3.342 A 5.53 5.53 0 0 1 8 2 c 2.69 0 4.923 2 5.166 4.579 C 14.758 6.804 16 8.137 16 9.773 C 16 11.569 14.502 13 12.687 13 H 3.781 C 1.708 13 0 11.366 0 9.318 c 0 -1.763 1.266 -3.223 2.942 -3.593 c 0.143 -0.863 0.698 -1.723 1.464 -2.383 z",1,"cloud"],[3,"onlyMessage","message"],[1,"small","text-center"],["type","text","required","",1,"form-control",3,"placeholder","ngModel","pattern","ngModelChange"],["input","ngModel"]],template:function(n,f){if(1&n){const o=e.EpF();e.TgZ(0,"div",0)(1,"input",1,2),e.NdJ("change",function(H){return f.handleSelectionEvent(H)}),e.qZA(),e.YNc(3,j,13,17,"ng-container",3),e.YNc(4,G,7,9,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(6,"app-modal",5,6),e.ALo(8,"translate"),e._UZ(9,"div",7),e.ALo(10,"translate"),e.TgZ(11,"ul",8)(12,"li")(13,"div",9)(14,"input",10),e.NdJ("ngModelChange",function(H){return f.options.compress=H})("ngModelChange",function(){return f.saveOptions()}),e.qZA(),e._UZ(15,"label",11),e.ALo(16,"translate"),e.qZA()(),e.TgZ(17,"li")(18,"div",9)(19,"input",12),e.NdJ("ngModelChange",function(H){return f.options.openLinkModalAfterUpload=H})("ngModelChange",function(){return f.saveOptions()}),e.qZA(),e._UZ(20,"label",13),e.ALo(21,"translate"),e.qZA()()()(),e.TgZ(22,"app-modal",14,15),e.ALo(24,"translate"),e._UZ(25,"div",7),e.ALo(26,"translate"),e.YNc(27,V,1,0,"ng-container",16),e.ynx(28,17),e.TgZ(29,"button",18),e.NdJ("click",function(){e.CHM(o);const H=e.MAs(23);return e.KtG(H.close("Close click"))}),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"button",19),e.NdJ("click",function(H){return e.CHM(o),e.MAs(23).close("Upload click"),e.KtG(f.handleRemoteUrlUpload(H))}),e.ALo(32,"translate"),e.qZA(),e.BQk(),e.qZA(),e.YNc(33,ae,3,5,"ng-template",null,20,e.W1O)}if(2&n){const o=e.MAs(5),B=e.MAs(34);e.Q6J("ngClass",e.WLB(34,ie,f.isUploading,f.isWidget)),e.xp6(1),e.Q6J("multiple",!0)("disabled",f.loading||f.isUploading),e.xp6(2),e.Q6J("ngIf",!f.isUploading)("ngIfElse",o),e.xp6(3),e.Q6J("title",e.lcZ(8,18,"COMPONENTS.UPLOADER.SETTINGS_MODAL.TITLE")),e.xp6(3),e.Q6J("innerHtml",e.lcZ(10,20,"COMPONENTS.UPLOADER.SETTINGS_MODAL.CONTENT.DESCRIPTION"),e.oJD),e.xp6(5),e.Q6J("ngModel",f.options.compress),e.xp6(1),e.Q6J("innerHTML",e.lcZ(16,22,"COMPONENTS.UPLOADER.SETTINGS_MODAL.CONTENT.COMPRESS_SWITCH"),e.oJD),e.xp6(4),e.Q6J("ngModel",f.options.openLinkModalAfterUpload),e.xp6(1),e.Q6J("innerHTML",e.lcZ(21,24,"COMPONENTS.UPLOADER.SETTINGS_MODAL.CONTENT.SHOW_LINK_SWITCH"),e.oJD),e.xp6(2),e.Q6J("title",e.lcZ(24,26,"COMPONENTS.UPLOADER.REMOTE_URL_MODAL.TITLE"))("disableCloseButton",!0),e.xp6(3),e.Q6J("innerHtml",e.lcZ(26,28,"COMPONENTS.UPLOADER.REMOTE_URL_MODAL.CONTENT"),e.oJD),e.xp6(2),e.Q6J("ngTemplateOutlet",B),e.xp6(2),e.Q6J("innerText",e.lcZ(30,30,"SHARED.CANCEL")),e.xp6(2),e.Q6J("disabled",0===f.remoteUrl.length||!f.isRemoteUrlValid)("innerText",e.lcZ(32,32,"COMPONENTS.UPLOADER.REMOTE_URL_MODAL.UPLOAD_BTN"))}},dependencies:[E.mk,E.O5,E.tP,E.PC,a.Fj,a.Wl,a.JJ,a.Q7,a.c5,a.On,u.R,P.R,x.z,U.J,E.OU,N.X$],styles:[".uploader[_ngcontent-%COMP%]:not(.widget){margin:0 1rem;border:2px dashed #4864FE;box-shadow:0 .125rem .25rem #00000013;color:#2036ad;height:100%}.uploader[_ngcontent-%COMP%]:not(.widget):not(.uploading)   svg[_ngcontent-%COMP%]{animation:bubble 4s linear infinite}.uploader[_ngcontent-%COMP%]:not(.widget).uploading   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{stroke:#2036ad}.uploader[_ngcontent-%COMP%]:not(.widget)   .description[_ngcontent-%COMP%]{max-width:350px}.uploader.widget.uploading[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{stroke:#4864fe}.uploader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.icon){height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.uploader.uploading[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{fill:none;stroke-linecap:round;stroke-dasharray:50;stroke-dashoffset:100;animation:draw 3.5s linear infinite}.uploader[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{top:5px;opacity:.7;transition:opacity .2s}.uploader[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:hover{opacity:1}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]{right:5px}.uploader[_ngcontent-%COMP%]   .remote-url-icon[_ngcontent-%COMP%]{right:30px}.upload-area.cursor-pointer[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(app-logo):not(.description), .upload-area.cursor-pointer[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(.remote-url-btn){pointer-events:none}.remote-url-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:300px}.remote-url-form[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{opacity:.5}@media (min-width: 768px){.uploader[_ngcontent-%COMP%]:not(.widget){margin:initial}}@keyframes bubble{6%{transform:scale(1.3,.8)}9%{transform:scale(.8,1.3) translateY(-.5rem)}12%{transform:scale(1)}}@keyframes draw{0%{stroke-dashoffset:100}to{stroke-dashoffset:0}}"]}),m})()},1197:(q,F,t)=>{"use strict";t.d(F,{M:()=>l});var h=t(8694),M=t(6895),e=t(4006),y=t(6818),C=t(1043),_=t(582),A=t(9383),i=t(4650);let l=(()=>{class d{}return d.\u0275fac=function(v){return new(v||d)},d.\u0275mod=i.oAB({type:d}),d.\u0275inj=i.cJS({imports:[h.r,M.ez,e.u5,y.q,C.h,_.z,A.aw.forChild()]}),d})()},8694:(q,F,t)=>{"use strict";t.d(F,{r:()=>e});var h=t(6895),M=t(4650);let e=(()=>{class y{}return y.\u0275fac=function(_){return new(_||y)},y.\u0275mod=M.oAB({type:y}),y.\u0275inj=M.cJS({imports:[h.ez]}),y})()},8212:(q,F,t)=>{"use strict";t.d(F,{J:()=>M});var h=t(4650);let M=(()=>{class e{transform(C,_){return C.join(_)}}return e.\u0275fac=function(C){return new(C||e)},e.\u0275pipe=h.Yjl({name:"arrayJoin",type:e,pure:!0}),e})()},575:(q,F,t)=>{"use strict";t.d(F,{In:()=>h,Ky:()=>C,VC:()=>M,c5:()=>y,gG:()=>e});var h=(()=>{return(_=h||(h={})).FILE_SHOW_LINKS="fileLinks",_.FILE_EDIT="fileEdit",_.DELETE="delete",_.RENAME="rename",_.MOVE="move",h;var _})(),M=(()=>{return(_=M||(M={})).FILE="file",_.FOLDER="folder",M;var _})(),e=(()=>{return(_=e||(e={})).FILENAME="filename",_.SIZE="size",_.TIME="time",_.EXTENSION="ext",e;var _})(),y=(()=>{return(_=y||(y={})).GRID="grid",_.LIST="list",y;var _})(),C=(()=>{return(_=C||(C={})).W_768_I_1="(max-width: 767.98px)",_.W_933_I_2="(min-width: 768px) and (max-width: 933.98px)",_.W_960_I_3="(min-width: 934px) and (max-width: 959.98px)",_.W_1226_I_2="(min-width: 960px) and (max-width: 1225.98px)",_.W_1540_I_3="(min-width: 1226px) and (max-width: 1539.98px)",_.W_1854_I_4="(min-width: 1540px) and (max-width: 1853.98px)",_.W_2168_I_5="(min-width: 1854px) and (max-width: 2167.98px)",_.W_2482_I_6="(min-width: 2168px) and (max-width: 2481.98px)",_.W_2796_I_7="(min-width: 2482px) and (max-width: 2795.98px)",_.W_3110_I_8="(min-width: 2796px) and (max-width: 3109.98px)",_.W_3424_I_9="(min-width: 3110px) and (max-width: 3423.98px)",_.W_3738_I_10="(min-width: 3424px)",C;var _})()},6986:(q,F,t)=>{"use strict";t.d(F,{C7:()=>y,Mi:()=>C,O8:()=>M,er:()=>_,p0:()=>e,xt:()=>A});var h=t(575);const M=[{ext:["png","apng"],maxSize:15},{ext:["jpeg","jpg","jpe"],maxSize:10},{ext:["gif"],maxSize:15},{ext:["bmp"],maxSize:10},{ext:["webp","webm"],maxSize:10},{ext:["psd","xcf"],maxSize:150},{ext:["svg"],maxSize:30}].map(i=>(i.maxSize*=1048576,i)),e={lastPath:[],layout:{asc:!0,orderBy:h.gG.FILENAME,type:h.c5.GRID},uploader:{checkImage:{time:0,active:!0},showLinkModal:!1}},y="https://upload.forumfree.net/api/",C=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-.\s])*$/,_=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-\s])*$/,A={invalidLength:!1,alreadyUsed:!1,invalidStartOrEnd:!1,invalidCharacter:!1}},3124:(q,F,t)=>{"use strict";t.d(F,{B:()=>y});var h=t(575),M=t(4650),e=t(3138);let y=(()=>{class C{constructor(A){this.globalsService=A,this.ffuid="",this.cache={},this.profileSubscription=this.globalsService.profileObservable.subscribe(i=>{this.ffuid=i?i.user.ffuid:""})}getItem(A){const i=this.createKey(A);if(this.cache.hasOwnProperty(i))return this.cache[i]}setItem(A,i){this.cache[this.createKey(A)]=i}removeItem(A){const i=this.createKey(A);if(this.cache.hasOwnProperty(i)){if(this.cache[i].folders.length)for(const l of this.cache[i].folders)this.removeItem([...A,l.name]);return delete this.cache[i],!0}return!1}getEntities(A,i){let l={};const d=this.createKey(A);if(!this.cache.hasOwnProperty(d))return l;for(const r of i){const v=(r.type===h.VC.FILE?this.cache[d].files:this.cache[d].folders).find(p=>p.name===r.name);v&&(l[v.name]=v)}return l}addEntities(A,i,l=h.VC.FILE){const d=this.createKey(A);return!!this.cache.hasOwnProperty(d)&&(Array.isArray(i)||(i=[i]),l===h.VC.FILE?this.cache[d].files.unshift(...i):this.cache[d].folders.unshift(...i),!0)}removeEntities(A,i,l=h.VC.FILE){if(Array.isArray(i)||(i=[i]),l===h.VC.FOLDER)for(const p of i)this.removeItem([...A,p]);const d=this.createKey(A);if(!this.cache.hasOwnProperty(d))return[];const r=l===h.VC.FILE?"files":"folders";let v=[];for(const p of i){const O=this.cache[d][r].findIndex(T=>T.name===p);O>-1&&(this.cache[d][r].splice(O,1),v.push(p))}return v}refactorFolderContent(A,i){const l=this.createKey(A);if(!this.cache.hasOwnProperty(l))return!1;i.endsWith("/")||(i+="/");for(const d of this.cache[l].folders)d.url=i+d.name;for(const d of this.cache[l].files)d.url=d.embedUrl=i+d.name,d.time=Date.now();return!0}createKey(A){return`${this.ffuid}/${A.join("/")}`}ngOnDestroy(){this.profileSubscription.unsubscribe()}}return C.\u0275fac=function(A){return new(A||C)(M.LFG(e.d))},C.\u0275prov=M.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},146:(q,F,t)=>{"use strict";t.d(F,{r:()=>C});var h=t(7579),M=t(1135),e=t(4650),y=t(8745);let C=(()=>{class _{constructor(i){this.uploadPreferencesService=i,this.selectedFileListArray=[],this.actionSubject=new h.x,this.uploadingFileQueueSubject=new h.x,this.uploadingFileErrorSubject=new h.x,this.currentFolderPathSubject=new h.x,this.layoutOptionsSubject=new h.x,this.renameEntitySubject=new h.x,this.entityPendingSubject=new h.x,this.deleteFileSubject=new h.x,this.uploadedFileSubject=new h.x,this.draggedFileListSubject=new h.x,this.startUploadSubject=new h.x,this.startMoveSubject=new h.x,this.selectedFileListSubject=new M.X(this.selectedFileListArray)}get actionObservable(){return this.actionSubject.asObservable()}pushAction(i){this.actionSubject.next(i)}get layoutOptionsObservable(){return this.layoutOptionsSubject.asObservable()}pushLayoutOptions(i){this.uploadPreferencesService.layoutOptions=i,this.layoutOptionsSubject.next(i)}get currentFolderPathObservable(){return this.currentFolderPathSubject.asObservable()}pushCurrentFolderPath(i){this.uploadPreferencesService.lastFolderPath=i,this.currentFolderPathSubject.next(i)}get uploadingFileQueueObservable(){return this.uploadingFileQueueSubject.asObservable()}pushUploadingFileQueue(i){this.uploadingFileQueueSubject.next(i)}get uploadingFileErrorObservable(){return this.uploadingFileErrorSubject.asObservable()}pushUploadingFileError(i){this.uploadingFileErrorSubject.next(i)}get renameEntityObservable(){return this.renameEntitySubject.asObservable()}pushRenameEntity(i){this.renameEntitySubject.next(i)}get entityPendingObservable(){return this.entityPendingSubject.asObservable()}pushEntityPending(i){this.entityPendingSubject.next(i)}get deleteFileObservable(){return this.deleteFileSubject.asObservable()}pushDeleteFile(i){this.deleteFileSubject.next(i)}get uploadedFileObservable(){return this.uploadedFileSubject.asObservable()}pushUploadedFile(i){this.uploadedFileSubject.next(i)}get draggedFileListObservable(){return this.draggedFileListSubject.asObservable()}pushDraggedFileList(i){this.draggedFileListSubject.next(i)}get startUploadObservable(){return this.startUploadSubject.asObservable()}pushStartUpload(i){this.startUploadSubject.next(i)}get startMoveObservable(){return this.startMoveSubject.asObservable()}pushStartMove(i){this.startMoveSubject.next(i)}get selectedFileListObservable(){return this.selectedFileListSubject.asObservable()}pushSelectedFile(i){if(Array.isArray(i)||(i=[i]),0===i.length)return void(this.selectedFileListArray.length>0&&(this.selectedFileListArray=[],this.selectedFileListSubject.next(this.selectedFileListArray)));let l=!1;for(const d of i){const r=this.selectedFileListArray.findIndex(v=>v.name===d.name);d.selected?-1===r&&(this.selectedFileListArray.push({name:d.name}),l=!0):r>-1&&(this.selectedFileListArray.splice(r,1),l=!0)}l&&this.selectedFileListSubject.next(this.selectedFileListArray)}}return _.\u0275fac=function(i){return new(i||_)(e.LFG(y.p))},_.\u0275prov=e.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},8745:(q,F,t)=>{"use strict";t.d(F,{p:()=>_});var h=t(5044),M=t(6986),e=t(4650),y=t(2381),C=t(6161);let _=(()=>{class A{constructor(l,d){this.preferencesService=l,this.urlQueryParamsService=d;const r=this.urlQueryParamsService.getAndDeleteParam(h.RT.UPLOAD_PATH);r&&(this.lastFolderPath=r.split("/").filter(v=>v.length>0))}get preferences(){return this.preferencesService.getItem(h.Ye.UPLOAD)||M.p0}set preferences(l){this.preferencesService.setItem(h.Ye.UPLOAD,l)}get lastFolderPath(){return(this.preferences.lastPath||M.p0.lastPath).filter(l=>l.length>0)}set lastFolderPath(l){const d=this.preferences;d.lastPath=l,this.preferences=d}get layoutOptions(){const l=M.p0.layout,d=this.preferences.layout;return d&&0===Object.keys(l).filter(r=>!d.hasOwnProperty(r)).length?d:l}set layoutOptions(l){const d=this.preferences;d.layout=l,this.preferences=d}get uploader(){const l=this.preferences.uploader||M.p0.uploader;return!l.checkImage.active&&Date.now()-l.checkImage.time>6048e5&&(l.checkImage.active=!0,this.uploader=l),l.hasOwnProperty("showLinkModal")||(l.showLinkModal=!1),l}set uploader(l){const d=this.preferences;d.uploader=l,this.preferences=d}}return A.\u0275fac=function(l){return new(l||A)(e.LFG(y.y),e.LFG(C.J))},A.\u0275prov=e.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A})()},3207:(q,F,t)=>{"use strict";t.d(F,{C:()=>a});var h=t(5861),M=t(7824),e=t(3905),y=t(575),C=t(3848),v=t(6986),p=t(1042),O=t(4650),T=t(5395),L=t(3124),N=t(8745),E=t(529);let a=(()=>{class u{constructor(x,U,I,W){this.graphqlService=x,this.uploadCacheService=U,this.uploadPreferencesService=I,this.http=W}get cache(){return this.uploadCacheService}get preferences(){return this.uploadPreferencesService}setGqlIdHeader(){this.graphqlService.safeSetGlobalHeader(M._.HeaderKeys.UUID,(0,p.Z)())}removeGqlIdHeader(){this.graphqlService.removeGlobalHeader(M._.HeaderKeys.UUID)}getGqlIdHeader(){return this.graphqlService.getGlobalHeader(M._.HeaderKeys.UUID)||""}getFileList(x,U){var I=this;return(0,h.Z)(function*(){const W=I.uploadCacheService.getItem(x);if(W)return W;const Q=(yield I.graphqlService.query({query:"\nquery UploadEntitiesListToken($scope: String, $target: String!) {\n    uploadEntitiesListToken(scope: $scope, target: $target)\n}",variables:{scope:U,target:x.join("/")}})).data.uploadEntitiesListToken,$=yield I.sendRequest(Q),ee={files:$.files.map(ne=>{const se=(0,C.Tb)(ne.url);return{...ne,time:1e3*ne.time,filename:se.filename,ext:se.ext,isImage:(0,C.Or)(se.ext),embedUrl:`${ne.url}?t=${ne.time}`,type:y.VC.FILE}}),folders:$.folders.map(ne=>({...ne,type:y.VC.FOLDER}))};return I.uploadCacheService.setItem(x,ee),ee})()}createDirectory(x,U){var I=this;return(0,h.Z)(function*(){const W=(yield I.graphqlService.mutate({mutation:"\nquery UploadEntitiesCreateDirectoryToken($scope: String, $target: String!) {\n    uploadEntitiesCreateDirectoryToken(scope: $scope, target: $target)\n}",variables:{scope:U,target:x.join("/")}})).data.uploadEntitiesCreateDirectoryToken;return yield I.sendRequest(W)})()}moveRenameEntity(x,U,I,W,Q){var $=this;return(0,h.Z)(function*(){W||(W=I);const oe=(yield $.graphqlService.mutate({mutation:"\nquery UploadEntitiesMoveToken($scope: String, $source: String!, $target: String!) {\n    uploadEntitiesMoveToken(scope: $scope, source: $source, target: $target)\n}",variables:{scope:Q,source:(x.length?`${x.join("/")}/`:"")+I,target:(U.length?`${U.join("/")}/`:"")+W}})).data.uploadEntitiesMoveToken,ee=yield $.sendRequest(oe);return{...ee,time:1e3*ee.time}})()}deleteEntity(x,U,I){var W=this;return(0,h.Z)(function*(){const Q=(yield W.graphqlService.mutate({mutation:"\nquery UploadEntitiesDeleteToken($scope: String, $target: String!) {\n    uploadEntitiesDeleteToken(scope: $scope, target: $target)\n}",variables:{scope:I,target:(x.length?`${x.join("/")}/`:"")+U}})).data.uploadEntitiesDeleteToken;return yield W.sendRequest(Q),!0})()}getHostToken(x,U,I){var W=this;return(0,h.Z)(function*(){return(yield W.graphqlService.query({query:"\nquery UploadEntitiesHostToken($scope: String, $target: String!) {\n    uploadEntitiesHostToken(scope: $scope, target: $target)\n}",variables:{scope:I,target:(x.length?`${x.join("/")}/`:"")+U}})).data.uploadEntitiesHostToken})()}sendRequest(x){var U=this;return(0,h.Z)(function*(){return(yield(0,e.z)(U.http.post(v.C7,JSON.stringify({payload:x}),{headers:{"Content-Type":"application/json"}}))).success})()}subscribeForChanges(x,U){var I=this;return(0,h.Z)(function*(){return yield I.graphqlService.subscribe({query:"\nsubscription UploadEntities($scope: String) {\n    uploadEntities(scope: $scope) {\n        eventMessage\n        eventType\n        user {\n            avatar\n            host\n            id\n            nickname\n        }\n    }\n}",variables:{scope:U}},W=>{if(!W.data?.uploadEntities)return;const Q=JSON.parse(W.data.uploadEntities.eventMessage);!Q.payload.customHeaders||!Q.payload.customHeaders.hasOwnProperty(M._.HeaderKeys.UUID)||Q.payload.customHeaders[M._.HeaderKeys.UUID]===I.getGqlIdHeader()||x({type:W.data.uploadEntities.eventType,message:Q})})})()}getBlobFromUrl(x){var U=this;return(0,h.Z)(function*(){return yield(0,e.z)(U.http.get(x,{responseType:"blob"})).catch(()=>{})})()}}return u.\u0275fac=function(x){return new(x||u)(O.LFG(T.J),O.LFG(L.B),O.LFG(N.p),O.LFG(E.eN))},u.\u0275prov=O.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},3848:(q,F,t)=>{"use strict";t.d(F,{$H:()=>O,JN:()=>d,Lv:()=>_,Or:()=>p,Tb:()=>y,jL:()=>v,lY:()=>A,ok:()=>L,rQ:()=>N,rc:()=>T,sT:()=>i,zO:()=>C});var h=t(5861),M=t(575),e=t(6986);function y(E){let a=E;if(E.indexOf("/")>-1){const U=E.split("/");a=U[U.length-1]}const u=a.split("."),P=u[u.length-1].toLowerCase(),x=decodeURIComponent(u.slice(0,-1).join("."));return{ext:P,filename:x,name:`${x}.${P}`}}function C(E,a={}){const u=y(E),P=Date.now();return{name:u.name,size:0,time:P,url:E,ext:u.ext,filename:u.filename,isImage:p(u.ext),embedUrl:`${E}?t=${P}`,type:M.VC.FILE,...a}}function _(E){let a=E;a.endsWith("/")&&(a=a.slice(0,-1));const u=a.split("/");return{name:decodeURIComponent(u[u.length-1])}}function A(E){return{name:_(E).name,url:E,type:M.VC.FOLDER}}function i(E){return l.apply(this,arguments)}function l(){return(l=(0,h.Z)(function*(E){const a=new FileReader,u=new Promise(P=>a.addEventListener("load",()=>P(a.result)));return a.readAsDataURL(E),u})).apply(this,arguments)}function d(E){return r.apply(this,arguments)}function r(){return(r=(0,h.Z)(function*(E){const a=new DataView(yield E.arrayBuffer());if(2303741511===a.getUint32(0)&&218765834===a.getUint32(4)){if(-1===[4,6].indexOf(a.getUint8(25)))return!1;const P=Object.assign(new Image,{src:yield i(E)});yield new Promise(I=>P.addEventListener("load",()=>I(!0)));const x=Object.assign(document.createElement("canvas"),{width:P.width,height:P.height}).getContext("2d");if(!x)return!1;x.imageSmoothingEnabled=!1,x.drawImage(P,0,0);const U=x?.getImageData(0,0,P.width,P.height);if(U)for(let I=0;I<U.data.length;I+=4)if(U.data[I+3]<255)return!0}return!1})).apply(this,arguments)}function v(E){return E.map(a=>({name:a.name,ext:a.ext,type:M.VC.FILE,url:a.url,embedUrl:a.embedUrl,isImage:a.isImage}))}function p(E,a=[]){return["png","apng","jpeg","jpg","jpe","gif","svg","webp"].includes(E)&&!a.includes(E)}function O(E){return p(E,["gif","svg"])}function T(E,a,u,P=[],x=""){let U={...e.xt};const I=E.trim();U.invalidLength=0===I.length;const W=(I+x).replace(/\s{2,}/g," ");return U.alreadyUsed=a!==I&&P.includes(W),U.invalidStartOrEnd=/(^(\s|\.))|((\s|\.)$)/.test(E),U.invalidCharacter=!(u===M.VC.FILE?e.Mi.test(E):e.er.test(E)),U}function L(E,a){return E.join("/")===a.join("/")}function N(E){let a=[],u=[];for(const P of E)P.type===M.VC.FILE?a.push(P):u.push(P);return{[M.VC.FILE]:a,[M.VC.FOLDER]:u}}},3612:(q,F,t)=>{"use strict";t.d(F,{q:()=>L});var h=t(5861),M=t(8896),e=t(6730),y=t.n(e),C=t(9969),_=t(3848),A=t(529),i=t(7579),l=t(7445),d=t(2722),r=t(6986);class v{static findApp1Marker(E){const a=new DataView(E),u=new Set([65498,65497,65476,65474,65472,65499,65501]);for(let P=0;P<E.byteLength-2;P+=2){const x=a.getUint16(P);if(65505===x)return{offset:P,size:a.getUint16(P+2),little:18761==a.getUint16(P+8,!1)};if(u.has(x))break}}static stripAndReturnExif(E){return(0,h.Z)(function*(){const a=yield E.arrayBuffer(),u=v.findApp1Marker(a);return u?{file:new File([a.slice(0,u.offset),a.slice(u.offset+u.size+2)],E.name,{type:E.type,lastModified:E.lastModified}),exif:a.slice(u.offset,u.offset+u.size)}:{file:E}})()}static checkImageOrientation(E){const a=new DataView(E);if(1165519206!=a.getUint32(4,!1))return-1;const u=18761==a.getUint16(10,!1);let P=10;P+=a.getUint32(P+4,u);const x=a.getUint16(P,u);P+=2;for(let U=0;U<x;U++)if(274==a.getUint16(P+12*U,u))return a.getUint16(P+12*U+8,u);return-1}}var p=t(4650),O=t(146),T=t(2020);let L=(()=>{class N{constructor(a,u,P){this.http=a,this.uploadObservablesService=u,this.loadImageService=P,this.requestSubscriptions=[],this.uploaderOptionsObject={compress:!0,openLinkModalAfterUpload:!1}}get uploaderOptions(){return{...this.uploaderOptionsObject}}set uploaderOptions(a){this.uploaderOptionsObject={...a}}compressFileIfNeeded(a,u){return(0,h.Z)(function*(){let P=["image/png","image/jpeg"],x={strict:!0,checkOrientation:!0,quality:.8,convertSize:1};u&&(P.push("image/webp"),x.width=u.width,x.height=u.height,x.resize="cover",x.strict=!1);const U=a.type.toLowerCase();return a.size<=4e6&&void 0===u||-1===P.indexOf(a.type.toLowerCase())?a:("image/png"===U&&(yield(0,_.JN)(a))&&(x.convertSize=1/0),new Promise((I,W)=>{new(y())(a,{...x,success:Q=>{const $=Q instanceof Blob?new File([Q],a.name,{type:a.type,lastModified:a.lastModified}):a;I($)},error:W})}))})()}orientFileIfNeeded(a){var u=this;return(0,h.Z)(function*(){if(-1===["image/jpeg"].indexOf(a.type.toLowerCase()))return a;const x=yield v.stripAndReturnExif(a);if(a=x.file,x.exif){const U=v.checkImageOrientation(x.exif);if(1!==U){let I=0;switch(U){case 3:case 4:I=180;break;case 5:case 6:I=90;break;case 7:case 8:I=270}const W=yield(0,_.sT)(a),Q=yield new Promise((oe,ee)=>{const ne=new Image;ne.onload=()=>oe({originalImage:ne,originalBase64:W}),ne.onerror=ee,ne.src=W}),$=yield u.loadImageService.transformLoadedImage({original:{base64:Q.originalBase64,image:Q.originalImage,size:{width:Q.originalImage.naturalWidth,height:Q.originalImage.naturalHeight}},exifTransform:{flip:[2,4,5,7].includes(U),rotate:I/90}},new C.R);a=new File([(0,M.L)($.transformed.base64)],a.name,{type:a.type,lastModified:Date.now()})}}return a})()}upload(a,u,P,x=!1){const U=new i.x,I=new FormData;I.append("payload",P),I.append("upload",a,a.name),x&&I.append("allowOverwrite","1");const W=this.http.request(new A.aW("POST",r.C7,I,{reportProgress:!0,responseType:"json"}));return this.requestSubscriptions.push(W.subscribe({next:Q=>{if(Q.type===A.dt.UploadProgress){if(!Q.total||(u.progress=Math.round(50*Q.loaded/Q.total)+20,u.progress<70))return;(0,l.F)(1e3).pipe((0,d.R)(U.asObservable())).subscribe(()=>{if(u.progress<95){const $=Math.round(8*Math.random()+8);u.progress+$>95?u.progress=95:u.progress+=$}})}else if(Q instanceof A.Zn){if(u.progress=100,u.completed=!0,Q.body?.error||!Q.body?.success)u.error=!0,this.uploadObservablesService.pushUploadingFileError(u);else{u.file.url=Q.body.success.url,u.file.time=Date.now(),u.file.embedUrl=`${u.file.url}?t=${u.file.time}`;const $=(0,_.Tb)(u.file.url);u.file.name=$.name,u.file.filename=$.filename}U.next(),U.complete()}},error:()=>{u.error=!0,this.uploadObservablesService.pushUploadingFileError(u),U.next(),U.complete()}})),U.asObservable()}clearPendingRequests(){for(const a of this.requestSubscriptions)a.unsubscribe();this.requestSubscriptions=[]}}return N.\u0275fac=function(a){return new(a||N)(p.LFG(A.eN),p.LFG(O.r),p.LFG(T.y))},N.\u0275prov=p.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})()},6730:function(q){q.exports=function(){"use strict";function F(b,s){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(b);s&&(g=g.filter(function(S){return Object.getOwnPropertyDescriptor(b,S).enumerable})),c.push.apply(c,g)}return c}function t(b){for(var s=1;s<arguments.length;s++){var c=null!=arguments[s]?arguments[s]:{};s%2?F(Object(c),!0).forEach(function(g){y(b,g,c[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):F(Object(c)).forEach(function(g){Object.defineProperty(b,g,Object.getOwnPropertyDescriptor(c,g))})}return b}function M(b,s){for(var c=0;c<s.length;c++){var g=s[c];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(b,g.key,g)}}function y(b,s,c){return s in b?Object.defineProperty(b,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):b[s]=c,b}function C(){return C=Object.assign||function(b){for(var s=1;s<arguments.length;s++){var c=arguments[s];for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(b[g]=c[g])}return b},C.apply(this,arguments)}var b,s,c,g,S,D,K,k,_={exports:{}};b=_,typeof window>"u"||(s=window,c=s.HTMLCanvasElement&&s.HTMLCanvasElement.prototype,g=s.Blob&&function(){try{return Boolean(new Blob)}catch{return!1}}(),S=g&&s.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch{return!1}}(),D=s.BlobBuilder||s.WebKitBlobBuilder||s.MozBlobBuilder||s.MSBlobBuilder,K=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,k=(g||D)&&s.atob&&s.ArrayBuffer&&s.Uint8Array&&function(j){var Z,G,V,ae,ie,R,m,w,n;if(!(Z=j.match(K)))throw new Error("invalid data URI");for(G=Z[2]?Z[1]:"text/plain"+(Z[3]||";charset=US-ASCII"),V=!!Z[4],ae=j.slice(Z[0].length),ie=V?atob(ae):decodeURIComponent(ae),R=new ArrayBuffer(ie.length),m=new Uint8Array(R),w=0;w<ie.length;w+=1)m[w]=ie.charCodeAt(w);return g?new Blob([S?m:R],{type:G}):((n=new D).append(R),n.getBlob(G))},s.HTMLCanvasElement&&!c.toBlob&&(c.mozGetAsFile?c.toBlob=function(j,Z,G){var V=this;setTimeout(function(){j(G&&c.toDataURL&&k?k(V.toDataURL(Z,G)):V.mozGetAsFile("blob",Z))})}:c.toDataURL&&k&&(c.toBlob=c.msToBlob?function(j,Z,G){var V=this;setTimeout(function(){j((Z&&"image/png"!==Z||G)&&c.toDataURL&&k?k(V.toDataURL(Z,G)):V.msToBlob(Z))})}:function(j,Z,G){var V=this;setTimeout(function(){j(k(V.toDataURL(Z,G)))})})),b.exports?b.exports=k:s.dataURLtoBlob=k);var A=_.exports,l={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},r=typeof window<"u"&&typeof window.document<"u"?window:{},v=function(s){return s>0&&s<1/0},p=Array.prototype.slice;function O(b){return Array.from?Array.from(b):p.call(b)}var T=/^image\/.+$/;function L(b){return T.test(b)}var E=String.fromCharCode;var u=r.btoa;function x(b){var c,s=new DataView(b);try{var g,S,D;if(255===s.getUint8(0)&&216===s.getUint8(1))for(var K=s.byteLength,k=2;k+1<K;){if(255===s.getUint8(k)&&225===s.getUint8(k+1)){S=k;break}k+=1}if(S){var Z=S+10;if("Exif"===function a(b,s,c){var S,g="";for(c+=s,S=s;S<c;S+=1)g+=E(b.getUint8(S));return g}(s,S+4,4)){var G=s.getUint16(Z);if(((g=18761===G)||19789===G)&&42===s.getUint16(Z+2,g)){var V=s.getUint32(Z+4,g);V>=8&&(D=Z+V)}}}if(D){var ie,R,ae=s.getUint16(D,g);for(R=0;R<ae;R+=1)if(274===s.getUint16(ie=D+12*R+2,g)){c=s.getUint16(ie+=8,g),s.setUint16(ie,1,g);break}}}catch{c=1}return c}var I=/\.\d*(?:0|9){12}\d*$/;function W(b){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return I.test(b)?Math.round(b*s)/s:b}function Q(b){var s=b.aspectRatio,c=b.height,g=b.width,S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",D=v(g),K=v(c);if(D&&K){var k=c*s;("contain"===S||"none"===S)&&k>g||"cover"===S&&k<g?c=g/s:g=c*s}else D?c=g/s:K&&(g=c*s);return{width:g,height:c}}var $=r.ArrayBuffer,oe=r.FileReader,ee=r.URL||r.webkitURL,ne=/\.\w+$/,se=r.Compressor;return function(){function b(s,c){(function h(b,s){if(!(b instanceof s))throw new TypeError("Cannot call a class as a function")})(this,b),this.file=s,this.image=new Image,this.options=t(t({},l),c),this.aborted=!1,this.result=null,this.init()}return function e(b,s,c){return s&&M(b.prototype,s),c&&M(b,c),b}(b,[{key:"init",value:function(){var c=this,g=this.file,S=this.options;if(function(s){return!(typeof Blob>"u")&&(s instanceof Blob||"[object Blob]"===Object.prototype.toString.call(s))}(g)){var D=g.type;if(L(D))if(ee&&oe)if($||(S.checkOrientation=!1),ee&&!S.checkOrientation)this.load({url:ee.createObjectURL(g)});else{var K=new oe,k=S.checkOrientation&&"image/jpeg"===D;this.reader=K,K.onload=function(j){var G=j.target.result,V={};if(k){var ae=x(G);ae>1||!ee?(V.url=function P(b,s){for(var c=[],S=new Uint8Array(b);S.length>0;)c.push(E.apply(null,O(S.subarray(0,8192)))),S=S.subarray(8192);return"data:".concat(s,";base64,").concat(u(c.join("")))}(G,D),ae>1&&C(V,function U(b){var s=0,c=1,g=1;switch(b){case 2:c=-1;break;case 3:s=-180;break;case 4:g=-1;break;case 5:s=90,g=-1;break;case 6:s=90;break;case 7:s=90,c=-1;break;case 8:s=-90}return{rotate:s,scaleX:c,scaleY:g}}(ae))):V.url=ee.createObjectURL(g)}else V.url=G;c.load(V)},K.onabort=function(){c.fail(new Error("Aborted to read the image with FileReader."))},K.onerror=function(){c.fail(new Error("Failed to read the image with FileReader."))},K.onloadend=function(){c.reader=null},k?K.readAsArrayBuffer(g):K.readAsDataURL(g)}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(c){var g=this,S=this.file,D=this.image;D.onload=function(){g.draw(t(t({},c),{},{naturalWidth:D.naturalWidth,naturalHeight:D.naturalHeight}))},D.onabort=function(){g.fail(new Error("Aborted to load the image."))},D.onerror=function(){g.fail(new Error("Failed to load the image."))},r.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(r.navigator.userAgent)&&(D.crossOrigin="anonymous"),D.alt=S.name,D.src=c.url}},{key:"draw",value:function(c){var g=this,S=c.naturalWidth,D=c.naturalHeight,K=c.rotate,k=void 0===K?0:K,j=c.scaleX,Z=void 0===j?1:j,G=c.scaleY,V=void 0===G?1:G,ae=this.file,ie=this.image,R=this.options,m=document.createElement("canvas"),w=m.getContext("2d"),n=Math.abs(k)%180==90,f=("contain"===R.resize||"cover"===R.resize)&&v(R.width)&&v(R.height),o=Math.max(R.maxWidth,0)||1/0,B=Math.max(R.maxHeight,0)||1/0,H=Math.max(R.minWidth,0)||0,Y=Math.max(R.minHeight,0)||0,re=S/D,z=R.width,X=R.height;if(n){var de=[B,o];o=de[0],B=de[1];var le=[Y,H];H=le[0],Y=le[1];var J=[X,z];z=J[0],X=J[1]}f&&(re=z/X);var te=Q({aspectRatio:re,width:o,height:B},"contain");o=te.width,B=te.height;var ce=Q({aspectRatio:re,width:H,height:Y},"cover");if(H=ce.width,Y=ce.height,f){var ue=Q({aspectRatio:re,width:z,height:X},R.resize);z=ue.width,X=ue.height}else{var pe=Q({aspectRatio:re,width:z,height:X}),me=pe.width;z=void 0===me?S:me;var _e=pe.height;X=void 0===_e?D:_e}var Me=-(z=Math.floor(W(Math.min(Math.max(z,H),o))))/2,Ue=-(X=Math.floor(W(Math.min(Math.max(X,Y),B))))/2,Ce=z,Te=X,ge=[];if(f){var fe,Ae,Oe=Q({aspectRatio:re,width:S,height:D},{contain:"cover",cover:"contain"}[R.resize]);ge.push((S-(fe=Oe.width))/2,(D-(Ae=Oe.height))/2,fe,Ae)}if(ge.push(Me,Ue,Ce,Te),n){var be=[X,z];z=be[0],X=be[1]}m.width=z,m.height=X,L(R.mimeType)||(R.mimeType=ae.type);var ye="transparent";if(ae.size>R.convertSize&&R.convertTypes.indexOf(R.mimeType)>=0&&(R.mimeType="image/jpeg"),"image/jpeg"===R.mimeType&&(ye="#fff"),w.fillStyle=ye,w.fillRect(0,0,z,X),R.beforeDraw&&R.beforeDraw.call(this,w,m),!this.aborted&&(w.save(),w.translate(z/2,X/2),w.rotate(k*Math.PI/180),w.scale(Z,V),w.drawImage.apply(w,[ie].concat(ge)),w.restore(),R.drew&&R.drew.call(this,w,m),!this.aborted)){var xe=function(Pe){g.aborted||g.done({naturalWidth:S,naturalHeight:D,result:Pe})};m.toBlob?m.toBlob(xe,R.mimeType,R.quality):xe(A(m.toDataURL(R.mimeType,R.quality)))}}},{key:"done",value:function(c){var g=c.naturalWidth,S=c.naturalHeight,D=c.result,K=this.file,j=this.options;if(ee&&!j.checkOrientation&&ee.revokeObjectURL(this.image.src),D)if(j.strict&&D.size>K.size&&j.mimeType===K.type&&!(j.width>g||j.height>S||j.minWidth>g||j.minHeight>S||j.maxWidth<g||j.maxHeight<S))D=K;else{var Z=new Date;D.lastModified=Z.getTime(),D.lastModifiedDate=Z,D.name=K.name,D.name&&D.type!==K.type&&(D.name=D.name.replace(ne,function N(b){var s=L(b)?b.substr(6):"";return"jpeg"===s&&(s="jpg"),".".concat(s)}(D.type)))}else D=K;this.result=D,j.success&&j.success.call(this,D)}},{key:"fail",value:function(c){var g=this.options;if(!g.error)throw c;g.error.call(this,c)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=se,b}},{key:"setDefaults",value:function(c){C(l,c)}}]),b}()}()},7445:(q,F,t)=>{"use strict";t.d(F,{F:()=>e});var h=t(4986),M=t(5963);function e(y=0,C=h.z){return y<0&&(y=0),(0,M.H)(y,y,C)}},1042:(q,F,t)=>{"use strict";t.d(F,{Z:()=>v});var h,M=new Uint8Array(16);function e(){if(!h&&!(h=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(M)}const y=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,_=function C(p){return"string"==typeof p&&y.test(p)};for(var A=[],i=0;i<256;++i)A.push((i+256).toString(16).substr(1));const v=function r(p,O,T){var L=(p=p||{}).random||(p.rng||e)();if(L[6]=15&L[6]|64,L[8]=63&L[8]|128,O){T=T||0;for(var N=0;N<16;++N)O[T+N]=L[N];return O}return function l(p){var O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,T=(A[p[O+0]]+A[p[O+1]]+A[p[O+2]]+A[p[O+3]]+"-"+A[p[O+4]]+A[p[O+5]]+"-"+A[p[O+6]]+A[p[O+7]]+"-"+A[p[O+8]]+A[p[O+9]]+"-"+A[p[O+10]]+A[p[O+11]]+A[p[O+12]]+A[p[O+13]]+A[p[O+14]]+A[p[O+15]]).toLowerCase();if(!_(T))throw TypeError("Stringified UUID is invalid");return T}(L)}}}]);