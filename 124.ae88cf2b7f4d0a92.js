"use strict";(self.webpackChunkpages=self.webpackChunkpages||[]).push([[124],{7429:(ue,Y,m)=>{m.d(Y,{d:()=>B});var _=m(5879),L=m(6223),y=m(5661),S=m(336);let e=(()=>{var M;class V{constructor(){this.allowedProps={$ref:{validator:this.isString},anyOf:{validator:this.validateAnyOf},default:{validator:this.isNestedOfPrimitives},definitions:null,description:null,enum:{validator:this.validateEnum},items:{child:"allProps"},maximum:null,maxItems:null,maxLength:null,minimum:null,minItems:null,minLength:null,multipleOf:null,oneOf:{validator:this.validateOneOf},properties:null,required:{validator:this.validateRequired},title:null,type:{validator:this.isNestedOfPrimitives},uniqueItems:null,widget:{child:{formlyConfig:{child:{props:{child:{placeholder:{validator:this.isString},multiple:{validator:this.isBoolean},pattern:{validator:this.isString},type:{validator:function(c){return"hidden"===c}},minLength:{validator:this.isNumber},maxLength:{validator:this.isNumber},rows:{validator:this.isNumber},keepGroupsWithoutId:{validator:this.isBoolean},fieldsetTemplate:{validator:this.isBoolean},startDate:{child:{year:null,month:null,day:null}},endDate:{child:{year:null,month:null,day:null}},minDate:{child:{year:null,month:null,day:null}},maxDate:{child:{year:null,month:null,day:null}},selectDomain:{validator:this.isBoolean}}},type:{validator:function(c){return"radio"===c}}}}}}},this.fieldListKeys=["properties","definitions"]}validateSchema(c){this.isObject(c)&&((!c.hasOwnProperty("type")||!c.hasOwnProperty("properties")||"object"!==c.type)&&(c.type="object",c.properties={}),this.validate(c))}validate(c,v){v||(v=this.allowedProps);for(const[E,s]of Object.entries(c)){var J,x;if(v.hasOwnProperty(E)){if(null!==(J=v[E])&&void 0!==J&&J.hasOwnProperty("validator"))v[E].validator.call(this,s)||delete c[E];else if(this.fieldListKeys.includes(E))for(const h of Object.keys(c[E]))this.validate(c[E][h]);else if(!this.isPrimitive(s)){if(null===(x=v[E])||void 0===x||!x.hasOwnProperty("child")||!this.isObject(s)){delete c[E];continue}this.validate(c[E],"allProps"===v[E].child?this.allowedProps:v[E].child)}}else delete c[E]}}isObject(c){return null!=c&&"object"==typeof c&&!Array.isArray(c)}isPrimitive(c){return this.isString(c)||this.isNumber(c)||this.isBoolean(c)||null==c}isString(c){return"string"==typeof c}isBoolean(c){return"boolean"==typeof c}isNumber(c){return"number"==typeof c}validateRequired(c){if(!Array.isArray(c))return!1;for(const v of c)if(!this.isString(v))return!1;return!0}validateEnum(c){if(!Array.isArray(c))return!1;for(const v of c)if(!this.isString(v)&&!this.isNumber(v))return!1;return!0}validateOneOf(c){var v;if(Array.isArray(c)&&null!==(v=c[0])&&void 0!==v&&v.hasOwnProperty("const")){for(const J of c){if(!this.isObject(J))return!1;this.validate(J,{const:null,title:null})}return!0}return this.validateAnyOf(c)}validateAnyOf(c){if(!Array.isArray(c))return!1;for(const v of c){if(!this.isObject(v))return!1;this.validate(v)}return!0}isNestedOfPrimitives(c){if(this.isPrimitive(c))return!0;if(Array.isArray(c)||this.isObject(c)){for(const v of Object.values(c))if(!this.isNestedOfPrimitives(v))return!1;return!0}return!1}}return(M=V).\u0275fac=function(c){return new(c||M)},M.\u0275prov=_.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),V})();var Z=m(5545);const G=["app-custom-form",""],H=[[["","buttons",""]]],$=["[buttons]"];let B=(()=>{var M;class V{constructor(c,v,J){this.formlyJsonschema=c,this.customFormSchemaService=v,this.toastService=J,this.model={},this.validateSchema=!1,this.enableModelChangeEvent=!1,this.defaultModel={},this.cancelEvent=new _.vpe,this.submitEvent=new _.vpe,this.validityChangeEvent=new _.vpe,this.modelChangeEvent=new _.vpe,this.form=new L.nJ({}),this.fields=[],this.options={},this.isFormCurrentlyValid=!0}ngOnInit(){this.createFields()}ngOnChanges(c){c.schema&&!c.schema.firstChange&&this.createFields()}createFields(){this.customFormSchemaService.isObject(this.schema)||(this.schema={}),this.validateSchema&&this.customFormSchemaService.validateSchema(this.schema),this.fields=[this.formlyJsonschema.toFieldConfig(this.schema)]}showFieldValidation(){this.cycleFields(this.fields)}showFieldValidationWithMessage(){this.showFieldValidation(),this.toastService.show({content:"Tutti i campi sono stati <strong>validati</strong>: quelli con errore sono evidenziati da un <strong>bordo rosso</strong>!"})}cycleFields(c){c.forEach(v=>{this.forceValidation(v),v.fieldGroup&&this.cycleFields(v.fieldGroup)})}forceValidation(c){c.validation||(c.validation={}),c.validation.show=!0}reset(){this.options.resetModel&&this.options.resetModel(this.defaultModel)}cancel(){this.cancelEvent.emit()}submit(){this.form.valid&&(this.log(),this.submitEvent.emit(this.model))}onModelChange(c){this.enableModelChangeEvent&&this.modelChangeEvent.emit(c||{}),this.form.valid!==this.isFormCurrentlyValid&&this.validityChangeEvent.emit(this.isFormCurrentlyValid=this.form.valid)}log(){}}return(M=V).\u0275fac=function(c){return new(c||M)(_.Y36(S.c),_.Y36(e),_.Y36(y.k))},M.\u0275cmp=_.Xpm({type:M,selectors:[["","app-custom-form",""]],inputs:{schema:"schema",model:"model",validateSchema:"validateSchema",enableModelChangeEvent:"enableModelChangeEvent",defaultModel:"defaultModel"},outputs:{cancelEvent:"cancelEvent",submitEvent:"submitEvent",validityChangeEvent:"validityChangeEvent",modelChangeEvent:"modelChangeEvent"},features:[_.TTD],attrs:G,ngContentSelectors:$,decls:3,vars:5,consts:[[3,"formGroup","ngSubmit"],[3,"model","fields","form","options","modelChange"]],template:function(c,v){1&c&&(_.F$t(H),_.TgZ(0,"form",0),_.NdJ("ngSubmit",function(){return v.submit()}),_.TgZ(1,"formly-form",1),_.NdJ("modelChange",function(x){return v.onModelChange(x)}),_.qZA(),_.Hsn(2),_.qZA()),2&c&&(_.Q6J("formGroup",v.form),_.xp6(1),_.Q6J("model",v.model)("fields",v.fields)("form",v.form)("options",v.options))},dependencies:[Z.T7,L._Y,L.JL,L.sg]}),V})()},4875:(ue,Y,m)=>{m.d(Y,{I:()=>xn});var _=m(6814),L=m(7905),y=m(5202),S=m(5545),e=m(5879),Z=m(8595);function G(t,o){1&t&&e.GkF(0)}function H(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"div",13),e.TgZ(2,"div",14),e._uU(3," ("),e.YNc(4,G,1,0,"ng-container",15),e._uU(5,") "),e.qZA(),e.BQk()),2&t){const n=e.oxw(),i=e.MAs(15);e.xp6(1),e.Q6J("innerHTML",n.parsedTitle,e.oJD),e.xp6(3),e.Q6J("ngTemplateOutlet",i)}}function $(t,o){1&t&&e.GkF(0)}function B(t,o){if(1&t&&(e.TgZ(0,"div",16),e._uU(1," Lista di "),e.YNc(2,$,1,0,"ng-container",15),e.qZA()),2&t){e.oxw();const n=e.MAs(15);e.xp6(2),e.Q6J("ngTemplateOutlet",n)}}function M(t,o){if(1&t&&e._UZ(0,"div",17),2&t){const n=e.oxw();e.Q6J("innerHTML",n.parsedDescription,e.oJD)}}const V=function(t){return{"mt-3":t}};function N(t,o){if(1&t&&(e.TgZ(0,"div",18),e._UZ(1,"formly-validation-message",19),e.qZA()),2&t){const n=e.oxw();e.Q6J("ngClass",e.VKq(2,V,n.parsedDescription.length)),e.xp6(1),e.Q6J("field",n.field)}}function c(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"li")(1,"div",30),e.NdJ("click",function(){e.CHM(n);const r=e.oxw().index,l=e.oxw(2);return e.KtG(l.move(r,r-1))}),e._uU(2," arrow_circle_up "),e.qZA()()}2&t&&(e.xp6(1),e.Q6J("disableOnTouchDevice",!0))}const v=function(t){return{"ms-1":t}};function J(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"li",31)(1,"div",32),e.NdJ("click",function(){e.CHM(n);const r=e.oxw().index,l=e.oxw(2);return e.KtG(l.move(r,r+1))}),e._uU(2," arrow_circle_down "),e.qZA()()}if(2&t){const n=e.oxw().first;e.Q6J("ngClass",e.VKq(2,v,!n)),e.xp6(1),e.Q6J("disableOnTouchDevice",!0)}}function x(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"li",31)(1,"div",33),e.NdJ("click",function(){e.CHM(n);const r=e.oxw().index,l=e.oxw(2);return e.KtG(l.remove(r))}),e._uU(2," highlight_off "),e.qZA()()}if(2&t){const n=e.oxw();e.Q6J("ngClass",e.VKq(2,v,!(n.first&&n.last))),e.xp6(1),e.Q6J("disableOnTouchDevice",!0)}}const E=function(t){return{"mb-3":t}},s=function(t){return{"has-error":t}};function h(t,o){if(1&t&&(e.TgZ(0,"li",22)(1,"fieldset",23)(2,"legend",24)(3,"div",25)(4,"div",26),e._uU(5),e.qZA(),e.TgZ(6,"ul",27),e.YNc(7,c,3,1,"li",28),e.YNc(8,J,3,4,"li",29),e.YNc(9,x,3,4,"li",29),e.qZA()()(),e._UZ(10,"formly-field",19),e.qZA()()),2&t){const n=o.$implicit,i=o.index,r=o.first,l=o.last;e.Q6J("ngClass",e.VKq(7,E,!l)),e.xp6(1),e.Q6J("ngClass",e.VKq(9,s,null==n.formControl?null:n.formControl.invalid)),e.xp6(4),e.hij("#",i+1,""),e.xp6(2),e.Q6J("ngIf",!r),e.xp6(1),e.Q6J("ngIf",!l),e.xp6(1),e.Q6J("ngIf",n.props&&!1!==n.props.removable),e.xp6(1),e.Q6J("field",n)}}function O(t,o){if(1&t&&(e.TgZ(0,"ul",20),e.YNc(1,h,11,11,"li",21),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.field.fieldGroup)}}const b=function(t){return{"d-none d-md-inline":t}};function d(t,o){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA(),e.TgZ(2,"span",31),e._uU(3),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Oqu(n.field.fieldGroup?n.field.fieldGroup.length:0),e.xp6(1),e.Q6J("ngClass",e.VKq(3,b,n.props.label)),e.xp6(1),e.hij(" element",n.field.fieldGroup&&1===n.field.fieldGroup.length?"o":"i","")}}const F=function(){return[10,10]},a=function(t){return{placement:"top-end",offset:t}};let u=(()=>{var t;class o extends S.hv{constructor(i){super(),this.customFormUtilsService=i,this.parsedTitle="",this.parsedDescription=""}ngOnInit(){this.parsedDescription=this.props.description?this.customFormUtilsService.parseBBCode(this.props.description):"",this.parsedTitle=this.props.label?this.customFormUtilsService.parseBBCode(this.props.label):""}get maxLengthExceeded(){return this.props.maxItems&&this.model&&this.model.length>=this.props.maxItems}move(i,r){const l=this.model[i];this.remove(i),this.add(r,l)}}return(t=o).\u0275fac=function(i){return new(i||t)(e.Y36(y.d6))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-array"]],features:[e.qOj],decls:16,vars:14,consts:[[1,"rounded","px-3","pb-3","pt-2","mb-3","formly-fieldset",3,"ngClass"],[1,"legend-reset","pb-1","px-2","mb-0","mw-100"],[1,"d-flex","align-items-center","mw-100"],[4,"ngIf","ngIfElse"],["nolabel",""],["class","mb-2 text-justify",3,"innerHTML",4,"ngIf"],["class","alert alert-danger formly-field-array-error text-center","role","alert",3,"ngClass",4,"ngIf"],["class","list-unstyled mb-3",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["appTippy","Hai aggiunto il numero massimo di elementi!",3,"disableInstance","tippyProps"],["type","button",1,"btn","btn-primary","d-flex","align-items-center",3,"disabled","click"],[1,"material-icons"],["itemscount",""],[1,"fs-xl","text-truncate","mw-100",3,"innerHTML"],[1,"ms-2","fs-reset","lh-1","fst-italic","list-counter","text-nowrap"],[4,"ngTemplateOutlet"],[1,"fs-xl","text-truncate","mw-10"],[1,"mb-2","text-justify",3,"innerHTML"],["role","alert",1,"alert","alert-danger","formly-field-array-error","text-center",3,"ngClass"],[3,"field"],[1,"list-unstyled","mb-3"],["class","item",3,"ngClass",4,"ngFor","ngForOf"],[1,"item",3,"ngClass"],[1,"rounded","formly-fieldset","dashed","show-success","px-3",3,"ngClass"],[1,"legend-reset","ms-auto","mb-0","px-2"],[1,"d-flex","align-items-center"],[1,"fs-xl","ms-1"],[1,"ms-2","mb-0","item-icons","list-unstyled","d-flex","align-items-center"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["appTippy","Sposta in alto",1,"d-block","material-icons","cursor-pointer",3,"disableOnTouchDevice","click"],[3,"ngClass"],["appTippy","Sposta in basso",1,"d-block","material-icons","cursor-pointer",3,"disableOnTouchDevice","click"],["appTippy","Rimuovi",1,"d-block","material-icons","cursor-pointer","text-danger",3,"disableOnTouchDevice","click"]],template:function(i,r){if(1&i&&(e.TgZ(0,"fieldset",0)(1,"legend",1)(2,"div",2),e.YNc(3,H,6,2,"ng-container",3),e.YNc(4,B,3,1,"ng-template",null,4,e.W1O),e.qZA()(),e.YNc(6,M,1,1,"div",5),e.YNc(7,N,2,4,"div",6),e.YNc(8,O,2,1,"ul",7),e.TgZ(9,"div",8)(10,"div",9)(11,"button",10),e.NdJ("click",function(){return!r.maxLengthExceeded&&r.add()}),e.TgZ(12,"span",11),e._uU(13,"add"),e.qZA()()()(),e.YNc(14,d,4,5,"ng-template",null,12,e.W1O),e.qZA()),2&i){const l=e.MAs(5);e.Q6J("ngClass",e.VKq(9,s,r.formControl.invalid)),e.xp6(3),e.Q6J("ngIf",r.parsedTitle)("ngIfElse",l),e.xp6(3),e.Q6J("ngIf",r.parsedDescription),e.xp6(1),e.Q6J("ngIf",r.showError&&r.formControl.errors),e.xp6(1),e.Q6J("ngIf",r.field.fieldGroup&&r.field.fieldGroup.length),e.xp6(2),e.Q6J("disableInstance",!r.maxLengthExceeded)("tippyProps",e.VKq(12,a,e.DdM(11,F))),e.xp6(1),e.Q6J("disabled",r.maxLengthExceeded)}},dependencies:[_.mk,_.sg,_.O5,_.tP,S.cw,S.M2,Z.$],styles:["legend[_ngcontent-%COMP%]   .list-counter[_ngcontent-%COMP%]{padding-top:.175rem}legend[_ngcontent-%COMP%]   .item-icons[_ngcontent-%COMP%]{padding-top:.1rem}"]}),o})();var C=m(1413),p=m(4020),f=m(6223),I=m(91),P=m(2181),T=m(8180),w=m(5619);const Q=["language","theme"],W=["editor"];let Pe=(()=>{class t{constructor(n,i){this.ngZone=n,this.monacoPathConfig=i,this.isMonacoLoaded$=new w.X(!1),this._monacoPath="assets/monaco-editor/min/vs",window.monacoEditorAlreadyInitialized?n.run(()=>this.isMonacoLoaded$.next(!0)):(window.monacoEditorAlreadyInitialized=!0,this.monacoPathConfig&&(this.monacoPath=this.monacoPathConfig),this.loadMonaco())}set monacoPath(n){n&&(this._monacoPath=n)}loadMonaco(){const n=()=>{let g=this._monacoPath;window.amdRequire=window.require;const A=!!this.nodeRequire,D=g.includes("http");A&&(window.require=this.nodeRequire,D||(g=window.require("path").resolve(window.__dirname,this._monacoPath))),window.amdRequire.config({paths:{vs:g}}),window.amdRequire(["vs/editor/editor.main"],()=>{this.ngZone.run(()=>this.isMonacoLoaded$.next(!0))},k=>console.error("Error loading monaco-editor: ",k))};if(window.amdRequire)return n();window.require&&(this.addElectronFixScripts(),this.nodeRequire=window.require);const l=document.createElement("script");l.type="text/javascript",l.src=`${this._monacoPath}/loader.js`,l.addEventListener("load",n),document.body.appendChild(l)}addElectronFixScripts(){const n=document.createElement("script"),i=document.createTextNode("self.module = undefined;"),r=document.createTextNode("self.process.browser = true;");n.appendChild(i),n.appendChild(r),document.body.appendChild(n)}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(e.R0b),e.LFG("MONACO_PATH",8))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Ve=(()=>{class t{constructor(n){this.monacoLoader=n,this.init=new e.vpe,this.onTouched=()=>{},this.onErrorStatusChange=()=>{},this.propagateChange=()=>{}}get model(){return this.editor&&this.editor.getModel()}get modelMarkers(){return this.model&&monaco.editor.getModelMarkers({resource:this.model.uri})}ngOnInit(){this.monacoLoader.isMonacoLoaded$.pipe((0,P.h)(n=>n),(0,T.q)(1)).subscribe(()=>{this.initEditor()})}ngOnChanges(n){if(this.editor&&n.options&&!n.options.firstChange){const i=n.options.currentValue,{language:r,theme:l}=i,g=(0,I.Z)(i,Q),{language:A,theme:D}=n.options.previousValue;A!==r&&monaco.editor.setModelLanguage(this.editor.getModel(),this.options&&this.options.language?this.options.language:"text"),D!==l&&monaco.editor.setTheme(l),this.editor.updateOptions(g)}if(this.editor&&n.uri){const i=n.uri.currentValue,r=n.uri.previousValue;if(r&&!i||!r&&i||i&&r&&i.path!==r.path){const l=this.editor.getValue();let g;this.modelUriInstance&&this.modelUriInstance.dispose(),i&&(g=monaco.editor.getModels().find(A=>A.uri.path===i.path)),this.modelUriInstance=g||monaco.editor.createModel(l,this.options.language||"text",this.uri),this.editor.setModel(this.modelUriInstance)}}}writeValue(n){this.value=n,this.editor&&n?this.editor.setValue(n):this.editor&&this.editor.setValue("")}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){this.onTouched=n}validate(){return this.parsedError?{monaco:{value:this.parsedError.split("|")}}:null}registerOnValidatorChange(n){this.onErrorStatusChange=n}initEditor(){const n={value:[this.value].join("\n"),language:"text",automaticLayout:!0,scrollBeyondLastLine:!1,theme:"vc"};this.editor=monaco.editor.create(this.editorContent.nativeElement,this.options?(0,C.Z)((0,C.Z)({},n),this.options):n),this.registerEditorListeners(),this.init.emit(this.editor)}registerEditorListeners(){this.editor.onDidChangeModelContent(()=>{this.propagateChange(this.editor.getValue())}),this.editor.onDidChangeModelDecorations(()=>{const n=this.modelMarkers.map(({message:r})=>r).join("|");this.parsedError!==n&&(this.parsedError=n,this.onErrorStatusChange())}),this.editor.onDidBlurEditorText(()=>{this.onTouched()})}ngOnDestroy(){this.editor&&this.editor.dispose()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(Pe))},t.\u0275cmp=e.Xpm({type:t,selectors:[["ngx-monaco-editor"]],viewQuery:function(n,i){if(1&n&&e.Gf(W,7),2&n){let r;e.iGM(r=e.CRH())&&(i.editorContent=r.first)}},inputs:{options:"options",uri:"uri"},outputs:{init:"init"},features:[e._Bn([{provide:f.JU,useExisting:(0,e.Gpc)(()=>t),multi:!0},{provide:f.Cf,useExisting:(0,e.Gpc)(()=>t),multi:!0}]),e.TTD],decls:4,vars:0,consts:[["fxFlex","",1,"editor-container"],["container",""],[1,"monaco-editor"],["editor",""]],template:function(n,i){1&n&&(e.TgZ(0,"div",0,1),e._UZ(2,"div",2,3),e.qZA())},styles:[".monaco-editor[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}.editor-container[_ngcontent-%COMP%]{overflow:hidden;position:relative;display:table;width:100%;height:100%;min-width:0}"],changeDetection:0}),t})(),Je=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[]]}),t})();function Le(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"textarea",2),e._uU(2,"            "),e.qZA(),e.BQk()),2&t){const n=e.oxw();e.xp6(1),e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("cols",1)("rows",10)("formlyAttributes",n.field)}}function Ue(t,o){1&t&&(e.ynx(0),e.TgZ(1,"p",4),e._UZ(2,"span",5),e.qZA(),e.BQk())}function ke(t,o){if(1&t&&e._UZ(0,"ngx-monaco-editor",6),2&t){const n=e.oxw(2);e.Udp("height",n.editorHeight),e.Q6J("options",n.editorOptions)("formControl",n.formControl)}}function Ne(t,o){if(1&t&&(e.YNc(0,Ue,3,0,"ng-container",0),e.YNc(1,ke,1,4,"ng-template",null,3,e.W1O)),2&t){const n=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.loading)("ngIfElse",n)}}let Qe=(()=>{var t;class o extends S.fS{constructor(){super(...arguments),this.touchDevice=p.eX,this.editorOptions={theme:"vs-dark",language:"json"},this.loading=!0,this.editorHeight="350px"}ngOnInit(){this.touchDevice||(this.field.props.editorOptions&&(this.field.props.editorOptions.height&&(this.editorHeight=this.field.props.editorOptions.height,delete this.field.props.editorOptions.height),this.editorOptions=(0,C.Z)((0,C.Z)({},this.editorOptions),this.field.props.editorOptions)),this.loading=!1)}}return(t=o).\u0275fac=function(){let n;return function(r){return(n||(n=e.n5z(t)))(r||t)}}(),t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-code-editor-type"]],features:[e.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["notTouchDevice",""],[1,"form-control",3,"formControl","cols","rows","formlyAttributes"],["codeEditor",""],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],[1,"d-block","formly-code-editor",3,"options","formControl"]],template:function(i,r){if(1&i&&(e.YNc(0,Le,3,6,"ng-container",0),e.YNc(1,Ne,3,2,"ng-template",null,1,e.W1O)),2&i){const l=e.MAs(2);e.Q6J("ngIf",r.touchDevice)("ngIfElse",l)}},dependencies:[_.O5,S.JD,f.Fj,f.JJ,f.oH,Ve],encapsulation:2}),o})();var R=m(5861),oe=m(8784);function Re(t,o){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"div",4),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.formControl.setValue(void 0))}),e._uU(2," highlight_off "),e.qZA(),e.BQk()}}function je(t,o){1&t&&(e.ynx(0),e.TgZ(1,"p",5),e._UZ(2,"span",6),e.qZA(),e.BQk())}function qe(t,o){if(1&t&&e._UZ(0,"option",10),2&t){const n=o.$implicit;e.Q6J("ngValue",n.id||n.name)("innerText",n.name)}}function Ye(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"select",8),e.YNc(2,qe,1,2,"option",9),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(1),e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(1),e.Q6J("ngForOf",n.groupsList)}}function Ge(t,o){if(1&t&&e._UZ(0,"option",10),2&t){const n=o.$implicit;e.Q6J("ngValue",n.id||n.name)("innerText",n.name)}}function He(t,o){if(1&t&&(e.TgZ(0,"select",11),e.YNc(1,Ge,1,2,"option",9),e.qZA()),2&t){const n=e.oxw(2);e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(1),e.Q6J("ngForOf",n.groupsList)}}function $e(t,o){if(1&t&&(e.YNc(0,Ye,3,5,"ng-container",2),e.YNc(1,He,2,5,"ng-template",null,7,e.W1O)),2&t){const n=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.field.props.multiple)("ngIfElse",n)}}const Be=function(t){return{"no-label":t}};let We=(()=>{var t;class o extends S.fS{constructor(i){super(),this.forumService=i,this.loading=!0,this.groupsList=[]}ngOnInit(){var i=this;return(0,R.Z)(function*(){i.field.defaultValue=void 0,i.field.props.hasOwnProperty("multiple")||(i.field.props.multiple=!0),i.groupsList=(yield i.forumService.getGroups()).sort((r,l)=>r.name.localeCompare(l.name)),i.field.props.keepGroupsWithoutId||(i.groupsList=i.groupsList.filter(r=>r.id>0)),i.loading=!1,i.field.formControl.updateValueAndValidity()})()}}return(t=o).\u0275fac=function(i){return new(i||t)(e.Y36(oe._))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-groups"]],features:[e.qOj],decls:5,vars:6,consts:[[1,"position-relative","wrapper",3,"ngClass"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["formSelect",""],[1,"reset-icon","position-absolute","cursor-pointer","d-block","material-icons","text-danger",3,"click"],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],["single",""],["multiple","",1,"form-select",3,"formControl","formlyAttributes"],[3,"ngValue","innerText",4,"ngFor","ngForOf"],[3,"ngValue","innerText"],[1,"form-select",3,"formControl","formlyAttributes"]],template:function(i,r){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,Re,3,0,"ng-container",1),e.YNc(2,je,3,0,"ng-container",2),e.YNc(3,$e,3,2,"ng-template",null,3,e.W1O),e.qZA()),2&i){const l=e.MAs(4);e.Q6J("ngClass",e.VKq(4,Be,!r.props.label)),e.xp6(1),e.Q6J("ngIf",!r.props.label||void 0!==r.formControl.value),e.xp6(1),e.Q6J("ngIf",r.loading)("ngIfElse",l)}},dependencies:[_.mk,_.sg,_.O5,S.JD,f.YN,f.Kr,f.EJ,f.K7,f.JJ,f.oH],styles:[".reset-icon[_ngcontent-%COMP%]{right:0}.wrapper[_ngcontent-%COMP%]:not(.no-label)   .reset-icon[_ngcontent-%COMP%]{top:calc(-24px - .45rem)}.no-label[_ngcontent-%COMP%]{padding-top:calc(24px + .45rem)}.no-label[_ngcontent-%COMP%]   .reset-icon[_ngcontent-%COMP%]{top:0}"]}),o})();var pe=m(1410),re=m(8645);const Ke=[{value:y.ig.FORUMFREE,placeholder:"ForumFree"},{value:y.ig.FORUMCOMMUNITY,placeholder:"ForumCommunity"},{value:y.ig.BLOGFREE,placeholder:"BlogFree"}];function ze(t,o){if(1&t&&e._UZ(0,"option",2),2&t){const n=o.$implicit;e.Q6J("ngValue",n.value)("innerText",n.placeholder)}}let Xe=(()=>{var t;class o{constructor(){this.model=y.ig.FORUMFREE,this.modelChange=new e.vpe,this.options=Ke,console.log("constr")}}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-domain-select"]],inputs:{model:"model"},outputs:{modelChange:"modelChange"},decls:2,vars:2,consts:[[1,"form-select",3,"ngModel","ngModelChange"],[3,"ngValue","innerText",4,"ngFor","ngForOf"],[3,"ngValue","innerText"]],template:function(i,r){1&i&&(e.TgZ(0,"select",0),e.NdJ("ngModelChange",function(g){return r.model=g})("ngModelChange",function(g){return r.modelChange.emit(g)}),e.YNc(1,ze,1,2,"option",1),e.qZA()),2&i&&(e.Q6J("ngModel",r.model),e.xp6(1),e.Q6J("ngForOf",r.options))},dependencies:[_.sg,f.YN,f.Kr,f.EJ,f.JJ,f.On],encapsulation:2}),o})();var fe=m(7827),ge=m(7357);function et(t,o){1&t&&e._UZ(0,"div",4),2&t&&e.Q6J("innerText","Nessun elemento inserito!")}function tt(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"li")(1,"a",7)(2,"div",8),e.NdJ("click",function(r){const g=e.CHM(n).index,A=e.oxw(2);return e.KtG(A.remove(g,r))}),e.TgZ(3,"div",9),e._uU(4," remove "),e.qZA()(),e._UZ(5,"img",10),e.ALo(6,"uploadsreplace"),e.qZA(),e._UZ(7,"a",11),e.qZA()}if(2&t){const n=o.$implicit,i=e.oxw(2);e.Gre("d-flex flex-column align-items-center item-",n.circuit,""),e.xp6(1),e.Q6J("href",n.link,e.LSH),e.xp6(1),e.Q6J("disableOnTouchDevice",!0),e.xp6(3),e.s9C("alt",n.title),e.Q6J("src",i.lazyImagePlaceholder,e.LSH)("lazyLoad",e.lcZ(6,12,n.image))("offset",100)("errorImage",i.defaultImage),e.xp6(2),e.Q6J("innerHTML",n.title,e.oJD)("href",n.link,e.LSH)}}function nt(t,o){if(1&t&&(e.TgZ(0,"ul",5),e.YNc(1,tt,8,14,"li",6),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.list)}}const it=function(t){return{"empty-list":t}};let ot=(()=>{var t;class o{constructor(){this.list=[],this.defaultImage="/assets/default_avatar.png",this.removeEvent=new e.vpe,this.lazyImagePlaceholder=p.vX}remove(i,r){r.preventDefault(),r.stopPropagation();const l=this.list[i].id;this.list.splice(i,1),this.list=[...this.list],this.removeEvent.emit(l)}}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-formly-typeahead-content"]],inputs:{list:"list",listTitle:"listTitle",defaultImage:"defaultImage"},outputs:{removeEvent:"removeEvent"},decls:5,vars:6,consts:[[1,"formly-list-container","rounded","px-3","pt-2","mb-3","mt-2",3,"ngClass"],[1,"legend-reset","fs-reset","mb-0","px-2","pb-1",3,"innerText"],["class","alert alert-primary text-center mb-0 fw-bold",3,"innerText",4,"ngIf","ngIfElse"],["noEmpty",""],[1,"alert","alert-primary","text-center","mb-0","fw-bold",3,"innerText"],[1,"formly-list","list-unstyled","mb-0","d-grid","px-2"],[3,"class",4,"ngFor","ngForOf"],["target","_blank",1,"preview","rounded-circle","d-block","position-relative",3,"href"],["appTippy","Rimuovi",1,"remove-btn","alert","alert-danger","position-absolute","cursor-pointer","mb-0","py-0","px-1",3,"disableOnTouchDevice","click"],[1,"material-icons","d-block","fs-reset"],[1,"d-block","image-cover","rounded-circle",3,"src","lazyLoad","offset","errorImage","alt"],["target","_blank",1,"d-block","fw-bold","mt-1","item-title","text-truncate","mw-100",3,"innerHTML","href"]],template:function(i,r){if(1&i&&(e.TgZ(0,"fieldset",0),e._UZ(1,"legend",1),e.YNc(2,et,1,1,"div",2),e.YNc(3,nt,2,1,"ng-template",null,3,e.W1O),e.qZA()),2&i){const l=e.MAs(4);e.Q6J("ngClass",e.VKq(4,it,0===r.list.length)),e.xp6(1),e.Q6J("innerText",r.listTitle),e.xp6(1),e.Q6J("ngIf",0===r.list.length)("ngIfElse",l)}},dependencies:[_.mk,_.sg,_.O5,fe.z1,Z.$,ge.g],styles:[".formly-list-container[_ngcontent-%COMP%]{border:1px dashed var(--bs-gray-500)}.formly-list-container[_ngcontent-%COMP%]:not(.empty-list){padding-bottom:.75rem}.formly-list-container.empty-list[_ngcontent-%COMP%]{padding-bottom:1rem}.formly-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(60px,1fr));gap:1rem}.formly-list[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{top:0;left:-8px}.formly-list[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:60px;height:60px;border:2px solid}.formly-list[_ngcontent-%COMP%]   .item-ff[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{border-color:#58a72e}.formly-list[_ngcontent-%COMP%]   .item-ff[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{color:#58a72e!important}.formly-list[_ngcontent-%COMP%]   .item-fc[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{border-color:#0082cd}.formly-list[_ngcontent-%COMP%]   .item-fc[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{color:#0082cd!important}.formly-list[_ngcontent-%COMP%]   .item-bf[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{border-color:#e67f22}.formly-list[_ngcontent-%COMP%]   .item-bf[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{color:#e67f22!important}@media (min-width: 960px){.formly-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(75px,1fr));gap:1.5rem}.formly-list[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{top:4px}.formly-list[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:75px;height:75px}}"]}),o})();var rt=m(1378);function he(t){const o=document.createElement("TEXTAREA");return o.innerHTML=t,o.value}var _e=m(3620),ye=m(3997),ve=m(3019),K=m(9397),xe=m(4664),Fe=m(2096),st=m(5592),lt=m(9773);function Ce(t){t||((0,e.gHi)(Ce),t=(0,e.f3M)(e.ktI));const o=new st.y(n=>t.onDestroy(n.next.bind(n)));return n=>n.pipe((0,lt.R)(o))}var we=m(5661),te=m(3946);function yt(t,o){1&t&&(e.TgZ(0,"span",8),e._uU(1,"*"),e.qZA())}function vt(t,o){if(1&t&&(e.TgZ(0,"legend",5)(1,"label",6),e._uU(2),e.YNc(3,yt,2,0,"span",7),e.qZA()()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("for",n.field.id),e.xp6(1),e.hij(" ",n.props.label," "),e.xp6(1),e.Q6J("ngIf",n.props.required)}}function xt(t,o){1&t&&e.GkF(0)}function Ft(t,o){1&t&&e.GkF(0)}function Ct(t,o){if(1&t&&e._UZ(0,"div",9),2&t){const n=e.oxw();e.Q6J("innerHTML",n.parsedDescription,e.oJD)}}function Ot(t,o){1&t&&(e.TgZ(0,"div",16)(1,"span",17),e._uU(2,"Loading..."),e.qZA()())}function bt(t,o){1&t&&e.GkF(0)}function Mt(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",18),e.YNc(2,bt,1,0,"ng-container",2),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(2),e.Q6J("ngTemplateOutlet",n.additionalInputsTemplate)}}function Tt(t,o){if(1&t&&(e.TgZ(0,"div",19),e._UZ(1,"formly-validation-message",20),e.qZA()),2&t){const n=e.oxw(2);e.Udp("display","block"),e.xp6(1),e.Q6J("field",n.field)}}function Et(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"input",12),e.NdJ("ngModelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.inputValue=r)})("selectItem",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.selectEntity(r))})("focus",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.focusSubject.next(r.target.value))}),e.qZA(),e.YNc(3,Ot,3,0,"div",13),e.qZA(),e.YNc(4,Mt,3,1,"ng-container",14),e.qZA(),e.YNc(5,Tt,2,3,"div",15)}if(2&t){const n=e.oxw();e.xp6(2),e.ekj("is-invalid",n.showError),e.Q6J("ngModel",n.inputValue)("formlyAttributes",n.field)("ngbTypeahead",n.search)("editable",!1)("inputFormatter",n.inputFormatter)("resultFormatter",n.resultFormatter),e.xp6(1),e.Q6J("ngIf",n.searching),e.xp6(1),e.Q6J("ngIf",n.additionalInputsTemplate),e.xp6(1),e.Q6J("ngIf",n.showError)}}let wt=(()=>{var t;class o{constructor(i,r,l,g){this.customFormUtilsService=i,this.changeDetectorRef=r,this.toastService=l,this.destroyRef=g,this.showError=!1,this.selectItemEvent=new e.vpe,this.populateListEvent=new e.vpe,this.inputValue="",this.inputFormatter=A=>A.name,this.focusSubject=new re.x,this.searching=!1,this.formlyFieldValues=[],this.search=A=>{const D=A.pipe((0,_e.b)(700),(0,ye.x)());return(0,ve.T)(D,this.focusSubject).pipe((0,K.b)(()=>this.setSearching(!0)),(0,xe.w)(k=>k.length<3?(0,Fe.of)([]):this.searchFunction(k)),(0,K.b)(()=>this.setSearching(!1)))}}ngOnInit(){this.formControl=this.field.formControl,this.props=this.field.props,this.parsedDescription=this.props.description?this.customFormUtilsService.parseBBCode(this.props.description):void 0,this.formlyFieldValues=Array.isArray(this.formControl.value)?this.formControl.value:Array.isArray(this.field.defaultValue)?this.field.defaultValue:[],this.populateListEvent.emit(this.formlyFieldValues),this.formControl.updateValueAndValidity(),this.removeItemObservable.pipe(Ce(this.destroyRef)).subscribe(i=>{const r=this.formlyFieldValues.indexOf(i);r>-1&&(this.formlyFieldValues.splice(r,1),this.formControl.setValue([...this.formlyFieldValues]))})}resultFormatter(i){return i.name.indexOf("&")>-1?he(i.name):i.name}setSearching(i){this.searching=i,this.changeDetectorRef.detectChanges()}selectEntity(i){const r=i.item;if(i.preventDefault(),this.formlyFieldValues.includes(r.id))return this.toastService.show({content:`L'elemento <strong>${r.name}</strong> \xe8 gi\xe0 stato aggiunto alla lista!`,level:rt.m.ERROR}),void(this.inputValue="");this.formlyFieldValues.push(r.id),this.selectItemEvent.emit(i.item),this.inputValue="",this.formControl.setValue([...this.formlyFieldValues])}}return(t=o).\u0275fac=function(i){return new(i||t)(e.Y36(y.d6),e.Y36(e.sBO),e.Y36(we.k),e.Y36(e.ktI))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-formly-typeahead"]],inputs:{field:"field",showError:"showError",removeItemObservable:"removeItemObservable",searchFunction:"searchFunction",resultsTemplate:"resultsTemplate",additionalInputsTemplate:"additionalInputsTemplate"},outputs:{selectItemEvent:"selectItemEvent",populateListEvent:"populateListEvent"},decls:7,vars:6,consts:[[1,"mb-3","rounded","px-3","pt-2","pb-3","formly-fieldset"],["class","legend-reset fs-reset mb-0 px-2 mw-100 lh-1 py-1",4,"ngIf"],[4,"ngTemplateOutlet"],["class","form-text text-muted",3,"innerHTML",4,"ngIf"],["typeaheadTemplate",""],[1,"legend-reset","fs-reset","mb-0","px-2","mw-100","lh-1","py-1"],[1,"form-label","mb-0","mw-100","text-truncate",3,"for"],["aria-hidden","true",4,"ngIf"],["aria-hidden","true"],[1,"form-text","text-muted",3,"innerHTML"],[1,"d-flex","flex-column","flex-sm-row"],[1,"position-relative","flex-grow-1"],["type","text","container","body",1,"form-control",3,"ngModel","formlyAttributes","ngbTypeahead","editable","inputFormatter","resultFormatter","ngModelChange","selectItem","focus"],["class","spinner-border spinner-border-sm text-primary position-absolute","role","status",4,"ngIf"],[4,"ngIf"],["class","invalid-feedback",3,"display",4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm","text-primary","position-absolute"],[1,"visually-hidden"],[1,"ms-sm-3","mt-3","mt-sm-0"],[1,"invalid-feedback"],[3,"field"]],template:function(i,r){if(1&i&&(e.TgZ(0,"fieldset",0),e.YNc(1,vt,4,3,"legend",1),e.YNc(2,xt,1,0,"ng-container",2),e.YNc(3,Ft,1,0,"ng-container",2),e.YNc(4,Ct,1,1,"div",3),e.qZA(),e.YNc(5,Et,6,11,"ng-template",null,4,e.W1O)),2&i){const l=e.MAs(6);e.ekj("has-error",r.formControl.invalid),e.xp6(1),e.Q6J("ngIf",r.props.label),e.xp6(1),e.Q6J("ngTemplateOutlet",l),e.xp6(1),e.Q6J("ngTemplateOutlet",r.resultsTemplate),e.xp6(1),e.Q6J("ngIf",r.parsedDescription)}},dependencies:[_.O5,_.tP,S.JD,S.M2,f.Fj,f.JJ,f.On,te.dR],styles:[".spinner-border[_ngcontent-%COMP%]{top:calc(50% - 8px);right:10px}"],changeDetection:0}),o})();function St(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"app-formly-typeahead-content",3),e.NdJ("removeEvent",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.removeItemSubject.next(r))}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("list",n.list)}}function At(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"app-domain-select",4),e.NdJ("modelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.selectedDomain=r)}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("model",n.selectedDomain)}}let Dt=(()=>{var t;class o extends S.fS{constructor(i,r){var l,g;super(),l=this,this.forumService=i,this.globalsService=r,this.removeItemSubject=new re.x,this.list=[],this.hasDomainSelect=!1,this.lastResults=[],this.search=function(){var A=(0,R.Z)(function*(D){if(l.lastDomain===l.selectedDomain&&l.lastSearchedValueWithoutResult&&D.startsWith(l.lastSearchedValueWithoutResult))return[];l.lastDomain=l.selectedDomain,l.lastResults=yield l.forumService.searchForumByName(D,l.forumService.domainToDefaultCid(l.selectedDomain)),l.lastSearchedValueWithoutResult=l.lastResults.length?void 0:D;const j=l.forumService.domainToShortDomain(l.selectedDomain);return l.lastResults.map(ne=>({id:`${j}${ne.id}`,name:`${ne.domain}.${l.selectedDomain}`}))});return function(D){return A.apply(this,arguments)}}(),this.selectedDomain=this.lastDomain=(null===(g=this.globalsService.credentials)||void 0===g?void 0:g.site.domain)||y.ig.FORUMFREE}ngOnInit(){this.hasDomainSelect=!0===this.props.selectDomain}populateListEvent(i){var r=this;return(0,R.Z)(function*(){r.list=i.map(l=>({id:l,title:"help",image:"https://uploads.forumfree.it/thumb/1.jpg",circuit:y.Yb.FORUMFREE,link:"help.forumfree.it"}))})()}selectItemEvent(i){this.list.push({id:i.id,title:"help",image:"https://uploads.forumfree.it/thumb/1.jpg",circuit:y.Yb.FORUMFREE,link:"help.forumfree.it"})}}return(t=o).\u0275fac=function(i){return new(i||t)(e.Y36(oe._),e.Y36(pe.d))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-list"]],features:[e.qOj],decls:5,vars:6,consts:[[3,"field","showError","removeItemObservable","searchFunction","resultsTemplate","additionalInputsTemplate","populateListEvent","selectItemEvent"],["forumList",""],["circuitSelect",""],["listTitle","Lista forum","defaultImage","https://uploads.forumfree.it/thumb/1.jpg",3,"list","removeEvent"],[3,"model","modelChange"]],template:function(i,r){if(1&i&&(e.TgZ(0,"app-formly-typeahead",0),e.NdJ("populateListEvent",function(g){return r.populateListEvent(g)})("selectItemEvent",function(g){return r.selectItemEvent(g)}),e.qZA(),e.YNc(1,St,1,1,"ng-template",null,1,e.W1O),e.YNc(3,At,1,1,"ng-template",null,2,e.W1O)),2&i){const l=e.MAs(2),g=e.MAs(4);e.Q6J("field",r.field)("showError",r.showError)("removeItemObservable",r.removeItemSubject)("searchFunction",r.search)("resultsTemplate",l)("additionalInputsTemplate",r.hasDomainSelect?g:void 0)}},dependencies:[Xe,ot,wt],encapsulation:2}),o})();function It(t,o){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"div",4),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.formControl.setValue(void 0))}),e._uU(2," highlight_off "),e.qZA(),e.BQk()}}function Zt(t,o){1&t&&(e.ynx(0),e.TgZ(1,"p",5),e._UZ(2,"span",6),e.qZA(),e.BQk())}function Pt(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&t){const n=o.$implicit;e.xp6(1),e.Q6J("ngValue",n.id)("innerHTML"," - "+n.name,e.oJD)}}function Vt(t,o){if(1&t&&(e.ynx(0),e.YNc(1,Pt,2,2,"ng-container",9),e.BQk()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",n.subsections)}}function Jt(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.YNc(2,Vt,2,1,"ng-container",1),e.BQk()),2&t){const n=o.$implicit;e.xp6(1),e.Q6J("ngValue",n.id)("innerHTML",n.name,e.oJD),e.xp6(1),e.Q6J("ngIf",n.subsections&&n.subsections.length)}}function Lt(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&t){const n=o.$implicit;e.xp6(1),e.Q6J("ngValue",n)("innerHTML"," -- Sezione ristretta -- #"+n,e.oJD)}}function Ut(t,o){if(1&t&&(e.ynx(0),e.YNc(1,Lt,2,2,"ng-container",9),e.BQk()),2&t){const n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",n.restrictedOrDeletedSections)}}function kt(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"select",8),e.YNc(2,Jt,3,3,"ng-container",9),e.YNc(3,Ut,2,1,"ng-container",1),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(1),e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(1),e.Q6J("ngForOf",n.sectionsList),e.xp6(1),e.Q6J("ngIf",n.restrictedOrDeletedSections.length>0)}}function Nt(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&t){const n=o.$implicit;e.xp6(1),e.Q6J("ngValue",n.id)("innerHTML"," - "+n.name,e.oJD)}}function Qt(t,o){if(1&t&&(e.ynx(0),e.YNc(1,Nt,2,2,"ng-container",9),e.BQk()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",n.subsections)}}function Rt(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.YNc(2,Qt,2,1,"ng-container",1),e.BQk()),2&t){const n=o.$implicit;e.xp6(1),e.Q6J("ngValue",n.id)("innerHTML",n.name,e.oJD),e.xp6(1),e.Q6J("ngIf",n.subsections&&n.subsections.length)}}function jt(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"option",10),e.BQk()),2&t){const n=o.$implicit;e.xp6(1),e.Q6J("ngValue",n)("innerHTML"," -- Sezione ristretta -- #"+n,e.oJD)}}function qt(t,o){if(1&t&&(e.ynx(0),e.YNc(1,jt,2,2,"ng-container",9),e.BQk()),2&t){const n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",n.restrictedOrDeletedSections)}}function Yt(t,o){if(1&t&&(e.TgZ(0,"select",11),e.YNc(1,Rt,3,3,"ng-container",9),e.YNc(2,qt,2,1,"ng-container",1),e.qZA()),2&t){const n=e.oxw(2);e.ekj("is-invalid",n.showError),e.Q6J("formControl",n.formControl)("formlyAttributes",n.field),e.xp6(1),e.Q6J("ngForOf",n.sectionsList),e.xp6(1),e.Q6J("ngIf",n.restrictedOrDeletedSections.length>0)}}function Gt(t,o){if(1&t&&(e.YNc(0,kt,4,6,"ng-container",2),e.YNc(1,Yt,3,6,"ng-template",null,7,e.W1O)),2&t){const n=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.field.props.multiple)("ngIfElse",n)}}const Ht=function(t){return{"no-label":t}};let $t=(()=>{var t;class o extends S.fS{constructor(i){super(),this.forumService=i,this.loading=!0,this.sectionsList=[],this.restrictedOrDeletedSections=[]}ngOnInit(){var i=this;return(0,R.Z)(function*(){i.field.defaultValue=void 0,i.field.props.hasOwnProperty("multiple")||(i.field.props.multiple=!0),i.restrictedOrDeletedSections=Array.isArray(i.field.formControl.value)?[...i.field.formControl.value]:[];const r=yield i.forumService.getSections();i.sectionsList=r.map(l=>{const g=i.restrictedOrDeletedSections.indexOf(l.id);return g>-1&&i.restrictedOrDeletedSections.splice(g,1),(0,C.Z)((0,C.Z)({},l),{subsections:i.flattenSubsections(l)})}),i.loading=!1,i.field.formControl.updateValueAndValidity()})()}flattenSubsections(i){let r=[],l=-1;if(i.subsections&&i.subsections.length)for(const g of i.subsections)l=this.restrictedOrDeletedSections.indexOf(g.id),l>-1&&this.restrictedOrDeletedSections.splice(l,1),r.push(g),g.subsections&&(r=[...r,...this.flattenSubsections(g)]);return r}}return(t=o).\u0275fac=function(i){return new(i||t)(e.Y36(oe._))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-sections"]],features:[e.qOj],decls:5,vars:6,consts:[[1,"position-relative","wrapper",3,"ngClass"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["formSelect",""],[1,"reset-icon","position-absolute","cursor-pointer","d-block","material-icons","text-danger",3,"click"],[1,"placeholder-glow"],[1,"placeholder","col-12","placeholder-lg"],["single",""],["multiple","",1,"form-select",3,"formControl","formlyAttributes"],[4,"ngFor","ngForOf"],[3,"ngValue","innerHTML"],[1,"form-select",3,"formControl","formlyAttributes"]],template:function(i,r){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,It,3,0,"ng-container",1),e.YNc(2,Zt,3,0,"ng-container",2),e.YNc(3,Gt,3,2,"ng-template",null,3,e.W1O),e.qZA()),2&i){const l=e.MAs(4);e.Q6J("ngClass",e.VKq(4,Ht,!r.props.label)),e.xp6(1),e.Q6J("ngIf",!r.props.label||void 0!==r.formControl.value),e.xp6(1),e.Q6J("ngIf",r.loading)("ngIfElse",l)}},dependencies:[_.mk,_.sg,_.O5,S.JD,f.YN,f.Kr,f.EJ,f.K7,f.JJ,f.oH],styles:[".reset-icon[_ngcontent-%COMP%]{right:0}.wrapper[_ngcontent-%COMP%]:not(.no-label)   .reset-icon[_ngcontent-%COMP%]{top:calc(-24px - .45rem)}.no-label[_ngcontent-%COMP%]{padding-top:calc(24px + .45rem)}.no-label[_ngcontent-%COMP%]   .reset-icon[_ngcontent-%COMP%]{top:0}"]}),o})(),Se=(()=>{var t;class o{transform(i){return he(i)}}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275pipe=e.Yjl({name:"decodeHtmlEntities",type:t,pure:!0}),o})();var Bt=m(7165),Wt=m(8418),Kt=m(4291),zt=m(9473);function Xt(t,o){1&t&&(e.TgZ(0,"span",8),e._uU(1,"*"),e.qZA())}function en(t,o){if(1&t&&(e.TgZ(0,"legend",5)(1,"label",6),e._uU(2),e.YNc(3,Xt,2,0,"span",7),e.qZA()()),2&t){const n=e.oxw();e.xp6(1),e.s9C("for",n.id),e.xp6(1),e.hij(" ",n.props.label," "),e.xp6(1),e.Q6J("ngIf",n.props.required)}}function tn(t,o){1&t&&e.GkF(0)}function nn(t,o){if(1&t&&e._UZ(0,"div",9),2&t){const n=e.oxw();e.Q6J("innerHTML",n.parsedDescription,e.oJD)}}function on(t,o){1&t&&(e.TgZ(0,"div",16)(1,"span",17),e._uU(2,"Loading..."),e.qZA()())}function rn(t,o){if(1&t&&(e.TgZ(0,"div",18),e._UZ(1,"formly-validation-message",19),e.qZA()),2&t){const n=e.oxw(2);e.Udp("display","block"),e.xp6(1),e.Q6J("field",n.field)}}function sn(t,o){1&t&&e._UZ(0,"app-loader",20)}function ln(t,o){1&t&&e._UZ(0,"div",25),2&t&&e.Q6J("innerText","Nessun utente inserito!")}function an(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"li")(1,"a",28)(2,"div",29),e.NdJ("click",function(r){const g=e.CHM(n).$implicit,A=e.oxw(4);return e.KtG(A.removeUser(g,r))}),e.TgZ(3,"div",30),e._uU(4," remove "),e.qZA()(),e._UZ(5,"img",31),e.ALo(6,"uploadsreplace"),e.qZA(),e._UZ(7,"a",32),e.qZA()}if(2&t){const n=o.$implicit,i=e.oxw(4);e.Gre("d-flex flex-column align-items-center user-",i.circuit,""),e.xp6(1),e.Q6J("href",i.baseUrl+n.uid.substring(2),e.LSH),e.xp6(1),e.Q6J("disableOnTouchDevice",!0),e.xp6(3),e.s9C("alt",n.nickname+"'s avatar"),e.Q6J("src",e.lcZ(6,9,n.avatar),e.LSH),e.xp6(2),e.Q6J("innerHTML",n.nickname,e.oJD)("href",i.baseUrl+n.uid.substring(2),e.LSH)}}function cn(t,o){if(1&t&&(e.TgZ(0,"ul",26),e.YNc(1,an,8,11,"li",27),e.qZA()),2&t){const n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",n.selectedUsers)}}const dn=function(t){return{"empty-list":t}};function un(t,o){if(1&t&&(e.TgZ(0,"fieldset",21)(1,"legend",22),e._uU(2," Lista utenti "),e.qZA(),e.YNc(3,ln,1,1,"div",23),e.YNc(4,cn,2,1,"ng-template",null,24,e.W1O),e.qZA()),2&t){const n=e.MAs(5),i=e.oxw(2);e.Q6J("ngClass",e.VKq(3,dn,0===i.selectedUsers.length)),e.xp6(3),e.Q6J("ngIf",0===i.selectedUsers.length)("ngIfElse",n)}}function mn(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"div",10)(1,"input",11),e.NdJ("ngModelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.inputValue=r)})("selectItem",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.selectUser(r))})("focus",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.focus.next(r.target.value))}),e.qZA(),e.YNc(2,on,3,0,"div",12),e.qZA(),e.YNc(3,rn,2,3,"div",13),e.YNc(4,sn,1,0,"app-loader",14),e.YNc(5,un,6,5,"ng-template",null,15,e.W1O)}if(2&t){const n=e.MAs(6),i=e.oxw();e.xp6(1),e.ekj("is-invalid",i.showError),e.Q6J("ngModel",i.inputValue)("formlyAttributes",i.field)("ngbTypeahead",i.search)("editable",!1)("inputFormatter",i.inputFormatter)("resultFormatter",i.outputFormatter),e.xp6(1),e.Q6J("ngIf",i.searching),e.xp6(1),e.Q6J("ngIf",i.showError),e.xp6(1),e.Q6J("ngIf",i.loading)("ngIfElse",n)}}let pn=(()=>{var t;class o extends S.fS{constructor(i,r,l,g,A,D){var k;if(super(),this.userService=i,this.globalsService=r,this.changeDetectorRef=l,this.toastService=g,this.customFormUtilsService=A,this.decodeHtmlEntitiesPipe=D,this.inputValue="",this.selectedUsers=[],this.loading=!0,this.searching=!1,this.focus=new re.x,this.parsedDescription="",this.formlyFieldValues=[],this.lastSearchedValueWithoutResult="",this.outputFormatter=j=>j?j.nickname.indexOf("&")>-1?this.decodeHtmlEntitiesPipe.transform(j.nickname):j.nickname:"",this.search=j=>{const ne=j.pipe((0,_e.b)(1e3),(0,ye.x)());return(0,ve.T)(ne,this.focus).pipe((0,K.b)(()=>this.setSearching(!0)),(0,xe.w)(Ie=>Ie.length<3?(0,Fe.of)([]):this.getUsers(Ie)),(0,K.b)(()=>this.setSearching(!1)))},this.circuit=(null===(k=this.globalsService.credentials)||void 0===k?void 0:k.site.short)||"",!this.circuit)throw new Error("Missing credentials!");this.baseUrl=Bt.hD[this.circuit]+"/?act=Profile&MID="}ngOnInit(){var i=this;return(0,R.Z)(function*(){i.parsedDescription=i.props.description?i.customFormUtilsService.parseBBCode(i.props.description):"",i.formlyFieldValues=Array.isArray(i.formControl.value)?i.formControl.value:Array.isArray(i.field.defaultValue)?i.field.defaultValue:[],yield i.getSelectedUsersFromApi(),i.loading=!1,i.formControl.updateValueAndValidity(),i.formControl.registerOnChange(()=>{i.formControlChangeCallback()})})()}inputFormatter(i){return i.nickname}getUsers(i){var r=this;return(0,R.Z)(function*(){if(r.lastSearchedValueWithoutResult&&0===i.indexOf(r.lastSearchedValueWithoutResult))return[];const l=yield r.userService.searchUserByName(i);return 0===l.length&&(r.lastSearchedValueWithoutResult=i),l})()}setSearching(i){this.searching=i,this.changeDetectorRef.detectChanges()}selectUser(i){const r=i.item,l=Number(r.uid.substring(2));if(this.formlyFieldValues.includes(l))return this.toastService.show({content:`L'utente <strong>${r.nickname}</strong> \xe8 gi\xe0 stato aggiunto alla lista!`}),void(this.inputValue="");this.formlyFieldValues.push(l),this.selectedUsers.push(r),i.preventDefault(),this.inputValue="",this.formControl.setValue([...this.formlyFieldValues])}removeUser(i,r){r.preventDefault(),r.stopPropagation();const l=Number(i.uid.substring(2));this.formlyFieldValues=this.formlyFieldValues.filter(g=>g!==l),this.selectedUsers=this.selectedUsers.filter(g=>g.uid!==i.uid),this.formControl.setValue([...this.formlyFieldValues])}formControlChangeCallback(){var i=this;return(0,R.Z)(function*(){if(!Array.isArray(i.formControl.value))return;let r=!1;if(i.formControl.value.length!==i.formlyFieldValues.length)r=!0;else for(const l of i.formControl.value)if(!i.formlyFieldValues.includes(l)){r=!0;break}r&&(i.formlyFieldValues=i.formControl.value,i.loading=!0,i.changeDetectorRef.detectChanges(),yield i.getSelectedUsersFromApi(),i.loading=!1,i.changeDetectorRef.detectChanges())})()}getSelectedUsersFromApi(){var i=this;return(0,R.Z)(function*(){i.selectedUsers=0!==i.formlyFieldValues.length?(yield i.userService.getDetailsFromUids(i.formlyFieldValues.map(r=>i.circuit+r))).sort((r,l)=>r.nickname>l.nickname?1:l.nickname>r.nickname?-1:0):[]})()}}return(t=o).\u0275fac=function(i){return new(i||t)(e.Y36(Wt.K),e.Y36(pe.d),e.Y36(e.sBO),e.Y36(we.k),e.Y36(y.d6),e.Y36(Se))},t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-forum-users"]],features:[e._Bn([Se]),e.qOj],decls:6,vars:5,consts:[[1,"mb-3","rounded","px-3","pt-2","pb-3","formly-fieldset"],["class","legend-reset fs-reset mb-0 px-2 mw-100 lh-1 py-1",4,"ngIf"],[4,"ngTemplateOutlet"],["class","form-text text-muted",3,"innerHTML",4,"ngIf"],["fieldContet",""],[1,"legend-reset","fs-reset","mb-0","px-2","mw-100","lh-1","py-1"],[1,"form-label","mb-0","mw-100","text-truncate",3,"for"],["aria-hidden","true",4,"ngIf"],["aria-hidden","true"],[1,"form-text","text-muted",3,"innerHTML"],[1,"position-relative"],["type","text","container","body",1,"form-control",3,"ngModel","formlyAttributes","ngbTypeahead","editable","inputFormatter","resultFormatter","ngModelChange","selectItem","focus"],["class","spinner-border spinner-border-sm text-primary position-absolute","role","status",4,"ngIf"],["class","invalid-feedback",3,"display",4,"ngIf"],["message","Recupero utenti","class","d-block mt-3",4,"ngIf","ngIfElse"],["userList",""],["role","status",1,"spinner-border","spinner-border-sm","text-primary","position-absolute"],[1,"visually-hidden"],[1,"invalid-feedback"],[3,"field"],["message","Recupero utenti",1,"d-block","mt-3"],[1,"formly-user-list-container","rounded","px-3","pt-2","mb-3","mt-2",3,"ngClass"],[1,"legend-reset","fs-reset","mb-0","px-2","pb-1"],["class","alert alert-primary text-center mb-0 fw-bold",3,"innerText",4,"ngIf","ngIfElse"],["noEmpty",""],[1,"alert","alert-primary","text-center","mb-0","fw-bold",3,"innerText"],[1,"formly-user-list","list-unstyled","mb-0","d-grid","px-2"],[3,"class",4,"ngFor","ngForOf"],["target","_blank",1,"avatar-container","rounded-circle","d-block","position-relative",3,"href"],["appTippy","Rimuovi",1,"remove-user","alert","alert-danger","position-absolute","cursor-pointer","mb-0","py-0","px-1",3,"disableOnTouchDevice","click"],[1,"material-icons","d-block","fs-reset"],["appImage","",1,"d-block","image-cover","rounded-circle",3,"src","alt"],["target","_blank",1,"d-block","fw-bold","mt-1","nickname","text-truncate","mw-100",3,"innerHTML","href"]],template:function(i,r){if(1&i&&(e.TgZ(0,"fieldset",0),e.YNc(1,en,4,3,"legend",1),e.YNc(2,tn,1,0,"ng-container",2),e.YNc(3,nn,1,1,"div",3),e.qZA(),e.YNc(4,mn,7,12,"ng-template",null,4,e.W1O)),2&i){const l=e.MAs(5);e.ekj("has-error",r.formControl.invalid),e.xp6(1),e.Q6J("ngIf",r.props.label),e.xp6(1),e.Q6J("ngTemplateOutlet",l),e.xp6(1),e.Q6J("ngIf",r.parsedDescription)}},dependencies:[_.mk,_.sg,_.O5,_.tP,S.JD,S.M2,f.Fj,f.JJ,f.On,Kt.t,zt.R,te.dR,Z.$,ge.g],styles:[".spinner-border[_ngcontent-%COMP%]{top:calc(50% - 8px);right:10px}fieldset.formly-user-list-container[_ngcontent-%COMP%]{border:1px dashed var(--bs-gray-500)}fieldset.formly-user-list-container[_ngcontent-%COMP%]:not(.empty-list){padding-bottom:.75rem}fieldset.formly-user-list-container.empty-list[_ngcontent-%COMP%]{padding-bottom:1rem}.formly-user-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(60px,1fr));gap:1rem}.formly-user-list[_ngcontent-%COMP%]   .remove-user[_ngcontent-%COMP%]{top:0;left:-8px}.formly-user-list[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{width:60px;height:60px;border:2px solid}.formly-user-list[_ngcontent-%COMP%]   .user-ff[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{border-color:#58a72e}.formly-user-list[_ngcontent-%COMP%]   .user-ff[_ngcontent-%COMP%]   .nickname[_ngcontent-%COMP%]{color:#58a72e!important}.formly-user-list[_ngcontent-%COMP%]   .user-fc[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{border-color:#0082cd}.formly-user-list[_ngcontent-%COMP%]   .user-fc[_ngcontent-%COMP%]   .nickname[_ngcontent-%COMP%]{color:#0082cd!important}.formly-user-list[_ngcontent-%COMP%]   .user-bf[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{border-color:#e67f22}.formly-user-list[_ngcontent-%COMP%]   .user-bf[_ngcontent-%COMP%]   .nickname[_ngcontent-%COMP%]{color:#e67f22!important}@media (min-width: 960px){.formly-user-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(75px,1fr));gap:1.5rem}.formly-user-list[_ngcontent-%COMP%]   .remove-user[_ngcontent-%COMP%]{top:4px}.formly-user-list[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{width:75px;height:75px}}"]}),o})(),fn=(()=>{var t;class o extends S.fS{constructor(){super(...arguments),this.defaultOptions={props:{label:""}}}}return(t=o).\u0275fac=function(){let n;return function(r){return(n||(n=e.n5z(t)))(r||t)}}(),t.\u0275cmp=e.Xpm({type:t,selectors:[["formly-field-label"]],features:[e.qOj],decls:2,vars:1,template:function(i,r){1&i&&(e.TgZ(0,"h5"),e._uU(1),e.qZA()),2&i&&(e.xp6(1),e.Oqu(r.props.label))},encapsulation:2,changeDetection:0}),o})(),gn=(()=>{var t;class o{}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[_.ez,f.u5]}),o})();var Ae=m(3038),De=m(5063);let hn=(()=>{var t;class o{}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[_.ez,fe.mZ,Ae.G,De.g]}),o})(),_n=(()=>{var t;class o{}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[_.ez,S.X0.forChild(),f.u5,te.ZS]}),o})(),yn=(()=>{var t;class o{}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[_.ez,gn,hn,_n]}),o})();var vn=m(4295);let xn=(()=>{var t;class o{}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[_.ez,L.Vy,L.d3,S.X0.forChild({types:[{name:"array",component:u},{name:"code-editor",component:Qe,wrappers:["form-field"]},{name:"forum-groups",component:We,wrappers:["form-field"]},{name:"forum-sections",component:$t,wrappers:["form-field"]},{name:"label",component:fn},{name:"forum-users",component:pn},{name:"forum-list",component:Dt}]}),f.u5,yn,vn.$,L.q,Je,te.ZS,Ae.G,De.g]}),o})()},336:(ue,Y,m)=>{m.d(Y,{c:()=>J});var _=m(9376),L=m(91),y=m(1413),S=m(5879),e=m(6223),Z=m(5545),G=m(9397);const H=["key"],$=["allOf"];function M(x){return""===x||null==x}function V(x){return null!=x&&"object"==typeof x&&!Array.isArray(x)}function N(x){return Number.isInteger?Number.isInteger(x):"number"==typeof x&&Math.floor(x)===x}function c(x){return"object"==typeof x&&(x.hasOwnProperty("const")||x.enum&&1===x.enum.length)}function v(x){if(!x.fieldGroup)return(0,Z._S)(x)&&void 0!==(0,Z.Hl)(x)?1:0;const E=x.fieldGroup.reduce((s,h)=>v(h)+s,0);if(0===E&&(0,Z._S)(x)){const s=(0,Z.Hl)(x);if(null===s||void 0!==s&&(x.fieldArray&&Array.isArray(s)||!x.fieldArray&&V(s)))return 1}return E}let J=(()=>{class x{toFieldConfig(s,h){return s=(0,Z.kg)(s),this._toFieldConfig(s,(0,y.Z)({schema:s},h||{}))}_toFieldConfig(s,h){var O;let{key:b}=h,d=(0,L.Z)(h,H);s=this.resolveSchema(s,d);const F=this.guessSchemaType(s);let a={type:F[0],defaultValue:s.default,props:{label:s.title,readonly:s.readOnly,description:s.description}};switch(null!=b&&(a.key=b),!d.ignoreDefault&&(s.readOnly||d.readOnly)&&(a.props.disabled=!0,d=(0,y.Z)((0,y.Z)({},d),{},{readOnly:!0})),d.resetOnHide&&(a.resetOnHide=!0),b&&d.strict&&this.addValidator(a,"type",(u,C)=>{const p=(0,Z.Hl)(C);if(null!=p)switch(a.type){case"string":return"string"==typeof p;case"integer":return N(p);case"number":return"number"==typeof p;case"object":return V(p);case"array":return Array.isArray(p)}return!0}),!1===d.shareFormControl&&(a.shareFormControl=!1),d.ignoreDefault&&delete a.defaultValue,this.addValidator(a,"type",{schemaType:F,expression:({value:u})=>{if(void 0===u||null===u&&-1!==F.indexOf("null"))return!0;switch(F[0]){case"null":return null===typeof u;case"string":return"string"==typeof u;case"integer":return N(u);case"number":return"number"==typeof u;case"object":return V(u);case"array":return Array.isArray(u)}return!0}}),a.type){case"number":case"integer":a.parsers=[u=>M(u)?u:Number(u)],s.hasOwnProperty("minimum")&&(a.props.min=s.minimum),s.hasOwnProperty("maximum")&&(a.props.max=s.maximum),s.hasOwnProperty("exclusiveMinimum")&&(a.props.exclusiveMinimum=s.exclusiveMinimum,this.addValidator(a,"exclusiveMinimum",({value:u})=>M(u)||u>s.exclusiveMinimum)),s.hasOwnProperty("exclusiveMaximum")&&(a.props.exclusiveMaximum=s.exclusiveMaximum,this.addValidator(a,"exclusiveMaximum",({value:u})=>M(u)||u<s.exclusiveMaximum)),s.hasOwnProperty("multipleOf")&&(a.props.step=s.multipleOf,this.addValidator(a,"multipleOf",({value:u})=>{if(M(u)||"number"!=typeof u||0===u||s.multipleOf<=0)return!0;const C=Math.pow(10,function B(x){if(!isFinite(x))return 0;let E=1,s=0;for(;Math.round(x*E)/E!==x;)E*=10,s++;return s}(s.multipleOf));return Math.round(u*C)%Math.round(s.multipleOf*C)==0}));break;case"string":a.parsers=[u=>(-1!==F.indexOf("null")?u=M(u)?null:u:a.props.required||(u=""===u?void 0:u),u)],["minLength","maxLength","pattern"].forEach(u=>{s.hasOwnProperty(u)&&(a.props[u]=s[u])});break;case"object":{a.fieldGroup||(a.fieldGroup=[]);const{propDeps:u,schemaDeps:C}=this.resolveDependencies(s);Object.keys(s.properties||{}).forEach(p=>{const f=Array.isArray(s.required)&&-1!==s.required.indexOf(p),I=this._toFieldConfig(s.properties[p],(0,y.Z)((0,y.Z)({},d),{},{key:p,isOptional:d.isOptional||!f}));if(a.fieldGroup.push(I),(f||u[p])&&(I.expressions=(0,y.Z)((0,y.Z)({},I.expressions||{}),{},{"props.required":P=>{let T=P.parent;const w=P.fieldGroup&&null!=P.key?T.model:P.model;for(;null==T.key&&T.parent;)T=T.parent;return!!(w||T&&T.props&&T.props.required)&&(!(!Array.isArray(s.required)||-1===s.required.indexOf(p))||u[p]&&P.model&&u[p].some(W=>!M(P.model[W])))}})),C[p]){const P=w=>w.hasOwnProperty("const")?w.const:w.enum[0],T=C[p].oneOf;T&&T.every(w=>w.properties&&w.properties[p]&&c(w.properties[p]))?T.forEach(w=>{const Q=w.properties,{[p]:W}=Q,me=(0,L.Z)(Q,[p].map(_.Z));a.fieldGroup.push((0,y.Z)((0,y.Z)({},this._toFieldConfig((0,y.Z)((0,y.Z)({},w),{},{properties:me}),(0,y.Z)((0,y.Z)({},d),{},{shareFormControl:!1,resetOnHide:!0}))),{},{expressions:{hide:ie=>!ie.model||P(W)!==ie.model[p]}}))}):a.fieldGroup.push((0,y.Z)((0,y.Z)({},this._toFieldConfig(C[p],d)),{},{expressions:{hide:w=>!w.model||M(w.model[p])}}))}}),s.oneOf&&a.fieldGroup.push(this.resolveMultiSchema("oneOf",s.oneOf,(0,y.Z)((0,y.Z)({},d),{},{shareFormControl:!1}))),s.anyOf&&a.fieldGroup.push(this.resolveMultiSchema("anyOf",s.anyOf,d));break}case"array":s.hasOwnProperty("minItems")&&(a.props.minItems=s.minItems,this.addValidator(a,"minItems",(u,C)=>{const p=(0,Z.Hl)(C);return M(p)||p.length>=s.minItems}),!d.isOptional&&s.minItems>0&&void 0===a.defaultValue&&(a.defaultValue=Array.from(new Array(s.minItems)))),s.hasOwnProperty("maxItems")&&(a.props.maxItems=s.maxItems,this.addValidator(a,"maxItems",(u,C)=>{const p=(0,Z.Hl)(C);return M(p)||p.length<=s.maxItems})),s.hasOwnProperty("uniqueItems")&&(a.props.uniqueItems=s.uniqueItems,this.addValidator(a,"uniqueItems",(u,C)=>{const p=(0,Z.Hl)(C);return!(!M(p)&&s.uniqueItems)||Array.from(new Set(p.map(I=>JSON.stringify(I,(P,T)=>V(T)?Object.keys(I).sort().reduce((w,Q)=>(w[Q]=I[Q],w),{}):T)))).length===p.length})),s.items&&!Array.isArray(s.items)&&(s.items=this.resolveSchema(s.items,d)),this.isEnum(s)||(a.fieldArray=u=>{const C=s.items;if(!Array.isArray(C)){if(!C)return{};const P=C.oneOf||C.anyOf,T=this._toFieldConfig(C,P?(0,y.Z)((0,y.Z)({},d),{},{key:`${u.fieldGroup.length}`}):d);return P&&!(0,Z._S)(T)&&(T.key=null),T.props.required=!0,T}const p=u.fieldGroup?u.fieldGroup.length:0,f=C[p]?C[p]:s.additionalItems,I=f?this._toFieldConfig(f,d):{};return I.props&&(I.props.required=!0),C[p]&&(I.props.removable=!1),I})}if(s.hasOwnProperty("const")&&(a.props.const=s.const,this.addValidator(a,"const",({value:u})=>u===s.const),a.type||(a.defaultValue=s.const)),this.isEnum(s)){const u=this.toEnumOptions(s),C="array"===a.type;a.type="enum",a.props.multiple=C,a.props.options=u;const p=u.map(f=>f.value);this.addValidator(a,"enum",({value:f})=>void 0===f||(C?!!Array.isArray(f)&&f.every(I=>p.includes(I)):p.includes(f)))}return s.oneOf&&!a.type&&(delete a.key,a.fieldGroup=[this.resolveMultiSchema("oneOf",s.oneOf,(0,y.Z)((0,y.Z)({},d),{},{key:b,shareFormControl:!1}))]),s.oneOf&&!a.type&&(delete a.key,a.fieldGroup=[this.resolveMultiSchema("oneOf",s.oneOf,(0,y.Z)((0,y.Z)({},d),{},{key:b,shareFormControl:!1}))]),null!==(O=s.widget)&&void 0!==O&&O.formlyConfig&&(a=this.mergeFields(a,s.widget.formlyConfig)),a.templateOptions=a.props,d.map?d.map(a,s):a}resolveSchema(s,h){return s&&s.$ref&&(s=this.resolveDefinition(s,h)),s&&s.allOf&&(s=this.resolveAllOf(s,h)),s}resolveAllOf(s,h){let{allOf:O}=s,b=(0,L.Z)(s,$);if(!O.length)throw Error(`allOf array can not be empty ${O}.`);return O.reduce((d,F)=>(F=this.resolveSchema(F,h),d.required&&F.required&&(d.required=[...d.required,...F.required]),F.uniqueItems&&(d.uniqueItems=F.uniqueItems),["maxLength","maximum","exclusiveMaximum","maxItems","maxProperties"].forEach(a=>{!M(d[a])&&!M(F[a])&&(d[a]=d[a]<F[a]?d[a]:F[a])}),["minLength","minimum","exclusiveMinimum","minItems","minProperties"].forEach(a=>{!M(d[a])&&!M(F[a])&&(d[a]=d[a]>F[a]?d[a]:F[a])}),(0,Z.Du)(d,F)),b)}resolveMultiSchema(s,h,O){return{type:"multischema",fieldGroup:[{type:"enum",defaultValue:-1,props:{multiple:"anyOf"===s,options:h.map((b,d)=>({label:b.title,value:d,disabled:b.readOnly}))},hooks:{onInit:b=>b.formControl.valueChanges.pipe((0,G.b)(()=>b.options.detectChanges(b.parent)))}},{fieldGroup:h.map((b,d)=>(0,y.Z)((0,y.Z)({},this._toFieldConfig(b,(0,y.Z)((0,y.Z)({},O),{},{resetOnHide:!0}))),{},{expressions:{hide:(F,a)=>{const u=F.parent.parent.fieldGroup[0].formControl;if(-1===u.value||a){let C=F.parent.fieldGroup.map((p,f)=>[p,f,this.isFieldValid(p,f,h,O)]).sort(([p,,f],[I,,P])=>{if(f!==P)return P?1:-1;const T=v(p),w=v(I);return T===w&&p.props.disabled===I.props.disabled?0:w>T?1:-1}).map(([,p])=>p);if("anyOf"===s){const p=C.filter(f=>v(F.parent.fieldGroup[f]));C=p.length>0?p:[C[0]||0]}C=C.length>0?C:[0],u.setValue("anyOf"===s?C:C[0])}return Array.isArray(u.value)?-1===u.value.indexOf(d):u.value!==d}}}))}]}}resolveDefinition(s,h){const[O,b]=s.$ref.split("#/");if(O)throw Error(`Remote schemas for ${s.$ref} not supported yet.`);const d=b?b.split("/").reduce((F,a)=>null!=F&&F.hasOwnProperty(a)?F[a]:null,h.schema):null;if(!d)throw Error(`Cannot find a definition for ${s.$ref}.`);return d.$ref?this.resolveDefinition(d,h):(0,y.Z)((0,y.Z)({},d),["title","description","default","widget"].reduce((F,a)=>(s.hasOwnProperty(a)&&(F[a]=s[a]),F),{}))}resolveDependencies(s){const h={},O={};return Object.keys(s.dependencies||{}).forEach(b=>{const d=s.dependencies[b];Array.isArray(d)?d.forEach(F=>{h[F]?h[F].push(b):h[F]=[b]}):O[b]=d}),{propDeps:h,schemaDeps:O}}guessSchemaType(s){const h=null==s?void 0:s.type;return!h&&null!=s&&s.properties?["object"]:Array.isArray(h)?1===h.length?h:2===h.length&&-1!==h.indexOf("null")?h.sort(O=>"null"==O?1:-1):h:h?[h]:[]}addValidator(s,h,O){s.validators=s.validators||{},s.validators[h]=O}isEnum(s){return!!s.enum||s.anyOf&&s.anyOf.every(c)||s.oneOf&&s.oneOf.every(c)||s.uniqueItems&&s.items&&!Array.isArray(s.items)&&this.isEnum(s.items)}toEnumOptions(s){if(s.enum)return s.enum.map(O=>({value:O,label:O}));const h=O=>{const b=O.hasOwnProperty("const")?O.const:O.enum[0],d={value:b,label:O.title||b};return O.readOnly&&(d.disabled=!0),d};return s.anyOf?s.anyOf.map(h):s.oneOf?s.oneOf.map(h):this.toEnumOptions(s.items)}isFieldValid(s,h,O,b){const d=O[h];d._field||Object.defineProperty(d,"_field",{enumerable:!1,writable:!0,configurable:!0});let F=d._field;const a=s.model?(0,Z.kg)(s.model):s.fieldArray?[]:{};return F?(F.model=a,s.options.build(F)):F=d._field=s.options.build({form:Array.isArray(a)?new e.Oe([]):new e.cw({}),fieldGroup:[this._toFieldConfig(d,(0,y.Z)((0,y.Z)({},b),{},{resetOnHide:!0,ignoreDefault:!0,map:null,strict:!0}))],model:a,options:{}}),F.form.valid}mergeFields(s,h){for(let O in h){const b="templateOptions"===O?"props":O;V(s[b])&&V(h[O])?s[b]=this.mergeFields(s[b],h[O]):null!=h[O]&&(s[b]=h[O])}return s}}return x.\u0275fac=function(s){return new(s||x)},x.\u0275prov=S.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"}),x})()}}]);