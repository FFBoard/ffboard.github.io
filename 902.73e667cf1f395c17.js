(self.webpackChunkpages=self.webpackChunkpages||[]).push([[902],{3285:(pt,Te,_)=>{"use strict";_.d(Te,{L:()=>U});var _e=_(2721),b=_(7165),w=_(9212);let De=(()=>{var P;class W{constructor(){this.dependencies={[b.B2.LOGIN]:null,[b.B2.HOME]:null,[b.B2.SETTINGS]:b.B2.HOME,[b.B2.SCRIPT]:b.B2.HOME,[b.B2.SCRIPT_FORUM]:b.B2.SCRIPT,[b.B2.SCRIPT_USER]:b.B2.SCRIPT,[b.B2.SCRIPT_SETTINGS]:[b.B2.SCRIPT_USER,b.B2.SCRIPT_FORUM],[b.B2.SCRIPT_SANDBOX]:[b.B2.SCRIPT_USER,b.B2.SCRIPT_FORUM],[b.B2.SCRIPT_DEV]:b.B2.SCRIPT,[b.B2.SCRIPT_DEV_SETTINGS]:b.B2.SCRIPT_DEV,[b.B2.UPLOAD]:b.B2.HOME,[b.B2.ADMIN]:b.B2.HOME,[b.B2.STATS]:b.B2.HOME,[b.B2.STATS_UPLOAD]:b.B2.STATS},this.names={[b.B2.LOGIN]:"Login",[b.B2.HOME]:"Home",[b.B2.SETTINGS]:"Notifiche",[b.B2.SCRIPT]:"Script",[b.B2.SCRIPT_FORUM]:"Forum",[b.B2.SCRIPT_USER]:"Utenti",[b.B2.SCRIPT_SETTINGS]:"Impostazioni",[b.B2.SCRIPT_SANDBOX]:"Altro",[b.B2.SCRIPT_DEV]:"Sviluppo",[b.B2.SCRIPT_DEV_SETTINGS]:"Impostazioni",[b.B2.UPLOAD]:"Upload",[b.B2.ADMIN]:"Amministrazione",[b.B2.STATS]:"Statistiche",[b.B2.STATS_UPLOAD]:"Upload"}}createPathList(q,K=[]){const J=(E,we)=>{E.unshift({name:this.names[we]||"",path:we})},ye=E=>(0,_e.o8)(this.dependencies,E)?this.dependencies[E]instanceof Array?this.dependencies[E].includes(K[0])?K.shift():this.dependencies[E][0]:this.dependencies[E]:null,Me=[{name:this.names[q]||"",path:""}];let ve=ye(q);for(;ve;)J(Me,ve),ve=ye(ve);return Me}}return(P=W).\u0275fac=function(q){return new(q||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),W})();var f=_(4190),ne=_(6814);function D(P,W){if(1&P&&w._UZ(0,"a",8),2&P){const I=w.oxw().$implicit;w.Q6J("routerLink",I.path)("innerText",I.name)}}function e(P,W){if(1&P&&w._UZ(0,"span",9),2&P){const I=w.oxw().$implicit;w.Q6J("innerText",I.name)}}const fe=P=>({active:P});function he(P,W){if(1&P&&(w.TgZ(0,"li",5),w.YNc(1,D,1,2,"a",6)(2,e,1,1,"ng-template",null,7,w.W1O),w.qZA()),2&P){const I=W.last,q=w.MAs(3);w.Q6J("ngClass",w.VKq(4,fe,I)),w.uIk("aria-current",I?"page":null),w.xp6(),w.Q6J("ngIf",!I)("ngIfElse",q)}}const Fe=P=>({"hide-nav":P}),Ze=P=>({"d-none d-md-block":P});let U=(()=>{var P;class W{constructor(q,K){this.breadcrumbService=q,this.router=K,this.pageTitle="",this.url="",this.nodes=[],this.hideNavOnSmallScreen=!1,this.breadcrumbs=[]}ngOnInit(){this.url||(this.url=this.router.url),this.breadcrumbs=this.breadcrumbService.createPathList(this.url,this.nodes)}}return(P=W).\u0275fac=function(q){return new(q||P)(w.Y36(De),w.Y36(f.F0))},P.\u0275cmp=w.Xpm({type:P,selectors:[["app-breadcrumb"]],inputs:{pageTitle:"pageTitle",url:"url",nodes:"nodes",hideNavOnSmallScreen:"hideNavOnSmallScreen"},decls:5,vars:8,consts:[[1,"container-fluid","px-md-1","d-flex","flex-column","flex-md-row","align-items-md-center",3,"ngClass"],[1,"h3","fw-light","mb-0","lh-1","fv-small-caps","pb-1",3,"innerText"],["aria-label","breadcrumb",1,"ms-md-auto","mt-1","flex-shrink-0",3,"ngClass"],[1,"breadcrumb","mb-0","justify-content-md-end"],["class","breadcrumb-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"breadcrumb-item",3,"ngClass"],[3,"routerLink","innerText",4,"ngIf","ngIfElse"],["lastItem",""],[3,"routerLink","innerText"],[3,"innerText"]],template:function(q,K){1&q&&(w.TgZ(0,"div",0),w._UZ(1,"h2",1),w.TgZ(2,"nav",2)(3,"ol",3),w.YNc(4,he,4,6,"li",4),w.qZA()()()),2&q&&(w.Q6J("ngClass",w.VKq(4,Fe,K.hideNavOnSmallScreen)),w.xp6(),w.Q6J("innerText",K.pageTitle),w.xp6(),w.Q6J("ngClass",w.VKq(6,Ze,K.hideNavOnSmallScreen)),w.xp6(2),w.Q6J("ngForOf",K.breadcrumbs))},dependencies:[ne.mk,ne.sg,ne.O5,f.rH],styles:[".container-fluid[_ngcontent-%COMP%]:not(.hide-nav){margin-bottom:.75rem}.container-fluid.hide-nav[_ngcontent-%COMP%]{margin-bottom:.5rem}@media (min-width: 768px){.container-fluid.hide-nav[_ngcontent-%COMP%]{margin-bottom:.75rem}}@media (min-width: 960px){.container-fluid[_ngcontent-%COMP%]{margin-top:.5rem}}"]}),W})()},9090:(pt,Te,_)=>{"use strict";_.d(Te,{w:()=>De});var _e=_(6814),b=_(4190),w=_(9212);let De=(()=>{var f;class ne{}return(f=ne).\u0275fac=function(e){return new(e||f)},f.\u0275mod=w.oAB({type:f}),f.\u0275inj=w.cJS({imports:[_e.ez,b.Bz]}),ne})()},4902:(pt,Te,_)=>{"use strict";_.r(Te),_.d(Te,{UploadModule:()=>Fa});var _e=_(8225),b=_(4243),w=_(9090),De=_(342),f=_(6814),ne=_(4041),D=_(6223),e=_(9212);let fe=(()=>{var s;class n{}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[f.ez]}),n})();var he=_(4101),Fe=_(578),Ze=_(4610),U=_(8726),P=_(4190);const W={suffixAgo:"fa",suffixFromNow:"da ora",seconds:"meno di un minuto",minute:"circa un minuto",minutes:"%d minuti",hour:"circa un'ora",hours:"circa %d ore",day:"un giorno",days:"%d giorni",month:"circa un mese",months:"%d mesi",year:"circa un anno",years:"%d anni"};var I=_(9360),q=_(564);function K(s,n=1/0,o){return n=(n||0)<1?1/0:n,(0,I.e)((t,i)=>(0,q.p)(t,i,s,n,void 0,!0,o))}var J=_(836),ye=_(2096),Me=_(4825),ve=_(6232),E=_(8645),we=_(2181);let qe=(()=>{var s;class n{constructor(){this.changes=new E.x}}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),n})();const Ut=function(s){const n=Date.now(),o=Math.round(Math.abs(n-s)/1e3),t=s<n?"ago":"from now",[i,r]=o<60?[Math.round(o),"second"]:o<3600?[Math.round(o/60),"minute"]:o<86400?[Math.round(o/3600),"hour"]:o<604800?[Math.round(o/86400),"day"]:o<2592e3?[Math.round(o/604800),"week"]:o<31536e3?[Math.round(o/2592e3),"month"]:[Math.round(o/31536e3),"year"];return{value:i,unit:r,suffix:t}};class Oe{}let It=(()=>{var s;class n extends Oe{format(t){const{suffix:i,value:r,unit:a}=Ut(t);return this.parse(r,a,i)}parse(t,i,r){return 1!==t&&(i+="s"),t+" "+i+" "+r}}return(s=n).\u0275fac=(()=>{let o;return function(i){return(o||(o=e.n5z(s)))(i||s)}})(),s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),n})(),oi=(()=>{var s;class n extends Oe{constructor(t){super(),this.intl=t}format(t){const{suffix:i,value:r,unit:a}=Ut(t);return this.parse(r,a,i,Date.now(),t)}parse(t,i,r,a,d){"week"===i&&!this.intl.strings.week&&!this.intl.strings.weeks&&(t=Math.round(Math.abs(a-d)/864e5),i="day");const h=this.normalizeFn(t,a-d,this.intl.strings.numbers),g=[];return"ago"===r&&this.intl.strings.prefixAgo&&g.push(h(this.intl.strings.prefixAgo)),"from now"===r&&this.intl.strings.prefixFromNow&&g.push(h(this.intl.strings.prefixFromNow)),g.push(h(t>1?this.intl.strings[i+"s"]||this.intl.strings[i]||"%d "+i:this.intl.strings[i]||this.intl.strings[i+"s"]||"%d "+i)),"ago"===r&&this.intl.strings.suffixAgo&&g.push(h(this.intl.strings.suffixAgo)),"from now"===r&&this.intl.strings.suffixFromNow&&g.push(h(this.intl.strings.suffixFromNow)),g.join("string"==typeof this.intl.strings.wordSeparator?this.intl.strings.wordSeparator:" ")}normalizeNumber(t,i){return t&&10===t.length?String(i).split("").map(r=>r.match(/^[0-9]$/)?t[parseInt(r,10)]:r).join(""):String(i)}normalizeFn(t,i,r){return a=>"function"==typeof a?a(t,i).replace(/%d/g,this.normalizeNumber(r,t)):a.replace(/%d/g,this.normalizeNumber(r,t))}}return(s=n).\u0275fac=function(t){return new(t||s)(e.LFG(qe))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),n})();class se{}let Dt=(()=>{var s;class n extends se{tick(t){return(0,ye.of)(0).pipe(K(()=>{const i=Date.now(),r=Math.round(Math.abs(i-t)/1e3),a=r<60?1e3:r<3600?6e4:r<86400?36e5:0;return a?(0,Me.H)(a):(0,ve.c)()}),(0,J.T)(1))}}return(s=n).\u0275fac=(()=>{let o;return function(i){return(o||(o=e.n5z(s)))(i||s)}})(),s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),n})(),et=(()=>{var s;class n{get date(){return this._date}set date(t){if(this._date=function Xe(s){const n=new Date(s);if(!Number.isNaN(n.valueOf()))return n;const o=String(s).match(/\d+/g);if(null===o||o.length<=2)return n;{const[t,i,...r]=o.map(a=>parseInt(a,10));return new Date(Date.UTC(t,i-1,...r))}}(t).valueOf(),!this._date)throw new SyntaxError("Wrong parameter in TimeagoDirective. Expected a valid date, received: ".concat(t));this.clockSubscription&&(this.clockSubscription.unsubscribe(),this.clockSubscription=void 0),this.clockSubscription=this.clock.tick(this.date).pipe((0,we.h)(()=>this.live,this)).subscribe(()=>this.stateChanges.next())}get live(){return this._live}set live(t){this._live=function Ae(s){return null!=s&&"false"!=="".concat(s)}(t)}constructor(t,i,r,a,d){this.cd=i,this.clock=d,this.stateChanges=new E.x,this._live=!0,t&&(this.intlSubscription=t.changes.subscribe(()=>this.stateChanges.next())),this.stateChanges.subscribe(()=>{this.setContent(a.nativeElement,r.format(this.date)),this.cd.markForCheck()})}ngOnChanges(){this.stateChanges.next()}setContent(t,i){!function Ot(s){return typeof s<"u"&&null!==s}(t.textContent)?t.data=i:t.textContent=i}ngOnDestroy(){this.intlSubscription&&(this.intlSubscription.unsubscribe(),this.intlSubscription=void 0),this.clockSubscription&&(this.clockSubscription.unsubscribe(),this.clockSubscription=void 0),this.stateChanges.complete()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(qe,8),e.Y36(e.sBO),e.Y36(Oe),e.Y36(e.SBq),e.Y36(se))},s.\u0275dir=e.lG2({type:s,selectors:[["","timeago",""]],inputs:{date:"date",live:"live"},exportAs:["timeago"],features:[e.TTD]}),n})(),Ft=(()=>{var s;class n{static forRoot(t={}){return{ngModule:n,providers:[t.clock||{provide:se,useClass:Dt},t.intl||[],t.formatter||{provide:Oe,useClass:It}]}}static forChild(t={}){return{ngModule:n,providers:[t.clock||{provide:se,useClass:Dt},t.intl||[],t.formatter||{provide:Oe,useClass:It}]}}}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({}),n})(),Q=(()=>{var s;class n extends se{constructor(){super(...arguments),this.minute=60,this.hour=60*this.minute,this.day=24*this.hour}tick(t){return(0,ye.of)(0).pipe(K(()=>{const i=Date.now(),r=Math.round(Math.abs(i-t)/1e3),a=r<this.minute||r<this.hour?1e3*this.minute:r<this.day?1e3*this.hour:0;return a?(0,Me.H)(a):ve.E}),(0,J.T)(1))}}return(s=n).\u0275fac=(()=>{let o;return function(i){return(o||(o=e.n5z(s)))(i||s)}})(),s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),n})();var C=_(1413),T=_(5861),v=_(5172),F=_(9054),Le=_(5983);let Je=(()=>{var s;class n{constructor(t){this.uploadCacheService=t,this.folderPath=[]}set currentFolderPath(t){this.folderPath=t}removeEntitiesCallback(t,i,r){const a=!(0,F.ok)(t,this.folderPath),d=this.uploadCacheService.removeEntities(t,i,r);return(0,C.Z)({success:d.length>0},a?{}:{payload:{list:d}})}addEntitiesCallback(t,i,r){const a=!(0,F.ok)(t,this.folderPath),d=this.uploadCacheService.addEntities(t,i,r);return(0,C.Z)({success:d},a?{}:{payload:{list:i}})}renameEntityCallback(t,i,r){if(!this.uploadCacheService.getItem(t))return{success:!1};this.uploadCacheService.removeEntities(t,i.name,i.type);const d=this.generateEntityFromUrl(r.url,i.type,i.type===v.VC.FILE?{size:r.size,time:r.time}:{});return this.uploadCacheService.addEntities(t,(0,C.Z)({},d),d.type),(0,C.Z)({success:!0},(0,F.ok)(t,this.folderPath)?{payload:{list:[d]}}:{})}moveEntitiesCallback(t){const i=[],r=[];for(const a of t)a.type===v.VC.FILE?i.push((0,F.zO)(a.data.url,{size:a.data.size,time:a.data.time})):r.push((0,F.lY)(a.data.url));return{success:!0,payload:{list:{files:i,folders:r}}}}generateEntityFromUrl(t,i,r={}){return i===v.VC.FILE?(0,F.zO)(t,r):(0,F.lY)(t)}}return(s=n).\u0275fac=function(t){return new(t||s)(e.LFG(Le.B))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),n})();var X=_(4464),Qe=_(4887),Z=_(5487),$=_(9773),Zt=_(1374),ke=_(3019),ue=_(2438),j=_(6593);const si=["wrapper"],ri=["sourceImage"];function ai(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"img",4,5),e.NdJ("load",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.imageLoadedInView())})("mousedown",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.startMove(i,r.moveTypes.Drag))})("touchstart",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.startMove(i,r.moveTypes.Drag))})("error",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.loadImageError(i))}),e.qZA()}if(2&s){const o=n.ngIf,t=e.oxw();e.Udp("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle),e.ekj("ngx-ic-draggable",!t.disabled&&t.allowMoveImage),e.Q6J("src",o,e.LSH),e.uIk("alt",t.imageAltText)}}function li(s,n){if(1&s){const o=e.EpF();e.ynx(0),e.TgZ(1,"span",9),e.NdJ("mousedown",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"topleft"))})("touchstart",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"topleft"))}),e._UZ(2,"span",10),e.qZA(),e.TgZ(3,"span",11),e._UZ(4,"span",10),e.qZA(),e.TgZ(5,"span",12),e.NdJ("mousedown",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"topright"))})("touchstart",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"topright"))}),e._UZ(6,"span",10),e.qZA(),e.TgZ(7,"span",13),e._UZ(8,"span",10),e.qZA(),e.TgZ(9,"span",14),e.NdJ("mousedown",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"bottomright"))})("touchstart",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"bottomright"))}),e._UZ(10,"span",10),e.qZA(),e.TgZ(11,"span",15),e._UZ(12,"span",10),e.qZA(),e.TgZ(13,"span",16),e.NdJ("mousedown",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"bottomleft"))})("touchstart",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"bottomleft"))}),e._UZ(14,"span",10),e.qZA(),e.TgZ(15,"span",17),e._UZ(16,"span",10),e.qZA(),e.TgZ(17,"span",18),e.NdJ("mousedown",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"top"))})("touchstart",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"top"))}),e.qZA(),e.TgZ(18,"span",19),e.NdJ("mousedown",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"right"))})("touchstart",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"right"))}),e.qZA(),e.TgZ(19,"span",20),e.NdJ("mousedown",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"bottom"))})("touchstart",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"bottom"))}),e.qZA(),e.TgZ(20,"span",21),e.NdJ("mousedown",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"left"))})("touchstart",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.startMove(i,r.moveTypes.Resize,"left"))}),e.qZA(),e.BQk()}}function ci(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"div",6),e.NdJ("keydown",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.keyboardAccess(i))}),e.TgZ(1,"div",7),e.NdJ("mousedown",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.startMove(i,r.moveTypes.Move))})("touchstart",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.startMove(i,r.moveTypes.Move))}),e.qZA(),e.YNc(2,li,21,0,"ng-container",8),e.qZA()}if(2&s){const o=e.oxw();e.Udp("top",o.state.cropper.y1,"px")("left",o.state.cropper.x1,"px")("width",o.state.cropper.x2-o.state.cropper.x1,"px")("height",o.state.cropper.y2-o.state.cropper.y1,"px")("margin-left","center"===o.state.options.alignImage?o.marginLeft:null)("visibility",o.imageVisible?"visible":"hidden"),e.ekj("ngx-ic-round",o.state.options.roundCropper),e.uIk("aria-label",o.state.options.cropperFrameAriaLabel),e.xp6(2),e.Q6J("ngIf",!(o.state.options.hideResizeSquares||o.state.options.cropperStaticWidth&&o.state.options.cropperStaticHeight))}}function Be(s,n,o){return s=function Lt(s,n){let o=s.x2-s.x1,t=s.y2-s.y1;const i=s.x1+o/2,r=s.y1+t/2;n.options.cropperStaticHeight&&n.options.cropperStaticWidth?(o=n.maxSize.width>n.options.cropperStaticWidth?n.options.cropperStaticWidth:n.maxSize.width,t=n.maxSize.height>n.options.cropperStaticHeight?n.options.cropperStaticHeight:n.maxSize.height):(o=Math.max(n.cropperScaledMinWidth,Math.min(o,n.cropperScaledMaxWidth,n.maxSize.width)),t=Math.max(n.cropperScaledMinHeight,Math.min(t,n.cropperScaledMaxHeight,n.maxSize.height)),n.options.maintainAspectRatio&&(n.maxSize.width/n.options.aspectRatio<n.maxSize.height?t=o/n.options.aspectRatio:o=t*n.options.aspectRatio));const a=i-o/2,h=r-t/2;return{x1:a,x2:a+o,y1:h,y2:h+t}}(s,n),Ve(s,n,o)}function Ve(s,n,o=!1){return s.x1<0&&(s=(0,C.Z)((0,C.Z)({},s),{},{x1:0,x2:s.x2-(o?s.x1:0)})),s.y1<0&&(s=(0,C.Z)((0,C.Z)({},s),{},{y2:s.y2-(o?s.y1:0),y1:0})),s.x2>n.maxSize.width&&(s=(0,C.Z)((0,C.Z)({},s),{},{x1:s.x1-(o?s.x2-n.maxSize.width:0),x2:n.maxSize.width})),s.y2>n.maxSize.height&&(s=(0,C.Z)((0,C.Z)({},s),{},{y1:s.y1-(o?s.y2-n.maxSize.height:0),y2:n.maxSize.height})),s}function Ge(s,n,o){const t=(0,C.Z)({},o.cropper),i=tt(s)-n.clientX,r=it(s)-n.clientY;switch(n.position){case"left":t.x1=Math.min(Math.max(n.cropper.x1+i,t.x2-o.cropperScaledMaxWidth),t.x2-o.cropperScaledMinWidth);break;case"topleft":t.x1=Math.min(Math.max(n.cropper.x1+i,t.x2-o.cropperScaledMaxWidth),t.x2-o.cropperScaledMinWidth),t.y1=Math.min(Math.max(n.cropper.y1+r,t.y2-o.cropperScaledMaxHeight),t.y2-o.cropperScaledMinHeight);break;case"top":t.y1=Math.min(Math.max(n.cropper.y1+r,t.y2-o.cropperScaledMaxHeight),t.y2-o.cropperScaledMinHeight);break;case"topright":t.x2=Math.max(Math.min(n.cropper.x2+i,t.x1+o.cropperScaledMaxWidth),t.x1+o.cropperScaledMinWidth),t.y1=Math.min(Math.max(n.cropper.y1+r,t.y2-o.cropperScaledMaxHeight),t.y2-o.cropperScaledMinHeight);break;case"right":t.x2=Math.max(Math.min(n.cropper.x2+i,t.x1+o.cropperScaledMaxWidth),t.x1+o.cropperScaledMinWidth);break;case"bottomright":t.x2=Math.max(Math.min(n.cropper.x2+i,t.x1+o.cropperScaledMaxWidth),t.x1+o.cropperScaledMinWidth),t.y2=Math.max(Math.min(n.cropper.y2+r,t.y1+o.cropperScaledMaxHeight),t.y1+o.cropperScaledMinHeight);break;case"bottom":t.y2=Math.max(Math.min(n.cropper.y2+r,t.y1+o.cropperScaledMaxHeight),t.y1+o.cropperScaledMinHeight);break;case"bottomleft":t.x1=Math.min(Math.max(n.cropper.x1+i,t.x2-o.cropperScaledMaxWidth),t.x2-o.cropperScaledMinWidth),t.y2=Math.max(Math.min(n.cropper.y2+r,t.y1+o.cropperScaledMaxHeight),t.y1+o.cropperScaledMinHeight);break;case"center":const a="scale"in s?s.scale:1,d=Math.min(Math.max(o.cropperScaledMinWidth,Math.abs(n.cropper.x2-n.cropper.x1)*a),o.cropperScaledMaxWidth),h=Math.min(Math.max(o.cropperScaledMinHeight,Math.abs(n.cropper.y2-n.cropper.y1)*a),o.cropperScaledMaxHeight);t.x1=n.clientX-d/2,t.x2=n.clientX+d/2,t.y1=n.clientY-h/2,t.y2=n.clientY+h/2,t.x1<0?(t.x2-=t.x1,t.x1=0):t.x2>o.maxSize.width&&(t.x1-=t.x2-o.maxSize.width,t.x2=o.maxSize.width),t.y1<0?(t.y2-=t.y1,t.y1=0):t.y2>o.maxSize.height&&(t.y1-=t.y2-o.maxSize.height,t.y2=o.maxSize.height)}return o.options.maintainAspectRatio?function ht(s,n,o){n=(0,C.Z)({},n);let t=0,i=0;switch(s){case"top":n.x2=n.x1+(n.y2-n.y1)*o.options.aspectRatio,t=Math.max(n.x2-o.maxSize.width,0),i=Math.max(0-n.y1,0),(t>0||i>0)&&(n.x2-=i*o.options.aspectRatio>t?i*o.options.aspectRatio:t,n.y1+=i*o.options.aspectRatio>t?i:t/o.options.aspectRatio);break;case"bottom":n.x2=n.x1+(n.y2-n.y1)*o.options.aspectRatio,t=Math.max(n.x2-o.maxSize.width,0),i=Math.max(n.y2-o.maxSize.height,0),(t>0||i>0)&&(n.x2-=i*o.options.aspectRatio>t?i*o.options.aspectRatio:t,n.y2-=i*o.options.aspectRatio>t?i:t/o.options.aspectRatio);break;case"topleft":n.y1=n.y2-(n.x2-n.x1)/o.options.aspectRatio,t=Math.max(0-n.x1,0),i=Math.max(0-n.y1,0),(t>0||i>0)&&(n.x1+=i*o.options.aspectRatio>t?i*o.options.aspectRatio:t,n.y1+=i*o.options.aspectRatio>t?i:t/o.options.aspectRatio);break;case"topright":n.y1=n.y2-(n.x2-n.x1)/o.options.aspectRatio,t=Math.max(n.x2-o.maxSize.width,0),i=Math.max(0-n.y1,0),(t>0||i>0)&&(n.x2-=i*o.options.aspectRatio>t?i*o.options.aspectRatio:t,n.y1+=i*o.options.aspectRatio>t?i:t/o.options.aspectRatio);break;case"right":case"bottomright":n.y2=n.y1+(n.x2-n.x1)/o.options.aspectRatio,t=Math.max(n.x2-o.maxSize.width,0),i=Math.max(n.y2-o.maxSize.height,0),(t>0||i>0)&&(n.x2-=i*o.options.aspectRatio>t?i*o.options.aspectRatio:t,n.y2-=i*o.options.aspectRatio>t?i:t/o.options.aspectRatio);break;case"left":case"bottomleft":n.y2=n.y1+(n.x2-n.x1)/o.options.aspectRatio,t=Math.max(0-n.x1,0),i=Math.max(n.y2-o.maxSize.height,0),(t>0||i>0)&&(n.x1+=i*o.options.aspectRatio>t?i*o.options.aspectRatio:t,n.y2-=i*o.options.aspectRatio>t?i:t/o.options.aspectRatio);break;case"center":n.x2=n.x1+(n.y2-n.y1)*o.options.aspectRatio,n.y2=n.y1+(n.x2-n.x1)/o.options.aspectRatio;const r=Math.max(0-n.x1,0),a=Math.max(n.x2-o.maxSize.width,0),d=Math.max(n.y2-o.maxSize.height,0),h=Math.max(0-n.y1,0);(r>0||a>0||d>0||h>0)&&(n.x1+=d*o.options.aspectRatio>r?d*o.options.aspectRatio:r,n.x2-=h*o.options.aspectRatio>a?h*o.options.aspectRatio:a,n.y1+=h*o.options.aspectRatio>a?h:a/o.options.aspectRatio,n.y2-=d*o.options.aspectRatio>r?d:r/o.options.aspectRatio)}return n}(n.position,t,o):t}function tt(s){return"touches"in s&&s.touches[0]?s.touches[0].clientX:"clientX"in s?s.clientX:0}function it(s){return"touches"in s&&s.touches[0]?s.touches[0].clientY:"clientX"in s?s.clientY:0}class di{constructor(){this.options={format:"png",output:"blob",autoCrop:!0,maintainAspectRatio:!0,aspectRatio:1,resetCropOnAspectRatioChange:!0,resizeToWidth:0,resizeToHeight:0,cropperMinWidth:0,cropperMinHeight:0,cropperMaxHeight:0,cropperMaxWidth:0,cropperStaticWidth:0,cropperStaticHeight:0,canvasRotation:0,roundCropper:!1,onlyScaleDown:!1,imageQuality:92,backgroundColor:null,containWithinAspectRatio:!1,hideResizeSquares:!1,alignImage:"center",cropperFrameAriaLabel:void 0,checkImageType:!0},this.cropper={x1:0,x2:0,y1:0,y2:0},this.transform={},this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=3}setOptionsFromChanges(n){var o;null!==(o=n.options)&&void 0!==o&&o.currentValue&&this.setOptions(n.options.currentValue);const t=Object.entries(n).filter(([i])=>i in this.options).reduce((i,[r,a])=>(0,C.Z)((0,C.Z)({},i),{},{[r]:a.currentValue}),{});Object.keys(t).length>0&&this.setOptions(t)}setOptions(n){var o;if(this.options=(0,C.Z)((0,C.Z)({},this.options),n||{}),this.validateOptions(),null===(o=this.loadedImage)||void 0===o||!o.transformed.image.complete||!this.maxSize)return;let t=!1;this.options.maintainAspectRatio&&n.aspectRatio||n.maintainAspectRatio?(this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.options.maintainAspectRatio&&(this.options.resetCropOnAspectRatioChange||!this.aspectRatioIsCorrect())&&(this.cropper=this.maxSizeCropperPosition(),t=!0)):((n.cropperMinWidth||n.cropperMinHeight)&&(this.setCropperScaledMinSize(),t=!0),(n.cropperMaxWidth||n.cropperMaxHeight)&&(this.setCropperScaledMaxSize(),t=!0),(n.cropperStaticWidth||n.cropperStaticHeight)&&(t=!0)),t&&(this.cropper=Be(this.cropper,this,!1))}validateOptions(){if(this.options.maintainAspectRatio&&!this.options.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}setMaxSize(n,o){this.maxSize={width:n,height:o},this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}setCropperScaledMinSize(){var n;null!==(n=this.loadedImage)&&void 0!==n&&n.transformed.size?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.cropperScaledMinWidth=this.options.cropperMinWidth>0?Math.max(20,this.options.cropperMinWidth/this.loadedImage.transformed.size.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.cropperScaledMinHeight=this.options.maintainAspectRatio?Math.max(20,this.cropperScaledMinWidth/this.options.aspectRatio):this.options.cropperMinHeight>0?Math.max(20,this.options.cropperMinHeight/this.loadedImage.transformed.size.height*this.maxSize.height):20}setCropperScaledMaxSize(){var n;if(null!==(n=this.loadedImage)&&void 0!==n&&n.transformed.size){const o=this.loadedImage.transformed.size.width/this.maxSize.width;this.cropperScaledMaxWidth=this.options.cropperMaxWidth>20?this.options.cropperMaxWidth/o:this.maxSize.width,this.cropperScaledMaxHeight=this.options.cropperMaxHeight>20?this.options.cropperMaxHeight/o:this.maxSize.height,this.options.maintainAspectRatio&&(this.cropperScaledMaxWidth>this.cropperScaledMaxHeight*this.options.aspectRatio?this.cropperScaledMaxWidth=this.cropperScaledMaxHeight*this.options.aspectRatio:this.cropperScaledMaxWidth<this.cropperScaledMaxHeight*this.options.aspectRatio&&(this.cropperScaledMaxHeight=this.cropperScaledMaxWidth/this.options.aspectRatio))}else this.cropperScaledMaxWidth=this.maxSize.width,this.cropperScaledMaxHeight=this.maxSize.height}equalsCropperPosition(n){return null==this.cropper&&null==n||null!=this.cropper&&null!=n&&this.cropper.x1.toFixed(3)===n.x1.toFixed(3)&&this.cropper.y1.toFixed(3)===n.y1.toFixed(3)&&this.cropper.x2.toFixed(3)===n.x2.toFixed(3)&&this.cropper.y2.toFixed(3)===n.y2.toFixed(3)}equalsTransformTranslate(n){var o,t,i,r;return(null!==(o=this.transform.translateH)&&void 0!==o?o:0)===(null!==(t=n.translateH)&&void 0!==t?t:0)&&(null!==(i=this.transform.translateV)&&void 0!==i?i:0)===(null!==(r=n.translateV)&&void 0!==r?r:0)}equalsTransform(n){var o,t,i,r,a,d,h,g;return this.equalsTransformTranslate(n)&&(null!==(o=this.transform.scale)&&void 0!==o?o:1)===(null!==(t=n.scale)&&void 0!==t?t:1)&&(null!==(i=this.transform.rotate)&&void 0!==i?i:0)===(null!==(r=n.rotate)&&void 0!==r?r:0)&&(null!==(a=this.transform.flipH)&&void 0!==a&&a)===(null!==(d=n.flipH)&&void 0!==d&&d)&&(null!==(h=this.transform.flipV)&&void 0!==h&&h)===(null!==(g=n.flipV)&&void 0!==g&&g)}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.options.aspectRatio}resizeCropperPosition(n){this.cropper&&(n.width!==this.maxSize.width||n.height!==this.maxSize.height)&&(this.cropper={x1:this.cropper.x1*this.maxSize.width/n.width,x2:this.cropper.x2*this.maxSize.width/n.width,y1:this.cropper.y1*this.maxSize.height/n.height,y2:this.cropper.y2*this.maxSize.height/n.height})}maxSizeCropperPosition(){return{x1:0,y1:0,x2:this.maxSize.width,y2:this.maxSize.height}}}var G=function(s){return s.Drag="drag",s.Move="move",s.Resize="resize",s.Pinch="pinch",s}(G||{});function Ye(s,n){return s/100*n}class hi{crop(n,o){const t=this.getImagePosition(n),i=t.x2-t.x1,r=t.y2-t.y1,a=document.createElement("canvas");a.width=i,a.height=r;const d=a.getContext("2d");if(!d)return null;null!=n.options.backgroundColor&&(d.fillStyle=n.options.backgroundColor,d.fillRect(0,0,i,r));const h=(n.transform.scale||1)*(n.transform.flipH?-1:1),g=(n.transform.scale||1)*(n.transform.flipV?-1:1),{translateH:y,translateV:M}=this.getCanvasTranslate(n),A=n.loadedImage.transformed;d.setTransform(h,0,0,g,A.size.width/2+y,A.size.height/2+M),d.translate(-t.x1/h,-t.y1/g),d.rotate((n.transform.rotate||0)*Math.PI/180),d.drawImage(A.image,-A.size.width/2,-A.size.height/2);const S={width:i,height:r,imagePosition:t,cropperPosition:(0,C.Z)({},n.cropper)};n.options.containWithinAspectRatio&&(S.offsetImagePosition=this.getOffsetImagePosition(n));const N=this.getResizeRatio(i,r,n.options);return 1!==N&&(S.width=Math.round(i*N),S.height=n.options.maintainAspectRatio?Math.round(S.width/n.options.aspectRatio):Math.round(r*N),function pi(s,n,o){const t=s.width,i=s.height,r=t/(n=Math.round(n)),a=i/(o=Math.round(o)),d=Math.ceil(r/2),h=Math.ceil(a/2),g=s.getContext("2d");if(g){const y=g.getImageData(0,0,t,i),M=g.createImageData(n,o),A=y.data,S=M.data;for(let N=0;N<o;N++)for(let be=0;be<n;be++){const L=4*(be+N*n),zi=N*a;let pe=0,ze=0,Pt=0,Un=0,In=0,Dn=0,Fn=0;const Za=Math.floor(be*r),La=Math.floor(N*a);let Hi=Math.ceil((be+1)*r),qi=Math.ceil((N+1)*a);Hi=Math.min(Hi,t),qi=Math.min(qi,i);for(let ii=La;ii<qi;ii++){const Zn=Math.abs(zi-ii)/h,ka=be*r,Ra=Zn*Zn;for(let ni=Za;ni<Hi;ni++){const Ln=Math.abs(ka-ni)/d,ct=Math.sqrt(Ra+Ln*Ln);if(ct>=1)continue;pe=2*ct*ct*ct-3*ct*ct+1;const dt=4*(ni+ii*t);Fn+=pe*A[dt+3],Pt+=pe,A[dt+3]<255&&(pe=pe*A[dt+3]/250),Un+=pe*A[dt],In+=pe*A[dt+1],Dn+=pe*A[dt+2],ze+=pe}}S[L]=Un/ze,S[L+1]=In/ze,S[L+2]=Dn/ze,S[L+3]=Fn/Pt}s.width=n,s.height=o,g.putImageData(M,0,0)}}(a,S.width,S.height)),"blob"===o?this.cropToBlob(S,a,n):(S.base64=a.toDataURL("image/"+n.options.format,this.getQuality(n.options)),S)}cropToBlob(n,o,t){var i=this;return(0,T.Z)(function*(){return n.blob=yield new Promise(r=>o.toBlob(r,"image/"+t.options.format,i.getQuality(t.options))),n.blob&&(n.objectUrl=URL.createObjectURL(n.blob)),n})()}getCanvasTranslate(n){if("px"===n.transform.translateUnit){const o=this.getRatio(n);return{translateH:(n.transform.translateH||0)*o,translateV:(n.transform.translateV||0)*o}}return{translateH:n.transform.translateH?Ye(n.transform.translateH,n.loadedImage.transformed.size.width):0,translateV:n.transform.translateV?Ye(n.transform.translateV,n.loadedImage.transformed.size.height):0}}getRatio(n){return n.loadedImage.transformed.size.width/n.maxSize.width}getImagePosition(n){const o=this.getRatio(n),t={x1:Math.round(n.cropper.x1*o),y1:Math.round(n.cropper.y1*o),x2:Math.round(n.cropper.x2*o),y2:Math.round(n.cropper.y2*o)};return n.options.containWithinAspectRatio||(t.x1=Math.max(t.x1,0),t.y1=Math.max(t.y1,0),t.x2=Math.min(t.x2,n.loadedImage.transformed.size.width),t.y2=Math.min(t.y2,n.loadedImage.transformed.size.height)),t}getOffsetImagePosition(n){const o=n.options.canvasRotation+n.loadedImage.exifTransform.rotate,t=this.getRatio(n);let i,r;o%2?(i=(n.loadedImage.transformed.size.width-n.loadedImage.original.size.height)/2,r=(n.loadedImage.transformed.size.height-n.loadedImage.original.size.width)/2):(i=(n.loadedImage.transformed.size.width-n.loadedImage.original.size.width)/2,r=(n.loadedImage.transformed.size.height-n.loadedImage.original.size.height)/2);const a={x1:Math.round(n.cropper.x1*t)-i,y1:Math.round(n.cropper.y1*t)-r,x2:Math.round(n.cropper.x2*t)-i,y2:Math.round(n.cropper.y2*t)-r};return n.options.containWithinAspectRatio||(a.x1=Math.max(a.x1,0),a.y1=Math.max(a.y1,0),a.x2=Math.min(a.x2,n.loadedImage.transformed.size.width),a.y2=Math.min(a.y2,n.loadedImage.transformed.size.height)),a}getResizeRatio(n,o,t){const i=t.resizeToWidth/n,r=t.resizeToHeight/o,a=new Array;t.resizeToWidth>0&&a.push(i),t.resizeToHeight>0&&a.push(r);const d=0===a.length?1:Math.min(...a);return d>1&&!t.onlyScaleDown?d:Math.min(d,1)}getQuality(n){return Math.min(1,Math.max(0,n.imageQuality/100))}}class gi{constructor(){this.autoRotateSupported=function Rt(){return new Promise(s=>{const n=new Image;n.onload=()=>{s(1===n.width&&2===n.height)},n.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(n,o){var t=this;return(0,T.Z)(function*(){const i=yield n.arrayBuffer();return o.options.checkImageType?yield t.checkImageTypeAndLoadImageFromArrayBuffer(i,n.type,o):yield t.loadImageFromArrayBuffer(i,o)})()}checkImageTypeAndLoadImageFromArrayBuffer(n,o,t){return this.isValidImageType(o)?this.loadImageFromArrayBuffer(n,t,o):Promise.reject(new Error("Invalid image type"))}isValidImageType(n){return/image\/(png|jpg|jpeg|heic|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(n)}loadImageFromURL(n,o){var t=this;return(0,T.Z)(function*(){const r=yield(yield fetch(n)).blob(),a=yield r.arrayBuffer();return yield t.loadImageFromArrayBuffer(a,o,r.type)})()}loadBase64Image(n,o){const t=this.base64ToArrayBuffer(n);return this.loadImageFromArrayBuffer(t,o)}base64ToArrayBuffer(n){n=n.replace(/^data:([^;]+);base64,/gim,"");const o=atob(n),t=o.length,i=new Uint8Array(t);for(let r=0;r<t;r++)i[r]=o.charCodeAt(r);return i.buffer}loadImageFromArrayBuffer(n,o,t){var i=this;return(0,T.Z)(function*(){const r=yield new Promise(function(){var a=(0,T.Z)(function*(d,h){try{const g=new Blob([n],t?{type:t}:void 0),y=URL.createObjectURL(g),M=new Image,S="image/svg+xml"===t?yield i.getSvgImageSize(g):void 0;M.onload=()=>d({originalImage:M,originalImageSize:S,originalObjectUrl:y,originalArrayBuffer:n}),M.onerror=h,M.src=y}catch(g){h(g)}});return function(d,h){return a.apply(this,arguments)}}());return yield i.transformImageFromArrayBuffer(r,o,null!=r.originalImageSize)})()}getSvgImageSize(n){return(0,T.Z)(function*(){const i=(new DOMParser).parseFromString(yield n.text(),"image/svg+xml").querySelector("svg");if(!i)throw Error("Failed to parse SVG image");const r=i.getAttribute("width"),a=i.getAttribute("height");if(r&&a)return null;const d=i.getAttribute("viewBox")||i.getAttribute("viewbox");if(d){const h=d.split(" ");return{width:+h[2],height:+h[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})()}transformImageFromArrayBuffer(n,o,t=!1){var i=this;return(0,T.Z)(function*(){var r;const d=function Nt(s){switch("object"==typeof s&&(s=function ut(s){const n=new DataView(s);if(65496!==n.getUint16(0,!1))return-2;const o=n.byteLength;let t=2;for(;t<o;){if(n.getUint16(t+2,!1)<=8)return-1;const i=n.getUint16(t,!1);if(t+=2,65505==i){if(1165519206!==n.getUint32(t+=2,!1))return-1;const r=18761==n.getUint16(t+=6,!1);t+=n.getUint32(t+4,r);const a=n.getUint16(t,r);t+=2;for(let d=0;d<a;d++)if(274==n.getUint16(t+12*d,r))return n.getUint16(t+12*d+8,r)}else{if(65280!=(65280&i))break;t+=n.getUint16(t,!1)}}return-1}(s)),s){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}((yield i.autoRotateSupported)?-1:n.originalArrayBuffer);if(!n.originalImage||!n.originalImage.complete)return Promise.reject(new Error("No image loaded"));const h={original:{objectUrl:n.originalObjectUrl,image:n.originalImage,size:null!==(r=n.originalImageSize)&&void 0!==r?r:{width:n.originalImage.naturalWidth,height:n.originalImage.naturalHeight}},exifTransform:d};return i.transformLoadedImage(h,o,t)})()}transformLoadedImage(n,o,t=!1){var i=this;return(0,T.Z)(function*(){const r=o.options.canvasRotation+n.exifTransform.rotate,a=n.original.size;if(!t&&0===r&&!n.exifTransform.flip&&!o.options.containWithinAspectRatio)return{original:{objectUrl:n.original.objectUrl,image:n.original.image,size:(0,C.Z)({},a)},transformed:{objectUrl:n.original.objectUrl,image:n.original.image,size:(0,C.Z)({},a)},exifTransform:n.exifTransform};const d=i.getTransformedSize(a,n.exifTransform,o),h=document.createElement("canvas");h.width=d.width,h.height=d.height;const g=h.getContext("2d");null==g||g.setTransform(n.exifTransform.flip?-1:1,0,0,1,h.width/2,h.height/2),null==g||g.rotate(Math.PI*(r/2)),null==g||g.drawImage(n.original.image,-a.width/2,-a.height/2);const y=yield new Promise(S=>h.toBlob(S,o.options.format));if(!y)throw new Error("Failed to get Blob for transformed image.");const M=URL.createObjectURL(y),A=yield i.loadImageFromObjectUrl(M);return{original:{objectUrl:n.original.objectUrl,image:n.original.image,size:(0,C.Z)({},a)},transformed:{objectUrl:M,image:A,size:{width:A.width,height:A.height}},exifTransform:n.exifTransform}})()}loadImageFromObjectUrl(n){return new Promise((o,t)=>{const i=new Image;i.onload=()=>o(i),i.onerror=t,i.src=n})}getTransformedSize(n,o,t){const i=t.options.canvasRotation+o.rotate;if(t.options.containWithinAspectRatio){if(i%2){const a=n.height/t.options.aspectRatio;return{width:Math.max(n.height,n.width*t.options.aspectRatio),height:Math.max(n.width,a)}}{const a=n.width/t.options.aspectRatio;return{width:Math.max(n.width,n.height*t.options.aspectRatio),height:Math.max(n.height,a)}}}return i%2?{height:n.width,width:n.height}:{width:n.width,height:n.height}}}let Ht=(()=>{var s;class n{get alignImageStyle(){return this.state.options.alignImage}constructor(t,i,r){this.sanitizer=t,this.cd=i,this.zone=r,this.pinchStart$=new E.x,this.cropService=new hi,this.loadImageService=new gi,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.moveTypes=G,this.state=new di,this.safeImgDataUrl=(0,e.tdS)(void 0),this.marginLeft="0px",this.imageVisible=!1,this.allowMoveImage=!1,this.checkImageType=!0,this.disabled=!1,this.hidden=!1,this.imageCropped=new e.vpe,this.startCropImage=new e.vpe,this.imageLoaded=new e.vpe,this.cropperReady=new e.vpe,this.loadImageFailed=new e.vpe,this.transformChange=new e.vpe,this.cropperChange=new e.vpe,this.reset()}ngOnInit(){this.state.stepSize=this.initialStepSize||this.state.stepSize}ngOnChanges(t){var i;const r=this.state.cropper,a=this.state.transform,d=this.state.options.backgroundColor;if(this.state.setOptionsFromChanges(t),this.onChangesInputImage(t),t.transform&&this.transform&&(this.state.transform=this.transform,this.setCssTransform()),null===(i=this.state.loadedImage)||void 0===i||!i.transformed.image.complete||!this.state.maxSize)return;if(this.containWithinAspectRatio&&t.aspectRatio||t.containWithinAspectRatio||t.canvasRotation)return void this.loadImageService.transformLoadedImage(this.state.loadedImage,this.state).then(g=>this.setLoadedImage(g)).catch(g=>this.loadImageError(g));t.cropper&&this.cropper&&(this.state.cropper=Be(this.cropper,this.state,!0));const h=!this.state.equalsCropperPosition(r);h&&(!this.cropper||!this.state.equalsCropperPosition(this.cropper))&&this.cropperChange.emit(this.state.cropper),(h||!this.state.equalsTransform(a)||this.state.options.backgroundColor!==d)&&this.doAutoCrop(),t.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){var t;const i=null===(t=this.imageChangedEvent)||void 0===t||null===(t=t.target)||void 0===t?void 0:t.files;return i instanceof FileList&&i.length>0}reset(){this.safeImgDataUrl.set("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="),this.state.loadedImage=void 0,this.state.maxSize=void 0,this.imageVisible=!1}loadImageFile(t){this.loadImageService.loadImageFile(t,this.state).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.state).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.state).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}setLoadedImage(t){this.state.loadedImage=t,this.safeImgDataUrl.set(this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.objectUrl))}loadImageError(t){console.error(t),this.loadImageFailed.emit()}setCssTransform(){var t;const i=(null===(t=this.state.transform)||void 0===t?void 0:t.translateUnit)||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle("translate(".concat(this.state.transform.translateH||0).concat(i,", ").concat(this.state.transform.translateV||0).concat(i,")")+" scaleX("+(this.state.transform.scale||1)*(this.state.transform.flipH?-1:1)+") scaleY("+(this.state.transform.scale||1)*(this.state.transform.flipV?-1:1)+") rotate("+(this.state.transform.rotate||0)+"deg)")}imageLoadedInView(){null!=this.state.loadedImage&&(this.imageLoaded.emit(this.state.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),!this.cropper||this.maintainAspectRatio&&!this.state.aspectRatioIsCorrect()?(this.state.cropper=Be(this.state.maxSizeCropperPosition(),this.state,!0),this.cropperChange.emit(this.state.cropper)):(this.state.cropper=Be(this.cropper,this.state,!0),this.emitCropperPositionChange(this.cropper)),this.imageVisible=!0,this.cropperReady.emit((0,C.Z)({},this.state.maxSize)),this.doAutoCrop(),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){var t;return(null===(t=this.sourceImage)||void 0===t||null===(t=t.nativeElement)||void 0===t?void 0:t.offsetWidth)>1}onResize(){if(this.state.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{const t=(0,C.Z)({},this.state.maxSize);this.setMaxSize(),this.state.resizeCropperPosition(t),this.cd.markForCheck()}}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){const i=+t.key;i>=1&&i<=9&&(this.state.stepSize=i)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;const r=t.shiftKey?G.Resize:G.Move,a=t.altKey?function _i(s){switch(s){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(t.key):function mi(s){switch(s){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(t.key),d=function zt(s,n){switch(s){case"ArrowUp":return{clientX:0,clientY:-1*n};case"ArrowRight":return{clientX:n,clientY:0};case"ArrowDown":return{clientX:0,clientY:n};default:return{clientX:-1*n,clientY:0}}}(t.key,this.state.stepSize);t.preventDefault(),t.stopPropagation(),this.moveStart={active:!0,type:r,position:a,clientX:0,clientY:0,transform:this.state.transform,cropper:this.state.cropper},this.handleMouseMove(d),this.handleMouseUp()}startMove(t,i,r=null){var a,d;this.disabled||null!==(a=this.moveStart)&&void 0!==a&&a.active&&(null===(d=this.moveStart)||void 0===d?void 0:d.type)===G.Pinch||i===G.Drag&&!this.allowMoveImage||("preventDefault"in t&&t.preventDefault(),this.moveStart={active:!0,type:i,position:r,clientX:tt(t),clientY:it(t),transform:this.state.transform,cropper:this.state.cropper},this.initMouseMove())}initMouseMove(){(0,ke.T)((0,ue.R)(document,"mousemove"),(0,ue.R)(document,"touchmove")).pipe((0,$.R)((0,ke.T)((0,ue.R)(document,"mouseup"),(0,ue.R)(document,"touchend"),this.pinchStart$).pipe((0,Zt.P)()))).subscribe({next:t=>this.zone.run(()=>{this.handleMouseMove(t),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handleMouseUp(),this.cd.markForCheck()})})}handleMouseMove(t){var i;if(null!==(i=this.moveStart)&&void 0!==i&&i.active)if("stopPropagation"in t&&t.stopPropagation(),"preventDefault"in t&&t.preventDefault(),this.moveStart.type===G.Move)this.state.cropper=Ve(function kt(s,n){const o=tt(s)-n.clientX,t=it(s)-n.clientY;return{x1:n.cropper.x1+o,y1:n.cropper.y1+t,x2:n.cropper.x2+o,y2:n.cropper.y2+t}}(t,this.moveStart),this.state,!0);else if(this.moveStart.type===G.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&(this.state.cropper=Ve(Ge(t,this.moveStart,this.state),this.state,!1));else if(this.moveStart.type===G.Drag){var r,a;const d=tt(t)-this.moveStart.clientX,h=it(t)-this.moveStart.clientY;this.state.transform=(0,C.Z)((0,C.Z)({},this.state.transform),{},{translateH:((null===(r=this.moveStart.transform)||void 0===r?void 0:r.translateH)||0)+d,translateV:((null===(a=this.moveStart.transform)||void 0===a?void 0:a.translateV)||0)+h}),this.setCssTransform()}}handleMouseUp(){var t,i;null===(t=this.moveStart)||void 0===t||!t.active||(null===(i=this.moveStart)||void 0===i?void 0:i.type)===G.Pinch||((!this.state.equalsCropperPosition(this.moveStart.cropper)||this.moveStart.transform&&!this.state.equalsTransform(this.moveStart.transform))&&(this.moveStart.type===G.Drag?this.transformChange.emit(this.state.transform):this.cropperChange.emit(this.state.cropper),this.doAutoCrop()),this.moveStart=void 0)}startPinch(t){this.disabled||!this.sourceImageLoaded()||t.touches.length<2||("preventDefault"in t&&t.preventDefault(),this.moveStart={active:!0,type:G.Pinch,position:"center",clientX:this.state.cropper.x1+(this.state.cropper.x2-this.state.cropper.x1)/2,clientY:this.state.cropper.y1+(this.state.cropper.y2-this.state.cropper.y1)/2,cropper:this.state.cropper},this.initPinch())}initPinch(){this.pinchStart$.next(),(0,ue.R)(document,"touchmove").pipe((0,$.R)((0,ue.R)(document,"touchend"))).subscribe({next:t=>this.zone.run(()=>{this.handlePinchMove(t),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handlePinchStop(),this.cd.markForCheck()})})}handlePinchMove(t){var i;null!==(i=this.moveStart)&&void 0!==i&&i.active&&(t.preventDefault&&t.preventDefault(),this.moveStart.type===G.Pinch&&!this.cropperStaticWidth&&!this.cropperStaticHeight&&(this.state.cropper=Ve(Ge(t,this.moveStart,this.state),this.state,!1)),this.cd.markForCheck())}handlePinchStop(){var t;null!==(t=this.moveStart)&&void 0!==t&&t.active&&(this.state.equalsCropperPosition(this.moveStart.cropper)||(this.emitCropperPositionChange(this.moveStart.cropper),this.doAutoCrop()),this.moveStart=void 0)}setMaxSize(){if(this.sourceImage){const t=getComputedStyle(this.sourceImage.nativeElement);this.state.setMaxSize(parseFloat(t.width),parseFloat(t.height)),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.state.maxSize.width/2+"px)")}}emitCropperPositionChange(t){this.state.equalsCropperPosition(t)||this.cropperChange.emit(this.state.cropper)}doAutoCrop(){this.state.options.autoCrop&&this.crop()}crop(t=this.state.options.output){var i;if(null!=(null===(i=this.state.loadedImage)||void 0===i||null===(i=i.transformed)||void 0===i?void 0:i.image)){if(this.startCropImage.emit(),"blob"===t)return this.cropToBlob();if("base64"===t)return this.cropToBase64()}return null}cropToBlob(){var t=this;return new Promise((i,r)=>this.zone.run((0,T.Z)(function*(){const a=yield t.cropService.crop(t.state,"blob");a?(t.imageCropped.emit(a),i(a)):r("Crop image failed")})))}cropToBase64(){const t=this.cropService.crop(this.state,"base64");return t?(this.imageCropped.emit(t),t):null}ngOnDestroy(){this.pinchStart$.complete()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(j.H7),e.Y36(e.sBO),e.Y36(e.R0b))},s.\u0275cmp=e.Xpm({type:s,selectors:[["image-cropper"]],viewQuery:function(t,i){if(1&t&&(e.Gf(si,7),e.Gf(ri,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.wrapper=r.first),e.iGM(r=e.CRH())&&(i.sourceImage=r.first)}},hostVars:6,hostBindings:function(t,i){1&t&&e.NdJ("resize",function(){return i.onResize()},!1,e.Jf7),2&t&&(e.Udp("text-align",i.alignImageStyle),e.ekj("disabled",i.disabled)("ngx-ic-hidden",i.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",options:"options",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",autoCrop:"autoCrop",cropper:"cropper",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",checkImageType:"checkImageType",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange",cropperChange:"cropperChange"},standalone:!0,features:[e.TTD,e.jDz],decls:4,vars:10,consts:[[3,"touchstart"],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"src","load","mousedown","touchstart","error"],["sourceImage",""],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.NdJ("touchstart",function(a){return i.startPinch(a)}),e.YNc(1,ai,2,8,"img",1),e._UZ(2,"div",2),e.YNc(3,ci,3,16,"div",3),e.qZA()),2&t&&(e.Udp("background",i.imageVisible&&i.state.options.backgroundColor),e.xp6(),e.Q6J("ngIf",i.safeImgDataUrl()),e.xp6(),e.Udp("width",(null==i.state.maxSize?null:i.state.maxSize.width)||0,"px")("height",(null==i.state.maxSize?null:i.state.maxSize.height)||0,"px")("margin-left","center"===i.alignImage?i.marginLeft:null),e.xp6(),e.Q6J("ngIf",i.imageVisible))},dependencies:[f.O5],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:var(--cropper-move-border, 1px solid rgba(255, 255, 255, .5))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ic-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),n})();var qt=_(9473),re=_(8366),We=_(5290),Re=_(8316),Jt=_(7357);const gt=["modal"];function fi(s,n){1&s&&(e.ynx(0),e._UZ(1,"app-loader",60),e.BQk())}function Qt(s,n){1&s&&(e.TgZ(0,"div",61),e._uU(1," Se non viene rispettato l'aspect ratio, l'immagine verr\xe0 tagliata per adattarsi alle dimensioni specificate! "),e.qZA())}const vi=()=>({placement:"bottom-start"}),ee=()=>({placement:"bottom"}),Bt=(s,n)=>({"btn-outline-warning-dark":s,"btn-warning-dark":n}),Vt=()=>({placement:"bottom",hideOnClick:!1}),mt=s=>({"is-invalid":s}),_t=()=>({hideOnClick:!1});function Ee(s,n){if(1&s){const o=e.EpF();e.ynx(0),e.TgZ(1,"div",7)(2,"image-cropper",8),e.NdJ("cropperReady",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.cropperReadyEvent())})("imageLoaded",function(i){e.CHM(o);const r=e.oxw(3);return e.KtG(r.imageLoadedEvent(i))})("imageCropped",function(i){e.CHM(o);const r=e.oxw(3);return e.KtG(r.imageCroppedEvent(i))}),e.ALo(3,"uploadsreplace"),e.qZA()(),e.YNc(4,fi,2,0,"ng-container",4),e.TgZ(5,"div",9)(6,"div",10)(7,"button",11),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.rotateLeft())}),e.TgZ(8,"div",12),e._uU(9,"rotate_left"),e.qZA()(),e.TgZ(10,"button",13),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.rotateRight())}),e.TgZ(11,"div",12),e._uU(12,"rotate_right"),e.qZA()()(),e.TgZ(13,"div",14)(14,"button",15),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.flipHorizontal())}),e.TgZ(15,"div",16),e._uU(16," height "),e.qZA()(),e.TgZ(17,"button",17),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.flipVertical())}),e.TgZ(18,"div",12),e._uU(19,"height"),e.qZA()()(),e.TgZ(20,"div",14)(21,"button",18),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.zoomIn())}),e.TgZ(22,"div",12),e._uU(23,"zoom_in"),e.qZA()(),e.TgZ(24,"button",19),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.zoomOut())}),e.TgZ(25,"div",12),e._uU(26,"zoom_out"),e.qZA()()(),e.TgZ(27,"div",14)(28,"button",20),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.translateUp())}),e.TgZ(29,"div",21),e._uU(30," arrow_circle_up "),e.qZA()(),e.TgZ(31,"button",22),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.translateDown())}),e.TgZ(32,"div",21),e._uU(33," arrow_circle_down "),e.qZA()(),e.TgZ(34,"button",23),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.translateLeft())}),e.TgZ(35,"div",21),e._uU(36," arrow_circle_left "),e.qZA()(),e.TgZ(37,"button",24),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.translateRight())}),e.TgZ(38,"div",21),e._uU(39," arrow_circle_right "),e.qZA()()(),e.TgZ(40,"button",25,26),e.NdJ("click",function(){e.CHM(o);const i=e.MAs(41);return e.oxw(3).toggleMaintainAspectRatio(),e.KtG(i.blur())}),e.TgZ(42,"div",27),e._uU(43,"image_aspect_ratio"),e.qZA()(),e.TgZ(44,"button",28),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.resetImage())}),e.TgZ(45,"div",12),e._uU(46,"restart_alt"),e.qZA()()(),e.TgZ(47,"div",29)(48,"div",30)(49,"div",31)(50,"div",32)(51,"label",33),e._uU(52,"Rotazione libera:"),e.qZA()(),e.TgZ(53,"input",34),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw(3);return e.KtG(r.rotationInput=i)})("ngModelChange",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.updateRotation())}),e.qZA()(),e.TgZ(54,"div",35)(55,"div",32)(56,"label",36),e._uU(57,"Sposta "),e.TgZ(58,"span",37),e._uU(59,"orizz"),e.qZA(),e.TgZ(60,"span",38),e._uU(61,"orizzontalmente (px)"),e.qZA(),e._uU(62,":"),e.qZA(),e.TgZ(63,"label",39),e._uU(64,"Sposta "),e.TgZ(65,"span",37),e._uU(66,"vert"),e.qZA(),e.TgZ(67,"span",38),e._uU(68,"verticalmente (px)"),e.qZA(),e._uU(69,":"),e.qZA()(),e.TgZ(70,"div",40)(71,"input",41),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw(3);return e.KtG(r.translateH=i)})("ngModelChange",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.updateTranslate())}),e.qZA(),e.TgZ(72,"input",42),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw(3);return e.KtG(r.translateV=i)})("ngModelChange",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.updateTranslate())}),e.qZA()()()()(),e.TgZ(73,"fieldset",43)(74,"legend",44),e._uU(75," Modifica le dimensioni "),e.qZA(),e.TgZ(76,"ul",45)(77,"li",46)(78,"div",47)(79,"div",32)(80,"label",48),e._uU(81,"Larghezza"),e.TgZ(82,"span",38),e._uU(83," (px)"),e.qZA(),e._uU(84,":"),e.qZA(),e.TgZ(85,"label",49),e._uU(86,"Altezza"),e.TgZ(87,"span",38),e._uU(88," (px)"),e.qZA(),e._uU(89,":"),e.qZA()(),e.TgZ(90,"div",40)(91,"input",50),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw(3);return e.KtG(r.imageWidth=i)})("ngModelChange",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.imageWidthInputChange())}),e.qZA(),e.TgZ(92,"span",51),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.keepAspectRationWhenScaling=!i.keepAspectRationWhenScaling)}),e._UZ(93,"span",52),e.qZA(),e.TgZ(94,"input",53),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw(3);return e.KtG(r.imageHeight=i)})("ngModelChange",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.imageHeightInputChange())}),e.qZA()(),e.YNc(95,Qt,2,0,"div",54),e.qZA()(),e.TgZ(96,"li")(97,"div",55)(98,"input",56),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw(3);return e.KtG(r.forceDimensionsOnSave=i)}),e.qZA(),e.TgZ(99,"label",57),e._uU(100,"Salva l'immagine con le dimensioni specificate"),e.qZA()()()()(),e.TgZ(101,"div",55)(102,"input",58),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw(3);return e.KtG(r.rewriteOnSave=i)}),e.qZA(),e.TgZ(103,"label",59),e._uU(104,"Sostituisci la vecchia immagine con quella modificata"),e.qZA()(),e.BQk()}if(2&s){const o=e.oxw(3);e.xp6(2),e.Q6J("hidden",!o.isImageLoaded)("imageURL",e.lcZ(3,48,o.entity.embedUrl))("format",o.exportFormat)("aspectRatio",o.aspectRatio)("maintainAspectRatio",o.maintainAspectRatio)("canvasRotation",o.canvasRotation)("transform",o.transform),e.xp6(2),e.Q6J("ngIf",!o.isImageLoaded),e.xp6(3),e.Q6J("disableOnTouchDevice",!0)("tippyProps",e.DdM(50,vi)),e.xp6(3),e.Q6J("disableOnTouchDevice",!0)("tippyProps",e.DdM(51,ee)),e.xp6(4),e.Q6J("disableOnTouchDevice",!0)("tippyProps",e.DdM(52,ee)),e.xp6(3),e.Q6J("disableOnTouchDevice",!0)("tippyProps",e.DdM(53,ee)),e.xp6(4),e.Q6J("disableOnTouchDevice",!0)("tippyProps",e.DdM(54,ee)),e.xp6(3),e.Q6J("disableOnTouchDevice",!0)("tippyProps",e.DdM(55,ee)),e.xp6(4),e.Q6J("disableOnTouchDevice",!0)("tippyProps",e.DdM(56,ee)),e.xp6(3),e.Q6J("disableOnTouchDevice",!0)("tippyProps",e.DdM(57,ee)),e.xp6(3),e.Q6J("disableOnTouchDevice",!0)("tippyProps",e.DdM(58,ee)),e.xp6(3),e.Q6J("disableOnTouchDevice",!0)("tippyProps",e.DdM(59,ee)),e.xp6(3),e.Q6J("ngClass",e.WLB(60,Bt,!o.maintainAspectRatio,o.maintainAspectRatio))("appTippy",o.maintainAspectRatio?"Trasformazione libera":"Mantieni il rapporto larghezza/altezza")("disableOnTouchDevice",!0)("tippyProps",e.DdM(63,Vt)),e.xp6(4),e.Q6J("disableOnTouchDevice",!0)("tippyProps",e.DdM(64,ee)),e.xp6(9),e.Q6J("ngModel",o.rotationInput),e.xp6(18),e.Q6J("ngModel",o.translateH),e.xp6(),e.Q6J("ngModel",o.translateV),e.xp6(19),e.Q6J("ngClass",e.VKq(65,mt,o.isImageLoaded&&(!o.imageWidth||o.imageWidth<1)))("ngModel",o.imageWidth),e.xp6(),e.Q6J("appTippy",o.keepAspectRationWhenScaling?"Scala liberamente":"Mantieni l'aspect ratio")("disableOnTouchDevice",!0)("tippyProps",e.DdM(67,_t)),e.xp6(),e.Q6J("innerText",o.keepAspectRationWhenScaling?"link":"link_off"),e.xp6(),e.Q6J("ngClass",e.VKq(68,mt,o.isImageLoaded&&(!o.imageHeight||o.imageHeight<1)))("ngModel",o.imageHeight),e.xp6(),e.Q6J("ngIf",!o.keepAspectRationWhenScaling),e.xp6(3),e.Q6J("ngModel",o.forceDimensionsOnSave),e.xp6(4),e.Q6J("ngModel",o.rewriteOnSave)}}function Ke(s,n){if(1&s&&(e.TgZ(0,"div",62)(1,"strong"),e._uU(2,"File non supportato!"),e.qZA(),e._UZ(3,"br"),e._uU(4," Purtroppo, al momento il file che si sta cercando di modificare ha un'estensione ("),e.TgZ(5,"em"),e._uU(6),e.qZA(),e._uU(7,") non supportata. Se lo si desidera, \xe8 possibile provare a convertire in autonomia il file in formato "),e.TgZ(8,"em"),e._uU(9,".jpg"),e.qZA(),e._uU(10," o "),e.TgZ(11,"em"),e._uU(12,".png"),e.qZA(),e._uU(13," e riprovare in seguito. "),e.qZA()),2&s){const o=e.oxw(3);e.xp6(6),e.hij(".",o.entity.ext,"")}}function $e(s,n){if(1&s&&(e.ynx(0),e.YNc(1,Ee,105,70,"ng-container",5)(2,Ke,14,1,"ng-template",null,6,e.W1O),e.BQk()),2&s){const o=e.MAs(3),t=e.oxw(2);e.xp6(),e.Q6J("ngIf",t.canImageBeCropped)("ngIfElse",o)}}function nt(s,n){if(1&s&&e.YNc(0,$e,4,2,"ng-container",4),2&s){const o=e.oxw();e.Q6J("ngIf",o.entity)}}function ft(s,n){if(1&s){const o=e.EpF();e.ynx(0),e.TgZ(1,"button",63),e.NdJ("click",function(){e.CHM(o),e.oxw(2);const i=e.MAs(1);return e.KtG(i.close("Close click"))}),e._uU(2," Annulla "),e.qZA(),e.TgZ(3,"button",64),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.save())}),e._uU(4," Salva "),e.qZA(),e.BQk()}if(2&s){const o=e.oxw(2);e.xp6(3),e.Q6J("disabled",!o.isCropperReady||!o.canImageBeCropped||!o.croppedImageBlob)}}function Ci(s,n){if(1&s&&e.YNc(0,ft,5,1,"ng-container",4),2&s){const o=e.oxw();e.Q6J("ngIf",o.entity)}}let xi=(()=>{var s;class n{constructor(t,i){this.uploaderService=t,this.uploadObservablesService=i,this.canImageBeCropped=!1,this.isCropperReady=!1,this.isImageLoaded=!1,this.rewriteOnSave=!1,this.imageWidth=0,this.imageHeight=0,this.keepAspectRationWhenScaling=!0,this.forceDimensionsOnSave=!1,this.exportFormat="jpeg",this.aspectRatio=4/3,this.maintainAspectRatio=!1,this.canvasRotation=0,this.transform={translateUnit:"px"},this.rotationInput=0,this.translateH=0,this.translateV=0,this.scale=1,this.translateHStep=0,this.translateVStep=0}ngOnChanges(t){t.entity&&!t.entity.firstChange&&this.entity&&(this.canImageBeCropped=(0,F.$H)(this.entity.ext),this.exportFormat=["png","apng"].includes(this.entity.ext)?"png":"webp"===this.entity.ext?"webp":"jpeg")}open(){return this.modalComponent.open()}resetOnHidden(){this.isImageLoaded=!1,this.isCropperReady=!1,this.resetImage(),this.maintainAspectRatio=!1,this.croppedImageBlob=void 0,this.keepAspectRationWhenScaling=!0,this.forceDimensionsOnSave=!1,this.imageHeight=0,this.imageWidth=0,this.rewriteOnSave=!1}save(){if(!(this.isCropperReady&&this.canImageBeCropped&&this.croppedImageBlob&&this.entity))return;this.modalComponent.close();const t={compress:this.uploaderService.uploaderOptions.compress,allowOverwrite:this.rewriteOnSave,openLinkModalAfterUpload:!1};this.forceDimensionsOnSave&&this.imageWidth>0&&this.imageHeight>0&&(t.compress=!0,t.imageDimensions={width:this.imageWidth,height:this.imageHeight}),this.uploadObservablesService.pushStartUpload({file:new File([this.croppedImageBlob],this.entity.name,{type:this.croppedImageBlob.type,lastModified:Date.now()}),options:t})}cropperReadyEvent(){this.isCropperReady=!0}imageLoadedEvent(t){this.imageWidth=t.original.size.width,this.imageHeight=t.original.size.height,this.translateHStep=Math.round(this.imageWidth/100),this.translateVStep=Math.round(this.imageHeight/100),this.aspectRatio=this.imageWidth/this.imageHeight,this.isImageLoaded=!0}imageCroppedEvent(t){this.croppedImageBlob=t.blob||void 0,this.imageWidth=t.width,this.imageHeight=t.height}imageWidthInputChange(){this.forceDimensionsOnSave=!0,this.keepAspectRationWhenScaling&&(this.imageHeight=Math.round(this.imageWidth/this.aspectRatio))}imageHeightInputChange(){this.forceDimensionsOnSave=!0,this.keepAspectRationWhenScaling&&(this.imageWidth=Math.round(this.imageHeight*this.aspectRatio))}rotateLeft(){this.canvasRotation--,this.flipAfterRotate()}rotateRight(){this.canvasRotation++,this.flipAfterRotate()}flipAfterRotate(){const t=this.transform.flipH,i=this.transform.flipV;this.transform=(0,C.Z)((0,C.Z)({},this.transform),{},{flipH:i,flipV:t})}updateRotation(){this.transform=(0,C.Z)((0,C.Z)({},this.transform),{},{rotate:this.rotationInput})}updateTranslate(){this.transform=(0,C.Z)((0,C.Z)({},this.transform),{},{translateV:this.translateV,translateH:this.translateH})}flipHorizontal(){this.transform=(0,C.Z)((0,C.Z)({},this.transform),{},{flipH:!this.transform.flipH})}flipVertical(){this.transform=(0,C.Z)((0,C.Z)({},this.transform),{},{flipV:!this.transform.flipV})}zoomOut(){this.scale-=.1,this.transform=(0,C.Z)((0,C.Z)({},this.transform),{},{scale:this.scale})}zoomIn(){this.scale+=.1,this.transform=(0,C.Z)((0,C.Z)({},this.transform),{},{scale:this.scale})}toggleMaintainAspectRatio(){this.maintainAspectRatio=!this.maintainAspectRatio}translateRight(){this.translateH+=this.translateHStep,this.transform=(0,C.Z)((0,C.Z)({},this.transform),{},{translateH:this.translateH})}translateLeft(){this.translateH+=-this.translateHStep,this.transform=(0,C.Z)((0,C.Z)({},this.transform),{},{translateH:this.translateH})}translateUp(){this.translateV+=-this.translateVStep,this.transform=(0,C.Z)((0,C.Z)({},this.transform),{},{translateV:this.translateV})}translateDown(){this.translateV+=this.translateVStep,this.transform=(0,C.Z)((0,C.Z)({},this.transform),{},{translateV:this.translateV})}resetImage(){this.scale=1,this.translateH=0,this.translateV=0,this.rotationInput=0,this.canvasRotation=0,this.transform={translateUnit:"px"}}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(Qe.q),e.Y36(Z.r))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-crop-modal"]],viewQuery:function(t,i){if(1&t&&e.Gf(gt,5),2&t){let r;e.iGM(r=e.CRH())&&(i.modalComponent=r.first)}},inputs:{entity:"entity"},features:[e.TTD],decls:4,vars:2,consts:[["size","xl",3,"title","disableCloseButton","hidden"],["modal",""],["appModalBody",""],["appModalFooter",""],[4,"ngIf"],[4,"ngIf","ngIfElse"],["noImage",""],[1,"image-cropper-container"],["alignImage","center",3,"hidden","imageURL","format","aspectRatio","maintainAspectRatio","canvasRotation","transform","cropperReady","imageLoaded","imageCropped"],[1,"image-cropper-utilities","d-flex","flex-wrap","align-items-center","py-1","mt-2","mb-1"],[1,"btn-group","my-2","me-3"],["appTippy","Ruota in senso antiorario",1,"btn","btn-outline-indigo","shadow-none",3,"disableOnTouchDevice","tippyProps","click"],[1,"d-block","material-icons"],["appTippy","Ruota in senso orario",1,"btn","btn-outline-indigo","shadow-none",3,"disableOnTouchDevice","tippyProps","click"],[1,"btn-group","me-3","my-2"],["appTippy","Rifletti orizzontalmente",1,"btn","btn-outline-primary","shadow-none",3,"disableOnTouchDevice","tippyProps","click"],[1,"d-block","material-icons","rotate-z90"],["appTippy","Rifletti verticalmente",1,"btn","btn-outline-primary","shadow-none",3,"disableOnTouchDevice","tippyProps","click"],["appTippy","Zoom in",1,"btn","btn-outline-success","shadow-none",3,"disableOnTouchDevice","tippyProps","click"],["appTippy","Zoom out",1,"btn","btn-outline-success","shadow-none",3,"disableOnTouchDevice","tippyProps","click"],["appTippy","Sposta in alto",1,"btn","btn-outline-secondary","shadow-none",3,"disableOnTouchDevice","tippyProps","click"],[1,"d-block","material-icons-outlined"],["appTippy","Sposta in basso",1,"btn","btn-outline-secondary","shadow-none",3,"disableOnTouchDevice","tippyProps","click"],["appTippy","Sposta a sinistra",1,"btn","btn-outline-secondary","shadow-none",3,"disableOnTouchDevice","tippyProps","click"],["appTippy","Sposta a destra",1,"btn","btn-outline-secondary","shadow-none",3,"disableOnTouchDevice","tippyProps","click"],[1,"btn","shadow-none","my-2","me-3",3,"ngClass","appTippy","disableOnTouchDevice","tippyProps","click"],["aspectBtn",""],[1,"material-icons","d-block"],["appTippy","Ripristina",1,"ms-lg-auto","my-2","btn","btn-danger","shadow-none",3,"disableOnTouchDevice","tippyProps","click"],[1,"container","mb-3"],[1,"row"],[1,"col","col-12","col-lg-4","px-0","pe-lg-2","mb-2","mb-lg-0"],[1,"d-flex"],["for","free-rotation",1,"fs-sm","ps-1"],["type","number","id","free-rotation",1,"form-control",3,"ngModel","ngModelChange"],[1,"col","col-12","col-lg-8","px-0","ps-lg-2","mb-2","mb-lg-0","free-translate-input-group"],["for","free-translate-h",1,"fs-sm","ps-1"],[1,"d-sm-none"],[1,"d-none","d-sm-inline"],["for","free-translate-v",1,"fs-sm","ps-1"],[1,"input-group"],["type","number","id","free-translate-h",1,"form-control",3,"ngModel","ngModelChange"],["type","number","id","free-translate-v",1,"form-control",3,"ngModel","ngModelChange"],[1,"px-3","pb-3","pt-2","rounded","mb-3","mb-1","border-dashed","border-light-gray"],[1,"legend-reset","fs-reset","px-2","mb-0"],[1,"list-unstyled","mb-0"],[1,"mb-3"],[1,"free-dimensions-input-group"],["for","free-width",1,"fs-sm","ps-1"],["for","free-height",1,"fs-sm","ps-1"],["type","number","id","free-width","min","1",1,"form-control",3,"ngClass","ngModel","ngModelChange"],[1,"input-group-text","cursor-pointer",3,"appTippy","disableOnTouchDevice","tippyProps","click"],[1,"material-icons",3,"innerText"],["type","number","id","free-height","min","1",1,"form-control",3,"ngClass","ngModel","ngModelChange"],["class","small px-1",4,"ngIf"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","force-resize",1,"form-check-input",3,"ngModel","ngModelChange"],["for","force-resize",1,"form-check-label","me-auto"],["type","checkbox","role","switch","id","allow-rewrite",1,"form-check-input",3,"ngModel","ngModelChange"],["for","allow-rewrite",1,"form-check-label","me-auto"],["message","Caricamento del tool in corso"],[1,"small","px-1"],[1,"alert","alert-primary","text-center"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,i){1&t&&(e.TgZ(0,"app-modal",0,1),e.NdJ("hidden",function(){return i.resetOnHidden()}),e.YNc(2,nt,1,1,"ng-template",2)(3,Ci,1,1,"ng-template",3),e.qZA()),2&t&&e.Q6J("title","Modifica <em>"+(null==i.entity?null:i.entity.name)+"</em>")("disableCloseButton",!0)},dependencies:[f.mk,f.O5,D.Fj,D.wV,D.Wl,D.JJ,D.qQ,D.On,Ht,qt.R,X.z,re.J,We.j,Re.$,Jt.g],styles:[".rotate-z90[_ngcontent-%COMP%]{transform:rotate(90deg)}.rotate-group[_ngcontent-%COMP%]{width:100%}.free-translate-input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .free-dimensions-input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1 1 1px}.free-dimensions-input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-of-type(2){margin-left:calc(24px + 1.5rem)}@media (min-width: 992px){.rotate-group[_ngcontent-%COMP%]{width:initial}.rotate-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:100px}}"]}),n})();var Se=_(1378),z=_(5661),te=_(658);const xe=["modal"];function ge(s,n){if(1&s&&(e.TgZ(0,"div",9)(1,"a",10),e._UZ(2,"img",11),e.qZA()()),2&s){const o=e.oxw(4);e.xp6(),e.Q6J("href",o.entities[0].url,e.LSH),e.xp6(),e.Q6J("src",o.entities[0].embedUrl,e.LSH)("alt",o.entities[0].name)}}function je(s,n){1&s&&(e.ynx(0),e._uU(1," La cancellazione della cartella comporta anche la "),e.TgZ(2,"strong"),e._uU(3,"cancellazione di tutto il suo contenuto!"),e.qZA(),e._uU(4," Si consiglia di procedere solo se si \xe8 sicuro di voler rimuovere definitivamente la cartella. "),e.BQk())}function ae(s,n){if(1&s&&(e.ynx(0),e.YNc(1,ge,3,3,"div",7),e.TgZ(2,"div",8),e._uU(3," La cancellazione di "),e.TgZ(4,"em"),e._uU(5),e.qZA(),e._uU(6," \xe8 "),e.TgZ(7,"strong"),e._uU(8,"definitiva"),e.qZA(),e._uU(9,", senza possibilit\xe0 di ripristino. "),e.qZA(),e.TgZ(10,"p"),e._uU(11," Il suo link non sar\xe0 pi\xf9 funzionante e, di conseguenza, i siti su cui \xe8 stato condiviso non riusciranno pi\xf9 a visualizzarlo. "),e.YNc(12,je,5,0,"ng-container",4),e.qZA(),e.BQk()),2&s){const o=e.oxw(3);e.xp6(),e.Q6J("ngIf",o.entities[0].isImage),e.xp6(4),e.Oqu(o.entities[0].name),e.xp6(7),e.Q6J("ngIf",o.entities[0].type===o.entityTypes.FOLDER)}}function me(s,n){if(1&s&&(e.TgZ(0,"div",8),e._uU(1," Saranno cancellati "),e.TgZ(2,"strong"),e._uU(3,"definitivamente"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6," Tutti i file selezionati non saranno pi\xf9 accessibili, pertanto eventuali link condivisi non saranno pi\xf9 funzionanti. L'operazione potrebbe richiedere diverso tempo. "),e.qZA()),2&s){const o=e.oxw(3);e.xp6(4),e.hij(" i ",o.entities.length," file selezionati! ")}}function Gt(s,n){if(1&s&&(e.ynx(0),e.YNc(1,ae,13,3,"ng-container",5)(2,me,7,1,"ng-template",null,6,e.W1O),e.BQk()),2&s){const o=e.MAs(3),t=e.oxw(2);e.xp6(),e.Q6J("ngIf",1===t.entities.length)("ngIfElse",o)}}function Yt(s,n){if(1&s&&e.YNc(0,Gt,4,2,"ng-container",4),2&s){const o=e.oxw();e.Q6J("ngIf",o.opened&&o.entities[0])}}function ot(s,n){if(1&s){const o=e.EpF();e.ynx(0,13),e.TgZ(1,"button",14),e.NdJ("click",function(){e.CHM(o),e.oxw(2);const i=e.MAs(1);return e.KtG(i.close("Close click"))}),e._uU(2," Annulla "),e.qZA(),e.TgZ(3,"button",15),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.deleteEntity())}),e._uU(4," Elimina! "),e.qZA(),e.BQk()}}function ie(s,n){if(1&s&&e.YNc(0,ot,5,0,"ng-container",12),2&s){const o=e.oxw();e.Q6J("ngIf",o.opened&&o.entities[0])}}let st=(()=>{var s;class n{constructor(t,i){this.toastService=t,this.uploadService=i,this.currentFolderPath=[],this.entities=[],this.deleteStartEvent=new e.vpe,this.deleteEndEvent=new e.vpe,this.opened=!1,this.entityTypes=v.VC,this.modalTitle=""}ngOnChanges(t){if(t.entities&&!t.entities.firstChange)if(this.entities.length>1)this.modalTitle="Rimuovi ".concat(this.entities.length," file");else if(1===this.entities.length){var i;this.modalTitle="Rimuovi <em>".concat((null===(i=this.entities[0])||void 0===i?void 0:i.name)||"","</em>")}else this.modalTitle="Rimuovi 0 file"}open(){return this.opened=!0,this.modalComponent.open()}onHidden(){this.opened=!1}deleteEntity(){var t=this;return(0,T.Z)(function*(){if(!t.opened||!t.entities[0])return;const i=[...t.currentFolderPath];t.modalComponent.close(),t.deleteStartEvent.emit({destPath:i,list:t.entities});let r=!1;for(const a of t.entities)if(r=yield t.uploadService.deleteEntity(i,a.name),!r)break;if(t.deleteEndEvent.emit(),r)if(1===t.entities.length){const a=t.entities[0],d="La rimozione "+(a.type===v.VC.FILE?"del file":"della cartella")+" <strong>".concat(a.name,"</strong> \xe8 avvenuta con successo!");t.toastService.show({content:d})}else t.toastService.show({content:"<strong>".concat(t.entities.length," file</strong> eliminati con successo!")});else t.toastService.show({content:"Errore nella rimozione!",level:Se.m.ERROR})})()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(z.k),e.Y36(te.C))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-delete-modal"]],viewQuery:function(t,i){if(1&t&&e.Gf(xe,5),2&t){let r;e.iGM(r=e.CRH())&&(i.modalComponent=r.first)}},inputs:{currentFolderPath:"currentFolderPath",entities:"entities"},outputs:{deleteStartEvent:"deleteStartEvent",deleteEndEvent:"deleteEndEvent"},features:[e.TTD],decls:4,vars:2,consts:[[3,"title","disableCloseButton","hidden"],["modal",""],["appModalBody",""],["appModalFooter",""],[4,"ngIf"],[4,"ngIf","ngIfElse"],["multipleEntity",""],["class","preview py-1 text-center mb-3",4,"ngIf"],[1,"alert","alert-danger","text-center"],[1,"preview","py-1","text-center","mb-3"],["target","_blank","rel","noreferrer",1,"d-inline-block","mw-100",3,"href"],[1,"d-inline-block","mw-100",3,"src","alt"],["footer","",4,"ngIf"],["footer",""],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"app-modal",0,1),e.NdJ("hidden",function(){return i.onHidden()}),e.YNc(2,Yt,1,1,"ng-template",2)(3,ie,1,1,"ng-template",3),e.qZA()),2&t&&e.Q6J("title",i.modalTitle)("disableCloseButton",!0)},dependencies:[f.O5,X.z,re.J,We.j],styles:[".preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:200px}"]}),n})();var k=_(4020),vt=_(2457),rt=_(4228);const Ct=["modal"];function at(s,n){if(1&s&&(e.TgZ(0,"div",11)(1,"a",12),e._UZ(2,"img",13),e.qZA()()),2&s){const o=e.oxw(3);e.xp6(),e.Q6J("href",o.entities[0].url,e.LSH),e.xp6(),e.Q6J("src",o.entities[0].embedUrl,e.LSH)("alt",o.entities[0].name)}}function Ue(s,n){1&s&&e.GkF(0)}function bi(s,n){1&s&&e.GkF(0)}const xt=s=>({$implicit:s,description:"Tag de"});function bt(s,n){if(1&s&&(e.TgZ(0,"li"),e.YNc(1,bi,1,0,"ng-container",6),e.qZA()),2&s){const o=e.oxw(3),t=e.MAs(4);e.xp6(),e.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",e.VKq(2,xt,o.html.tag))}}function Wt(s,n){1&s&&e.GkF(0)}function Ti(s,n){1&s&&e.GkF(0)}function yi(s,n){if(1&s&&(e.TgZ(0,"li"),e.YNc(1,Ti,1,0,"ng-container",6),e.qZA()),2&s){const o=e.oxw(3),t=e.MAs(4);e.xp6(),e.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",e.VKq(2,xt,o.bbcode.tag))}}function l(s,n){1&s&&e.GkF(0)}const c=s=>({$implicit:s,description:"Url de"}),p=s=>({$implicit:s,description:"Link a"});function u(s,n){if(1&s&&(e.ynx(0),e.YNc(1,at,3,3,"div",5),e.TgZ(2,"div"),e.YNc(3,Ue,1,0,"ng-container",6),e.qZA(),e.TgZ(4,"fieldset",7)(5,"legend",8),e._uU(6,"HTML"),e.qZA(),e.TgZ(7,"ul",9),e.YNc(8,bt,2,4,"li",4),e.TgZ(9,"li"),e.YNc(10,Wt,1,0,"ng-container",6),e.qZA()()(),e.TgZ(11,"fieldset",10)(12,"legend",8),e._uU(13,"BBCODE"),e.qZA(),e.TgZ(14,"ul",9),e.YNc(15,yi,2,4,"li",4),e.TgZ(16,"li"),e.YNc(17,l,1,0,"ng-container",6),e.qZA()()(),e.BQk()),2&s){const o=e.oxw(2),t=e.MAs(4);e.xp6(),e.Q6J("ngIf",1===o.entities.length&&o.entities[0].isImage),e.xp6(2),e.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",e.VKq(9,c,o.urls)),e.xp6(5),e.Q6J("ngIf",o.html.tag.length),e.xp6(2),e.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",e.VKq(11,p,o.html.link)),e.xp6(5),e.Q6J("ngIf",o.bbcode.tag.length),e.xp6(2),e.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",e.VKq(13,p,o.bbcode.link))}}function m(s,n){if(1&s&&e.YNc(0,u,18,15,"ng-container",4),2&s){const o=e.oxw();e.Q6J("ngIf",o.entities.length)}}function x(s,n){if(1&s&&(e.TgZ(0,"div",14),e._uU(1),e.qZA(),e._UZ(2,"app-custom-pre",15),e.ALo(3,"arrayJoin")),2&s){const o=n.$implicit,t=n.description;e.xp6(),e.AsE(" ",t,"",o.length>1?"gli elementi":"ll'elemento",": "),e.xp6(),e.Q6J("content",e.xi3(3,3,o,"\n"))}}let O=(()=>{var s;class n{constructor(){this.entities=[],this.touchDevice=k.b1,this.modalTitle="",this.urls=[],this.html={tag:[],link:[]},this.bbcode={tag:[],link:[]},this.opened=!1}ngOnChanges(t){if(this.opened&&t.entities&&!t.entities.firstChange){var i;this.modalTitle=1!==this.entities.length?"Codici delle immagini":"Codici di <em>".concat((null===(i=this.entities[0])||void 0===i?void 0:i.name)||"","</em>"),this.urls=[],this.html={tag:[],link:[]},this.bbcode={tag:[],link:[]};for(const r of this.entities)this.urls.push(r.url),this.html.link.push('<a href="'.concat(r.url,'" target="_blank">').concat(r.name,"</a>")),this.bbcode.link.push("[URL=".concat(r.url,"]").concat(r.name,"[/URL]")),r.isImage&&(this.html.tag.push('<img src="'.concat(r.url,'" alt="').concat(r.name,'">')),this.bbcode.tag.push("[IMG]".concat(r.url,"[/IMG]")))}}open(){return this.opened=!0,this.modalComponent.open()}onHidden(){this.opened=!1}}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-file-links-modal"]],viewQuery:function(t,i){if(1&t&&e.Gf(Ct,5),2&t){let r;e.iGM(r=e.CRH())&&(i.modalComponent=r.first)}},inputs:{entities:"entities"},features:[e.TTD],decls:5,vars:1,consts:[[3,"title","hidden"],["modal",""],["appModalBody",""],["linkInput",""],[4,"ngIf"],["class","preview py-1 text-center mb-2",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"px-3","pb-3","pt-1","rounded","mt-3","border-dashed","border-light-gray"],[1,"legend-reset","fs-reset","px-2","mb-0"],[1,"list-unstyled","mb-0"],[1,"px-3","pb-3","pt-1","rounded","mt-3","mb-1","border-dashed","border-light-gray"],[1,"preview","py-1","text-center","mb-2"],["target","_blank","rel","noreferrer",1,"d-inline-block","mw-100",3,"href"],[1,"d-inline-block","mw-100",3,"src","alt"],[1,"fs-sm","d-inline-block"],[3,"content"]],template:function(t,i){1&t&&(e.TgZ(0,"app-modal",0,1),e.NdJ("hidden",function(){return i.onHidden()}),e.YNc(2,m,1,1,"ng-template",2),e.qZA(),e.YNc(3,x,4,6,"ng-template",null,3,e.W1O)),2&t&&e.Q6J("title",i.modalTitle)},dependencies:[f.O5,f.tP,vt.s,X.z,re.J,rt.J],styles:[".preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:200px}fieldset[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:not(:first-of-type){margin-top:.75rem}"]}),n})();const R=["modal"];function H(s,n){1&s&&(e.TgZ(0,"p",15),e._uU(1," \xc8 possibile spostare pi\xf9 file contemporaneamente in una stessa destinazione. Occorre sottolineare che, a seguito dello spostamento, tutti i "),e.TgZ(2,"strong"),e._uU(3,"link dei file saranno modificati"),e.qZA(),e._uU(4," e, pertanto, i vacchi indirizzi non risulteranno pi\xf9 funzionanti. L'operazione potrebbe richiedere diverso tempo. "),e.qZA())}function B(s,n){1&s&&(e.TgZ(0,"p",15),e._uU(1," \xc8 possibile spostare un file nella cartella base ("),e.TgZ(2,"em"),e._uU(3,"root"),e.qZA(),e._uU(4,"), in quella di livello superiore, se esistente, oppure in una sottocartella presente nella cartella corrente. Spostanto un file, verr\xe0 "),e.TgZ(5,"strong"),e._uU(6,"modificato anche il suo link"),e.qZA(),e._uU(7,", pertanto eventuali link gi\xe0 condivisi andranno aggiornati. "),e.qZA())}function le(s,n){1&s&&(e.TgZ(0,"p",15),e._uU(1," \xc8 possibile spostare un'intera cartella e "),e.TgZ(2,"strong"),e._uU(3,"tutto il suo contenuto"),e.qZA(),e._uU(4," nella cartella base ("),e.TgZ(5,"em"),e._uU(6,"root"),e.qZA(),e._uU(7,"), in quella di livello superiore, se esistente, oppure in una sottocartella presente nella cartella corrente. Occorre evidenziare che, spostando una cartella, i "),e.TgZ(8,"strong"),e._uU(9,"link di tutti gli elementi"),e.qZA(),e._uU(10," in essa contenuti saranno "),e.TgZ(11,"strong"),e._uU(12,"modificati"),e.qZA(),e._uU(13," e, pertanto, se gi\xe0 condivisi andranno aggiornati. "),e.qZA())}function kn(s,n){if(1&s&&e.YNc(0,B,8,0,"p",7)(1,le,14,0,"ng-template",null,16,e.W1O),2&s){const o=e.MAs(2),t=e.oxw(3);e.Q6J("ngIf",t.entities[0].type===t.entityTypes.FILE)("ngIfElse",o)}}function Rn(s,n){1&s&&e.GkF(0)}const Mi=s=>({$implicit:s});function Nn(s,n){if(1&s&&(e.TgZ(0,"div",17),e.YNc(1,Rn,1,0,"ng-container",14),e.qZA()),2&s){const o=e.oxw(3),t=e.MAs(5);e.xp6(),e.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",e.VKq(2,Mi,o.newLink?o.newLink:o.entities[0].url))}}function zn(s,n){1&s&&e.GkF(0)}const Hn=s=>({"mt-2":s}),qn=(s,n,o)=>({loading:s,"has-error":n,"touch-device":o});function Jn(s,n){if(1&s&&(e.ynx(0),e.YNc(1,H,5,0,"p",7)(2,kn,3,2,"ng-template",null,8,e.W1O),e.TgZ(4,"p")(5,"em"),e._uU(6,"Tip:"),e.qZA(),e._uU(7," cliccando sulla "),e.TgZ(8,"strong"),e._uU(9,"freccia blu"),e.qZA(),e._uU(10," accanto al nome della cartella \xe8 possibile navigare nelle eventuali sottocartelle. Se non \xe8 presente alcun simbolo accanto al nome di una cartella, quest'ultima non ha sottocartelle. "),e.qZA(),e.TgZ(11,"div",9),e.YNc(12,Nn,2,4,"div",10),e.TgZ(13,"fieldset",11)(14,"legend",12),e._uU(15," Cartella di destinazione: "),e.qZA(),e.TgZ(16,"ul",13),e.YNc(17,zn,1,0,"ng-container",14),e.qZA()()(),e.BQk()),2&s){const o=e.MAs(3),t=e.oxw(2),i=e.MAs(7);e.xp6(),e.Q6J("ngIf",t.entities.length>1)("ngIfElse",o),e.xp6(11),e.Q6J("ngIf",1===t.entities.length),e.xp6(),e.Q6J("ngClass",e.VKq(7,Hn,t.entities.length>1)),e.xp6(3),e.Q6J("ngClass",e.kEZ(9,qn,t.loading,!t.isValid,t.touchDevice)),e.xp6(),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.VKq(13,Mi,t.folders[0]))}}function Qn(s,n){if(1&s&&e.YNc(0,Jn,18,15,"ng-container",6),2&s){const o=e.oxw();e.Q6J("ngIf",o.entities[0])}}function Bn(s,n){if(1&s){const o=e.EpF();e.ynx(0,19),e.TgZ(1,"button",20),e.NdJ("click",function(){e.CHM(o),e.oxw(2);const i=e.MAs(1);return e.KtG(i.close("Close click"))}),e._uU(2," Annulla "),e.qZA(),e.TgZ(3,"button",21),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.move())}),e._uU(4," Sposta "),e.qZA(),e.BQk()}if(2&s){const o=e.oxw(2);e.xp6(3),e.Q6J("disabled",!o.isValid)}}function Vn(s,n){if(1&s&&e.YNc(0,Bn,5,1,"ng-container",18),2&s){const o=e.oxw();e.Q6J("ngIf",o.entities.length)}}const Gn=s=>({placement:"top",hideOnClick:s});function Yn(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"label",22),e._uU(1,"Anteprima nuovo link:"),e.qZA(),e.TgZ(2,"div",23),e._UZ(3,"input",24),e.TgZ(4,"div",25,26),e.NdJ("click",function(){e.CHM(o);const i=e.MAs(5),r=e.oxw();return e.KtG(!r.touchDevice&&i.changeContent("Copiato!","Copia"))}),e.TgZ(6,"span",27),e._uU(7,"content_copy"),e.qZA()()()}if(2&s){const o=n.$implicit,t=e.oxw();e.xp6(3),e.Q6J("value",o),e.xp6(),e.Q6J("cdkCopyToClipboard",o)("appTippy",t.touchDevice?"Copiato!":"Copia")("tippyProps",e.VKq(4,Gn,t.touchDevice))}}function Wn(s,n){1&s&&(e.ynx(0),e.TgZ(1,"div",34)(2,"div",35)(3,"span",36),e._uU(4,"Loading..."),e.qZA()()(),e.BQk())}const Kn=s=>({"is-expanded":s});function $n(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"a",38),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(2).$implicit,r=e.oxw();return e.KtG(r.getSubfolders(i))}),e.TgZ(1,"div",39),e._uU(2," chevron_right "),e.qZA()()}if(2&s){const o=e.oxw(2).$implicit;e.Q6J("ngClass",e.VKq(1,Kn,!o.collapsed))}}function jn(s,n){if(1&s&&e.YNc(0,$n,3,3,"a",37),2&s){const o=e.oxw().$implicit;e.Q6J("ngIf",!o.checked||o.subfolders.length)}}const Xn=()=>[5,10],eo=s=>({placement:"top-end",offset:s});function to(s,n){if(1&s&&(e.TgZ(0,"div",40)(1,"div",41),e._uU(2,"info"),e.qZA()()),2&s){const o=e.oxw(2);e.Q6J("appTippy",o.errorMessage)("tippyProps",e.VKq(3,eo,e.DdM(2,Xn)))}}function io(s,n){1&s&&e.GkF(0)}function no(s,n){if(1&s&&(e.ynx(0),e.YNc(1,io,1,0,"ng-container",14),e.BQk()),2&s){const o=n.$implicit;e.oxw(3);const t=e.MAs(7);e.xp6(),e.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",e.VKq(2,Mi,o))}}function oo(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"ul",42),e.NdJ("ngbCollapseChange",function(i){e.CHM(o);const r=e.oxw().$implicit;return e.KtG(r.collapsed=i)}),e.YNc(1,no,2,4,"ng-container",43),e.qZA()}if(2&s){const o=e.oxw().$implicit;e.Q6J("ngbCollapse",o.collapsed),e.xp6(),e.Q6J("ngForOf",o.subfolders)}}const so=(s,n)=>({selected:s,"ps-2":n});function ro(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"li")(1,"div",28),e.YNc(2,Wn,5,0,"ng-container",29)(3,jn,1,1,"ng-template",null,30,e.W1O),e.TgZ(5,"div",31),e.NdJ("click",function(){const r=e.CHM(o).$implicit,a=e.oxw();return e.KtG(a.setSelectedPath(r,r.collapsed))}),e.qZA(),e.YNc(6,to,3,5,"div",32),e.qZA(),e.YNc(7,oo,2,2,"ul",33),e.qZA()}if(2&s){const o=n.$implicit,t=e.MAs(4),i=e.oxw();e.xp6(),e.Q6J("ngClass",e.WLB(6,so,i.selectedPathAsString===o.pathString,!o.loading&&o.checked&&0===o.subfolders.length)),e.xp6(),e.Q6J("ngIf",o.loading)("ngIfElse",t),e.xp6(3),e.Q6J("innerHTML",o.name,e.oJD),e.xp6(),e.Q6J("ngIf",!i.isValid&&i.selectedPathAsString===o.pathString),e.xp6(),e.Q6J("ngIf",o.subfolders.length>0)}}let ao=(()=>{var s;class n{constructor(t,i,r){this.uploadService=t,this.toastService=i,this.uploadObservablesService=r,this.currentFolderPath=[],this.entities=[],this.moveEvent=new e.vpe,this.deleteBeforeMovingEvent=new e.vpe,this.touchDevice=k.b1,this.entityTypes=v.VC,this.modalTitle="",this.newLink="",this.isValid=!1,this.loading=!1,this.currentFolderPathAsString="",this.errorMessage="",this.folders=[],this.newFolderPath=[],this.basepath="",this.opened=!1}ngOnInit(){this.currentFolderPathAsString=this.currentFolderPath.join("/"),this.setRootFolder(),this.startExternalMoveSubscription=this.uploadObservablesService.startMoveObservable.subscribe(t=>{this.sendMoveRequest(t.destPath,t.originPath,t.entities)})}ngOnChanges(t){if(t.entities&&!t.entities.firstChange){if(this.entities.length>1)this.modalTitle="Sposta ".concat(this.entities.length," file");else if(1===this.entities.length){var i;this.modalTitle="Sposta <em>".concat((null===(i=this.entities[0])||void 0===i?void 0:i.name)||"","</em>")}else this.modalTitle="Sposta 0 file";const r=this.entities[0].url.match(/^(https:\/\/[^/]*\/i\/[^/]*)/);r&&(this.basepath="".concat(r[0],"/"))}t.currentFolderPath&&!t.currentFolderPath.firstChange&&(this.currentFolderPathAsString=this.currentFolderPath.join("/"))}open(){return this.opened=!0,this.reset(),this.modalComponent.open()}onHidden(){this.opened=!1}reset(){this.selectedPathAsString=void 0,this.newLink="",this.newFolderPath=[],this.isValid=!1,this.setRootFolder()}setRootFolder(){this.folders=[{name:"Cartella base (root)",paths:[],pathString:"",checked:!1,loading:!1,collapsed:!0,subfolders:[]}]}move(){var t=this;return(0,T.Z)(function*(){if(!t.opened||!t.isValid||!t.entities[0])return;const i=[...t.newFolderPath],r=[...t.currentFolderPath],a=[...t.entities];t.modalComponent.close(),t.sendMoveRequest(i,r,a)})()}sendMoveRequest(t,i,r){var a=this;return(0,T.Z)(function*(){a.deleteBeforeMovingEvent.emit({destPath:i,list:r});const d=1===r.length?(r[0].type===v.VC.FILE?"File <strong>".concat(r[0].name,"</strong> spostato"):"Cartella <strong>".concat(r[0].name,"</strong> spostata"))+" con successo!":"<strong>".concat(r.length," elementi</strong> spostati con successo!"),g=[];for(let y=0;y<r.length;y+=5){const M=r.slice(y,y+5),A=yield Promise.all(M.map(S=>a.uploadService.moveRenameEntity(i,t,S.name)));g.push(...A.map((S,N)=>({data:S,type:M[N].type})))}a.moveEvent.emit({list:r,destPath:t,originPath:i,results:g}),a.toastService.show({content:d})})()}getSubfolders(t){var i=this;return(0,T.Z)(function*(){if(i.loading)return;if(t.checked){if(0===t.subfolders.length)return;return t.collapsed||i.closeSubfoldersCollapseElements(t),void(t.collapsed=!t.collapsed)}i.loading=t.loading=!0;const r=yield i.uploadService.getFileList(t.paths);r.folders.length&&(t.subfolders=r.folders.map(a=>{const d=[...t.paths,a.name];return{name:a.name,paths:d,pathString:d.join("/"),checked:!1,loading:!1,collapsed:!0,subfolders:[]}}).sort((a,d)=>a.name.localeCompare(d.name))),t.checked=!0,setTimeout(()=>{t.subfolders.length>0&&(t.collapsed=!t.collapsed),i.loading=t.loading=!1},200)})()}setSelectedPath(t,i=!1){if(i&&this.getSubfolders(t).then(),this.selectedPathAsString=t.paths.join("/"),this.selectedPathAsString===this.currentFolderPathAsString)return this.isValid=!1,this.newLink="",void(this.errorMessage="La cartella di origine \xe8 uguale alla destinazione!");if(this.newFolderPath=[...t.paths],1===this.entities.length){if(this.entities[0].type===v.VC.FOLDER&&(this.selectedPathAsString+"/").startsWith(this.currentFolderPathAsString+(this.currentFolderPathAsString.length?"/":"")+this.entities[0].name+"/"))return this.isValid=!1,this.newLink="",void(this.errorMessage="La cartella di arrivo contiene quella di origine!");this.newLink=this.basepath+"".concat(this.newFolderPath.map(a=>encodeURIComponent(a)).join("/"))+(this.newFolderPath.length?"/":"")+encodeURIComponent(this.entities[0].name)}this.isValid=!0}closeSubfoldersCollapseElements(t){if(t.subfolders)for(const i of t.subfolders)i.collapsed=!0,this.closeSubfoldersCollapseElements(i)}ngOnDestroy(){var t;null===(t=this.startExternalMoveSubscription)||void 0===t||t.unsubscribe()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(te.C),e.Y36(z.k),e.Y36(Z.r))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-move-modal"]],viewQuery:function(t,i){if(1&t&&e.Gf(R,5),2&t){let r;e.iGM(r=e.CRH())&&(i.modalComponent=r.first)}},inputs:{currentFolderPath:"currentFolderPath",entities:"entities"},outputs:{moveEvent:"moveEvent",deleteBeforeMovingEvent:"deleteBeforeMovingEvent"},features:[e.TTD],decls:8,vars:2,consts:[[3,"title","disableCloseButton","hidden"],["modal",""],["appModalBody",""],["appModalFooter",""],["newLinkInput",""],["folderTree",""],[4,"ngIf"],["class","mb-1",4,"ngIf","ngIfElse"],["singleEntity",""],[1,"mt-2"],["class","mb-3",4,"ngIf"],[1,"pb-3","pt-2","rounded","border-dashed","border-light-gray",3,"ngClass"],[1,"legend-reset","fs-sm","px-2","mb-0"],[1,"list-unstyled","mb-0","folder-tree",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mb-1"],["folderDesc",""],[1,"mb-3"],["footer","",4,"ngIf"],["footer",""],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["for","new-link",1,"fs-sm"],[1,"input-group"],["type","text","id","new-link","disabled","",1,"form-control",3,"value"],[1,"input-group-text","cursor-pointer",3,"cdkCopyToClipboard","appTippy","tippyProps","click"],["tippyRef","appTippy"],[1,"material-icons","d-block","text-muted"],[1,"d-flex","align-items-center","tree-title","rounded",3,"ngClass"],[4,"ngIf","ngIfElse"],["collapseButton",""],[1,"cursor-pointer","flex-grow-1","f-name","me-2","text-truncate",3,"innerHTML","click"],["class","me-1 d-flex cursor-pointer flex-shrink-0",3,"appTippy","tippyProps",4,"ngIf"],["class","list-unstyled collapse-content sub-tree mb-0",3,"ngbCollapse","ngbCollapseChange",4,"ngIf"],[1,"spinner-cont","d-flex","align-items-center","flex-shrink-0"],["role","status",1,"spinner-border"],[1,"visually-hidden"],["role","button","class","d-flex align-items-center collapse-btn flex-shrink-0",3,"ngClass","click",4,"ngIf"],["role","button",1,"d-flex","align-items-center","collapse-btn","flex-shrink-0",3,"ngClass","click"],[1,"collapse-icon","collapse-icon-right","material-icons"],[1,"me-1","d-flex","cursor-pointer","flex-shrink-0",3,"appTippy","tippyProps"],[1,"material-icons-outlined","icon-small"],[1,"list-unstyled","collapse-content","sub-tree","mb-0",3,"ngbCollapse","ngbCollapseChange"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(e.TgZ(0,"app-modal",0,1),e.NdJ("hidden",function(){return i.onHidden()}),e.YNc(2,Qn,1,1,"ng-template",2)(3,Vn,1,1,"ng-template",3),e.qZA(),e.YNc(4,Yn,8,6,"ng-template",null,4,e.W1O)(6,ro,8,9,"ng-template",null,5,e.W1O)),2&t&&e.Q6J("title",i.modalTitle)("disableCloseButton",!0)},dependencies:[De.i3,f.mk,f.sg,f.O5,f.tP,X.z,re.J,We.j,U._D,Re.$],styles:["fieldset[_ngcontent-%COMP%]{padding-left:11px;padding-right:11px}.folder-tree.loading[_ngcontent-%COMP%]{pointer-events:none!important}.sub-tree[_ngcontent-%COMP%]{margin-left:.125rem}.spinner-cont[_ngcontent-%COMP%]{width:24px;height:24px;padding:6px}.spinner-border[_ngcontent-%COMP%]{width:100%;height:100%;border-width:.125rem;color:#4864fe}.tree-title[_ngcontent-%COMP%]{transition:background-color .2s}.folder-tree[_ngcontent-%COMP%]:not(.touch-device)   .tree-title[_ngcontent-%COMP%]:not(.selected):hover{background-color:rgb(var(--bs-light-rgb))}.f-name[_ngcontent-%COMP%]{padding:.125rem 0}.folder-tree[_ngcontent-%COMP%]:not(.has-error)   .tree-title.selected[_ngcontent-%COMP%]{background-color:#dae0ff}.has-error[_ngcontent-%COMP%]   .tree-title.selected[_ngcontent-%COMP%]{background-color:#f1d5d8;color:#701b23}.has-error[_ngcontent-%COMP%]   .tree-title.selected[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:inherit!important}.has-error[_ngcontent-%COMP%]   .tree-title.selected[_ngcontent-%COMP%]   .spinner-border[_ngcontent-%COMP%]{color:#701b23}@media (min-width: 992px){.sub-tree[_ngcontent-%COMP%]{margin-left:11px;padding-left:12px;border-left:1px solid #dee2e6}}"]}),n})();var Ne=_(1990);const lo=["modal"];function co(s,n){1&s&&(e.ynx(0),e._uU(1," \xc8 possibile rinominare un file liberamente, tuttavia occorre tenere presente che "),e.TgZ(2,"strong"),e._uU(3,"la modifica del nome comporta il cambiamento del link"),e.qZA(),e._uU(4,", pertanto al termine dell'operazione andranno aggiornati tutti i link gi\xe0 condivisi, i quali in caso contrario non saranno pi\xf9 funzionanti. "),e.BQk())}function po(s,n){1&s&&(e._uU(0," Rinominando una cartella, verr\xe0 "),e.TgZ(1,"strong"),e._uU(2,"modificato il link di tutti i file contenuti"),e.qZA(),e._uU(3," in essa. Pertanto, eventuali link gi\xe0 condivisi non saranno pi\xf9 funzionanti e andranno aggiornati. "))}function ho(s,n){1&s&&(e.ynx(0),e._uU(1," Il nome non pu\xf2 essere vuoto! "),e.BQk())}function uo(s,n){if(1&s&&e._UZ(0,"span",24),2&s){const o=e.oxw(5);e.Q6J("innerHTML",o.errorMessage,e.oJD)}}function go(s,n){1&s&&e._uU(0,"Questo nome \xe8 gi\xe0 in uso!")}function mo(s,n){if(1&s&&e.YNc(0,uo,1,1,"span",22)(1,go,1,0,"ng-template",null,23,e.W1O),2&s){const o=e.MAs(2),t=e.oxw(4);e.Q6J("ngIf",!t.nameValidationErrors.alreadyUsed)("ngIfElse",o)}}function _o(s,n){if(1&s&&(e.TgZ(0,"div",20),e.YNc(1,ho,2,0,"ng-container",7)(2,mo,3,2,"ng-template",null,21,e.W1O),e.qZA()),2&s){const o=e.MAs(3),t=e.oxw(3);e.xp6(),e.Q6J("ngIf",t.nameValidationErrors.invalidLength)("ngIfElse",o)}}function fo(s,n){1&s&&e.GkF(0)}const vo=(s,n)=>({"is-valid":s,"is-invalid":n}),Co=s=>({$implicit:s});function xo(s,n){if(1&s){const o=e.EpF();e.ynx(0),e.TgZ(1,"p",6),e._uU(2," Il nome pu\xf2 contenere i caratteri "),e.TgZ(3,"em"),e._uU(4,"a-z"),e.qZA(),e._uU(5,", sia maiuscoli che minuscoli, i trattini alti e bassi "),e.TgZ(6,"em"),e._uU(7,"-_"),e.qZA(),e._uU(8," e i numeri. "),e.YNc(9,co,5,0,"ng-container",7)(10,po,4,0,"ng-template",null,8,e.W1O),e.qZA(),e.TgZ(12,"div",9)(13,"label",10),e._uU(14,"Nome attuale:"),e.qZA(),e._UZ(15,"input",11),e.qZA(),e.TgZ(16,"fieldset",12)(17,"legend",13),e._uU(18," Valori modificati "),e.qZA(),e.TgZ(19,"ul",14)(20,"li")(21,"label",15),e._uU(22,"Nuovo nome:"),e.qZA(),e.TgZ(23,"input",16,17),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw(2);return e.KtG(r.newName=i)})("ngModelChange",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.checkNameValidity())}),e.qZA(),e.YNc(25,_o,4,2,"div",18),e.qZA(),e.TgZ(26,"li"),e.YNc(27,fo,1,0,"ng-container",19),e.qZA()()(),e.BQk()}if(2&s){const o=e.MAs(11),t=e.MAs(24),i=e.oxw(2),r=e.MAs(5);e.xp6(9),e.Q6J("ngIf",i.entity.type===i.entityTypes.FILE)("ngIfElse",o),e.xp6(6),e.Q6J("value",i.currentName),e.xp6(8),e.Q6J("pattern",i.entity.type===i.entityTypes.FILE?i.filenameValidationRegex:i.foldernameValidationRegex)("ngClass",e.WLB(9,vo,i.currentName!==i.newName&&t.dirty&&i.isNewNameValid,t.dirty&&!i.isNewNameValid))("ngModel",i.newName),e.xp6(2),e.Q6J("ngIf",!i.isNewNameValid),e.xp6(2),e.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",e.VKq(12,Co,i.path+i.newNameParsedUrl+i.ext))}}function bo(s,n){if(1&s&&e.YNc(0,xo,28,14,"ng-container",5),2&s){const o=e.oxw();e.Q6J("ngIf",o.entity)}}function To(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(o),e.oxw();const i=e.MAs(1);return e.KtG(i.close("Close click"))}),e._uU(1," Annulla "),e.qZA(),e.TgZ(2,"button",26),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.rename())}),e._uU(3," Salva "),e.qZA()}if(2&s){const o=e.oxw();e.xp6(2),e.Q6J("disabled",o.currentName===o.newName||!o.isNewNameValid)}}const yo=s=>({placement:"top",hideOnClick:s});function Mo(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"label",27),e._uU(1,"Anteprima nuovo link:"),e.qZA(),e.TgZ(2,"div",28),e._UZ(3,"input",29),e.TgZ(4,"div",30,31),e.NdJ("click",function(){e.CHM(o);const i=e.MAs(5),r=e.oxw();return e.KtG(!r.touchDevice&&i.changeContent("Copiato!","Copia"))}),e.TgZ(6,"span",32),e._uU(7,"content_copy"),e.qZA()()()}if(2&s){const o=n.$implicit,t=e.oxw();e.xp6(3),e.Q6J("value",o),e.xp6(),e.Q6J("cdkCopyToClipboard",o)("appTippy",t.touchDevice?"Copiato!":"Copia")("tippyProps",e.VKq(4,yo,t.touchDevice))}}let wo=(()=>{var s;class n{constructor(t,i,r){this.toastService=t,this.uploadService=i,this.uploadObservablesService=r,this.currentFolderPath=[],this.reservedNames=[],this.renameEvent=new e.vpe,this.touchDevice=k.b1,this.currentName="",this.newName="",this.newNameParsedUrl="",this.ext="",this.isNewNameValid=!1,this.entityTypes=v.VC,this.path="",this.filenameValidationRegex=Ne.JJ,this.foldernameValidationRegex=Ne.b3,this.errorMessage="",this.nameValidationErrors=Ne.uJ,this.characterFileErrorMessage="Il nome pu\xf2 contenere solo i caratteri <em>a-z</em>, i trattini alti e bassi <em>-_</em>, gli spazi, i punti e i numeri!",this.characterFolderErrorMessage="Il nome pu\xf2 contenere solo i caratteri <em>a-z</em>, i trattini alti e bassi <em>-_</em>, gli spazi e i numeri!",this.startAndEndErrorMessage="Il nome non pu\xf2 iniziare o finire con un punto o uno spazio!",this.opened=!1}ngOnChanges(t){t.entity&&!t.entity.firstChange&&this.entity&&(this.ext=this.entity.ext?".".concat(this.entity.ext):"",this.currentName=this.newName=this.ext?this.entity.name.replace(this.ext,""):this.entity.name,this.path=this.entity.url.split("/").slice(0,-1).join("/")+"/",this.createNameForUrl())}open(){return this.opened=!0,this.modalComponent.open()}onHidden(){this.opened=!1,this.newName=this.newNameParsedUrl=this.currentName,this.isNewNameValid=!1,this.nameValidationErrors=Ne.uJ}checkNameValidity(){var t;this.nameValidationErrors=(0,F.rc)(this.newName,this.currentName,(null===(t=this.entity)||void 0===t?void 0:t.type)||v.VC.FILE,this.reservedNames||[],this.ext),this.isNewNameValid=!Object.values(this.nameValidationErrors).some(i=>i),this.isNewNameValid?this.createNameForUrl():this.setErrorMessage()}createNameForUrl(){this.newNameParsedUrl=encodeURIComponent(this.newName)}setErrorMessage(){var t;this.errorMessage=this.nameValidationErrors.invalidStartOrEnd?this.startAndEndErrorMessage:(null===(t=this.entity)||void 0===t?void 0:t.type)===v.VC.FOLDER?this.characterFolderErrorMessage:this.characterFileErrorMessage}rename(){var t=this;return(0,T.Z)(function*(){if(!t.opened||!t.isNewNameValid||!t.entity)return;const i=t.newName+t.ext,r=(0,C.Z)({},t.entity);t.modalComponent.close();let a=!1,d=" <strong>".concat(r.name,"</strong> modificato con successo!");const h=[...t.currentFolderPath];t.uploadObservablesService.pushEntityPending([{type:r.type,name:r.name,start:!0}]);const g=yield t.uploadService.moveRenameEntity(h,h,r.name,i);if(a=!(!g||!g.url),t.uploadObservablesService.pushEntityPending([{type:r.type,name:r.name,start:!1}]),a)return t.renameEvent.emit({list:[r],newEntityData:g,destPath:h}),d=(r.type===v.VC.FILE?"Nome del file":"Nome della cartella")+d,void t.toastService.show({content:d});t.toastService.show({content:"La modifica del nome <strong>non</strong> \xe8 andata a buon fine!<br>Prova a ricaricare la pagina ed a rieseguirla.",level:Se.m.ERROR})})()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(z.k),e.Y36(te.C),e.Y36(Z.r))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-rename-modal"]],viewQuery:function(t,i){if(1&t&&e.Gf(lo,5),2&t){let r;e.iGM(r=e.CRH())&&(i.modalComponent=r.first)}},inputs:{currentFolderPath:"currentFolderPath",entity:"entity",reservedNames:"reservedNames"},outputs:{renameEvent:"renameEvent"},features:[e.TTD],decls:6,vars:2,consts:[[3,"title","disableCloseButton","hidden"],["modal",""],["appModalBody",""],["appModalFooter",""],["newUrl",""],[4,"ngIf"],[1,"mb-0"],[4,"ngIf","ngIfElse"],["folderDesc",""],[1,"mt-2"],["for","current-name",1,"fs-sm"],["type","text","disabled","","id","current-name",1,"form-control",3,"value"],[1,"px-3","pb-3","pt-1","rounded","mt-3","mb-1","border-dashed","border-light-gray"],[1,"legend-reset","fs-reset","px-2","mb-0"],[1,"list-unstyled","mb-0"],["for","file-new-name",1,"fs-sm"],["type","text","id","file-new-name","required","",1,"form-control",3,"pattern","ngClass","ngModel","ngModelChange"],["newNameInput","ngModel"],["class","invalid-feedback",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"invalid-feedback"],["invalidName",""],[3,"innerHTML",4,"ngIf","ngIfElse"],["alreadyUsed",""],[3,"innerHTML"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["for","new-link",1,"fs-sm"],[1,"input-group"],["type","text","id","new-link","disabled","",1,"form-control",3,"value"],[1,"input-group-text","cursor-pointer",3,"cdkCopyToClipboard","appTippy","tippyProps","click"],["tippyRef","appTippy"],[1,"material-icons","d-block","text-muted"]],template:function(t,i){1&t&&(e.TgZ(0,"app-modal",0,1),e.NdJ("hidden",function(){return i.onHidden()}),e.YNc(2,bo,1,1,"ng-template",2)(3,To,4,1,"ng-template",3),e.qZA(),e.YNc(4,Mo,8,6,"ng-template",null,4,e.W1O)),2&t&&e.Q6J("title","Rinomina <em>"+((null==i.entity?null:i.entity.name)||"")+"</em>")("disableCloseButton",!0)},dependencies:[De.i3,f.mk,f.O5,f.tP,D.Fj,D.JJ,D.Q7,D.c5,D.On,X.z,re.J,We.j,Re.$],styles:["fieldset[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:not(:first-of-type){margin-top:.75rem}"]}),n})(),Ao=(()=>{var s;class n{constructor(t){this.uploadCacheService=t}parseUploadEvent(t){const i=this.parseSubscriptionEventMessage(t),r=this.uploadCacheService.getItem(i.targetPaths);if(!r||!i.output)return;const a=r.files.findIndex(h=>{var g;return h.url===(null===(g=i.output)||void 0===g?void 0:g.url)})>-1,d=(0,F.zO)(i.output.url);return d.size=i.output.size,d.time=1e3*i.output.time,{rewrite:a,destPath:i.targetPaths,list:[d]}}parseCreateFolderEvent(t){const i=this.parseSubscriptionEventMessage(t);if(!i.output)return;const r=(0,F.lY)(i.output);return{opened:!1,destPath:i.targetPaths,list:[r]}}parseDeleteEntityEvent(t,i,r){const a=this.parseSubscriptionEventMessage(t);if(a.output)return(0,C.Z)((0,C.Z)({},this.checkCompromissions(a.targetPaths,i,a.targetName,a.isFile,r)),{},{event:{destPath:a.targetPaths,list:[{name:a.targetName,type:a.isFile?v.VC.FILE:v.VC.FOLDER}]}})}parseMoveEntityEvent(t,i,r){const a=this.parseSubscriptionEventMessage(t);if(!a.output)return;const d=a.sourcePaths.join("/")===a.targetPaths.join("/");return(0,C.Z)((0,C.Z)({isRename:d},this.checkCompromissions(a.sourcePaths,i,a.sourceName,a.isFile,r)),{},{newEntity:(0,C.Z)((0,C.Z)({},a.output),{},{time:1e3*a.output.time}),type:a.isFile?v.VC.FILE:v.VC.FOLDER,source:{name:a.sourceName,paths:a.sourcePaths},target:{name:a.targetName,paths:a.targetPaths}})}parseSubscriptionEventMessage(t){const i=(t.payload.content.source||"").split("/"),r=(t.payload.content.target||"").split("/"),a=r[r.length-1].indexOf(".")>-1;let d;try{d=JSON.parse(t.output).success||void 0}catch(h){}return{sourceName:i[i.length-1],sourcePaths:i.slice(0,-1),targetName:r[r.length-1],targetPaths:r.slice(0,-1),isFile:a,output:d}}checkCompromissions(t,i,r,a,d){const h=i.join("/");return!a&&h.includes([...t,r].join("/"))?{pathCompromised:!0,entityCompromised:!1}:h===t.join("/")&&d.find(g=>g.name===r)?{pathCompromised:!1,entityCompromised:!0}:{pathCompromised:!1,entityCompromised:!1}}}return(s=n).\u0275fac=function(t){return new(t||s)(e.LFG(Le.B))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),n})();var Tt=function(s){return s.MOVE="MOVE",s.DELETE="DELETE",s.NEW_DIR="NEW_DIR",s.UPLOAD="UPLOAD",s}(Tt||{}),Bi=_(6779),Po=_(3285);let Vi=(()=>{var s;class n{constructor(){this.loginAsService=(0,e.f3M)(Bi.D)}logout(){this.loginAsService.disconnect()}}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-login-as-advice"]],standalone:!0,features:[e.jDz],decls:7,vars:2,consts:[[1,"d-flex","alert-container"],["type","danger",1,"d-flex","align-items-center","justify-content-center","flex-grow-1","position-fixed","p-0","min-w-0",3,"dismissible","closed"],[1,"me-1","flex-shrink-0"],[1,"text-truncate"],[3,"innerHTML"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"ngb-alert",1),e.NdJ("closed",function(){return i.logout()}),e.TgZ(2,"div",2),e._uU(3,"Sei connesso come"),e.qZA(),e.TgZ(4,"div",3),e._UZ(5,"strong",4),e._uU(6,"!"),e.qZA()()()),2&t&&(e.xp6(),e.Q6J("dismissible",!0),e.xp6(4),e.Q6J("innerHTML",(null==i.loginAsService.profile?null:i.loginAsService.profile.nickname)||"",e.oJD))},dependencies:[f.ez,U.xm],styles:[".alert-container[_ngcontent-%COMP%], ngb-alert[_ngcontent-%COMP%]{height:58px}.alert-container[_ngcontent-%COMP%]{margin-bottom:.5rem}ngb-alert[_ngcontent-%COMP%]{z-index:999;left:0;right:0;border-radius:0;border-left-width:0;border-right-width:0;padding-left:3rem}@media (min-width: 960px){ngb-alert[_ngcontent-%COMP%]{border-left-width:1px;border-right-width:1px;border-radius:.25rem;margin-left:calc(260px + 1.5rem);margin-right:1.5rem}}"]}),n})();var Oo=_(5851),Gi=_(2721),Yi=_(446),Eo=_(7621);const So=s=>({disabled:s});let Wi=(()=>{var s;class n{constructor(t,i,r){this.uploadObservalesService=t,this.toastService=i,this.proxyService=r,this.isSelected=!1,this.actionNames=v.In,this.canBeCropped=!0}ngOnInit(){this.canBeCropped=(0,F.$H)(this.file.ext)}pushAction(t){this.uploadObservalesService.pushAction({name:t,payload:{entities:(0,F.jL)([this.file])}})}pushSelectedFile(){this.dropdownRef.close(),this.uploadObservalesService.pushSelectedFile({name:this.file.name,selected:!this.isSelected})}downloadFile(){var t=this;return(0,T.Z)(function*(){t.dropdownRef.close(),t.uploadObservalesService.pushEntityPending([{type:v.VC.FILE,name:t.file.name,start:!0}]);const i=yield t.proxyService.get(t.file.embedUrl);if(i){const r=URL.createObjectURL(i),a=document.createElement("a");a.href=r,a.download=t.file.name,a.click()}else t.toastService.show({content:"Errore nel download del file <strong>".concat(t.file.name,"</strong>!"),level:Se.m.ERROR});t.uploadObservalesService.pushEntityPending([{type:v.VC.FILE,name:t.file.name,start:!1}])})()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(Z.r),e.Y36(z.k),e.Y36(Eo.y))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-file-menu"]],inputs:{file:"file",isSelected:"isSelected",dropdownRef:"dropdownRef"},decls:43,vars:5,consts:[[1,"list-unstyled","mb-0","dropdown-material-icons"],["role","button",1,"dropdown-item","d-flex","align-items-center",3,"click"],[1,"material-icons-outlined","d-block"],["role","button",1,"dropdown-item","d-flex","align-items-center",3,"ngClass","click"],[1,"material-icons-outlined","d-block",3,"innerText"],[3,"innerText"],[1,"dropdown-divider"]],template:function(t,i){1&t&&(e.TgZ(0,"ul",0)(1,"li")(2,"a",1),e.NdJ("click",function(){return i.pushAction(i.actionNames.FILE_SHOW_LINKS)}),e.TgZ(3,"div",2),e._uU(4,"construction"),e.qZA(),e.TgZ(5,"div"),e._uU(6,"Codici"),e.qZA()()(),e.TgZ(7,"li")(8,"a",1),e.NdJ("click",function(){return i.downloadFile()}),e.TgZ(9,"div",2),e._uU(10,"file_download"),e.qZA(),e.TgZ(11,"div"),e._uU(12,"Scarica"),e.qZA()()(),e.TgZ(13,"li")(14,"a",1),e.NdJ("click",function(){return i.pushAction(i.actionNames.MOVE)}),e.TgZ(15,"div",2),e._uU(16,"drive_file_move"),e.qZA(),e.TgZ(17,"div"),e._uU(18,"Sposta"),e.qZA()()(),e.TgZ(19,"li")(20,"a",1),e.NdJ("click",function(){return i.pushAction(i.actionNames.RENAME)}),e.TgZ(21,"div",2),e._uU(22," drive_file_rename_outline "),e.qZA(),e.TgZ(23,"div"),e._uU(24,"Rinomina"),e.qZA()()(),e.TgZ(25,"li")(26,"a",3),e.NdJ("click",function(){return i.pushAction(i.actionNames.FILE_EDIT)}),e.TgZ(27,"div",2),e._uU(28,"transform"),e.qZA(),e.TgZ(29,"div"),e._uU(30,"Modifica"),e.qZA()()(),e.TgZ(31,"li")(32,"a",1),e.NdJ("click",function(){return i.pushSelectedFile()}),e._UZ(33,"div",4)(34,"div",5),e.qZA()(),e.TgZ(35,"li"),e._UZ(36,"hr",6),e.qZA(),e.TgZ(37,"li")(38,"a",1),e.NdJ("click",function(){return i.pushAction(i.actionNames.DELETE)}),e.TgZ(39,"div",2),e._uU(40,"delete"),e.qZA(),e.TgZ(41,"div"),e._uU(42,"Elimina"),e.qZA()()()()),2&t&&(e.xp6(26),e.Q6J("ngClass",e.VKq(3,So,!i.canBeCropped)),e.xp6(7),e.Q6J("innerText",i.isSelected?"unpublished":"check_circle_outline"),e.xp6(),e.Q6J("innerText",i.isSelected?"Deseleziona":"Seleziona"))},dependencies:[f.mk]}),n})(),Uo=(()=>{var s;class n{}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-all-file-filtered"]],decls:17,vars:0,consts:[[1,"pt-3","px-2","text-center","empty-filtered-list"],["xmlns","http://www.w3.org/2000/svg","width","161.909065","height","158.04346","viewBox","0 0 647.63626 632.17383",1,"p-1","overflow-visible"],["d","M687.3279,276.08691H512.81813a15.01828,15.01828,0,0,0-15,15v387.85l-2,.61005-42.81006,13.11a8.00676,8.00676,0,0,1-9.98974-5.31L315.678,271.39691a8.00313,8.00313,0,0,1,5.31006-9.99l65.97022-20.2,191.25-58.54,65.96972-20.2a7.98927,7.98927,0,0,1,9.99024,5.3l32.5498,106.32Z","transform","translate(-276.18187 -133.91309)","fill","#f2f2f2"],["d","M725.408,274.08691l-39.23-128.14a16.99368,16.99368,0,0,0-21.23-11.28l-92.75,28.39L380.95827,221.60693l-92.75,28.4a17.0152,17.0152,0,0,0-11.28028,21.23l134.08008,437.93a17.02661,17.02661,0,0,0,16.26026,12.03,16.78926,16.78926,0,0,0,4.96972-.75l63.58008-19.46,2-.62v-2.09l-2,.61-64.16992,19.65a15.01489,15.01489,0,0,1-18.73-9.95l-134.06983-437.94a14.97935,14.97935,0,0,1,9.94971-18.73l92.75-28.4,191.24024-58.54,92.75-28.4a15.15551,15.15551,0,0,1,4.40966-.66,15.01461,15.01461,0,0,1,14.32032,10.61l39.0498,127.56.62012,2h2.08008Z","transform","translate(-276.18187 -133.91309)","fill","#3f3d56"],["d","M398.86279,261.73389a9.0157,9.0157,0,0,1-8.61133-6.3667l-12.88037-42.07178a8.99884,8.99884,0,0,1,5.9712-11.24023l175.939-53.86377a9.00867,9.00867,0,0,1,11.24072,5.9707l12.88037,42.07227a9.01029,9.01029,0,0,1-5.9707,11.24072L401.49219,261.33887A8.976,8.976,0,0,1,398.86279,261.73389Z","transform","translate(-276.18187 -133.91309)","fill","#565656"],["cx","190.15351","cy","24.95465","r","20","fill","#565656"],["cx","190.15351","cy","24.95465","r","12.66462","fill","#fff"],["d","M878.81836,716.08691h-338a8.50981,8.50981,0,0,1-8.5-8.5v-405a8.50951,8.50951,0,0,1,8.5-8.5h338a8.50982,8.50982,0,0,1,8.5,8.5v405A8.51013,8.51013,0,0,1,878.81836,716.08691Z","transform","translate(-276.18187 -133.91309)","fill","#e6e6e6"],["d","M723.31813,274.08691h-210.5a17.02411,17.02411,0,0,0-17,17v407.8l2-.61v-407.19a15.01828,15.01828,0,0,1,15-15H723.93825Zm183.5,0h-394a17.02411,17.02411,0,0,0-17,17v458a17.0241,17.0241,0,0,0,17,17h394a17.0241,17.0241,0,0,0,17-17v-458A17.02411,17.02411,0,0,0,906.81813,274.08691Zm15,475a15.01828,15.01828,0,0,1-15,15h-394a15.01828,15.01828,0,0,1-15-15v-458a15.01828,15.01828,0,0,1,15-15h394a15.01828,15.01828,0,0,1,15,15Z","transform","translate(-276.18187 -133.91309)","fill","#3f3d56"],["d","M801.81836,318.08691h-184a9.01015,9.01015,0,0,1-9-9v-44a9.01016,9.01016,0,0,1,9-9h184a9.01016,9.01016,0,0,1,9,9v44A9.01015,9.01015,0,0,1,801.81836,318.08691Z","transform","translate(-276.18187 -133.91309)","fill","#565656"],["cx","433.63626","cy","105.17383","r","20","fill","#565656"],["cx","433.63626","cy","105.17383","r","12.18187","fill","#fff"],[1,"mt-2"],[1,"text-muted"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.O4$(),e.TgZ(1,"svg",1),e._UZ(2,"path",2)(3,"path",3)(4,"path",4)(5,"circle",5)(6,"circle",6)(7,"path",7)(8,"path",8)(9,"path",9)(10,"circle",10)(11,"circle",11),e.qZA(),e.kcU(),e.TgZ(12,"div",12)(13,"strong"),e._uU(14,"Nessun elemento trovato!"),e.qZA()(),e.TgZ(15,"div",13),e._uU(16," Prova a modificare le parole chiave da cercare. "),e.qZA()())},styles:["svg[_ngcontent-%COMP%]{opacity:.5}"]}),n})(),Io=(()=>{var s;class n{constructor(t){this.uploadObservablesService=t}startUpload(){this.uploadObservablesService.pushStartUpload()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(Z.r))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-empty-file-list"]],decls:7,vars:0,consts:[[1,"text-center","py-2","px-2"],[1,"text-muted"],[1,"mb-3"],[1,"btn","btn-primary",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"Nessun file caricato!"),e.qZA(),e.TgZ(3,"div",2),e._uU(4," Puoi iniziare l'upload di un nuovo file tramite il pulsante sottostante. "),e.qZA(),e.TgZ(5,"button",3),e.NdJ("click",function(){return i.startUpload()}),e._uU(6,"Carica!"),e.qZA()())}}),n})();var Ki=_(8792),Do=_(1088),ce=_(1116),Ie=_(2831),V=_(2495),$i=_(6034),yt=_(7394),Fo=_(1687),Zo=_(927),ji=_(5592),Lo=_(7398),Xi=_(8180),wi=_(7921),ko=_(9397),Ro=_(4664),en=_(9388);function Ai(s,n,o){for(let t in n)if(n.hasOwnProperty(t)){const i=n[t];i?s.setProperty(t,i,null!=o&&o.has(t)?"important":""):s.removeProperty(t)}return s}function lt(s,n){const o=n?"":"none";Ai(s.style,{"touch-action":n?"":"none","-webkit-user-drag":n?"":"none","-webkit-tap-highlight-color":n?"":"transparent","user-select":o,"-ms-user-select":o,"-webkit-user-select":o,"-moz-user-select":o})}function tn(s,n,o){Ai(s.style,{position:n?"":"fixed",top:n?"":"0",opacity:n?"":"0",left:n?"":"-999em"},o)}function Kt(s,n){return n&&"none"!=n?s+" "+n:s}function nn(s){const n=s.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(s)*n}function Pi(s,n){return s.getPropertyValue(n).split(",").map(t=>t.trim())}function Oi(s){const n=s.getBoundingClientRect();return{top:n.top,right:n.right,bottom:n.bottom,left:n.left,width:n.width,height:n.height,x:n.x,y:n.y}}function Ei(s,n,o){const{top:t,bottom:i,left:r,right:a}=s;return o>=t&&o<=i&&n>=r&&n<=a}function Mt(s,n,o){s.top+=n,s.bottom=s.top+s.height,s.left+=o,s.right=s.left+s.width}function on(s,n,o,t){const{top:i,right:r,bottom:a,left:d,width:h,height:g}=s,y=h*n,M=g*n;return t>i-M&&t<a+M&&o>d-y&&o<r+y}class sn{constructor(n){this._document=n,this.positions=new Map}clear(){this.positions.clear()}cache(n){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),n.forEach(o=>{this.positions.set(o,{scrollPosition:{top:o.scrollTop,left:o.scrollLeft},clientRect:Oi(o)})})}handleScroll(n){const o=(0,Ie.sA)(n),t=this.positions.get(o);if(!t)return null;const i=t.scrollPosition;let r,a;if(o===this._document){const g=this.getViewportScrollPosition();r=g.top,a=g.left}else r=o.scrollTop,a=o.scrollLeft;const d=i.top-r,h=i.left-a;return this.positions.forEach((g,y)=>{g.clientRect&&o!==y&&o.contains(y)&&Mt(g.clientRect,d,h)}),i.top=r,i.left=a,{top:d,left:h}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function rn(s){const n=s.cloneNode(!0),o=n.querySelectorAll("[id]"),t=s.nodeName.toLowerCase();n.removeAttribute("id");for(let i=0;i<o.length;i++)o[i].removeAttribute("id");return"canvas"===t?cn(s,n):("input"===t||"select"===t||"textarea"===t)&&ln(s,n),an("canvas",s,n,cn),an("input, textarea, select",s,n,ln),n}function an(s,n,o,t){const i=n.querySelectorAll(s);if(i.length){const r=o.querySelectorAll(s);for(let a=0;a<i.length;a++)t(i[a],r[a])}}let zo=0;function ln(s,n){"file"!==n.type&&(n.value=s.value),"radio"===n.type&&n.name&&(n.name="mat-clone-".concat(n.name,"-").concat(zo++))}function cn(s,n){const o=n.getContext("2d");if(o)try{o.drawImage(s,0,0)}catch(t){}}const dn=(0,Ie.i$)({passive:!0}),$t=(0,Ie.i$)({passive:!1}),Si=new Set(["position"]);class qo{get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(n){n!==this._disabled&&(this._disabled=n,this._toggleNativeDragInteractions(),this._handles.forEach(o=>lt(o,n)))}constructor(n,o,t,i,r,a){this._config=o,this._document=t,this._ngZone=i,this._viewportRuler=r,this._dragDropRegistry=a,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new E.x,this._pointerMoveSubscription=yt.w0.EMPTY,this._pointerUpSubscription=yt.w0.EMPTY,this._scrollSubscription=yt.w0.EMPTY,this._resizeSubscription=yt.w0.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new E.x,this.started=new E.x,this.released=new E.x,this.ended=new E.x,this.entered=new E.x,this.exited=new E.x,this.dropped=new E.x,this.moved=this._moveEvents,this._pointerDown=d=>{if(this.beforeStarted.next(),this._handles.length){const h=this._getTargetHandle(d);h&&!this._disabledHandles.has(h)&&!this.disabled&&this._initializeDragSequence(h,d)}else this.disabled||this._initializeDragSequence(this._rootElement,d)},this._pointerMove=d=>{const h=this._getPointerPositionOnPage(d);if(!this._hasStartedDragging){if(Math.abs(h.x-this._pickupPositionOnPage.x)+Math.abs(h.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const S=Date.now()>=this._dragStartTime+this._getDragStartDelay(d),N=this._dropContainer;if(!S)return void this._endDragSequence(d);(!N||!N.isDragging()&&!N.isReceiving())&&(d.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(d)))}return}d.preventDefault();const g=this._getConstrainedPointerPosition(h);if(this._hasMoved=!0,this._lastKnownPointerPosition=h,this._updatePointerDirectionDelta(g),this._dropContainer)this._updateActiveDropContainer(g,h);else{const y=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,M=this._activeTransform;M.x=g.x-y.x+this._passiveTransform.x,M.y=g.y-y.y+this._passiveTransform.y,this._applyRootElementTransform(M.x,M.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:g,event:d,distance:this._getDragDistance(g),delta:this._pointerDirectionDelta})})},this._pointerUp=d=>{this._endDragSequence(d)},this._nativeDragStart=d=>{if(this._handles.length){const h=this._getTargetHandle(d);h&&!this._disabledHandles.has(h)&&!this.disabled&&d.preventDefault()}else this.disabled||d.preventDefault()},this.withRootElement(n).withParent(o.parentDragRef||null),this._parentPositions=new sn(t),a.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(n){this._handles=n.map(t=>(0,V.fI)(t)),this._handles.forEach(t=>lt(t,this.disabled)),this._toggleNativeDragInteractions();const o=new Set;return this._disabledHandles.forEach(t=>{this._handles.indexOf(t)>-1&&o.add(t)}),this._disabledHandles=o,this}withPreviewTemplate(n){return this._previewTemplate=n,this}withPlaceholderTemplate(n){return this._placeholderTemplate=n,this}withRootElement(n){const o=(0,V.fI)(n);return o!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{o.addEventListener("mousedown",this._pointerDown,$t),o.addEventListener("touchstart",this._pointerDown,dn),o.addEventListener("dragstart",this._nativeDragStart,$t)}),this._initialTransform=void 0,this._rootElement=o),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(n){return this._boundaryElement=n?(0,V.fI)(n):null,this._resizeSubscription.unsubscribe(),n&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(n){return this._parentDragRef=n,this}dispose(){var n,o;this._removeRootElementListeners(this._rootElement),this.isDragging()&&(null===(o=this._rootElement)||void 0===o||o.remove()),null===(n=this._anchor)||void 0===n||n.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(n){!this._disabledHandles.has(n)&&this._handles.indexOf(n)>-1&&(this._disabledHandles.add(n),lt(n,!0))}enableHandle(n){this._disabledHandles.has(n)&&(this._disabledHandles.delete(n),lt(n,this.disabled))}withDirection(n){return this._direction=n,this}_withDropContainer(n){this._dropContainer=n}getFreeDragPosition(){const n=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:n.x,y:n.y}}setFreeDragPosition(n){return this._activeTransform={x:0,y:0},this._passiveTransform.x=n.x,this._passiveTransform.y=n.y,this._dropContainer||this._applyRootElementTransform(n.x,n.y),this}withPreviewContainer(n){return this._previewContainer=n,this}_sortFromLastPointerPosition(){const n=this._lastKnownPointerPosition;n&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(n),n)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){var n,o;null===(n=this._preview)||void 0===n||n.remove(),null===(o=this._previewRef)||void 0===o||o.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){var n,o;null===(n=this._placeholder)||void 0===n||n.remove(),null===(o=this._placeholderRef)||void 0===o||o.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(n){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this,event:n}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(n),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const o=this._getPointerPositionOnPage(n);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(o),dropPoint:o,event:n})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(n){wt(n)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const o=this._dropContainer;if(o){const t=this._rootElement,i=t.parentNode,r=this._placeholder=this._createPlaceholderElement(),a=this._anchor=this._anchor||this._document.createComment(""),d=this._getShadowRoot();i.insertBefore(a,t),this._initialTransform=t.style.transform||"",this._preview=this._createPreviewElement(),tn(t,!1,Si),this._document.body.appendChild(i.replaceChild(r,t)),this._getPreviewInsertionPoint(i,d).appendChild(this._preview),this.started.next({source:this,event:n}),o.start(),this._initialContainer=o,this._initialIndex=o.getItemIndex(this)}else this.started.next({source:this,event:n}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(o?o.getScrollableParents():[])}_initializeDragSequence(n,o){this._parentDragRef&&o.stopPropagation();const t=this.isDragging(),i=wt(o),r=!i&&0!==o.button,a=this._rootElement,d=(0,Ie.sA)(o),h=!i&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),g=i?(0,$i.yG)(o):(0,$i.X6)(o);if(d&&d.draggable&&"mousedown"===o.type&&o.preventDefault(),t||r||h||g)return;if(this._handles.length){const A=a.style;this._rootElementTapHighlight=A.webkitTapHighlightColor||"",A.webkitTapHighlightColor="transparent"}this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(A=>this._updateOnScroll(A)),this._boundaryElement&&(this._boundaryRect=Oi(this._boundaryElement));const y=this._previewTemplate;this._pickupPositionInElement=y&&y.template&&!y.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,n,o);const M=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(o);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:M.x,y:M.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,o)}_cleanupDragArtifacts(n){tn(this._rootElement,!0,Si),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const o=this._dropContainer,t=o.getItemIndex(this),i=this._getPointerPositionOnPage(n),r=this._getDragDistance(i),a=o._isOverContainer(i.x,i.y);this.ended.next({source:this,distance:r,dropPoint:i,event:n}),this.dropped.next({item:this,currentIndex:t,previousIndex:this._initialIndex,container:o,previousContainer:this._initialContainer,isPointerOverContainer:a,distance:r,dropPoint:i,event:n}),o.drop(this,t,this._initialIndex,this._initialContainer,a,r,i,n),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:n,y:o},{x:t,y:i}){let r=this._initialContainer._getSiblingContainerFromPosition(this,n,o);!r&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,o)&&(r=this._initialContainer),r&&r!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=r,this._dropContainer.enter(this,n,o,r===this._initialContainer&&r.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:r,currentIndex:r.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(t,i),this._dropContainer._sortItem(this,n,o,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(n,o):this._applyPreviewTransform(n-this._pickupPositionInElement.x,o-this._pickupPositionInElement.y))}_createPreviewElement(){const n=this._previewTemplate,o=this.previewClass,t=n?n.template:null;let i;if(t&&n){const r=n.matchSize?this._initialDomRect:null,a=n.viewContainer.createEmbeddedView(t,n.context);a.detectChanges(),i=hn(a,this._document),this._previewRef=a,n.matchSize?un(i,r):i.style.transform=jt(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else i=rn(this._rootElement),un(i,this._initialDomRect),this._initialTransform&&(i.style.transform=this._initialTransform);return Ai(i.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":"".concat(this._config.zIndex||1e3)},Si),lt(i,!1),i.classList.add("cdk-drag-preview"),i.setAttribute("dir",this._direction),o&&(Array.isArray(o)?o.forEach(r=>i.classList.add(r)):i.classList.add(o)),i}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const n=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(n.left,n.top);const o=function No(s){const n=getComputedStyle(s),o=Pi(n,"transition-property"),t=o.find(d=>"transform"===d||"all"===d);if(!t)return 0;const i=o.indexOf(t),r=Pi(n,"transition-duration"),a=Pi(n,"transition-delay");return nn(r[i])+nn(a[i])}(this._preview);return 0===o?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(t=>{const i=a=>{var d;(!a||(0,Ie.sA)(a)===this._preview&&"transform"===a.propertyName)&&(null===(d=this._preview)||void 0===d||d.removeEventListener("transitionend",i),t(),clearTimeout(r))},r=setTimeout(i,1.5*o);this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){const n=this._placeholderTemplate,o=n?n.template:null;let t;return o?(this._placeholderRef=n.viewContainer.createEmbeddedView(o,n.context),this._placeholderRef.detectChanges(),t=hn(this._placeholderRef,this._document)):t=rn(this._rootElement),t.style.pointerEvents="none",t.classList.add("cdk-drag-placeholder"),t}_getPointerPositionInElement(n,o,t){const i=o===this._rootElement?null:o,r=i?i.getBoundingClientRect():n,a=wt(t)?t.targetTouches[0]:t,d=this._getViewportScrollPosition();return{x:r.left-n.left+(a.pageX-r.left-d.left),y:r.top-n.top+(a.pageY-r.top-d.top)}}_getPointerPositionOnPage(n){const o=this._getViewportScrollPosition(),t=wt(n)?n.touches[0]||n.changedTouches[0]||{pageX:0,pageY:0}:n,i=t.pageX-o.left,r=t.pageY-o.top;if(this._ownerSVGElement){const a=this._ownerSVGElement.getScreenCTM();if(a){const d=this._ownerSVGElement.createSVGPoint();return d.x=i,d.y=r,d.matrixTransform(a.inverse())}}return{x:i,y:r}}_getConstrainedPointerPosition(n){const o=this._dropContainer?this._dropContainer.lockAxis:null;let{x:t,y:i}=this.constrainPosition?this.constrainPosition(n,this,this._initialDomRect,this._pickupPositionInElement):n;if("x"===this.lockAxis||"x"===o?i=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):("y"===this.lockAxis||"y"===o)&&(t=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){const{x:r,y:a}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,d=this._boundaryRect,{width:h,height:g}=this._getPreviewRect(),y=d.top+a,M=d.bottom-(g-a);t=pn(t,d.left+r,d.right-(h-r)),i=pn(i,y,M)}return{x:t,y:i}}_updatePointerDirectionDelta(n){const{x:o,y:t}=n,i=this._pointerDirectionDelta,r=this._pointerPositionAtLastDirectionChange,a=Math.abs(o-r.x),d=Math.abs(t-r.y);return a>this._config.pointerDirectionChangeThreshold&&(i.x=o>r.x?1:-1,r.x=o),d>this._config.pointerDirectionChangeThreshold&&(i.y=t>r.y?1:-1,r.y=t),i}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const n=this._handles.length>0||!this.isDragging();n!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=n,lt(this._rootElement,n))}_removeRootElementListeners(n){n.removeEventListener("mousedown",this._pointerDown,$t),n.removeEventListener("touchstart",this._pointerDown,dn),n.removeEventListener("dragstart",this._nativeDragStart,$t)}_applyRootElementTransform(n,o){const t=jt(n,o),i=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=i.transform&&"none"!=i.transform?i.transform:""),i.transform=Kt(t,this._initialTransform)}_applyPreviewTransform(n,o){var t;const i=null!==(t=this._previewTemplate)&&void 0!==t&&t.template?void 0:this._initialTransform,r=jt(n,o);this._preview.style.transform=Kt(r,i)}_getDragDistance(n){const o=this._pickupPositionOnPage;return o?{x:n.x-o.x,y:n.y-o.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:n,y:o}=this._passiveTransform;if(0===n&&0===o||this.isDragging()||!this._boundaryElement)return;const t=this._rootElement.getBoundingClientRect(),i=this._boundaryElement.getBoundingClientRect();if(0===i.width&&0===i.height||0===t.width&&0===t.height)return;const r=i.left-t.left,a=t.right-i.right,d=i.top-t.top,h=t.bottom-i.bottom;i.width>t.width?(r>0&&(n+=r),a>0&&(n-=a)):n=0,i.height>t.height?(d>0&&(o+=d),h>0&&(o-=h)):o=0,(n!==this._passiveTransform.x||o!==this._passiveTransform.y)&&this.setFreeDragPosition({y:o,x:n})}_getDragStartDelay(n){const o=this.dragStartDelay;return"number"==typeof o?o:wt(n)?o.touch:o?o.mouse:0}_updateOnScroll(n){const o=this._parentPositions.handleScroll(n);if(o){const t=(0,Ie.sA)(n);this._boundaryRect&&t!==this._boundaryElement&&t.contains(this._boundaryElement)&&Mt(this._boundaryRect,o.top,o.left),this._pickupPositionOnPage.x+=o.left,this._pickupPositionOnPage.y+=o.top,this._dropContainer||(this._activeTransform.x-=o.left,this._activeTransform.y-=o.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){var n;return(null===(n=this._parentPositions.positions.get(this._document))||void 0===n?void 0:n.scrollPosition)||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,Ie.kV)(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(n,o){const t=this._previewContainer||"global";if("parent"===t)return n;if("global"===t){const i=this._document;return o||i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement||i.body}return(0,V.fI)(t)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_getTargetHandle(n){return this._handles.find(o=>n.target&&(n.target===o||o.contains(n.target)))}}function jt(s,n){return"translate3d(".concat(Math.round(s),"px, ").concat(Math.round(n),"px, 0)")}function pn(s,n,o){return Math.max(n,Math.min(o,s))}function wt(s){return"t"===s.type[0]}function hn(s,n){const o=s.rootNodes;if(1===o.length&&o[0].nodeType===n.ELEMENT_NODE)return o[0];const t=n.createElement("div");return o.forEach(i=>t.appendChild(i)),t}function un(s,n){s.style.width="".concat(n.width,"px"),s.style.height="".concat(n.height,"px"),s.style.transform=jt(n.left,n.top)}function At(s,n){return Math.max(0,Math.min(n,s))}class Qo{constructor(n,o){this._element=n,this._dragDropRegistry=o,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(n){this.withItems(n)}sort(n,o,t,i){const r=this._itemPositions,a=this._getItemIndexFromPointerPosition(n,o,t,i);if(-1===a&&r.length>0)return null;const d="horizontal"===this.orientation,h=r.findIndex(L=>L.drag===n),g=r[a],M=g.clientRect,A=h>a?1:-1,S=this._getItemOffsetPx(r[h].clientRect,M,A),N=this._getSiblingOffsetPx(h,r,A),be=r.slice();return function Jo(s,n,o){const t=At(n,s.length-1),i=At(o,s.length-1);if(t===i)return;const r=s[t],a=i<t?-1:1;for(let d=t;d!==i;d+=a)s[d]=s[d+a];s[i]=r}(r,h,a),r.forEach((L,zi)=>{if(be[zi]===L)return;const pe=L.drag===n,ze=pe?S:N,Pt=pe?n.getPlaceholderElement():L.drag.getRootElement();L.offset+=ze,d?(Pt.style.transform=Kt("translate3d(".concat(Math.round(L.offset),"px, 0, 0)"),L.initialTransform),Mt(L.clientRect,0,ze)):(Pt.style.transform=Kt("translate3d(0, ".concat(Math.round(L.offset),"px, 0)"),L.initialTransform),Mt(L.clientRect,ze,0))}),this._previousSwap.overlaps=Ei(M,o,t),this._previousSwap.drag=g.drag,this._previousSwap.delta=d?i.x:i.y,{previousIndex:h,currentIndex:a}}enter(n,o,t,i){const r=null==i||i<0?this._getItemIndexFromPointerPosition(n,o,t):i,a=this._activeDraggables,d=a.indexOf(n),h=n.getPlaceholderElement();let g=a[r];if(g===n&&(g=a[r+1]),!g&&(null==r||-1===r||r<a.length-1)&&this._shouldEnterAsFirstChild(o,t)&&(g=a[0]),d>-1&&a.splice(d,1),g&&!this._dragDropRegistry.isDragging(g)){const y=g.getRootElement();y.parentElement.insertBefore(h,y),a.splice(r,0,n)}else(0,V.fI)(this._element).appendChild(h),a.push(n);h.style.transform="",this._cacheItemPositions()}withItems(n){this._activeDraggables=n.slice(),this._cacheItemPositions()}withSortPredicate(n){this._sortPredicate=n}reset(){this._activeDraggables.forEach(n=>{const o=n.getRootElement();if(o){var t;const i=null===(t=this._itemPositions.find(r=>r.drag===n))||void 0===t?void 0:t.initialTransform;o.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(n){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(t=>t.drag===n)}updateOnScroll(n,o){this._itemPositions.forEach(({clientRect:t})=>{Mt(t,n,o)}),this._itemPositions.forEach(({drag:t})=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}_cacheItemPositions(){const n="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(o=>{const t=o.getVisibleElement();return{drag:o,offset:0,initialTransform:t.style.transform||"",clientRect:Oi(t)}}).sort((o,t)=>n?o.clientRect.left-t.clientRect.left:o.clientRect.top-t.clientRect.top)}_getItemOffsetPx(n,o,t){const i="horizontal"===this.orientation;let r=i?o.left-n.left:o.top-n.top;return-1===t&&(r+=i?o.width-n.width:o.height-n.height),r}_getSiblingOffsetPx(n,o,t){const i="horizontal"===this.orientation,r=o[n].clientRect,a=o[n+-1*t];let d=r[i?"width":"height"]*t;if(a){const h=i?"left":"top",g=i?"right":"bottom";-1===t?d-=a.clientRect[h]-r[g]:d+=r[h]-a.clientRect[g]}return d}_shouldEnterAsFirstChild(n,o){if(!this._activeDraggables.length)return!1;const t=this._itemPositions,i="horizontal"===this.orientation;if(t[0].drag!==this._activeDraggables[0]){const a=t[t.length-1].clientRect;return i?n>=a.right:o>=a.bottom}{const a=t[0].clientRect;return i?n<=a.left:o<=a.top}}_getItemIndexFromPointerPosition(n,o,t,i){const r="horizontal"===this.orientation,a=this._itemPositions.findIndex(({drag:d,clientRect:h})=>d!==n&&((!i||d!==this._previousSwap.drag||!this._previousSwap.overlaps||(r?i.x:i.y)!==this._previousSwap.delta)&&(r?o>=Math.floor(h.left)&&o<Math.floor(h.right):t>=Math.floor(h.top)&&t<Math.floor(h.bottom))));return-1!==a&&this._sortPredicate(a,n)?a:-1}}var de=function(s){return s[s.NONE=0]="NONE",s[s.UP=1]="UP",s[s.DOWN=2]="DOWN",s}(de||{}),Y=function(s){return s[s.NONE=0]="NONE",s[s.LEFT=1]="LEFT",s[s.RIGHT=2]="RIGHT",s}(Y||{});class Bo{constructor(n,o,t,i,r){this._dragDropRegistry=o,this._ngZone=i,this._viewportRuler=r,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new E.x,this.entered=new E.x,this.exited=new E.x,this.dropped=new E.x,this.sorted=new E.x,this.receivingStarted=new E.x,this.receivingStopped=new E.x,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=yt.w0.EMPTY,this._verticalScrollDirection=de.NONE,this._horizontalScrollDirection=Y.NONE,this._stopScrollTimers=new E.x,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),(0,Fo.F)(0,Zo.Z).pipe((0,$.R)(this._stopScrollTimers)).subscribe(()=>{const a=this._scrollNode,d=this.autoScrollStep;this._verticalScrollDirection===de.UP?a.scrollBy(0,-d):this._verticalScrollDirection===de.DOWN&&a.scrollBy(0,d),this._horizontalScrollDirection===Y.LEFT?a.scrollBy(-d,0):this._horizontalScrollDirection===Y.RIGHT&&a.scrollBy(d,0)})},this.element=(0,V.fI)(n),this._document=t,this.withScrollableParents([this.element]),o.registerDropContainer(this),this._parentPositions=new sn(t),this._sortStrategy=new Qo(this.element,o),this._sortStrategy.withSortPredicate((a,d)=>this.sortPredicate(a,d,this))}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(n,o,t,i){this._draggingStarted(),null==i&&this.sortingDisabled&&(i=this._draggables.indexOf(n)),this._sortStrategy.enter(n,o,t,i),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:n,container:this,currentIndex:this.getItemIndex(n)})}exit(n){this._reset(),this.exited.next({item:n,container:this})}drop(n,o,t,i,r,a,d,h={}){this._reset(),this.dropped.next({item:n,currentIndex:o,previousIndex:t,container:this,previousContainer:i,isPointerOverContainer:r,distance:a,dropPoint:d,event:h})}withItems(n){const o=this._draggables;return this._draggables=n,n.forEach(t=>t._withDropContainer(this)),this.isDragging()&&(o.filter(i=>i.isDragging()).every(i=>-1===n.indexOf(i))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(n){return this._sortStrategy.direction=n,this}connectedTo(n){return this._siblings=n.slice(),this}withOrientation(n){return this._sortStrategy.orientation=n,this}withScrollableParents(n){const o=(0,V.fI)(this.element);return this._scrollableElements=-1===n.indexOf(o)?[o,...n]:n.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(n){return this._isDragging?this._sortStrategy.getItemIndex(n):this._draggables.indexOf(n)}isReceiving(){return this._activeSiblings.size>0}_sortItem(n,o,t,i){if(this.sortingDisabled||!this._domRect||!on(this._domRect,.05,o,t))return;const r=this._sortStrategy.sort(n,o,t,i);r&&this.sorted.next({previousIndex:r.previousIndex,currentIndex:r.currentIndex,container:this,item:n})}_startScrollingIfNecessary(n,o){if(this.autoScrollDisabled)return;let t,i=de.NONE,r=Y.NONE;if(this._parentPositions.positions.forEach((a,d)=>{d===this._document||!a.clientRect||t||on(a.clientRect,.05,n,o)&&([i,r]=function Vo(s,n,o,t,i){const r=_n(n,i),a=fn(n,t);let d=de.NONE,h=Y.NONE;if(r){const g=s.scrollTop;r===de.UP?g>0&&(d=de.UP):s.scrollHeight-g>s.clientHeight&&(d=de.DOWN)}if(a){const g=s.scrollLeft;"rtl"===o?a===Y.RIGHT?g<0&&(h=Y.RIGHT):s.scrollWidth+g>s.clientWidth&&(h=Y.LEFT):a===Y.LEFT?g>0&&(h=Y.LEFT):s.scrollWidth-g>s.clientWidth&&(h=Y.RIGHT)}return[d,h]}(d,a.clientRect,this._sortStrategy.direction,n,o),(i||r)&&(t=d))}),!i&&!r){const{width:a,height:d}=this._viewportRuler.getViewportSize(),h={width:a,height:d,top:0,right:a,bottom:d,left:0};i=_n(h,o),r=fn(h,n),t=window}t&&(i!==this._verticalScrollDirection||r!==this._horizontalScrollDirection||t!==this._scrollNode)&&(this._verticalScrollDirection=i,this._horizontalScrollDirection=r,this._scrollNode=t,(i||r)&&t?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const n=(0,V.fI)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=n.msScrollSnapType||n.scrollSnapType||"",n.scrollSnapType=n.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const n=(0,V.fI)(this.element);this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(n).clientRect}_reset(){this._isDragging=!1;const n=(0,V.fI)(this.element).style;n.scrollSnapType=n.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(o=>o._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(n,o){return null!=this._domRect&&Ei(this._domRect,n,o)}_getSiblingContainerFromPosition(n,o,t){return this._siblings.find(i=>i._canReceive(n,o,t))}_canReceive(n,o,t){if(!this._domRect||!Ei(this._domRect,o,t)||!this.enterPredicate(n,this))return!1;const i=this._getShadowRoot().elementFromPoint(o,t);if(!i)return!1;const r=(0,V.fI)(this.element);return i===r||r.contains(i)}_startReceiving(n,o){const t=this._activeSiblings;!t.has(n)&&o.every(i=>this.enterPredicate(i,this)||this._draggables.indexOf(i)>-1)&&(t.add(n),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:n,receiver:this,items:o}))}_stopReceiving(n){this._activeSiblings.delete(n),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:n,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(n=>{if(this.isDragging()){const o=this._parentPositions.handleScroll(n);o&&this._sortStrategy.updateOnScroll(o.top,o.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const n=(0,Ie.kV)((0,V.fI)(this.element));this._cachedShadowRoot=n||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const n=this._sortStrategy.getActiveItemsSnapshot().filter(o=>o.isDragging());this._siblings.forEach(o=>o._startReceiving(this,n))}}function _n(s,n){const{top:o,bottom:t,height:i}=s,r=.05*i;return n>=o-r&&n<=o+r?de.UP:n>=t-r&&n<=t+r?de.DOWN:de.NONE}function fn(s,n){const{left:o,right:t,width:i}=s,r=.05*i;return n>=o-r&&n<=o+r?Y.LEFT:n>=t-r&&n<=t+r?Y.RIGHT:Y.NONE}const Xt=(0,Ie.i$)({passive:!1,capture:!0});let Go=(()=>{var s;class n{constructor(t,i){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=r=>r.isDragging(),this.pointerMove=new E.x,this.pointerUp=new E.x,this.scroll=new E.x,this._preventDefaultWhileDragging=r=>{this._activeDragInstances.length>0&&r.preventDefault()},this._persistentTouchmoveListener=r=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&r.preventDefault(),this.pointerMove.next(r))},this._document=i}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,Xt)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,Xt)}startDragging(t,i){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const r=i.type.startsWith("touch");this._globalListeners.set(r?"touchend":"mouseup",{handler:a=>this.pointerUp.next(a),options:!0}).set("scroll",{handler:a=>this.scroll.next(a),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:Xt}),r||this._globalListeners.set("mousemove",{handler:a=>this.pointerMove.next(a),options:Xt}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((a,d)=>{this._document.addEventListener(d,a.handler,a.options)})})}}stopDragging(t){const i=this._activeDragInstances.indexOf(t);i>-1&&(this._activeDragInstances.splice(i,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const i=[this.scroll];return t&&t!==this._document&&i.push(new ji.y(r=>this._ngZone.runOutsideAngular(()=>{const d=h=>{this._activeDragInstances.length&&r.next(h)};return t.addEventListener("scroll",d,!0),()=>{t.removeEventListener("scroll",d,!0)}}))),(0,ke.T)(...i)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,i)=>{this._document.removeEventListener(i,t.handler,t.options)}),this._globalListeners.clear()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.LFG(e.R0b),e.LFG(f.K0))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),n})();const Yo={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let Ui=(()=>{var s;class n{constructor(t,i,r,a){this._document=t,this._ngZone=i,this._viewportRuler=r,this._dragDropRegistry=a}createDrag(t,i=Yo){return new qo(t,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new Bo(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return(s=n).\u0275fac=function(t){return new(t||s)(e.LFG(f.K0),e.LFG(e.R0b),e.LFG(ce.rL),e.LFG(Go))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),n})();const Ii=new e.OlP("CDK_DRAG_PARENT"),Di=new e.OlP("CdkDragHandle"),vn=new e.OlP("CdkDragPlaceholder"),Cn=new e.OlP("CdkDragPreview");let Fi=(()=>{var s;class n{constructor(t){this.templateRef=t,this.matchSize=!1}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(e.Rgc))},s.\u0275dir=e.lG2({type:s,selectors:[["ng-template","cdkDragPreview",""]],inputs:{data:"data",matchSize:[e.lbL.HasDecoratorInputTransform,"matchSize","matchSize",e.VuI]},standalone:!0,features:[e._Bn([{provide:Cn,useExisting:s}]),e.Xq5]}),n})();const xn=new e.OlP("CDK_DRAG_CONFIG"),bn=new e.OlP("CdkDropList");let Zi=(()=>{var s;class n{get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=t,this._dragRef.disabled=this._disabled}constructor(t,i,r,a,d,h,g,y,M,A,S){this.element=t,this.dropContainer=i,this._ngZone=a,this._viewContainerRef=d,this._dir=g,this._changeDetectorRef=M,this._selfHandle=A,this._parentDrag=S,this._destroyed=new E.x,this.started=new e.vpe,this.released=new e.vpe,this.ended=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.dropped=new e.vpe,this.moved=new ji.y(N=>{const be=this._dragRef.moved.pipe((0,Lo.U)(L=>({source:this,pointerPosition:L.pointerPosition,event:L.event,delta:L.delta,distance:L.distance}))).subscribe(N);return()=>{be.unsubscribe()}}),this._dragRef=y.createDrag(t,{dragStartThreshold:h&&null!=h.dragStartThreshold?h.dragStartThreshold:5,pointerDirectionChangeThreshold:h&&null!=h.pointerDirectionChangeThreshold?h.pointerDirectionChangeThreshold:5,zIndex:null==h?void 0:h.zIndex}),this._dragRef.data=this,n._dragInstances.push(this),h&&this._assignDefaults(h),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(t){this._dragRef.setFreeDragPosition(t)}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,Xi.q)(1),(0,$.R)(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(t){const i=t.rootElementSelector,r=t.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const t=n._dragInstances.indexOf(this);t>-1&&n._dragInstances.splice(t,1),this._ngZone.runOutsideAngular(()=>{this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_updateRootElement(){const t=this.element.nativeElement;let i=t;var r;this.rootElementSelector&&(i=void 0!==t.closest?t.closest(this.rootElementSelector):null===(r=t.parentElement)||void 0===r?void 0:r.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?this.element.nativeElement.closest(t):(0,V.fI)(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){const i=this._dir,r=this.dragStartDelay,a=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,d=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.dragStartDelay="object"==typeof r&&r?r:(0,V.su)(r),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(a).withPreviewTemplate(d).withPreviewContainer(this.previewContainer||"global"),i&&t.withDirection(i.value)}}),t.beforeStarted.pipe((0,Xi.q)(1)).subscribe(()=>{if(this._parentDrag)return void t.withParent(this._parentDrag._dragRef);let i=this.element.nativeElement.parentElement;for(;i;){if(i.classList.contains("cdk-drag")){var r;t.withParent((null===(r=n._dragInstances.find(a=>a.element.nativeElement===i))||void 0===r?void 0:r._dragRef)||null);break}i=i.parentElement}})}_handleEvents(t){t.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),t.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(t){const{lockAxis:i,dragStartDelay:r,constrainPosition:a,previewClass:d,boundaryElement:h,draggingDisabled:g,rootElementSelector:y,previewContainer:M}=t;this.disabled=null!=g&&g,this.dragStartDelay=r||0,i&&(this.lockAxis=i),a&&(this.constrainPosition=a),d&&(this.previewClass=d),h&&(this.boundaryElement=h),y&&(this.rootElementSelector=y),M&&(this.previewContainer=M)}_setupHandlesListener(){this._handles.changes.pipe((0,wi.O)(this._handles),(0,ko.b)(t=>{const i=t.filter(r=>r._parentDrag===this).map(r=>r.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),(0,Ro.w)(t=>(0,ke.T)(...t.map(i=>i._stateChanges.pipe((0,wi.O)(i))))),(0,$.R)(this._destroyed)).subscribe(t=>{const i=this._dragRef,r=t.element.nativeElement;t.disabled?i.disableHandle(r):i.enableHandle(r)})}}return(s=n)._dragInstances=[],s.\u0275fac=function(t){return new(t||s)(e.Y36(e.SBq),e.Y36(bn,12),e.Y36(f.K0),e.Y36(e.R0b),e.Y36(e.s_b),e.Y36(xn,8),e.Y36(en.Is,8),e.Y36(Ui),e.Y36(e.sBO),e.Y36(Di,10),e.Y36(Ii,12))},s.\u0275dir=e.lG2({type:s,selectors:[["","cdkDrag",""]],contentQueries:function(t,i,r){if(1&t&&(e.Suo(r,Cn,5),e.Suo(r,vn,5),e.Suo(r,Di,5)),2&t){let a;e.iGM(a=e.CRH())&&(i._previewTemplate=a.first),e.iGM(a=e.CRH())&&(i._placeholderTemplate=a.first),e.iGM(a=e.CRH())&&(i._handles=a)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,i){2&t&&e.ekj("cdk-drag-disabled",i.disabled)("cdk-drag-dragging",i._dragRef.isDragging())},inputs:{data:[e.lbL.None,"cdkDragData","data"],lockAxis:[e.lbL.None,"cdkDragLockAxis","lockAxis"],rootElementSelector:[e.lbL.None,"cdkDragRootElement","rootElementSelector"],boundaryElement:[e.lbL.None,"cdkDragBoundary","boundaryElement"],dragStartDelay:[e.lbL.None,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[e.lbL.None,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[e.lbL.HasDecoratorInputTransform,"cdkDragDisabled","disabled",e.VuI],constrainPosition:[e.lbL.None,"cdkDragConstrainPosition","constrainPosition"],previewClass:[e.lbL.None,"cdkDragPreviewClass","previewClass"],previewContainer:[e.lbL.None,"cdkDragPreviewContainer","previewContainer"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[e._Bn([{provide:Ii,useExisting:s}]),e.Xq5,e.TTD]}),n})();const Li=new e.OlP("CdkDropListGroup");let Xo=0,ki=(()=>{var s;class n{get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(t){this._dropListRef.disabled=this._disabled=t}constructor(t,i,r,a,d,h,g){this.element=t,this._changeDetectorRef=r,this._scrollDispatcher=a,this._dir=d,this._group=h,this._destroyed=new E.x,this.connectedTo=[],this.id="cdk-drop-list-".concat(Xo++),this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.sorted=new e.vpe,this._unsortedItems=new Set,this._dropListRef=i.createDropList(t),this._dropListRef.data=this,g&&this._assignDefaults(g),this._dropListRef.enterPredicate=(y,M)=>this.enterPredicate(y.data,M.data),this._dropListRef.sortPredicate=(y,M,A)=>this.sortPredicate(y,M.data,A.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),n._dropLists.push(this),h&&h._items.add(this)}addItem(t){this._unsortedItems.add(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(t){this._unsortedItems.delete(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((t,i)=>t._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const t=n._dropLists.indexOf(this);t>-1&&n._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(t){this._dir&&this._dir.change.pipe((0,wi.O)(this._dir.value),(0,$.R)(this._destroyed)).subscribe(i=>t.withDirection(i)),t.beforeStarted.subscribe(()=>{const i=(0,V.Eq)(this.connectedTo).map(r=>"string"==typeof r?n._dropLists.find(d=>d.id===r):r);if(this._group&&this._group._items.forEach(r=>{-1===i.indexOf(r)&&i.push(r)}),!this._scrollableParentsResolved){const r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(a=>a.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.sortingDisabled=this.sortingDisabled,t.autoScrollDisabled=this.autoScrollDisabled,t.autoScrollStep=(0,V.su)(this.autoScrollStep,2),t.connectedTo(i.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(t){t.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),t.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),(0,ke.T)(t.receivingStarted,t.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(t){const{lockAxis:i,draggingDisabled:r,sortingDisabled:a,listAutoScrollDisabled:d,listOrientation:h}=t;this.disabled=null!=r&&r,this.sortingDisabled=null!=a&&a,this.autoScrollDisabled=null!=d&&d,this.orientation=h||"vertical",i&&(this.lockAxis=i)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(t=>t._dragRef))}}return(s=n)._dropLists=[],s.\u0275fac=function(t){return new(t||s)(e.Y36(e.SBq),e.Y36(Ui),e.Y36(e.sBO),e.Y36(ce.mF),e.Y36(en.Is,8),e.Y36(Li,12),e.Y36(xn,8))},s.\u0275dir=e.lG2({type:s,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(t,i){2&t&&(e.uIk("id",i.id),e.ekj("cdk-drop-list-disabled",i.disabled)("cdk-drop-list-dragging",i._dropListRef.isDragging())("cdk-drop-list-receiving",i._dropListRef.isReceiving()))},inputs:{connectedTo:[e.lbL.None,"cdkDropListConnectedTo","connectedTo"],data:[e.lbL.None,"cdkDropListData","data"],orientation:[e.lbL.None,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[e.lbL.None,"cdkDropListLockAxis","lockAxis"],disabled:[e.lbL.HasDecoratorInputTransform,"cdkDropListDisabled","disabled",e.VuI],sortingDisabled:[e.lbL.HasDecoratorInputTransform,"cdkDropListSortingDisabled","sortingDisabled",e.VuI],enterPredicate:[e.lbL.None,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[e.lbL.None,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[e.lbL.HasDecoratorInputTransform,"cdkDropListAutoScrollDisabled","autoScrollDisabled",e.VuI],autoScrollStep:[e.lbL.None,"cdkDropListAutoScrollStep","autoScrollStep"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],standalone:!0,features:[e._Bn([{provide:Li,useValue:void 0},{provide:bn,useExisting:s}]),e.Xq5]}),n})(),es=(()=>{var s;class n{}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ui],imports:[ce.ZD]}),n})();var Tn=_(7827),yn=_(3264),ts=_(3602);let Mn=(()=>{var s;class n{transform(t,i){return t.filter(r=>i(r))}}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275pipe=e.Yjl({name:"arrayFilter",type:s,pure:!0}),n})();function is(s,n){1&s&&e.GkF(0)}const wn=s=>({$implicit:s});function ns(s,n){if(1&s&&(e.ynx(0),e.YNc(1,is,1,0,"ng-container",17),e.BQk()),2&s){const o=e.oxw().$implicit,t=e.oxw(2);e.xp6(),e.Q6J("ngTemplateOutlet",t.templates.cdkPreview)("ngTemplateOutletContext",e.VKq(2,wn,o.name))}}function os(s,n){if(1&s&&e._UZ(0,"img",19),2&s){const o=e.oxw().$implicit;e.Q6J("lazyLoad",o.embedUrl)("offset",100)("alt",o.name)}}function ss(s,n){1&s&&e.GkF(0)}function rs(s,n){1&s&&e.GkF(0)}function as(s,n){1&s&&e.GkF(0)}const ls=(s,n)=>({pending:s,selected:n}),cs=s=>({$implicit:s,addAfterContent:!0}),ds=s=>({$implicit:s,firstPlacement:"left"});function ps(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"li",4),e.NdJ("contextmenu",function(i){const a=e.CHM(o).$implicit,d=e.oxw(2);return e.KtG(d.emitRightClick(i,a,!1))})("press",function(i){const a=e.CHM(o).$implicit,d=e.oxw(2);return e.KtG(d.emitRightClick(i,a,!0,!1))})("tap",function(i){const a=e.CHM(o).$implicit,d=e.oxw(2);return e.KtG(d.emitRightClick(i,a,!0,!0))})("cdkDragStarted",function(){const r=e.CHM(o).$implicit,a=e.oxw(2);return e.KtG(a.draggedFileEvent.emit(r))})("cdkDragReleased",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.draggedFileEvent.emit(void 0))}),e.YNc(1,ns,2,4,"ng-container",5),e.TgZ(2,"div",6)(3,"div",7),e.YNc(4,os,1,3,"img",8),e.TgZ(5,"div",9),e._UZ(6,"app-svg-icon",10),e.qZA()(),e.TgZ(7,"div",11)(8,"div",12)(9,"a",13),e._UZ(10,"div",14)(11,"div",15),e.qZA(),e.TgZ(12,"div",16),e.YNc(13,ss,1,0,"ng-container",17)(14,rs,1,0,"ng-container",17),e.qZA()(),e.TgZ(15,"div",18),e.YNc(16,as,1,0,"ng-container",17),e.qZA()()()()}if(2&s){const o=n.$implicit,t=e.oxw(2);e.Q6J("ngClass",e.WLB(15,ls,o.pending,o.selected))("cdkDragDisabled",t.touchDevice||o.pending),e.xp6(4),e.Q6J("ngIf",o.isImage),e.xp6(2),e.Q6J("setKey",t.iconSetKeys.FILE_ICONS)("iconType",o.ext)("width",64),e.xp6(3),e.Q6J("href",o.url,e.LSH),e.xp6(),e.Q6J("innerText",o.filename),e.xp6(),e.Q6J("innerText","."+o.ext),e.xp6(2),e.Q6J("ngTemplateOutlet",t.templates.size)("ngTemplateOutletContext",e.VKq(18,cs,o.size)),e.xp6(),e.Q6J("ngTemplateOutlet",t.templates.time)("ngTemplateOutletContext",e.VKq(20,wn,o.time)),e.xp6(2),e.Q6J("ngTemplateOutlet",t.templates.dropdown)("ngTemplateOutletContext",e.VKq(22,ds,o))}}function hs(s,n){if(1&s&&(e.ynx(0),e.YNc(1,ps,17,24,"li",3),e.BQk()),2&s){const o=n.$implicit;e.xp6(),e.Q6J("ngForOf",o)}}const us=s=>({"touch-device":s});let gs=(()=>{var s;class n{constructor(t){this.breakpointObserver=t,this.sortedList=[],this.rightClickEvent=new e.vpe,this.draggedFileEvent=new e.vpe,this.touchDevice=k.b1,this.filterCallback=i=>!i.isFiltered,this.filesPerRow=1,this.fileListGap=16,this.iconSetKeys=Ki.C,this.filesPerRowMap=new Map([[v.Ky.W_768_I_1,1],[v.Ky.W_933_I_2,2],[v.Ky.W_960_I_3,3],[v.Ky.W_1226_I_2,2],[v.Ky.W_1540_I_3,3],[v.Ky.W_1854_I_4,4],[v.Ky.W_2168_I_5,5],[v.Ky.W_2482_I_6,6],[v.Ky.W_2796_I_7,7],[v.Ky.W_3110_I_8,8],[v.Ky.W_3424_I_9,9],[v.Ky.W_3738_I_10,10]])}ngOnInit(){this.breakpointObserverSubscription=this.breakpointObserver.observe(Object.values(v.Ky)).subscribe(t=>{for(const r of Object.keys(t.breakpoints))if(t.breakpoints[r]){var i;this.filesPerRow=null!==(i=this.filesPerRowMap.get(r))&&void 0!==i?i:1}this.fileListGap=t.breakpoints[v.Ky.W_768_I_1]||t.breakpoints[v.Ky.W_933_I_2]||t.breakpoints[v.Ky.W_960_I_3]?16:24})}emitRightClick(t,i,r,a){t.preventDefault(),!(!k.b1&&r||k.b1&&(!r||"A"===t.target.nodeName||t.target.classList.contains("dropdown-toggle")))&&this.rightClickEvent.emit({file:i,isTap:a||!1})}ngOnDestroy(){var t;null===(t=this.breakpointObserverSubscription)||void 0===t||t.unsubscribe()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(Do.Yg))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-file-grid-list"]],inputs:{templates:"templates",sortedList:"sortedList"},outputs:{rightClickEvent:"rightClickEvent",draggedFileEvent:"draggedFileEvent"},decls:5,vars:12,consts:[["scrollWindow","",1,"file-grid-scroll",3,"itemSize","ngClass"],["cdkDropList","","cdkDropListSortingDisabled","",1,"list-unstyled","mb-0","d-grid","file-list","file-grid-list",3,"cdkDropListData"],[4,"cdkVirtualFor","cdkVirtualForOf"],["class","min-w-0 file-item","cdkDrag","",3,"ngClass","cdkDragDisabled","contextmenu","press","tap","cdkDragStarted","cdkDragReleased",4,"ngFor","ngForOf"],["cdkDrag","",1,"min-w-0","file-item",3,"ngClass","cdkDragDisabled","contextmenu","press","tap","cdkDragStarted","cdkDragReleased"],[4,"cdkDragPreview"],[1,"flat-container","overflow-hidden","h-100","d-flex","flex-column"],[1,"file-preview","border-bottom","overflow-hidden","text-center","position-relative"],["src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D","class","mw-100",3,"lazyLoad","offset","alt",4,"ngIf"],[1,"position-absolute","svg-container"],[1,"d-block",3,"setKey","iconType","width"],[1,"file-info","py-3","ps-3","pe-2","d-flex","align-items-center","flex-grow-1"],[1,"d-flex","flex-column","min-w-0","flex-grow-1","pe-2"],["target","_blank","rel","noreferrer",1,"file-link","d-flex","fw-bold","me-auto","mw-100",3,"href"],[1,"text-truncate",3,"innerText"],[3,"innerText"],[1,"text-muted","fs-xs","d-flex","align-items-center"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"dropdown-tpl"],["src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D",1,"mw-100",3,"lazyLoad","offset","alt"]],template:function(t,i){1&t&&(e.TgZ(0,"cdk-virtual-scroll-viewport",0)(1,"ul",1),e.YNc(2,hs,2,1,"ng-container",2),e.ALo(3,"arrayChunk"),e.ALo(4,"arrayFilter"),e.qZA()()),2&t&&(e.Q6J("itemSize",228+i.fileListGap)("ngClass",e.VKq(10,us,i.touchDevice)),e.xp6(),e.Q6J("cdkDropListData",i.sortedList),e.xp6(),e.Q6J("cdkVirtualForOf",e.xi3(3,4,e.xi3(4,7,i.sortedList,i.filterCallback),i.filesPerRow)))},dependencies:[f.mk,f.sg,f.O5,f.tP,ki,Zi,Fi,Tn.z1,ce.xd,ce.x0,ce.N7,ce.LO,yn.b,ts.K,Mn],styles:[".file-item.pending[_ngcontent-%COMP%]{opacity:.5}.file-item.pending[_ngcontent-%COMP%]   .dropdown-tpl[_ngcontent-%COMP%]{display:none!important}.file-item.pending[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{pointer-events:none}.cdk-drag-placeholder[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{opacity:.4}.drag-multiple-files[_nghost-%COMP%]   .file-item.selected[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{opacity:.4;pointer-events:none}.cdk-drag-preview[_ngcontent-%COMP%]{min-width:150px}.cdk-drag-dragging[_ngcontent-%COMP%]{display:none}",".file-grid-scroll[_ngcontent-%COMP%]{margin-bottom:-16px!important}[_nghost-%COMP%]:not(.drag-multiple-files)   .file-grid-scroll[_ngcontent-%COMP%]:not(.touch-device)   .file-item[_ngcontent-%COMP%]:not(.pending):hover, .drag-multiple-files[_nghost-%COMP%]   .file-grid-scroll[_ngcontent-%COMP%]:not(.touch-device)   .file-item[_ngcontent-%COMP%]:not(.pending):not(.selected):hover{box-shadow:0 .375rem .25rem #00000013}.file-grid-list[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px;padding-bottom:16px!important}.file-item[_ngcontent-%COMP%]{transition:opacity .2s,box-shadow .2s;height:228px}.file-item.selected[_ngcontent-%COMP%]   .flat-container[_ngcontent-%COMP%]{border-color:#c6cfff}.file-item.selected[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]{background-color:#dae0ff}.file-item.selected[_ngcontent-%COMP%]   .file-link[_ngcontent-%COMP%]{text-shadow:0 1px #fff}.touch-device[_ngcontent-%COMP%]   .file-link[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{pointer-events:none}.flat-container[_ngcontent-%COMP%]{transition:border-color .2s}.file-info[_ngcontent-%COMP%]{transition:background-color .2s}.file-preview[_ngcontent-%COMP%]{height:150px;background-color:rgb(var(--bs-light-rgb))}.file-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:0;transition:opacity .3s}.file-preview[_ngcontent-%COMP%]   img.ng-lazyloaded[_ngcontent-%COMP%]:not(.ng-failed-lazyloaded){opacity:1}.file-preview[_ngcontent-%COMP%]   img.ng-failed-lazyloaded[_ngcontent-%COMP%]{display:none}.ng-lazyloaded[_ngcontent-%COMP%]:not(.ng-failed-lazyloaded) + .svg-container[_ngcontent-%COMP%], .ng-lazyloading[_ngcontent-%COMP%] + .svg-container[_ngcontent-%COMP%]{display:none}.svg-container[_ngcontent-%COMP%]{left:50%;top:50%;transform:translate(-50%,-50%);background-color:inherit}.file-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder)   .svg-container[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn07 .3s linear forwards}.cdk-drag-placeholder[_ngcontent-%COMP%]   .svg-container[_ngcontent-%COMP%]{opacity:.7}@keyframes _ngcontent-%COMP%_fadeIn07{0%{opacity:0}to{opacity:.7}}@media (min-width: 768px){.file-grid-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(290px,1fr))}}@media (min-width: 960px){.file-grid-list[_ngcontent-%COMP%]{gap:24px;padding-bottom:24px!important}.file-grid-scroll[_ngcontent-%COMP%]{margin-bottom:-24px!important}.file-grid-scroll[_ngcontent-%COMP%]:not(.touch-device){margin-left:-.5rem!important;margin-right:-.5rem!important}.file-grid-scroll[_ngcontent-%COMP%]:not(.touch-device)   .file-list[_ngcontent-%COMP%]{padding-left:.5rem!important;padding-right:.5rem!important}}@media (min-width: 3738px){.file-grid-list[_ngcontent-%COMP%]{grid-template-columns:repeat(10,1fr)}}"]}),n})();function ms(s,n){1&s&&e.GkF(0)}const Ri=s=>({$implicit:s});function _s(s,n){if(1&s&&(e.ynx(0),e.YNc(1,ms,1,0,"ng-container",12),e.BQk()),2&s){const o=e.oxw().$implicit,t=e.oxw();e.xp6(),e.Q6J("ngTemplateOutlet",t.templates.cdkPreview)("ngTemplateOutletContext",e.VKq(2,Ri,o.name))}}function fs(s,n){1&s&&e.GkF(0)}function vs(s,n){1&s&&e.GkF(0)}function Cs(s,n){1&s&&e.GkF(0)}const xs=(s,n)=>({pending:s,selected:n}),bs=s=>({$implicit:s,firstPlacement:"left-top"});function Ts(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"li",4),e.NdJ("contextmenu",function(i){const a=e.CHM(o).$implicit,d=e.oxw();return e.KtG(d.emitRightClick(i,a,!1))})("press",function(i){const a=e.CHM(o).$implicit,d=e.oxw();return e.KtG(d.emitRightClick(i,a,!0,!1))})("tap",function(i){const a=e.CHM(o).$implicit,d=e.oxw();return e.KtG(d.emitRightClick(i,a,!0,!0))})("cdkDragStarted",function(){const r=e.CHM(o).$implicit,a=e.oxw();return e.KtG(a.draggedFileEvent.emit(r))})("cdkDragReleased",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.draggedFileEvent.emit(void 0))}),e.YNc(1,_s,2,4,"ng-container",5),e._UZ(2,"app-svg-icon",6),e.TgZ(3,"a",7),e._UZ(4,"div",8)(5,"div",9),e.qZA(),e._UZ(6,"div",10),e.TgZ(7,"div",11),e.YNc(8,fs,1,0,"ng-container",12),e.qZA(),e.TgZ(9,"div",13),e.YNc(10,vs,1,0,"ng-container",12),e.qZA(),e.TgZ(11,"div",14),e.YNc(12,Cs,1,0,"ng-container",12),e.qZA()()}if(2&s){const o=n.$implicit,t=e.oxw();e.Q6J("ngClass",e.WLB(15,xs,o.pending,o.selected))("cdkDragDisabled",t.touchDevice||o.pending),e.xp6(2),e.Q6J("setKey",t.iconSetKeys.FILE_ICONS)("iconType",o.ext)("width",24),e.xp6(),e.Q6J("href",o.url,e.LSH),e.xp6(),e.Q6J("innerText",o.filename),e.xp6(),e.Q6J("innerText","."+o.ext),e.xp6(),e.Q6J("innerText",o.ext),e.xp6(2),e.Q6J("ngTemplateOutlet",t.templates.size)("ngTemplateOutletContext",e.VKq(18,Ri,o.size)),e.xp6(2),e.Q6J("ngTemplateOutlet",t.templates.time)("ngTemplateOutletContext",e.VKq(20,Ri,o.time)),e.xp6(2),e.Q6J("ngTemplateOutlet",t.templates.dropdown)("ngTemplateOutletContext",e.VKq(22,bs,o))}}const ys=s=>({"touch-device":s});let Ms=(()=>{var s;class n{constructor(){this.sortedList=[],this.rightClickEvent=new e.vpe,this.draggedFileEvent=new e.vpe,this.touchDevice=k.b1,this.filterCallback=t=>!t.isFiltered,this.iconSetKeys=Ki.C}emitRightClick(t,i,r,a){t.preventDefault(),!(!k.b1&&r||k.b1&&(!r||"A"===t.target.nodeName||t.target.classList.contains("dropdown-toggle")))&&this.rightClickEvent.emit({file:i,isTap:a||!1})}}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-file-simple-list"]],inputs:{templates:"templates",sortedList:"sortedList"},outputs:{rightClickEvent:"rightClickEvent",draggedFileEvent:"draggedFileEvent"},decls:5,vars:9,consts:[[1,"flat-container","overflow-hidden"],["scrollWindow","",1,"file-simple-scroll",3,"itemSize","ngClass"],["cdkDropList","","cdkDropListSortingDisabled","",1,"list-unstyled","mb-0","file-list","file-simple-list",3,"cdkDropListData"],["class","file-item d-grid ps-3 ps-md-4 pe-2 pe-md-3","cdkDrag","",3,"ngClass","cdkDragDisabled","contextmenu","press","tap","cdkDragStarted","cdkDragReleased",4,"cdkVirtualFor","cdkVirtualForOf"],["cdkDrag","",1,"file-item","d-grid","ps-3","ps-md-4","pe-2","pe-md-3",3,"ngClass","cdkDragDisabled","contextmenu","press","tap","cdkDragStarted","cdkDragReleased"],[4,"cdkDragPreview"],[1,"me-3","me-md-4","text-center","mx-auto","d-block",3,"setKey","iconType","width"],["target","_blank","rel","noreferrer",1,"filename","fw-bold","d-flex","me-auto","min-w-0","mw-100",3,"href"],[1,"mw-100","text-truncate",3,"innerText"],[1,"flex-shrink-0","pe-2",3,"innerText"],[1,"text-uppercase","file-extension","text-center","mx-auto",3,"innerText"],[1,"size-tpl","text-center","mx-auto"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"time-tpl","text-center","mx-auto"],[1,"dropdown-tpl","d-flex","flex-end"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"cdk-virtual-scroll-viewport",1)(2,"ul",2),e.YNc(3,Ts,13,24,"li",3),e.ALo(4,"arrayFilter"),e.qZA()()()),2&t&&(e.xp6(),e.Q6J("itemSize",57)("ngClass",e.VKq(7,ys,i.touchDevice)),e.xp6(),e.Q6J("cdkDropListData",i.sortedList),e.xp6(),e.Q6J("cdkVirtualForOf",e.xi3(4,4,i.sortedList,i.filterCallback)))},dependencies:[f.mk,f.tP,ki,Zi,Fi,ce.xd,ce.x0,ce.N7,ce.LO,yn.b,Mn],styles:[".file-item.pending[_ngcontent-%COMP%]{opacity:.5}.file-item.pending[_ngcontent-%COMP%]   .dropdown-tpl[_ngcontent-%COMP%]{display:none!important}.file-item.pending[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{pointer-events:none}.cdk-drag-placeholder[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{opacity:.4}.drag-multiple-files[_nghost-%COMP%]   .file-item.selected[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{opacity:.4;pointer-events:none}.cdk-drag-preview[_ngcontent-%COMP%]{min-width:150px}.cdk-drag-dragging[_ngcontent-%COMP%]{display:none}",".file-simple-scroll[_ngcontent-%COMP%]:not(.touch-device)   .file-item[_ngcontent-%COMP%]:not(.selected):hover{background-color:rgb(var(--bs-light-rgb))}.file-item[_ngcontent-%COMP%]{grid-template-columns:calc(24px + 1rem) calc(100% - 48px - 1rem) 24px;align-items:center;transition:opacity .2s,background-color .2s;background-color:#fff;height:57px}.file-item[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.dropdown-tpl){font-size:.875rem}.file-item[_ngcontent-%COMP%]:not(:first-of-type){border-top:1px solid transparent}.file-item[_ngcontent-%COMP%]:not(:first-of-type):not(.selected){border-color:#dee2e6}.file-item[_ngcontent-%COMP%]:not(:first-of-type).selected, .file-item[_ngcontent-%COMP%]:not(:first-of-type).selected + .file-item[_ngcontent-%COMP%]{border-color:#c6cfff}.file-item.selected[_ngcontent-%COMP%]{background-color:#dae0ff}.file-extension[_ngcontent-%COMP%], .size-tpl[_ngcontent-%COMP%], .time-tpl[_ngcontent-%COMP%]{display:none}app-svg-icon[_ngcontent-%COMP%]{color:#495057}.touch-device[_ngcontent-%COMP%]   .filename[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{pointer-events:none}@media (min-width: 768px){.file-simple-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]{grid-template-columns:calc(24px + 1.5rem) calc(58% - 24px - 1.5rem) repeat(2,18%) 6%}.file-simple-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .size-tpl[_ngcontent-%COMP%], .file-simple-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .time-tpl[_ngcontent-%COMP%]{display:initial}}@media (min-width: 1200px){.file-simple-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]{grid-template-columns:calc(24px + 1.5rem) calc(52% - 24px - 1.5rem) repeat(3,14%) 6%}.file-simple-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-extension[_ngcontent-%COMP%]{display:initial}}"]}),n})();var ei=_(9010);const An=s=>({"drag-multiple-files":s}),Pn=(s,n,o,t)=>({size:s,time:n,dropdown:o,cdkPreview:t});function ws(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"app-upload-file-grid-list",11),e.NdJ("rightClickEvent",function(i){e.CHM(o);const r=e.oxw(4);return e.KtG(r.onRightClick(i))})("draggedFileEvent",function(i){e.CHM(o);const r=e.oxw(4);return e.KtG(r.pushDraggedFile(i))}),e.qZA()}if(2&s){const o=e.oxw(4),t=e.MAs(2),i=e.MAs(4),r=e.MAs(6),a=e.MAs(8);e.Q6J("ngClass",e.VKq(3,An,o.isDraggingSelectedFiles))("sortedList",o.sortedList)("templates",e.l5B(5,Pn,t,i,r,a))}}function As(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"app-upload-file-simple-list",12),e.NdJ("rightClickEvent",function(i){e.CHM(o);const r=e.oxw(4);return e.KtG(r.onRightClick(i))})("draggedFileEvent",function(i){e.CHM(o);const r=e.oxw(4);return e.KtG(r.pushDraggedFile(i))}),e.qZA()}if(2&s){const o=e.oxw(4),t=e.MAs(2),i=e.MAs(4),r=e.MAs(6),a=e.MAs(8);e.Q6J("sortedList",o.sortedList)("ngClass",e.VKq(3,An,o.isDraggingSelectedFiles))("templates",e.l5B(5,Pn,t,i,r,a))}}function Ps(s,n){if(1&s&&(e.ynx(0),e.YNc(1,ws,1,10,"app-upload-file-grid-list",9)(2,As,1,10,"ng-template",null,10,e.W1O),e.BQk()),2&s){const o=e.MAs(3),t=e.oxw(3);e.xp6(),e.Q6J("ngIf",t.layoutOptions.type===t.layoutTypes.GRID)("ngIfElse",o)}}function Os(s,n){1&s&&e._UZ(0,"app-upload-all-file-filtered")}function Es(s,n){if(1&s&&(e.ynx(0),e.YNc(1,Ps,4,2,"ng-container",6)(2,Os,1,0,"ng-template",null,8,e.W1O),e.BQk()),2&s){const o=e.MAs(3),t=e.oxw(2);e.xp6(),e.Q6J("ngIf",t.filteredElementsCount<t.sortedList.length)("ngIfElse",o)}}function Ss(s,n){1&s&&e._UZ(0,"app-upload-empty-file-list")}function Us(s,n){if(1&s&&(e.ynx(0),e.TgZ(1,"div",5),e._uU(2," File e Immagini "),e.qZA(),e.YNc(3,Es,4,2,"ng-container",6)(4,Ss,1,0,"ng-template",null,7,e.W1O),e.BQk()),2&s){const o=e.MAs(5),t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.sortedList.length>0)("ngIfElse",o)}}const Is=s=>({"me-1 after-content":s});function Ds(s,n){if(1&s&&(e._UZ(0,"div",13),e.ALo(1,"formatBytes")),2&s){const t=n.addAfterContent;e.Q6J("innerText",e.lcZ(1,2,n.$implicit))("ngClass",e.VKq(4,Is,t))}}const Fs=()=>[0,5],Zs=s=>({offset:s});function Ls(s,n){if(1&s&&(e.TgZ(0,"div",14),e.ALo(1,"date"),e._UZ(2,"span",15),e.qZA()),2&s){const o=n.$implicit;e.Q6J("appTippy",e.xi3(1,3,o,"dd-MM-YY HH:mm")||"")("tippyProps",e.VKq(7,Zs,e.DdM(6,Fs))),e.xp6(2),e.Q6J("date",o)}}function ks(s,n){if(1&s&&e._UZ(0,"app-upload-file-menu",21),2&s){const o=e.oxw().$implicit,t=e.MAs(1);e.Q6J("file",o)("isSelected",o.selected)("dropdownRef",t)}}const Rs=s=>({"touch-device":s}),Ns=s=>[s,"left-bottom","auto"];function zs(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"div",16,17),e.NdJ("openChange",function(i){const a=e.CHM(o).$implicit,d=e.oxw();return e.KtG(d.onDropdownOpenChange(i,a))}),e.TgZ(2,"div",18),e._uU(3," more_vert "),e.qZA(),e.TgZ(4,"div",19),e.YNc(5,ks,1,3,"app-upload-file-menu",20),e.qZA()()}if(2&s){const o=n.$implicit,t=n.firstPlacement,i=e.oxw();e.Q6J("ngClass",e.VKq(3,Rs,i.touchDevice))("placement",e.VKq(5,Ns,t)),e.xp6(5),e.Q6J("ngIf",o.hasDropdown)}}function Hs(s,n){if(1&s&&e._UZ(0,"div",22),2&s){const o=n.$implicit,t=e.oxw();e.Q6J("innerHTML",t.isDraggingSelectedFiles&&t.selectedFileCounter>1?t.selectedFileCounter+" file selezionati":o,e.oJD)}}let qs=(()=>{var s;class n{constructor(t,i){this.uploadObservablesService=t,this.uploadPreferencesService=i,this.fileList=[],this.filter="",this.loading=!0,this.sortedList=[],this.layoutTypes=v.c5,this.filteredElementsCount=0,this.isDraggingSelectedFiles=!1,this.selectedFileCounter=0,this.touchDevice=k.b1,this.currentFilter="",this.sortedBy=v.gG.FILENAME,this.sortOrder=1,this.subscriptions=[],this.layoutOptions=this.uploadPreferencesService.layoutOptions}ngOnInit(){this.setSortOption(this.layoutOptions.orderBy,this.layoutOptions.asc),this.copyList(),this.sort(),this.setSubscriptions()}updateListAfterChange(){this.sortedList=[...this.sortedList]}setSubscriptions(){this.subscriptions.push(this.uploadObservablesService.layoutOptionsObservable.subscribe(t=>{this.layoutOptions=t,this.setSortOption(t.orderBy,t.asc),this.sort(),this.updateListAfterChange()}),this.uploadObservablesService.renameEntityObservable.subscribe(t=>{if(t.newEntity.type!==v.VC.FILE)return;const i=this.sortedList.findIndex(r=>r.name===t.oldName);if(i>-1){const r=this.sortedList[i].selected,a=this.sortedList[i].hasDropdown;this.sortedList[i]=(0,C.Z)((0,C.Z)({},t.newEntity),{},{isFiltered:!1,pending:!1,selected:r,hasDropdown:a})}this.updateListAfterChange()}),this.uploadObservablesService.deleteFileObservable.subscribe(t=>{for(const i of t){const r=this.sortedList.findIndex(a=>a.name===i);r>-1&&this.sortedList.splice(r,1)}this.updateListAfterChange()}),this.uploadObservablesService.uploadedFileObservable.subscribe(t=>{this.sortedList.unshift(...t.map(i=>(0,C.Z)((0,C.Z)({},i),{},{isFiltered:!1,pending:!1,selected:!1,hasDropdown:!1}))),this.sort(),this.filterList(),this.updateListAfterChange()}),this.uploadObservablesService.entityPendingObservable.subscribe(t=>{t.forEach(i=>{if(i.type!==v.VC.FILE)return;const r=this.sortedList.findIndex(a=>a.name===i.name);r>-1&&(this.sortedList[r].pending=i.start)})}),this.uploadObservablesService.selectedFileListObservable.subscribe(t=>{const i=t.map(r=>r.name);this.sortedList.filter(r=>r.selected||i.includes(r.name)).forEach(r=>{r.selected=i.includes(r.name)}),this.selectedFileCounter=t.length}))}ngOnChanges(t){t.fileList&&!t.fileList.firstChange&&(this.copyList(),this.sortedList.length&&(this.sort(),this.currentFilter="",this.filterList())),t.filter&&!t.filter.firstChange&&(this.filterList(),this.updateListAfterChange())}setSortOption(t,i){this.sortedBy=t,this.sortOrder=i?1:-1}sort(){this.sortedBy!==v.gG.FILENAME?(this.sortedList.sort((t,i)=>this.sortOrder*(t[this.sortedBy]>i[this.sortedBy]?1:-1)),this.sortedBy===v.gG.TIME&&this.sortedList.reverse()):(0,Gi.Qt)(this.sortedList,"filename",this.sortOrder>0)}copyList(){this.sortedList=this.fileList.map(t=>(0,C.Z)((0,C.Z)({},t),{},{isFiltered:!1,pending:!1,selected:!1,hasDropdown:!1}))}filterList(){if(this.currentFilter===this.filter)return;if(this.currentFilter=this.filter,this.filteredElementsCount=0,0===this.filter.length)return void this.sortedList.filter(i=>i.isFiltered).forEach(i=>i.isFiltered=!1);const t=this.filter.toLowerCase();for(const i of this.sortedList)i.isFiltered=!i.name.toLowerCase().includes(t),this.filteredElementsCount+=+i.isFiltered}pushDraggedFile(t){if(this.isDraggingSelectedFiles=!1,t)return t.selected?(this.uploadObservablesService.pushDraggedFileList(this.sortedList.filter(i=>i.selected)),void(this.isDraggingSelectedFiles=!0)):void this.uploadObservablesService.pushDraggedFileList([t]);this.uploadObservablesService.pushDraggedFileList([])}onRightClick(t){if(!t.isTap||0!==this.selectedFileCounter)return this.uploadObservablesService.pushSelectedFile({name:t.file.name,selected:!t.file.selected}),!1}onDropdownOpenChange(t,i){t&&!i.hasDropdown&&(i.hasDropdown=!0)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(Z.r),e.Y36(Yi.p))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-file-list"]],inputs:{fileList:"fileList",filter:"filter",loading:"loading"},features:[e.TTD],decls:9,vars:1,consts:[[4,"ngIf"],["fileSizeTemplate",""],["fileTimeTemplate",""],["fileDropdownTemplate",""],["fileCdkPreview",""],[1,"px-md-1","mb-2","fv-small-caps","container-fluid"],[4,"ngIf","ngIfElse"],["noFiles",""],["allFilesFilteredMessage",""],[3,"ngClass","sortedList","templates","rightClickEvent","draggedFileEvent",4,"ngIf","ngIfElse"],["listLayout",""],[3,"ngClass","sortedList","templates","rightClickEvent","draggedFileEvent"],[3,"sortedList","ngClass","templates","rightClickEvent","draggedFileEvent"],[1,"file-size",3,"innerText","ngClass"],[1,"file-time",3,"appTippy","tippyProps"],["timeago","",3,"date"],["ngbDropdown","","display","dynamic","container","body",1,"dropdown-no-caret","ms-auto","flex-shrink-0",3,"ngClass","placement","openChange"],["fileDropdown","ngbDropdown"],["ngbDropdownToggle","",1,"material-icons-outlined","d-block","cursor-pointer","dropdown-icon"],["ngbDropdownMenu",""],[3,"file","isSelected","dropdownRef",4,"ngIf"],[3,"file","isSelected","dropdownRef"],[1,"flat-container","p-3",3,"innerHTML"]],template:function(t,i){1&t&&e.YNc(0,Us,6,2,"ng-container",0)(1,Ds,2,6,"ng-template",null,1,e.W1O)(3,Ls,3,9,"ng-template",null,2,e.W1O)(5,zs,6,7,"ng-template",null,3,e.W1O)(7,Hs,1,1,"ng-template",null,4,e.W1O),2&t&&e.Q6J("ngIf",!i.loading)},dependencies:[f.mk,f.O5,U.jt,U.iD,U.Vi,et,Re.$,Wi,Uo,Io,gs,Ms,f.uU,ei.b],styles:['.file-size.after-content[_ngcontent-%COMP%]:after{content:" - "}.dropdown-no-caret[_ngcontent-%COMP%]:not(.touch-device)   .dropdown-icon[_ngcontent-%COMP%]{opacity:.7;transition:opacity .2s}.dropdown-no-caret[_ngcontent-%COMP%]:not(.touch-device)   .dropdown-icon[_ngcontent-%COMP%]:hover{opacity:1}']}),n})();function Js(s,n){1&s&&e.GkF(0)}function Qs(s,n){1&s&&e.GkF(0)}const Bs=(s,n,o)=>({$implicit:s,index:n,last:o});function Vs(s,n){if(1&s&&(e.ynx(0),e.YNc(1,Qs,1,0,"ng-container",1),e.BQk()),2&s){const o=n.$implicit,t=n.index,i=n.last;e.oxw();const r=e.MAs(4);e.xp6(),e.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",e.kEZ(2,Bs,o,t+1,i))}}function Gs(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"a",7),e.NdJ("click",function(){e.CHM(o);const i=e.oxw().index,r=e.oxw();return e.KtG(r.navigateEvent.emit(i))}),e.qZA()}if(2&s){const o=e.oxw().$implicit;e.Q6J("innerText",o)}}function Ys(s,n){if(1&s&&e._UZ(0,"span",8),2&s){const o=e.oxw().$implicit;e.Q6J("innerText",o)}}const Ws=s=>({active:s});function Ks(s,n){if(1&s&&(e.TgZ(0,"li",4),e.YNc(1,Gs,1,1,"a",5)(2,Ys,1,1,"ng-template",null,6,e.W1O),e.qZA()),2&s){const o=n.last,t=e.MAs(3);e.Q6J("ngClass",e.VKq(3,Ws,o)),e.xp6(),e.Q6J("ngIf",!o)("ngIfElse",t)}}const $s=(s,n)=>({$implicit:s,index:0,last:n});let js=(()=>{var s;class n{constructor(){this.currentFolderPath=[],this.navigateEvent=new e.vpe,this.rootName="Il mio spazio"}}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-breadcrumb"]],inputs:{currentFolderPath:"currentFolderPath"},outputs:{navigateEvent:"navigateEvent"},decls:5,vars:6,consts:[[1,"breadcrumb","folders-breadcrumb","mb-0"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngFor","ngForOf"],["breadcrumbItem",""],[1,"breadcrumb-item","small","text-break",3,"ngClass"],["role","button",3,"innerText","click",4,"ngIf","ngIfElse"],["lastItem",""],["role","button",3,"innerText","click"],[3,"innerText"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ol",0),e.YNc(1,Js,1,0,"ng-container",1)(2,Vs,2,6,"ng-container",2)(3,Ks,4,5,"ng-template",null,3,e.W1O),e.qZA()),2&t){const r=e.MAs(4);e.xp6(),e.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",e.WLB(3,$s,i.rootName,0===i.currentFolderPath.length)),e.xp6(),e.Q6J("ngForOf",i.currentFolderPath)}},dependencies:[f.mk,f.sg,f.O5,f.tP],styles:[".folders-breadcrumb[_ngcontent-%COMP%]{--bs-breadcrumb-divider: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E\")}"]}),n})(),Xs=(()=>{var s;class n{constructor(t){this.uploadObservablesService=t,this.createNewFolderEvent=new e.vpe,this.actionNames=v.In}pushAction(t){this.uploadObservablesService.pushAction({name:t,payload:{entities:[{name:this.folder.name,type:v.VC.FOLDER,ext:"",url:this.folder.url,embedUrl:this.folder.url,isImage:!1}]}})}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(Z.r))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-folder-menu"]],inputs:{folder:"folder"},outputs:{createNewFolderEvent:"createNewFolderEvent"},decls:27,vars:0,consts:[[1,"list-unstyled","mb-0","dropdown-material-icons"],["role","button",1,"dropdown-item","d-flex","align-items-center",3,"click"],[1,"material-icons-outlined","d-block"],[1,"dropdown-divider"]],template:function(t,i){1&t&&(e.TgZ(0,"ul",0)(1,"li")(2,"a",1),e.NdJ("click",function(){return i.createNewFolderEvent.emit()}),e.TgZ(3,"div",2),e._uU(4," add_circle_outline "),e.qZA(),e.TgZ(5,"div"),e._uU(6,"Nuova cartella"),e.qZA()()(),e.TgZ(7,"li")(8,"a",1),e.NdJ("click",function(){return i.pushAction(i.actionNames.MOVE)}),e.TgZ(9,"div",2),e._uU(10,"drive_file_move"),e.qZA(),e.TgZ(11,"div"),e._uU(12,"Sposta"),e.qZA()()(),e.TgZ(13,"li")(14,"a",1),e.NdJ("click",function(){return i.pushAction(i.actionNames.RENAME)}),e.TgZ(15,"div",2),e._uU(16," drive_file_rename_outline "),e.qZA(),e.TgZ(17,"div"),e._uU(18,"Rinomina"),e.qZA()()(),e.TgZ(19,"li"),e._UZ(20,"hr",3),e.qZA(),e.TgZ(21,"li")(22,"a",1),e.NdJ("click",function(){return i.pushAction(i.actionNames.DELETE)}),e.TgZ(23,"div",2),e._uU(24,"delete"),e.qZA(),e.TgZ(25,"div"),e._uU(26,"Elimina"),e.qZA()()()())}}),n})();const er=["modal"];function tr(s,n){1&s&&(e.ynx(0),e._uU(1," Il nome non pu\xf2 essere vuoto! "),e.BQk())}function ir(s,n){if(1&s&&e._UZ(0,"span",17),2&s){const o=e.oxw(4);e.Q6J("innerHTML",o.errorMessage,e.oJD)}}function nr(s,n){1&s&&e._uU(0,"Questo nome \xe8 gi\xe0 usato da un'altra cartella!")}function or(s,n){if(1&s&&e.YNc(0,ir,1,1,"span",15)(1,nr,1,0,"ng-template",null,16,e.W1O),2&s){const o=e.MAs(2),t=e.oxw(3);e.Q6J("ngIf",!t.nameValidationErrors.alreadyUsed)("ngIfElse",o)}}function sr(s,n){if(1&s&&(e.TgZ(0,"div",12),e.YNc(1,tr,2,0,"ng-container",13)(2,or,3,2,"ng-template",null,14,e.W1O),e.qZA()),2&s){const o=e.MAs(3),t=e.oxw(2);e.xp6(),e.Q6J("ngIf",t.nameValidationErrors.invalidLength)("ngIfElse",o)}}const rr=(s,n)=>({"is-valid":s,"is-invalid":n});function ar(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"p"),e._uU(1," Tramite questo modal \xe8 possibile "),e.TgZ(2,"strong"),e._uU(3,"creare una nuova cartella"),e.qZA(),e._uU(4," nella posizione corrente. Il nome della nuova cartella far\xe0 "),e.TgZ(5,"strong"),e._uU(6,"parte dell'url"),e.qZA(),e._uU(7," di tutti i file che la cartella stessa conterr\xe0. Per questo motivo, \xe8 bene che includa esclusivamente dei caratteri facilmente inseribili nei link di un file: in particolare, sono accettati i caratteri "),e.TgZ(8,"em"),e._uU(9,"a-z"),e.qZA(),e._uU(10,", sia maiuscoli che minuscoli, i trattini alti e bassi "),e.TgZ(11,"em"),e._uU(12,"-_"),e.qZA(),e._uU(13," e i numeri. "),e.qZA(),e.TgZ(14,"div",4)(15,"label",5),e._uU(16,"Nome della nuova cartella:"),e.qZA(),e.TgZ(17,"input",6,7),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.name=i)})("ngModelChange",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.checkNameValidity())}),e.qZA(),e.YNc(19,sr,4,2,"div",8),e.qZA(),e.TgZ(20,"div",9)(21,"input",10),e.NdJ("ngModelChange",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.openFolderOnCreation=i)}),e.qZA(),e.TgZ(22,"label",11),e._uU(23,"Apri la cartella dopo la creazione"),e.qZA()()}if(2&s){const o=e.MAs(18),t=e.oxw();e.xp6(17),e.Q6J("ngClass",e.WLB(5,rr,o.dirty&&t.isNameValid,o.dirty&&!t.isNameValid))("pattern",t.nameRegex)("ngModel",t.name),e.xp6(2),e.Q6J("ngIf",!t.isNameValid),e.xp6(2),e.Q6J("ngModel",t.openFolderOnCreation)}}function lr(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){e.CHM(o),e.oxw();const i=e.MAs(1);return e.KtG(i.close("Close click"))}),e._uU(1," Annulla "),e.qZA(),e.TgZ(2,"button",19),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.create())}),e._uU(3," Crea "),e.qZA()}if(2&s){const o=e.oxw();e.xp6(2),e.Q6J("disabled",!o.isNameValid)}}let cr=(()=>{var s;class n{constructor(){this.reservedNames=[],this.createFolderEvent=new e.vpe,this.nameRegex=Ne.b3,this.name="",this.openFolderOnCreation=!1,this.isNameValid=!1,this.nameValidationErrors=Ne.uJ,this.errorMessage="",this.opened=!1}open(){this.opened=!0,this.modalComponent.open()}onHidden(){this.opened=!1,this.name="",this.openFolderOnCreation=!1,this.isNameValid=!1,this.errorMessage="",this.nameValidationErrors=Ne.uJ}checkNameValidity(){this.nameValidationErrors=(0,F.rc)(this.name,"",v.VC.FOLDER,this.reservedNames),this.isNameValid=!Object.values(this.nameValidationErrors).some(t=>t),this.nameValidationErrors.invalidStartOrEnd?this.errorMessage="Il nome non pu\xf2 iniziare o finire con un punto o uno spazio!":this.isNameValid||(this.errorMessage="Il nome pu\xf2 contenere solo i caratteri <em>a-z</em>, i trattini alti e bassi <em>-_</em>, gli spazi e i numeri!")}create(){!this.opened||!this.isNameValid||(this.createFolderEvent.emit({name:this.name,open:this.openFolderOnCreation}),this.modalComponent.close())}}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-newfolder-modal"]],viewQuery:function(t,i){if(1&t&&e.Gf(er,5),2&t){let r;e.iGM(r=e.CRH())&&(i.modalComponent=r.first)}},inputs:{reservedNames:"reservedNames"},outputs:{createFolderEvent:"createFolderEvent"},decls:4,vars:1,consts:[["title","Crea nuova cartella",3,"disableCloseButton","hidden"],["modal",""],["appModalBody",""],["appModalFooter",""],[1,"mt-2"],["for","folder-name",1,"fs-sm"],["type","text","id","folder-name","required","",1,"form-control",3,"ngClass","pattern","ngModel","ngModelChange"],["newNameInput","ngModel"],["class","invalid-feedback",4,"ngIf"],[1,"form-check","mt-2","mb-0","fs-sm"],["type","checkbox","id","open-folder",1,"form-check-input",3,"ngModel","ngModelChange"],["for","open-folder",1,"form-check-label"],[1,"invalid-feedback"],[4,"ngIf","ngIfElse"],["invalidName",""],[3,"innerHTML",4,"ngIf","ngIfElse"],["alreadyUsed",""],[3,"innerHTML"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,i){1&t&&(e.TgZ(0,"app-modal",0,1),e.NdJ("hidden",function(){return i.onHidden()}),e.YNc(2,ar,24,8,"ng-template",2)(3,lr,4,1,"ng-template",3),e.qZA()),2&t&&e.Q6J("disableCloseButton",!0)},dependencies:[f.mk,f.O5,D.Fj,D.Wl,D.JJ,D.Q7,D.c5,D.On,X.z,re.J,We.j]}),n})();var On=_(6441);function dr(s,n){1&s&&(e.TgZ(0,"div",4),e._UZ(1,"app-loader",5),e.qZA())}function pr(s,n){1&s&&(e.O4$(),e.ynx(0),e._UZ(1,"path",21)(2,"path",22),e.BQk())}function hr(s,n){1&s&&(e.O4$(),e._UZ(0,"path",23))}const ur=(s,n)=>({"is-entered":s,"flat-container px-3":n});function gr(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"li",17),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.navigateUp(-1))})("mouseenter",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.setFolderEntered(null,!0))})("mouseleave",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.setFolderEntered(void 0))}),e.O4$(),e.TgZ(1,"svg",13),e.YNc(2,pr,3,0,"ng-container",18)(3,hr,1,0,"ng-template",null,19,e.W1O),e.qZA(),e.kcU(),e.TgZ(5,"div",20),e._uU(6,"cartella superiore"),e.qZA()()}if(2&s){const o=e.MAs(4),t=e.oxw(2);e.Q6J("ngClass",e.WLB(3,ur,null===t.currentFolderEnteredName,t.currentLayout===t.layouts.GRID)),e.xp6(2),e.Q6J("ngIf",t.currentLayout===t.layouts.GRID)("ngIfElse",o)}}function mr(s,n){1&s&&(e.O4$(),e._UZ(0,"path",32))}function _r(s,n){1&s&&(e.O4$(),e._UZ(0,"path",33))}const fr=(s,n,o)=>({pending:s,"is-entered":n,"flat-container":o}),vr=()=>["left-top","auto"];function Cr(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"li",24),e.NdJ("mouseenter",function(){const r=e.CHM(o).$implicit,a=e.oxw(2);return e.KtG(a.setFolderEntered(r.name))})("mouseleave",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.setFolderEntered(void 0))}),e.ALo(1,"arrayIncludes"),e.TgZ(2,"div",25),e.NdJ("click",function(){const r=e.CHM(o).$implicit,a=e.oxw(2);return e.KtG(a.navigateDown(r.name))}),e.O4$(),e.TgZ(3,"svg",26),e.YNc(4,mr,1,0,"path",27)(5,_r,1,0,"ng-template",null,19,e.W1O),e.qZA(),e.kcU(),e._UZ(7,"div",28),e.qZA(),e.TgZ(8,"div",29)(9,"div",30),e._uU(10," more_vert "),e.qZA(),e.TgZ(11,"app-upload-folder-menu",31),e.NdJ("createNewFolderEvent",function(){e.CHM(o),e.oxw(2);const i=e.MAs(4);return e.KtG(i.open())}),e.qZA()()()}if(2&s){const o=n.$implicit,t=e.MAs(6),i=e.oxw(2);e.Q6J("ngClass",e.kEZ(9,fr,e.xi3(1,6,i.pendingFolders,o.name),i.currentFolderEnteredName===o.name,i.currentLayout===i.layouts.GRID)),e.xp6(4),e.Q6J("ngIf",i.currentLayout===i.layouts.GRID)("ngIfElse",t),e.xp6(3),e.Q6J("innerText",o.name),e.xp6(),e.Q6J("placement",e.DdM(13,vr)),e.xp6(3),e.Q6J("folder",o)}}function xr(s,n){1&s&&(e.O4$(),e.kcU(),e.TgZ(0,"div",34),e._uU(1," nuova cartella "),e.qZA())}const br=(s,n,o)=>({"touch-device":s,"d-grid grid-list":n,"simple-list flat-container d-flex flex-column":o});function Tr(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"div",6)(1,"div",7),e._uU(2,"Cartelle"),e.qZA(),e.TgZ(3,"app-upload-breadcrumb",8),e.NdJ("navigateEvent",function(i){e.CHM(o);const r=e.oxw();return e.KtG(r.navigateUp(i))}),e.qZA()(),e.TgZ(4,"ul",9),e.YNc(5,gr,7,6,"li",10)(6,Cr,12,14,"li",11),e.TgZ(7,"li",12),e.NdJ("click",function(){e.CHM(o),e.oxw();const i=e.MAs(4);return e.KtG(i.open())}),e.O4$(),e.TgZ(8,"svg",13),e._UZ(9,"path",14)(10,"path",15),e.qZA(),e.YNc(11,xr,2,0,"div",16),e.qZA()()}if(2&s){const o=e.oxw();e.xp6(3),e.Q6J("currentFolderPath",o.currentFolderPath),e.xp6(),e.Q6J("ngClass",e.kEZ(5,br,o.touchDevice,o.currentLayout===o.layouts.GRID,o.currentLayout===o.layouts.LIST)),e.xp6(),e.Q6J("ngIf",o.currentFolderPath.length>0),e.xp6(),e.Q6J("ngForOf",o.filteredAndSortedList),e.xp6(5),e.Q6J("ngIf",o.currentLayout===o.layouts.LIST)}}let yr=(()=>{var s;class n{constructor(t,i,r){this.uploadService=t,this.uploadObservablesService=i,this.toastService=r,this.folderList=[],this.currentFolderPath=[],this.loading=!0,this.filter="",this.newFolderEvent=new e.vpe,this.filteredAndSortedList=[],this.layouts=v.c5,this.currentLayout=v.c5.GRID,this.touchDevice=k.b1,this.actionNames=v.In,this.pendingFolders=[],this.currentFolderEnteredName="",this.folderNamesList=[],this.orderAsc=!0,this.currentDraggedFileList=[]}ngOnInit(){this.folderNamesList=this.folderList.map(t=>t.name),this.filterList(),this.orderAsc=this.uploadService.preferences.layoutOptions.asc,this.currentLayout=this.uploadService.preferences.layoutOptions.type,this.orderList(),this.layoutOptionsSubscription=this.uploadObservablesService.layoutOptionsObservable.subscribe(t=>{this.currentLayout=t.type,this.orderAsc=t.asc,this.orderList()}),this.draggedFileSubscription=this.uploadObservablesService.draggedFileListObservable.subscribe(t=>{void 0!==this.currentFolderEnteredPath&&0===t.length&&this.currentDraggedFileList.length&&(this.uploadObservablesService.pushStartMove({entities:(0,F.jL)(this.currentDraggedFileList),destPath:[...this.currentFolderEnteredPath],originPath:[...this.currentFolderPath]}),this.currentFolderEnteredName=""),this.currentDraggedFileList=[...t]}),this.entityPendingSubscription=this.uploadObservablesService.entityPendingObservable.subscribe(t=>{t.forEach(i=>{i.type===v.VC.FOLDER&&(i.start?this.pendingFolders.includes(i.name)||(this.pendingFolders=[...this.pendingFolders,i.name]):this.pendingFolders.indexOf(i.name)>-1&&(this.pendingFolders=this.pendingFolders.filter(a=>i.name!==a)))})}),this.renameFolderSubscription=this.uploadObservablesService.renameEntityObservable.subscribe(t=>{t.newEntity.type===v.VC.FOLDER&&(this.folderNamesList=this.folderList.map(i=>i.name))})}ngOnChanges(t){t.folderList&&!t.folderList.firstChange&&(this.folderNamesList=this.folderList.map(i=>i.name),this.filterList(),this.orderList()),t.filter&&!t.filter.firstChange&&(this.filterList(),this.orderList())}filterList(){if(0===this.filter.length)return void(this.filteredAndSortedList=this.folderList);const t=this.filter.toLowerCase();this.filteredAndSortedList=this.folderList.filter(i=>i.name.toLowerCase().includes(t))}orderList(){(0,Gi.Qt)(this.filteredAndSortedList,"name",this.orderAsc)}navigateUp(t){this.uploadObservablesService.pushCurrentFolderPath(this.currentFolderPath.slice(0,t))}navigateDown(t){this.pendingFolders.includes(t)||this.uploadObservablesService.pushCurrentFolderPath([...this.currentFolderPath,t])}createFolder(t){var i=this;return(0,T.Z)(function*(){const r=t.name,a=[...i.currentFolderPath],d=yield i.uploadService.createDirectory([...a,r]);if(d){const g={name:(0,F.Lv)(d).name,url:d,type:v.VC.FOLDER};return i.newFolderEvent.emit({list:[g],destPath:a,opened:t.open}),i.toastService.show({content:"Cartella <strong>".concat(r,"</strong> creata con successo!")}),void(t.open&&i.navigateDown(r))}i.toastService.show({content:"La creazione della cartella ha <strong>riscontrato un errore!</strong><br>Prova a ricaricare la pagina ed a rieseguirla.",level:Se.m.ERROR})})()}setFolderEntered(t,i=!1){if(void 0===t)return this.currentFolderEnteredPath=void 0,void(this.currentFolderEnteredName="");if(0!==this.currentDraggedFileList.length){if(this.currentFolderEnteredName=t,i)return void(this.currentFolderEnteredPath=this.currentFolderPath.length<2?[]:this.currentFolderPath.slice(0,-1));this.currentFolderEnteredPath=[...this.currentFolderPath,t]}}ngOnDestroy(){var t,i,r,a;null===(t=this.layoutOptionsSubscription)||void 0===t||t.unsubscribe(),null===(i=this.draggedFileSubscription)||void 0===i||i.unsubscribe(),null===(r=this.entityPendingSubscription)||void 0===r||r.unsubscribe(),null===(a=this.renameFolderSubscription)||void 0===a||a.unsubscribe()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(te.C),e.Y36(Z.r),e.Y36(z.k))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-folder-list"]],inputs:{folderList:"folderList",currentFolderPath:"currentFolderPath",loading:"loading",filter:"filter"},outputs:{newFolderEvent:"newFolderEvent"},features:[e.TTD],decls:5,vars:3,consts:[["class","d-flex justify-content-center",4,"ngIf","ngIfElse"],["dataList",""],[3,"reservedNames","createFolderEvent"],["modal",""],[1,"d-flex","justify-content-center"],["message","Recupero dei file in corso"],[1,"px-md-1","mb-2","d-flex","flex-wrap","flex-column","flex-md-row","align-items-md-center","container-fluid"],[1,"fv-small-caps"],[1,"d-block","ms-md-auto",3,"currentFolderPath","navigateEvent"],[1,"folders","list-unstyled",3,"ngClass"],["class","d-flex align-items-center cursor-pointer navigate-upper-level",3,"ngClass","click","mouseenter","mouseleave",4,"ngIf"],["class","d-flex align-items-center min-w-0",3,"ngClass","mouseenter","mouseleave",4,"ngFor","ngForOf"],[1,"new-folder","d-flex","align-items-center","cursor-pointer",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 16 16",1,"d-block"],["d","m.5 3 .04.87a1.99 1.99 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14H9v-1H2.826a1 1 0 0 1-.995-.91l-.637-7A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09L14.54 8h1.005l.256-2.819A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2zm5.672-1a1 1 0 0 1 .707.293L7.586 3H2.19c-.24 0-.47.042-.683.12L1.5 2.98a1 1 0 0 1 1-.98h3.672z"],["d","M13.5 10a.5.5 0 0 1 .5.5V12h1.5a.5.5 0 1 1 0 1H14v1.5a.5.5 0 1 1-1 0V13h-1.5a.5.5 0 0 1 0-1H13v-1.5a.5.5 0 0 1 .5-.5z"],["class","new-folder-description fst-italic",4,"ngIf"],[1,"d-flex","align-items-center","cursor-pointer","navigate-upper-level",3,"ngClass","click","mouseenter","mouseleave"],[4,"ngIf","ngIfElse"],["folderFilled",""],[1,"folder-name","fst-italic"],["d","m11.798 8.271-3.182 1.97c-.27.166-.616-.036-.616-.372V9.1s-2.571-.3-4 2.4c.571-4.8 3.143-4.8 4-4.8v-.769c0-.336.346-.538.616-.371l3.182 1.969c.27.166.27.576 0 .742z"],["d","m.5 3 .04.87a1.99 1.99 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14h10.348a2 2 0 0 0 1.991-1.819l.637-7A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2zm.694 2.09A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09l-.636 7a1 1 0 0 1-.996.91H2.826a1 1 0 0 1-.995-.91l-.637-7zM6.172 2a1 1 0 0 1 .707.293L7.586 3H2.19c-.24 0-.47.042-.683.12L1.5 2.98a1 1 0 0 1 1-.98h3.672z"],["d","M13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2l.04.87a1.99 1.99 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14h10.348a2 2 0 0 0 1.991-1.819l.637-7A2 2 0 0 0 13.81 3zM2.19 3c-.24 0-.47.042-.683.12L1.5 2.98a1 1 0 0 1 1-.98h3.672a1 1 0 0 1 .707.293L7.586 3H2.19zm9.608 5.271-3.182 1.97c-.27.166-.616-.036-.616-.372V9.1s-2.571-.3-4 2.4c.571-4.8 3.143-4.8 4-4.8v-.769c0-.336.346-.538.616-.371l3.182 1.969c.27.166.27.576 0 .742z"],[1,"d-flex","align-items-center","min-w-0",3,"ngClass","mouseenter","mouseleave"],[1,"d-flex","align-items-center","min-w-0","navigate-item","flex-grow-1","h-100","pe-1",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 16 16",1,"d-block","flex-shrink-0"],["d","M.54 3.87.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.826a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31zM2.19 4a1 1 0 0 0-.996 1.09l.637 7a1 1 0 0 0 .995.91h10.348a1 1 0 0 0 .995-.91l.637-7A1 1 0 0 0 13.81 4H2.19zm4.69-1.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707z",4,"ngIf","ngIfElse"],[1,"folder-name","text-truncate",3,"innerText"],["ngbDropdown","","display","dynamic","container","body",1,"dropdown-no-caret","ms-auto",3,"placement"],["ngbDropdownToggle","",1,"material-icons-outlined","d-block","cursor-pointer","dropdown-toggle"],["ngbDropdownMenu","",1,"dropdown-menu",3,"folder","createNewFolderEvent"],["d","M.54 3.87.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.826a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31zM2.19 4a1 1 0 0 0-.996 1.09l.637 7a1 1 0 0 0 .995.91h10.348a1 1 0 0 0 .995-.91l.637-7A1 1 0 0 0 13.81 4H2.19zm4.69-1.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707z"],["d","M9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.825a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31L.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3zm-8.322.12C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139z"],[1,"new-folder-description","fst-italic"]],template:function(t,i){if(1&t&&(e.YNc(0,dr,2,0,"div",0)(1,Tr,12,9,"ng-template",null,1,e.W1O),e.TgZ(3,"app-upload-newfolder-modal",2,3),e.NdJ("createFolderEvent",function(a){return i.createFolder(a)}),e.qZA()),2&t){const r=e.MAs(2);e.Q6J("ngIf",i.loading)("ngIfElse",r),e.xp6(3),e.Q6J("reservedNames",i.folderNamesList)}},dependencies:[f.mk,f.sg,f.O5,qt.R,U.jt,U.iD,U.Vi,js,Xs,cr,On.Q],styles:[".folders[_ngcontent-%COMP%]{margin-bottom:1.5rem}.folders[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{transition:opacity .2s,background-color .2s}.folders[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .navigate-item[_ngcontent-%COMP%]{cursor:pointer}.folders[_ngcontent-%COMP%] > li.pending[_ngcontent-%COMP%]{opacity:.5}.folders[_ngcontent-%COMP%] > li.pending[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]{display:none!important}.folders[_ngcontent-%COMP%] > li.pending[_ngcontent-%COMP%]   .navigate-item[_ngcontent-%COMP%]{cursor:default!important;pointer-events:none}.folders[_ngcontent-%COMP%] > li.is-entered[_ngcontent-%COMP%]{background-color:#dae0ff;border-color:#c6cfff}.folders[_ngcontent-%COMP%]:not(.touch-device)   .dropdown-toggle[_ngcontent-%COMP%]{opacity:.7;transition:opacity .2s}.folders[_ngcontent-%COMP%]:not(.touch-device)   .dropdown-toggle[_ngcontent-%COMP%]:hover{opacity:1}.folders[_ngcontent-%COMP%]:not(.touch-device).simple-list > li[_ngcontent-%COMP%]:not(.is-entered):hover{background-color:rgb(var(--bs-light-rgb))}.grid-list[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.grid-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{min-height:75px}.grid-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:32px;height:32px}.grid-list[_ngcontent-%COMP%]   .navigate-item[_ngcontent-%COMP%]{padding-left:1rem}.grid-list[_ngcontent-%COMP%]   .dropdown-no-caret[_ngcontent-%COMP%]{margin-right:.5rem}.grid-list[_ngcontent-%COMP%]   .folder-name[_ngcontent-%COMP%]{margin-left:.75rem}.grid-list[_ngcontent-%COMP%]   .new-folder[_ngcontent-%COMP%]{color:var(--bs-gray-600);border-top:1px dashed;border-bottom:1px dashed;border-radius:.25rem;justify-content:center}.simple-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{height:57px;padding-right:.5rem}.simple-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:not(:first-of-type){border-top:1px solid #dee2e6}.simple-list[_ngcontent-%COMP%] > li.is-entered[_ngcontent-%COMP%], .simple-list[_ngcontent-%COMP%] > li.is-entered[_ngcontent-%COMP%] + li[_ngcontent-%COMP%]{border-color:#c6cfff}.simple-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;color:#4864fe}.simple-list[_ngcontent-%COMP%]   .navigate-item[_ngcontent-%COMP%], .simple-list[_ngcontent-%COMP%]   .folder-name[_ngcontent-%COMP%], .simple-list[_ngcontent-%COMP%]   .navigate-upper-level[_ngcontent-%COMP%], .simple-list[_ngcontent-%COMP%]   .new-folder[_ngcontent-%COMP%], .simple-list[_ngcontent-%COMP%]   .new-folder-description[_ngcontent-%COMP%]{padding-left:1rem}app-loader[_ngcontent-%COMP%]{margin-top:1rem}@media (min-width: 768px){.folders[_ngcontent-%COMP%]{margin-bottom:2rem}.grid-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(250px,1fr))}.grid-list[_ngcontent-%COMP%]   .new-folder[_ngcontent-%COMP%]{border:1px dashed}.simple-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding-right:1rem}.simple-list[_ngcontent-%COMP%]   .navigate-item[_ngcontent-%COMP%], .simple-list[_ngcontent-%COMP%]   .folder-name[_ngcontent-%COMP%], .simple-list[_ngcontent-%COMP%]   .navigate-upper-level[_ngcontent-%COMP%], .simple-list[_ngcontent-%COMP%]   .new-folder[_ngcontent-%COMP%], .simple-list[_ngcontent-%COMP%]   .new-folder-description[_ngcontent-%COMP%]{padding-left:1.5rem}app-loader[_ngcontent-%COMP%]{margin-top:0}}@media (min-width: 960px){.grid-list[_ngcontent-%COMP%]{gap:1.5rem}}"]}),n})();var Mr=_(4733),wr=_(4723);function Ar(s,n){1&s&&(e.O4$(),e.ynx(0),e._UZ(1,"path",20)(2,"path",21),e.BQk())}function Pr(s,n){1&s&&(e.O4$(),e._UZ(0,"path",20)(1,"path",22))}function Or(s,n){1&s&&e.GkF(0)}function Er(s,n){1&s&&e.GkF(0)}function Sr(s,n){if(1&s){const o=e.EpF();e.ynx(0),e.TgZ(1,"li")(2,"a",31),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.pushMassiveAction(i.actionNames.FILE_SHOW_LINKS))}),e.TgZ(3,"div",17),e._uU(4," construction "),e.qZA(),e.TgZ(5,"div"),e._uU(6,"Visualizza codici"),e.qZA()()(),e.TgZ(7,"li")(8,"a",31),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.pushMassiveAction(i.actionNames.MOVE))}),e.TgZ(9,"div",17),e._uU(10," drive_file_move "),e.qZA(),e.TgZ(11,"div"),e._uU(12,"Sposta selezionati"),e.qZA()()(),e.TgZ(13,"li"),e._UZ(14,"hr",35),e.qZA(),e.TgZ(15,"li")(16,"a",31),e.NdJ("click",function(){e.CHM(o);const i=e.oxw(3);return e.KtG(i.pushMassiveAction(i.actionNames.DELETE))}),e.TgZ(17,"div",17),e._uU(18," delete "),e.qZA(),e.TgZ(19,"div"),e._uU(20,"Elimina selezionati"),e.qZA()()(),e.BQk()}}const Ur=s=>({"position-fixed fixed-dropdown rounded-circle":s}),Ir=()=>["start-bottom","top-end","auto"],En=()=>["bottom-end","top-end","auto"],Dr=(s,n)=>({"rounded-circle btn-success":s,"btn-outline-success":n});function Fr(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"div",24,25)(2,"button",26),e.O4$(),e.TgZ(3,"svg",7),e._UZ(4,"path",27)(5,"path",28),e.qZA()(),e.kcU(),e.TgZ(6,"div",29)(7,"ul",30)(8,"li")(9,"h6",15),e._uU(10,"Azioni massive"),e.qZA()(),e.TgZ(11,"li")(12,"a",31),e.NdJ("click",function(){e.CHM(o);const i=e.MAs(1),r=e.oxw(2);return e.KtG(r.selectOrDeselectAll(i))}),e._UZ(13,"div",32)(14,"div",33),e.qZA()(),e.YNc(15,Sr,21,0,"ng-container",34),e.qZA()()()}if(2&s){const o=e.oxw().$implicit,t=e.oxw();e.Q6J("ngClass",e.VKq(7,Ur,o))("placement",o?e.DdM(9,Ir):e.DdM(10,En)),e.xp6(2),e.Q6J("ngClass",e.WLB(11,Dr,o,!o))("disabled",t.loading),e.xp6(11),e.Q6J("innerText",t.selectedFiles.length?"unpublished":"check_circle_outline"),e.xp6(),e.Q6J("innerText",t.selectedFiles.length?"Deseleziona tutti":"Seleziona tutti"),e.xp6(),e.Q6J("ngIf",t.selectedFiles.length)}}function Zr(s,n){if(1&s&&e.YNc(0,Fr,16,14,"div",23),2&s){const o=n.$implicit,t=e.oxw();e.Q6J("ngIf",!o||t.touchDevice&&t.selectedFiles.length)}}const ti=s=>({disabled:s}),Lr=()=>({$implicit:!1}),kr=()=>({$implicit:!0});let Rr=(()=>{var s;class n{constructor(t,i){this.uploadPreferencesService=t,this.uploadObservablesService=i,this.loading=!0,this.fileList=[],this.filterEvent=new e.vpe,this.selectAllFilesEvent=new e.vpe,this.touchDevice=k.b1,this.layoutParams=v.gG,this.layoutTypes=v.c5,this.selectedFiles=[],this.actionNames=v.In,this.layoutOptions=this.uploadPreferencesService.layoutOptions}ngOnInit(){this.selectedFileListSubscription=this.uploadObservablesService.selectedFileListObservable.subscribe(t=>{this.selectedFiles=t.map(i=>i.name)})}pushLayoutOptions(){this.uploadObservablesService.pushLayoutOptions(this.layoutOptions)}toggleLayoutOrder(){this.layoutOptions.asc=!this.layoutOptions.asc,this.pushLayoutOptions()}setLayoutType(){this.layoutOptions.type=this.layoutOptions.type===v.c5.GRID?v.c5.LIST:v.c5.GRID,this.pushLayoutOptions()}setLayoutOrder(t){this.layoutOptions.orderBy=t,this.pushLayoutOptions()}selectOrDeselectAll(t){t.close(),this.selectedFiles.length?this.uploadObservablesService.pushSelectedFile([]):this.selectAllFilesEvent.emit()}pushMassiveAction(t){const i=this.fileList.filter(r=>this.selectedFiles.includes(r.name));this.uploadObservablesService.pushAction({name:t,payload:{entities:(0,F.jL)(i)}})}ngOnDestroy(){var t;null===(t=this.selectedFileListSubscription)||void 0===t||t.unsubscribe()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(Yi.p),e.Y36(Z.r))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-filter"]],inputs:{loading:"loading",fileList:"fileList"},outputs:{filterEvent:"filterEvent",selectAllFilesEvent:"selectAllFilesEvent"},decls:47,vars:28,consts:[[1,"d-flex","utilities"],[1,"d-block","flex-grow-1","input-filter",3,"disabled","enterKeyOnly","textEvent"],[1,"flex-shrink-0","ms-auto","btn-container","d-flex","align-items-stretch"],[1,"btn","btn-outline-indigo","shadow-none","d-flex","align-items-center",3,"disabled","click"],[1,"material-icons",3,"innerText"],[1,"btn-group","mx-3"],[1,"btn","btn-outline-primary","py-1","shadow-none",3,"disabled","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","currentColor","viewBox","0 0 16 16"],[4,"ngIf","ngIfElse"],["desc",""],["ngbDropdown","","display","dynamic",1,"dropdown-no-caret","btn-group",3,"placement"],["ngbDropdownToggle","",1,"btn","btn-outline-primary","px-1","shadow-none",3,"disabled"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16"],["d","M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"],["ngbDropdownMenu","",1,"list-unstyled","mb-0","dropdown-menu","dropdown-material-icons"],[1,"dropdown-header","text-center"],["role","button",1,"dropdown-item","d-flex","align-items-center",3,"ngClass","click"],[1,"material-icons-outlined","d-block"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["massiveActionsButton",""],["fill-rule","evenodd","d","M10.082 5.629 9.664 7H8.598l1.789-5.332h1.234L13.402 7h-1.12l-.419-1.371h-1.781zm1.57-.785L11 2.687h-.047l-.652 2.157h1.351z"],["d","M12.96 14H9.028v-.691l2.579-3.72v-.054H9.098v-.867h3.785v.691l-2.567 3.72v.054h2.645V14zM4.5 2.5a.5.5 0 0 0-1 0v9.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L4.5 12.293V2.5z"],["d","M12.96 14H9.028v-.691l2.579-3.72v-.054H9.098v-.867h3.785v.691l-2.567 3.72v.054h2.645V14zm-8.46-.5a.5.5 0 0 1-1 0V3.707L2.354 4.854a.5.5 0 1 1-.708-.708l2-1.999.007-.007a.498.498 0 0 1 .7.006l2 2a.5.5 0 1 1-.707.708L4.5 3.707V13.5z"],["class","dropdown-no-caret btn-group","ngbDropdown","","display","dynamic",3,"ngClass","placement",4,"ngIf"],["ngbDropdown","","display","dynamic",1,"dropdown-no-caret","btn-group",3,"ngClass","placement"],["actionsDropdown","ngbDropdown"],["ngbDropdownToggle","",1,"btn","py-1","h-100","shadow-none",3,"ngClass","disabled"],["d","M3 14.5A1.5 1.5 0 0 1 1.5 13V3A1.5 1.5 0 0 1 3 1.5h8a.5.5 0 0 1 0 1H3a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v5a1.5 1.5 0 0 1-1.5 1.5H3z"],["d","m8.354 10.354 7-7a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0z"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-material-icons"],[1,"list-unstyled","mb-0"],["role","button",1,"dropdown-item","d-flex","align-items-center",3,"click"],[1,"material-icons-outlined","d-block",3,"innerText"],[3,"innerText"],[4,"ngIf"],[1,"dropdown-divider"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"app-input-filter-text",1),e.NdJ("textEvent",function(a){return i.filterEvent.emit(a)}),e.qZA(),e.TgZ(2,"div",2)(3,"button",3),e.NdJ("click",function(){return i.setLayoutType()}),e._UZ(4,"span",4),e.qZA(),e.TgZ(5,"div",5)(6,"button",6),e.NdJ("click",function(){return i.toggleLayoutOrder()}),e.O4$(),e.TgZ(7,"svg",7),e.YNc(8,Ar,3,0,"ng-container",8)(9,Pr,2,0,"ng-template",null,9,e.W1O),e.qZA()(),e.kcU(),e.TgZ(11,"div",10)(12,"button",11),e.O4$(),e.TgZ(13,"svg",12),e._UZ(14,"path",13),e.qZA()(),e.kcU(),e.TgZ(15,"ul",14)(16,"li")(17,"h6",15),e._uU(18," Criterio di ordinamento "),e.qZA()(),e.TgZ(19,"li")(20,"a",16),e.NdJ("click",function(){return i.setLayoutOrder(i.layoutParams.FILENAME)}),e.TgZ(21,"div",17),e._uU(22," account_box "),e.qZA(),e.TgZ(23,"div"),e._uU(24,"Nome"),e.qZA()()(),e.TgZ(25,"li")(26,"a",16),e.NdJ("click",function(){return i.setLayoutOrder(i.layoutParams.TIME)}),e.TgZ(27,"div",17),e._uU(28," history "),e.qZA(),e.TgZ(29,"div"),e._uU(30,"Ultima modifica"),e.qZA()()(),e.TgZ(31,"li")(32,"a",16),e.NdJ("click",function(){return i.setLayoutOrder(i.layoutParams.SIZE)}),e.TgZ(33,"div",17),e._uU(34," balance "),e.qZA(),e.TgZ(35,"div"),e._uU(36,"Dimensione"),e.qZA()()(),e.TgZ(37,"li")(38,"a",16),e.NdJ("click",function(){return i.setLayoutOrder(i.layoutParams.EXTENSION)}),e.TgZ(39,"div",17),e._uU(40," description "),e.qZA(),e.TgZ(41,"div"),e._uU(42,"Estensione"),e.qZA()()()()()(),e.YNc(43,Or,1,0,"ng-container",18),e.qZA()(),e.YNc(44,Er,1,0,"ng-container",18)(45,Zr,1,1,"ng-template",null,19,e.W1O)),2&t){const r=e.MAs(10),a=e.MAs(46);e.xp6(),e.Q6J("disabled",i.loading)("enterKeyOnly",!0),e.xp6(2),e.Q6J("disabled",i.loading),e.xp6(),e.Q6J("innerText",i.layoutOptions.type===i.layoutTypes.GRID?"space_dashboard":"view_list"),e.xp6(2),e.Q6J("disabled",i.loading),e.xp6(2),e.Q6J("ngIf",i.layoutOptions.asc)("ngIfElse",r),e.xp6(3),e.Q6J("placement",e.DdM(17,En)),e.xp6(),e.Q6J("disabled",i.loading),e.xp6(8),e.Q6J("ngClass",e.VKq(18,ti,i.layoutOptions.orderBy===i.layoutParams.FILENAME)),e.xp6(6),e.Q6J("ngClass",e.VKq(20,ti,i.layoutOptions.orderBy===i.layoutParams.TIME)),e.xp6(6),e.Q6J("ngClass",e.VKq(22,ti,i.layoutOptions.orderBy===i.layoutParams.SIZE)),e.xp6(6),e.Q6J("ngClass",e.VKq(24,ti,i.layoutOptions.orderBy===i.layoutParams.EXTENSION)),e.xp6(5),e.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",e.DdM(26,Lr)),e.xp6(),e.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",e.DdM(27,kr))}},dependencies:[f.mk,f.O5,f.tP,wr.r,U.jt,U.iD,U.Vi],styles:[".utilities[_ngcontent-%COMP%]{margin:1rem 1rem 0;flex-wrap:wrap}.utilities[_ngcontent-%COMP%]   .btn-container[_ngcontent-%COMP%]{margin-top:1rem}.input-filter[_ngcontent-%COMP%]{width:100%;box-shadow:0 .125rem .25rem #00000013}.fixed-dropdown[_ngcontent-%COMP%]{bottom:2rem;right:2rem;z-index:1;width:56px;height:56px;box-shadow:0 .125rem .25rem #00000040}@media (min-width: 500px){.input-filter[_ngcontent-%COMP%]{width:auto}.utilities[_ngcontent-%COMP%]{flex-wrap:nowrap}.utilities[_ngcontent-%COMP%]   .btn-container[_ngcontent-%COMP%]{margin-top:initial}.utilities[_ngcontent-%COMP%]   .btn-outline-indigo[_ngcontent-%COMP%]{margin-left:1rem}}@media (min-width: 960px){.utilities[_ngcontent-%COMP%]{margin:1.5rem 0 0}}"]}),n})();const Nr=["modal"];function zr(s,n){if(1&s&&(e.TgZ(0,"tr"),e._UZ(1,"td",10),e.ALo(2,"arrayJoin"),e._UZ(3,"td",11),e.ALo(4,"formatBytes"),e.qZA()),2&s){const o=n.$implicit;e.xp6(),e.Q6J("innerText","."+e.xi3(2,2,o.ext,", .")),e.xp6(2),e.Q6J("innerText",e.lcZ(4,5,o.maxSize))}}function Hr(s,n){if(1&s&&(e.ynx(0),e.YNc(1,zr,5,7,"tr",9),e.BQk()),2&s){const o=e.oxw(2);e.xp6(),e.Q6J("ngForOf",o.supportedFiles)}}function qr(s,n){if(1&s&&(e.TgZ(0,"p"),e._uU(1," Il servizio "),e.TgZ(2,"strong"),e._uU(3,"Upload"),e.qZA(),e._uU(4),e.TgZ(5,"strong"),e._uU(6,"spazio gestito e amministrato"),e.qZA(),e._uU(7," dagli utenti per caricare immagini e file da condividere e utilizzare sui circuiti ForumFree, ForumCommunity e BlogFree. Grazie all'elevato livello di sicurezza e alle numerose funzioni disponibili, il servizio si presenta come alternativa "),e.TgZ(8,"strong"),e._uU(9,"valida e affidabile"),e.qZA(),e._uU(10," agli altri "),e.TgZ(11,"em"),e._uU(12,"hosting"),e.qZA(),e._uU(13," disponibili. "),e.qZA(),e.TgZ(14,"h6",3),e._uU(15,"Metodi di caricamento"),e.qZA(),e.TgZ(16,"p",4),e._uU(17,"Sono possibili i seguenti metodi di upload:"),e.qZA(),e.TgZ(18,"ul")(19,"li")(20,"em"),e._uU(21,"caricare file da memoria"),e.qZA(),e._uU(22,": cliccando sull'apposita area, \xe8 possibile "),e.TgZ(23,"strong"),e._uU(24,"selezionare"),e.qZA(),e._uU(25," uno o pi\xf9 file da caricare direttamente dalla memoria del dispositivo in uso. Nel caso di dispositivi mobile, \xe8 necessario che sia presente l'autorizzazione del browser ad accedere ai file presenti in locale; "),e.qZA(),e.TgZ(26,"li")(27,"em"),e._uU(28,"drag & drop"),e.qZA(),e._uU(29,": \xe8 possibile "),e.TgZ(30,"strong"),e._uU(31,"trascinare"),e.qZA(),e._uU(32," nell'apposita area i file che si desiderano caricare. Una volta rilasciati i file, l'upload inizier\xe0 immediatamente senza ulteriori conferme; "),e.qZA(),e.TgZ(33,"li")(34,"em"),e._uU(35,"clipboard"),e.qZA(),e._uU(36,": \xe8 consentito "),e.TgZ(37,"strong"),e._uU(38,"copincollare"),e.qZA(),e._uU(39," un file che si vuole aggiungere al proprio spazio. Per fare ci\xf2, occorre dapprima copiare (ad esempio premendo "),e.TgZ(40,"em"),e._uU(41,"ctrl + c"),e.qZA(),e._uU(42,") il file e in seguito, rimanendo sulla pagina di upload, incollarlo (ad esempio premendo "),e.TgZ(43,"em"),e._uU(44,"ctrl + v"),e.qZA(),e._uU(45,"). Se ci\xf2 che \xe8 stato copiato e incollato soddisfa i requisiti richiesti, l'upload inizier\xe0 senza ulteriori conferme. Questa tecnica pu\xf2 essere utilizzata come valida alternativa per caricare file da indirizzo remoto: \xe8 infatti sufficiente aprire il file da caricare in una finestra del browser, copiarlo e infine incollarlo nella pagina di upload. "),e.qZA()(),e.TgZ(46,"h6",3),e._uU(47,"Azioni disponibili"),e.qZA(),e.TgZ(48,"p",4),e._uU(49," Il servizio Upload consente di eseguire diverse azioni su singoli file o cartelle. Per aprire il men\xf9 con le opzioni disponibili, \xe8 sufficiente cliccare sui tre pallini verticali presenti vicino ad ogni file e cartella. In particolare, i pulsanti a disposizione sono: "),e.qZA(),e.TgZ(50,"ul")(51,"li")(52,"em"),e._uU(53,"sposta"),e.qZA(),e._uU(54,": questa azione, disponibile sia per file che per cartelle, consente, tramite l'apposito modal, di "),e.TgZ(55,"strong"),e._uU(56,"muovere"),e.qZA(),e._uU(57," l'elemento selezionato verso un'altra destinazione; "),e.qZA(),e.TgZ(58,"li")(59,"em"),e._uU(60,"rinomina"),e.qZA(),e._uU(61,": questa azione, disponibile sia per file che per cartelle, consente, tramite l'apposito modal, di assegnare un "),e.TgZ(62,"strong"),e._uU(63,"nuovo nome"),e.qZA(),e._uU(64," all'elemento selezionato; "),e.qZA(),e.TgZ(65,"li")(66,"em"),e._uU(67,"elimina"),e.qZA(),e._uU(68,": questa azione, disponibile sia per file che per cartelle, consente, tramite l'apposito modal, di "),e.TgZ(69,"strong"),e._uU(70,"rimuovere"),e.qZA(),e._uU(71," completamente e senza possibilit\xe0 di ripristino l'elemento selezionato. Nel caso in cui si agisca su una cartella, la rimozione viene estesa anche a tutto il suo contenuto, comprese eventuali sottocartelle; "),e.qZA(),e.TgZ(72,"li")(73,"em"),e._uU(74,"nuova cartella"),e.qZA(),e._uU(75,": premendo questo pulsante, presente solo tra le opzioni di una cartella, \xe8 possibile aggiungere una "),e.TgZ(76,"strong"),e._uU(77,"nuova cartella"),e.qZA(),e._uU(78,"; "),e.qZA(),e.TgZ(79,"li")(80,"em"),e._uU(81,"codici"),e.qZA(),e._uU(82,": questo pulsante, presente solo per i file, consente di aprire un modal contenente i vari "),e.TgZ(83,"strong"),e._uU(84,"codici"),e.qZA(),e._uU(85," del file stesso, tra cui i link per condividerlo ed eventualmente per incorporarlo come immagine; "),e.qZA(),e.TgZ(86,"li")(87,"em"),e._uU(88,"scarica"),e.qZA(),e._uU(89,": questo pulsante, presente solo per i file, permette di "),e.TgZ(90,"strong"),e._uU(91,"scaricare"),e.qZA(),e._uU(92," il file selezionato; "),e.qZA(),e.TgZ(93,"li")(94,"em"),e._uU(95,"modifica"),e.qZA(),e._uU(96,": questa azione, abilitata solo per i file supportati, permette di "),e.TgZ(97,"strong"),e._uU(98,"modificare"),e.qZA(),e._uU(99," (ritagliare, ingrandire, rimpicciolire, ruotare) il file selezionato; "),e.qZA(),e.TgZ(100,"li")(101,"em"),e._uU(102,"seleziona"),e.qZA(),e._uU(103,": questo pulsante consente di "),e.TgZ(104,"strong"),e._uU(105,"selezionare"),e.qZA(),e._uU(106," il file per eseguire in seguito un'azione massiva. "),e.qZA()(),e.TgZ(107,"h6",3),e._uU(108,"Azioni massive"),e.qZA(),e.TgZ(109,"p",4),e._uU(110," Tramite il pulsante verde con il simbolo del checkbox, \xe8 possibile aprire l'elenco delle azioni massive disponibili. Un'azione massiva \xe8 un'operazione che coinvolge contemporaneamente e allo stesso modo due o pi\xf9 file. Sono effettuabili le seguenti azioni massive: "),e.qZA(),e.TgZ(111,"ul")(112,"li")(113,"em"),e._uU(114,"seleziona tutti"),e.qZA(),e._uU(115,": questo pulsante, visibile solo se non \xe8 ancora stato selezionato alcun file, consente di "),e.TgZ(116,"strong"),e._uU(117,"selezionare tutti"),e.qZA(),e._uU(118," i file presente nella cartella corrente; "),e.qZA(),e.TgZ(119,"li")(120,"em"),e._uU(121,"deseleziona tutti"),e.qZA(),e._uU(122,": questo pulsante, visibile solo se \xe8 stato selezionato almeno un file, consente di "),e.TgZ(123,"strong"),e._uU(124,"rimuovere la selezione"),e.qZA(),e._uU(125," da tutti i file in precedenza selezionati; "),e.qZA(),e.TgZ(126,"li")(127,"em"),e._uU(128,"visualizza codici"),e.qZA(),e._uU(129,": questa azione, visibile solo se \xe8 stato selezionato almeno un file, consente di aprire un modal contenente i vari "),e.TgZ(130,"strong"),e._uU(131,"codici"),e.qZA(),e._uU(132," di tutti i file selezionati, tra cui i link per condividerli insieme ed eventualmente per incorporarli come immagine; "),e.qZA(),e.TgZ(133,"li")(134,"em"),e._uU(135,"sposta selezionati"),e.qZA(),e._uU(136,": questa azione, visibile solo se \xe8 stato selezionato almeno un file, consente di "),e.TgZ(137,"strong"),e._uU(138,"spostare"),e.qZA(),e._uU(139," verso un'unica destinazione tutti i file selezionati; "),e.qZA(),e.TgZ(140,"li")(141,"em"),e._uU(142,"elimina selezionati"),e.qZA(),e._uU(143,": questa azione, visibile solo se \xe8 stato selezionato almeno un file, consente di "),e.TgZ(144,"strong"),e._uU(145,"eliminare"),e.qZA(),e._uU(146," in modo definitivo tutti i file selezionati. "),e.qZA()(),e.TgZ(147,"h6",3),e._uU(148,"File accettati"),e.qZA(),e.TgZ(149,"p",5),e._uU(150," Vengono accettati differenti tipi di file, ciascuno con un limite massimo di dimensione: "),e.qZA(),e.TgZ(151,"table",6)(152,"thead")(153,"tr")(154,"th"),e._uU(155,"Estensione"),e.qZA(),e.TgZ(156,"th"),e._uU(157,"Dimensione"),e.qZA()()(),e.TgZ(158,"tbody"),e.YNc(159,Hr,2,1,"ng-container",7),e.qZA()(),e.TgZ(160,"h6",3),e._uU(161,"Ricerca e opzioni di layout"),e.qZA(),e.TgZ(162,"p",4),e._uU(163," Nell'apposito input "),e.TgZ(164,"em"),e._uU(165,"Cerca"),e.qZA(),e._uU(166," \xe8 possibile inserire una parola che verr\xe0 usata per filtrare la lista dei file e delle cartelle sulla base del nome e dell'estensione degli stessi. Il pulsante viola accanto all'input di ricerca consente di modificare il layout dell'elenco di cartelle e file, scegliendo tra griglia e lista. I due pulsanti blu permettono infine di personalizzare l'ordinamento degli elementi presenti nella cartella corrente: "),e.qZA(),e.TgZ(167,"ul",8)(168,"li"),e._uU(169," il pulsante "),e.TgZ(170,"em"),e._uU(171,"a-z"),e.qZA(),e._uU(172," e "),e.TgZ(173,"em"),e._uU(174,"z-a"),e.qZA(),e._uU(175," consente di ordinare gli elementi seguendo un criterio rispettivamente crescente o decrescente; "),e.qZA(),e.TgZ(176,"li"),e._uU(177," il secondo pulsante apre un men\xf9 in cui \xe8 possibile scegliere un criterio di ordinamento tra "),e.TgZ(178,"em"),e._uU(179,"nome"),e.qZA(),e._uU(180,", "),e.TgZ(181,"em"),e._uU(182,"data di ultima modifica"),e.qZA(),e._uU(183,", che per i file non modificati coincide con la data di caricamento, "),e.TgZ(184,"em"),e._uU(185,"dimensione"),e.qZA(),e._uU(186,", cio\xe8 peso in byte del file, ed "),e.TgZ(187,"em"),e._uU(188,"estensione"),e.qZA(),e._uU(189,". "),e.qZA()()),2&s){const o=e.oxw();e.xp6(4),e.hij(" di ",o.appName," si pone come obiettivo fornire uno "),e.xp6(155),e.Q6J("ngIf",o.supportedFiles)}}let Jr=(()=>{var s;class n{constructor(t){this.uploadService=t,this.appName=k.DJ}open(){var t=this;return(0,T.Z)(function*(){t.modalComponent.open(),t.supportedFiles||(t.supportedFiles=yield t.uploadService.getFileLimits())})()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(te.C))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-info-modal"]],viewQuery:function(t,i){if(1&t&&e.Gf(Nr,5),2&t){let r;e.iGM(r=e.CRH())&&(i.modalComponent=r.first)}},decls:3,vars:0,consts:[["title","Servizio Upload"],["modal",""],["appModalBody",""],[1,"fst-italic"],[1,"mb-1"],[1,"mb-3"],[1,"table","table-striped","text-center","border"],[4,"ngIf"],[1,"mb-0"],[4,"ngFor","ngForOf"],[1,"fst-italic",3,"innerText"],[3,"innerText"]],template:function(t,i){1&t&&(e.TgZ(0,"app-modal",0,1),e.YNc(2,qr,190,2,"ng-template",2),e.qZA())},dependencies:[f.sg,f.O5,X.z,re.J,rt.J,ei.b]}),n})();const Qr=["scrollerContainer"],Br=["app-hidden-scroller",""],Vr=(s,n)=>({"max-height":s,height:n}),Gr=["*"];let Yr=(()=>{var s;class n{constructor(){this.touchDevice=k.b1}ngAfterViewInit(){const t=this.scrollerContainer.nativeElement;t.style.marginRight=-(t.offsetWidth-t.clientWidth)+"px"}}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["","app-hidden-scroller",""]],viewQuery:function(t,i){if(1&t&&e.Gf(Qr,5),2&t){let r;e.iGM(r=e.CRH())&&(i.scrollerContainer=r.first)}},inputs:{maxHeight:"maxHeight",height:"height"},attrs:Br,ngContentSelectors:Gr,decls:3,vars:4,consts:[[1,"scroller-container",3,"ngStyle"],["scrollerContainer",""]],template:function(t,i){1&t&&(e.F$t(),e.TgZ(0,"div",0,1),e.Hsn(2),e.qZA()),2&t&&e.Q6J("ngStyle",e.WLB(1,Vr,i.maxHeight||null,i.height||null))},dependencies:[f.PC],styles:[".scroller-container[_ngcontent-%COMP%]{overflow-y:scroll}[_nghost-%COMP%]{overflow:hidden}"]}),n})();const Wr=s=>({"mb-2":s});function Kr(s,n){1&s&&e._UZ(0,"li",6),2&s&&e.Q6J("ngClass",e.VKq(1,Wr,!n.last))}const $r=()=>[];function jr(s,n){1&s&&(e.ynx(0),e.TgZ(1,"ul",4),e.YNc(2,Kr,1,3,"li",5),e.qZA(),e.BQk()),2&s&&(e.xp6(2),e.Q6J("ngForOf",e.DdM(1,$r).constructor(3)))}function Xr(s,n){1&s&&(e.ynx(0),e.TgZ(1,"div",9),e._uU(2," Non ci sono file recenti! "),e.qZA(),e.BQk())}const ea=s=>({rotating:s}),ta=s=>({width:s});function ia(s,n){if(1&s&&(e.TgZ(0,"li",16),e._UZ(1,"div",17),e.TgZ(2,"div",18)(3,"div",19),e._UZ(4,"div",20)(5,"div",21),e.TgZ(6,"div",22),e._uU(7),e.qZA()(),e.TgZ(8,"div",23),e._UZ(9,"div",24),e.qZA()()()),2&s){const o=e.oxw().$implicit;e.xp6(),e.Q6J("ngClass",e.VKq(6,ea,o.progress>0&&o.progress<100))("innerText",o.progress>0?o.progress<100?"sync":"check_circle":"schedule"),e.xp6(3),e.Q6J("innerText",o.file.filename),e.xp6(),e.Q6J("innerText","."+o.file.ext),e.xp6(2),e.hij(" ",o.progress,"% "),e.xp6(2),e.Q6J("ngStyle",e.VKq(8,ta,o.progress+"%"))}}function na(s,n){if(1&s&&(e.ynx(0),e.YNc(1,ia,10,10,"li",15),e.BQk()),2&s){const o=n.$implicit;e.xp6(),e.Q6J("ngIf",!o.error)}}function oa(s,n){if(1&s&&(e.TgZ(0,"li",25)(1,"div",26),e._uU(2," cancel "),e.qZA(),e.TgZ(3,"div",18)(4,"div",27),e._UZ(5,"div",20)(6,"div",21),e.qZA(),e.TgZ(7,"div",28),e._uU(8," Errore durante il caricamento "),e.qZA()()()),2&s){const o=n.$implicit;e.xp6(5),e.Q6J("innerText",o.file.filename),e.xp6(),e.Q6J("innerText","."+o.file.ext)}}const sa=(s,n)=>({pending:s,selected:n}),ra=()=>[0,5],aa=s=>({offset:s,appendTo:"parent"});function la(s,n){if(1&s){const o=e.EpF();e.TgZ(0,"li",29),e.ALo(1,"arrayIncludes"),e.ALo(2,"arrayIncludes"),e.TgZ(3,"button",30),e.NdJ("click",function(){const r=e.CHM(o).$implicit,a=e.oxw(3);return e.KtG(a.unselectFile(r.name))}),e.O4$(),e.TgZ(4,"svg",31),e._UZ(5,"path",32)(6,"path",33),e.qZA()(),e.kcU(),e.TgZ(7,"a",34),e._uU(8,"wallpaper"),e.qZA(),e.TgZ(9,"div",35)(10,"a",36),e._UZ(11,"div",20)(12,"div",37),e.qZA(),e.TgZ(13,"div",38)(14,"div",39),e._uU(15),e.ALo(16,"formatBytes"),e.qZA(),e.TgZ(17,"div",40),e.ALo(18,"date"),e._UZ(19,"span",41),e.qZA()()(),e.TgZ(20,"div",42,43),e.NdJ("openChange",function(i){e.CHM(o);const r=e.MAs(21);e.oxw();const a=e.MAs(1),d=e.oxw(2);return e.KtG(d.saveDropdown(r,a,i))}),e.TgZ(22,"div",44),e._uU(23," more_vert "),e.qZA(),e.TgZ(24,"div",45),e._UZ(25,"app-upload-file-menu",46),e.ALo(26,"arrayIncludes"),e.qZA()()()}if(2&s){const o=n.$implicit,t=e.MAs(21),i=e.oxw(3);e.Q6J("ngClass",e.WLB(26,sa,e.xi3(1,12,i.pendingFiles,o.name),e.xi3(2,15,i.selectedFiles,o.name))),e.xp6(7),e.Q6J("href",o.url,e.LSH),e.xp6(3),e.Q6J("href",o.url,e.LSH),e.xp6(),e.Q6J("innerText",o.filename),e.xp6(),e.Q6J("innerText","."+o.ext),e.xp6(3),e.hij(" ",e.lcZ(16,18,o.size)," "),e.xp6(2),e.Q6J("appTippy",e.xi3(18,20,o.time,"dd-MM-YY HH:mm")||"")("tippyProps",e.VKq(30,aa,e.DdM(29,ra))),e.xp6(2),e.Q6J("date",o.time),e.xp6(6),e.Q6J("file",o)("isSelected",e.xi3(26,23,i.selectedFiles,o.name))("dropdownRef",t)}}function ca(s,n){if(1&s&&(e.TgZ(0,"ul",10,11),e.YNc(2,na,2,1,"ng-container",12)(3,oa,9,2,"li",13)(4,la,27,32,"li",14),e.ALo(5,"slice"),e.qZA()),2&s){const o=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",o.uploadingFileList),e.xp6(),e.Q6J("ngForOf",o.uploadedFileWithErrors),e.xp6(),e.Q6J("ngForOf",e.Dn7(5,3,o.fileList,0,5))}}function da(s,n){if(1&s&&(e.TgZ(0,"div",7),e.YNc(1,Xr,3,0,"ng-container",2)(2,ca,6,7,"ng-template",null,8,e.W1O),e.qZA()),2&s){const o=e.MAs(3),t=e.oxw();e.xp6(),e.Q6J("ngIf",0===t.fileList.length&&0===t.uploadingFileList.length&&0===t.uploadedFileWithErrors.length)("ngIfElse",o)}}const pa=s=>({"touch-device":s});let ha=(()=>{var s;class n{constructor(t,i){this.uploadObservablesService=t,this.renderer=i,this.fileList=[],this.loading=!0,this.touchDevice=k.b1,this.uploadingFileList=[],this.uploadedFileWithErrors=[],this.pendingFiles=[],this.selectedFiles=[],this.openedDropdown=[],this.checkOpenedDropdownEvent=!1}ngOnInit(){this.uploadingListSubscription=this.uploadObservablesService.uploadingFileQueueObservable.subscribe(t=>{this.uploadingFileList=[...t].reverse()}),this.uploadingErrorSubscription=this.uploadObservablesService.uploadingFileErrorObservable.subscribe(t=>{this.uploadedFileWithErrors.unshift(t)}),this.entityPendingSubscription=this.uploadObservablesService.entityPendingObservable.subscribe(t=>{t.forEach(i=>{i.type===v.VC.FILE&&(this.pendingFiles=[...this.updatePendingFileList(this.pendingFiles,i.name,i.start)])})}),this.selectedFileListSubscription=this.uploadObservablesService.selectedFileListObservable.subscribe(t=>{this.selectedFiles=t.map(i=>i.name)})}updatePendingFileList(t,i,r){if(r)t.includes(i)||t.push(i);else{const a=t.indexOf(i);a>-1&&t.splice(a,1)}return t}saveDropdown(t,i,r){if(!r||(this.openedDropdown.push(t),this.checkOpenedDropdownEvent))return;this.checkOpenedDropdownEvent=!0;const a=this.renderer.listen(i,"scroll",()=>{this.openedDropdown.forEach(d=>{d.isOpen()&&d.close()}),this.openedDropdown=[],this.checkOpenedDropdownEvent=!1,a()})}unselectFile(t){this.uploadObservablesService.pushSelectedFile({name:t,selected:!1})}ngOnDestroy(){var t,i,r,a;null===(t=this.uploadingListSubscription)||void 0===t||t.unsubscribe(),null===(i=this.uploadingErrorSubscription)||void 0===i||i.unsubscribe(),null===(r=this.entityPendingSubscription)||void 0===r||r.unsubscribe(),null===(a=this.selectedFileListSubscription)||void 0===a||a.unsubscribe()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(Z.r),e.Y36(e.Qsj))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-recent-files"]],inputs:{fileList:"fileList",loading:"loading"},decls:6,vars:5,consts:[[1,"flat-container","py-2","px-3","h-100","d-flex","flex-column",3,"ngClass"],[1,"fv-small-caps","fs-lg","mb-2"],[4,"ngIf","ngIfElse"],["listContainer",""],[1,"list-unstyled","mb-1","placeholder-glow"],["class","placeholder col-12 rounded",3,"ngClass",4,"ngFor","ngForOf"],[1,"placeholder","col-12","rounded",3,"ngClass"],["app-hidden-scroller","","height","100%",1,"file-list-container","mb-1","flex-grow-1"],["listContent",""],[1,"alert","alert-primary","mb-0","text-center"],[1,"list-unstyled","mb-0","file-list"],["list",""],[4,"ngFor","ngForOf"],["class","file-container rounded bg-danger text-white",4,"ngFor","ngForOf"],["class","file-container rounded position-relative",3,"ngClass",4,"ngFor","ngForOf"],["class","file-container rounded uploading",4,"ngIf"],[1,"file-container","rounded","uploading"],[1,"d-block","material-icons-outlined","text-primary",3,"ngClass","innerText"],[1,"ms-3","flex-grow-1","min-w-0"],[1,"d-flex","align-items-end"],[1,"text-truncate",3,"innerText"],[1,"me-3",3,"innerText"],[1,"ms-auto","fs-sm"],[1,"progress","bg-white","mt-1"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar",3,"ngStyle"],[1,"file-container","rounded","bg-danger","text-white"],[1,"d-block","material-icons-outlined"],[1,"d-flex"],[1,"fs-xs"],[1,"file-container","rounded","position-relative",3,"ngClass"],[1,"btn","btn-primary","shadow-none","pre-button","d-flex","justify-content-center","align-items-center","p-0","position-absolute",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","currentColor","viewBox","0 0 16 16"],["d","M2.5 8a5.5 5.5 0 0 1 8.25-4.764.5.5 0 0 0 .5-.866A6.5 6.5 0 1 0 14.5 8a.5.5 0 0 0-1 0 5.5 5.5 0 1 1-11 0z"],["d","M15.354 3.354a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l7-7z"],["target","_blank","rel","noreferrer",1,"material-icons-outlined","d-block","text-primary",3,"href"],[1,"mx-3","flex-grow-1","min-w-0"],["target","_blank","rel","noreferrer",1,"text-reset","d-inline-flex","mw-100",3,"href"],[3,"innerText"],[1,"text-muted","fs-xs","d-flex","flex-wrap","align-items-center","position-relative"],[1,"file-size","me-1"],[1,"file-time",3,"appTippy","tippyProps"],["timeago","",3,"date"],["ngbDropdown","","placement","left-top","display","dynamic","container","body",1,"dropdown-no-caret","ms-auto",3,"openChange"],["dropdownRef","ngbDropdown"],["ngbDropdownToggle","",1,"material-icons-outlined","d-block","text-primary","cursor-pointer","dropdown-icon"],["ngbDropdownMenu","",1,"dropdown-menu"],[3,"file","isSelected","dropdownRef"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"File recenti"),e.qZA(),e.YNc(3,jr,3,2,"ng-container",2)(4,da,4,2,"ng-template",null,3,e.W1O),e.qZA()),2&t){const r=e.MAs(5);e.Q6J("ngClass",e.VKq(3,pa,i.touchDevice)),e.xp6(3),e.Q6J("ngIf",i.loading)("ngIfElse",r)}},dependencies:[f.mk,f.sg,f.O5,f.PC,Yr,U.jt,U.iD,U.Vi,et,Re.$,Wi,On.Q,f.OU,f.uU,ei.b],styles:['.placeholder[_ngcontent-%COMP%]{height:59px;background-color:var(--bs-gray-500)}.file-list-container[_ngcontent-%COMP%]{overflow:hidden;height:calc(177px + 1rem)}.file-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem 1rem;transition:opacity .2s,margin-left .2s;height:59px}.file-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .pre-button[_ngcontent-%COMP%]{width:40px;left:-10px;transform:translate(-100%);height:70%}.file-list[_ngcontent-%COMP%] > li.selected[_ngcontent-%COMP%]{margin-left:50px}.file-list[_ngcontent-%COMP%] > li.pending[_ngcontent-%COMP%]{opacity:.5}.file-list[_ngcontent-%COMP%] > li.pending[_ngcontent-%COMP%]   .dropdown-icon[_ngcontent-%COMP%]{display:none!important}.file-list[_ngcontent-%COMP%] > li.pending[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{pointer-events:none}.file-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:.5rem}.file-container[_ngcontent-%COMP%]{background-color:#dae0ff;min-height:59px}.file-container.uploading[_ngcontent-%COMP%]   .rotating[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fullRotation 1s linear infinite}.file-container.uploading[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{height:.5rem;border-radius:.15rem}.touch-device[_ngcontent-%COMP%]   .file-time[_ngcontent-%COMP%]{cursor:pointer}.file-size[_ngcontent-%COMP%]:after{content:" - "}@keyframes _ngcontent-%COMP%_fullRotation{0%{transform:rotate(0)}to{transform:rotate(-360deg)}}']}),n})();function ua(s,n){if(1&s&&e._UZ(0,"span",13),2&s){const o=e.oxw();e.Q6J("innerText",o.usedStoragePercentage+"%")}}const ga=s=>({width:s}),ma=(s,n)=>({pending:s,loading:n});let _a=(()=>{var s;class n{constructor(){this.recalculatingStorage=!1,this.loading=!1,this.openInfoModal=new e.vpe,this.recalculateStorage=new e.vpe,this.usedStoragePercentage=0,this.storageAvailable=0}ngOnChanges(t){t.userStorage&&(this.usedStoragePercentage=Math.round(Math.min(100*this.userStorage.used/this.userStorage.max,100)),this.storageAvailable=Math.max(this.userStorage.max-this.userStorage.used,0))}}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-upload-used-storage"]],inputs:{userStorage:"userStorage",recalculatingStorage:"recalculatingStorage",loading:"loading"},outputs:{openInfoModal:"openInfoModal",recalculateStorage:"recalculateStorage"},features:[e.TTD],decls:28,vars:22,consts:[[1,"flat-container","py-2","px-3","flex-grow-1","position-relative","d-flex","flex-column"],[1,"d-flex","align-items-end"],[1,"fv-small-caps","fs-lg"],[1,"material-icons-outlined","d-block","ms-auto","text-primary","cursor-pointer",3,"click"],[1,"my-auto"],[1,"storage-desc","text-justify"],[3,"innerHTML"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress",3,"appTippy","ariaValueNow"],[1,"progress-bar",3,"ngStyle"],[3,"innerText",4,"ngIf"],[1,"d-flex","align-items-center"],[1,"me-auto"],["role","button","appTippy","Ricalcola lo spazio",1,"d-block","material-icons-outlined","icon-small","mt-1","ms-1","refresh-storage",3,"ngClass","disableOnTouchDevice","click"],[3,"innerText"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Spazio occupato"),e.qZA(),e.TgZ(4,"div",3),e.NdJ("click",function(){return i.openInfoModal.emit()}),e._uU(5," info "),e.qZA()(),e.TgZ(6,"div",4)(7,"p",5),e._uU(8," A questo account \xe8 associato uno spazio di "),e._UZ(9,"span",6),e.ALo(10,"formatBytes"),e._uU(11,". Una volta occupato tutto lo spazio disponibile, per caricare nuovi file occorre cancellare quelli pi\xf9 vecchi o inutilizzati. "),e.qZA()(),e.TgZ(12,"div")(13,"div",7),e.ALo(14,"formatBytes"),e.TgZ(15,"div",8),e.YNc(16,ua,1,1,"span",9),e.qZA()(),e.TgZ(17,"div",10)(18,"div",11)(19,"small"),e._uU(20,"Spazio libero: "),e._UZ(21,"span",6),e.ALo(22,"formatBytes"),e._uU(23," su "),e._UZ(24,"span",6),e.ALo(25,"formatBytes"),e.qZA()(),e.TgZ(26,"a",12),e.NdJ("click",function(){return i.recalculateStorage.emit()}),e._uU(27,"sync"),e.qZA()()()()),2&t&&(e.xp6(9),e.Q6J("innerHTML",e.lcZ(10,9,i.userStorage.max),e.oJD),e.xp6(4),e.Q6J("appTippy","I file caricati occupano "+e.lcZ(14,11,i.userStorage.used))("ariaValueNow",i.usedStoragePercentage),e.xp6(2),e.Q6J("ngStyle",e.VKq(17,ga,i.usedStoragePercentage+"%")),e.xp6(),e.Q6J("ngIf",i.usedStoragePercentage>1),e.xp6(5),e.Q6J("innerHTML",e.lcZ(22,13,i.storageAvailable),e.oJD),e.xp6(3),e.Q6J("innerHTML",e.lcZ(25,15,i.userStorage.max),e.oJD),e.xp6(2),e.Q6J("ngClass",e.WLB(19,ma,i.recalculatingStorage,i.loading))("disableOnTouchDevice",!0))},dependencies:[f.mk,f.O5,f.PC,Re.$,ei.b],styles:[".storage-desc[_ngcontent-%COMP%]{margin:.5rem 0 1rem}.progress-bar[_ngcontent-%COMP%]{transition:none}.refresh-storage.pending[_ngcontent-%COMP%], .refresh-storage.loading[_ngcontent-%COMP%]{pointer-events:none}.refresh-storage.pending[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotation 1s linear infinite}@media (min-width: 1100px){.storage-desc[_ngcontent-%COMP%]{margin:.25rem 0 .5rem}}@keyframes _ngcontent-%COMP%_rotation{0%{transform:rotate(0)}to{transform:rotate(-360deg)}}"]}),n})();const fa=["fileLinksModal"],va=["renameModal"],Ca=["deleteModal"],xa=["moveModal"],ba=["cropModal"];function Ta(s,n){1&s&&e._UZ(0,"app-login-as-advice")}function ya(s,n){if(1&s&&e._UZ(0,"app-upload-no-storage-advice",22),2&s){const o=e.oxw();e.Q6J("storageToFree",o.userStorage.used-o.userStorage.max)}}let Ma=(()=>{var s;class n{constructor(t,i,r,a,d,h){this.uploadService=t,this.uploadObservablesService=i,this.uploadActionsService=r,this.uploadSubscriptionsService=a,this.toastService=d,this.loginAsService=h,this.fileList=[],this.folderList=[],this.loading=!0,this.currentFolderPath=[],this.currentFilter="",this.currentActionEntities=[],this.currentActionReservedNames=[],this.userStoragePlaceholder={used:0,max:Ne.p$,exceeded:!1},this.recalculatingUserStorage=!1,this.loadingCounter=1}ngOnInit(){var t=this;return(0,T.Z)(function*(){t.uploadService.setGqlIdHeader(),t.currentFolderPath=t.uploadService.preferences.lastFolderPath,t.uploadActionsService.currentFolderPath=[...t.currentFolderPath],yield Promise.all([t.getUserStorage(),t.getFiles()]),t.setSubscriptions(),yield t.subscribeForChanges(),t.setLoading(!1)})()}setLoading(t){if(t)return++this.loadingCounter,void(this.loading=!0);--this.loadingCounter,this.loadingCounter<=0&&(this.loading=!1)}getUserStorage(t=!1){var i=this;return(0,T.Z)(function*(){t&&i.uploadService.flushUserStorage(),i.userStorage=yield i.uploadService.getUserStorage()})()}recalculateUserStorage(){var t=this;return(0,T.Z)(function*(){t.recalculatingUserStorage=!0,t.userStorage=yield t.uploadService.getUserStorage(!0),t.recalculatingUserStorage=!1,t.toastService.show({content:"Lo spazio occupato \xe8 stato ricalcolato!"})})()}subscribeForChanges(){var t=this;return(0,T.Z)(function*(){t.graphqlChangesSubscriptionDispose=yield t.uploadService.subscribeForChanges(function(){var i=(0,T.Z)(function*(r){const a=(d,h)=>{d&&t.closeActionModal(),h&&t.uploadObservablesService.pushCurrentFolderPath([])};switch(r.type){case Tt.UPLOAD:{const d=t.uploadSubscriptionsService.parseUploadEvent(r.message);d&&t.uploadedFiles(d)}break;case Tt.NEW_DIR:{const d=t.uploadSubscriptionsService.parseCreateFolderEvent(r.message);d&&t.createFolder(d)}break;case Tt.DELETE:{const d=t.uploadSubscriptionsService.parseDeleteEntityEvent(r.message,t.currentFolderPath,t.currentActionEntities);d&&(a(d.entityCompromised,d.pathCompromised),t.removeEntitiesFromList(d.event))}break;case Tt.MOVE:{const d=t.uploadSubscriptionsService.parseMoveEntityEvent(r.message,t.currentFolderPath,t.currentActionEntities);if(!d)break;a(d.entityCompromised,d.pathCompromised);const h={name:d.source.name,type:d.type};d.isRename?t.renameEntityInList({list:[h],destPath:d.target.paths,newEntityData:d.newEntity}):(t.removeEntitiesFromList({destPath:d.source.paths,list:[h]}),t.moveEntitiesInList({list:[h],destPath:d.target.paths,originPath:d.source.paths,results:[{data:d.newEntity,type:h.type}]}))}}});return function(r){return i.apply(this,arguments)}}())})()}setSubscriptions(){var t=this;this.actionSubscription=this.uploadObservablesService.actionObservable.subscribe(i=>{if(i.payload.entities[0]){switch(i.name){case v.In.FILE_SHOW_LINKS:this.currentActionModalRef=this.fileLinksModalComponent.open();break;case v.In.RENAME:this.currentActionReservedNames=i.payload.entities[0].type===v.VC.FILE?this.fileList.map(r=>r.name):this.folderList.map(r=>r.name),this.currentActionModalRef=this.renameModalComponent.open();break;case v.In.MOVE:this.currentActionModalRef=this.fileMoveModalComponent.open();break;case v.In.DELETE:this.currentActionModalRef=this.deleteModalComponent.open();break;case v.In.FILE_EDIT:this.currentActionModalRef=this.fileCropModalComponent.open()}this.currentActionEntities=i.payload.entities}}),this.currentFolderPathSubscription=this.uploadObservablesService.currentFolderPathObservable.subscribe(function(){var i=(0,T.Z)(function*(r){t.setLoading(!0),t.uploadObservablesService.pushSelectedFile([]),t.uploadObservablesService.pushUploadingFileQueue([]),t.closeActionModal(),t.currentFolderPath=r,t.uploadActionsService.currentFolderPath=[...r],yield t.getFiles(),t.setLoading(!1)});return function(r){return i.apply(this,arguments)}}()),this.loginAsSubscription=this.loginAsService.profileObservable.subscribe(function(){var i=(0,T.Z)(function*(r){r||(t.setLoading(!0),t.getUserStorage(),t.uploadObservablesService.pushCurrentFolderPath(t.uploadService.preferences.lastFolderPath),t.setLoading(!1))});return function(r){return i.apply(this,arguments)}}())}closeActionModal(){this.currentActionModalRef&&(this.currentActionModalRef.close(),this.currentActionModalRef=void 0)}getFiles(){var t=this;return(0,T.Z)(function*(){const i=yield t.uploadService.getFileList(t.currentFolderPath);t.fileList=i.files.map(r=>(0,C.Z)({},r)),t.folderList=i.folders.map(r=>(0,C.Z)({},r)),t.sortListByTime()})()}sortListByTime(){this.fileList.sort((t,i)=>t.time>i.time?-1:1)}deleteEndEvent(){var t=this;return(0,T.Z)(function*(){yield t.getUserStorage(!0)})()}removeEntitiesFromList(t){const i=(0,F.rQ)(t.list);for(const[r,a]of Object.entries(i)){if(0===a.length)continue;const d=this.uploadActionsService.removeEntitiesCallback(t.destPath,a.map(h=>h.name),r);if(d.success&&d.payload){const h=r===v.VC.FILE,g=h?this.fileList:this.folderList;for(const y of d.payload.list){const M=g.findIndex(A=>A.name===y);M>-1&&g.splice(M,1)}h?(this.uploadObservablesService.pushDeleteFile(d.payload.list),this.deselectFiles(d.payload.list)):this.folderList=[...g]}}}renameEntityInList(t){const i=t.list[0],r=this.uploadActionsService.renameEntityCallback(t.destPath,i,t.newEntityData);if(!r.payload)return;const a=r.payload.list[0],d=i.type===v.VC.FILE?this.fileList:this.folderList,h=d.findIndex(g=>g.name===i.name);h<0||(d[h]=a,this.uploadObservablesService.pushRenameEntity({oldName:i.name,newEntity:a}),i.type===v.VC.FILE&&this.sortListByTime())}moveEntitiesInList(t){const i=this.uploadActionsService.moveEntitiesCallback(t.results);i.payload&&(i.payload.list.files.length&&this.uploadedFiles({destPath:t.destPath,list:i.payload.list.files,rewrite:!1}),i.payload.list.folders.length&&this.createFolder({destPath:t.destPath,list:i.payload.list.folders,opened:!1}))}fileUploadedEvent(t){var i=this;return(0,T.Z)(function*(){i.uploadedFiles(t),t.list.length&&(yield i.getUserStorage(!0))})()}uploadedFiles(t){let i=[];if(t.rewrite)i=t.list.map(d=>d.name);else{var r;const d=null===(r=this.uploadService.cache.getItem(t.destPath))||void 0===r?void 0:r.files;if(d)for(const h of t.list)d.findIndex(g=>g.name===h.name)>-1&&i.push(h.name)}i.length&&this.removeEntitiesFromList({destPath:t.destPath,list:i.map(d=>({name:d,type:v.VC.FILE}))});const a=this.uploadActionsService.addEntitiesCallback(t.destPath,t.list,v.VC.FILE);a.success&&a.payload&&(this.fileList.unshift(...a.payload.list),this.uploadObservablesService.pushUploadedFile(a.payload.list))}createFolder(t){const i=this.uploadActionsService.addEntitiesCallback(t.destPath,t.list,v.VC.FOLDER);!t.opened&&i.success&&i.payload&&(this.folderList=[...this.folderList,...i.payload.list])}selectAllFiles(){this.uploadObservablesService.pushSelectedFile(this.fileList.map(t=>({name:t.name,selected:!0})))}deselectFiles(t){this.uploadObservablesService.pushSelectedFile(t.map(i=>({name:i,selected:!1})))}ngOnDestroy(){var t,i,r;null===(t=this.actionSubscription)||void 0===t||t.unsubscribe(),null===(i=this.currentFolderPathSubscription)||void 0===i||i.unsubscribe(),null===(r=this.loginAsSubscription)||void 0===r||r.unsubscribe(),this.graphqlChangesSubscriptionDispose&&this.graphqlChangesSubscriptionDispose(),this.uploadService.removeGqlIdHeader(),this.deselectFiles([])}}return(s=n).\u0275fac=function(t){return new(t||s)(e.Y36(te.C),e.Y36(Z.r),e.Y36(Je),e.Y36(Ao),e.Y36(z.k),e.Y36(Bi.D))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],viewQuery:function(t,i){if(1&t&&(e.Gf(fa,5),e.Gf(va,5),e.Gf(Ca,5),e.Gf(xa,5),e.Gf(ba,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.fileLinksModalComponent=r.first),e.iGM(r=e.CRH())&&(i.renameModalComponent=r.first),e.iGM(r=e.CRH())&&(i.deleteModalComponent=r.first),e.iGM(r=e.CRH())&&(i.fileMoveModalComponent=r.first),e.iGM(r=e.CRH())&&(i.fileCropModalComponent=r.first)}},decls:23,vars:29,consts:[[4,"ngIf"],["pageTitle","Gestione file"],[1,"d-grid","upload-header"],[3,"loading","currentFolderPath","disabled","disabledLoading","fileUploadedEvent","openInfoModal"],[1,"min-w-0",3,"fileList","loading"],[1,"d-flex","flex-column"],[1,"d-flex","flex-grow-1",3,"loading","userStorage","recalculatingStorage","openInfoModal","recalculateStorage"],[3,"loading","fileList","filterEvent","selectAllFilesEvent"],[3,"storageToFree",4,"ngIf"],[3,"loading","folderList","currentFolderPath","filter","newFolderEvent"],[3,"loading","fileList","filter"],[3,"entities"],["fileLinksModal",""],[3,"currentFolderPath","entity","reservedNames","renameEvent"],["renameModal",""],[3,"entities","currentFolderPath","deleteStartEvent","deleteEndEvent"],["deleteModal",""],[3,"entities","currentFolderPath","moveEvent","deleteBeforeMovingEvent"],["moveModal",""],[3,"entity"],["cropModal",""],["infoModal",""],[3,"storageToFree"]],template:function(t,i){if(1&t){const r=e.EpF();e.YNc(0,Ta,1,0,"app-login-as-advice",0),e._UZ(1,"app-breadcrumb",1),e.TgZ(2,"div",2)(3,"app-uploader",3),e.NdJ("fileUploadedEvent",function(d){return i.fileUploadedEvent(d)})("openInfoModal",function(){e.CHM(r);const d=e.MAs(22);return e.KtG(d.open())}),e.qZA(),e._UZ(4,"app-upload-recent-files",4),e.TgZ(5,"div",5)(6,"app-upload-used-storage",6),e.NdJ("openInfoModal",function(){e.CHM(r);const d=e.MAs(22);return e.KtG(d.open())})("recalculateStorage",function(){return i.recalculateUserStorage()}),e.qZA(),e.TgZ(7,"app-upload-filter",7),e.NdJ("filterEvent",function(d){return i.currentFilter=d})("selectAllFilesEvent",function(){return i.selectAllFiles()}),e.qZA()()(),e.YNc(8,ya,1,1,"app-upload-no-storage-advice",8),e.TgZ(9,"app-upload-folder-list",9),e.NdJ("newFolderEvent",function(d){return i.createFolder(d)}),e.qZA(),e._UZ(10,"app-upload-file-list",10)(11,"app-upload-file-links-modal",11,12),e.TgZ(13,"app-upload-rename-modal",13,14),e.NdJ("renameEvent",function(d){return i.renameEntityInList(d)}),e.qZA(),e.TgZ(15,"app-upload-delete-modal",15,16),e.NdJ("deleteStartEvent",function(d){return i.removeEntitiesFromList(d)})("deleteEndEvent",function(){return i.deleteEndEvent()}),e.qZA(),e.TgZ(17,"app-upload-move-modal",17,18),e.NdJ("moveEvent",function(d){return i.moveEntitiesInList(d)})("deleteBeforeMovingEvent",function(d){return i.removeEntitiesFromList(d)}),e.qZA(),e._UZ(19,"app-upload-crop-modal",19,20)(21,"app-upload-info-modal",null,21)}2&t&&(e.Q6J("ngIf",i.loginAsService.isActive),e.xp6(3),e.Q6J("loading",i.loading)("currentFolderPath",i.currentFolderPath)("disabled",(null==i.userStorage?null:i.userStorage.exceeded)||!1)("disabledLoading",!i.userStorage),e.xp6(),e.Q6J("fileList",i.fileList)("loading",i.loading),e.xp6(2),e.Q6J("loading",i.loading)("userStorage",i.userStorage||i.userStoragePlaceholder)("recalculatingStorage",i.recalculatingUserStorage),e.xp6(),e.Q6J("loading",i.loading)("fileList",i.fileList),e.xp6(),e.Q6J("ngIf",i.userStorage&&i.userStorage.exceeded),e.xp6(),e.Q6J("loading",i.loading)("folderList",i.folderList)("currentFolderPath",i.currentFolderPath)("filter",i.currentFilter),e.xp6(),e.Q6J("loading",i.loading)("fileList",i.fileList)("filter",i.currentFilter),e.xp6(),e.Q6J("entities",i.currentActionEntities),e.xp6(2),e.Q6J("currentFolderPath",i.currentFolderPath)("entity",i.currentActionEntities[0])("reservedNames",i.currentActionReservedNames),e.xp6(2),e.Q6J("entities",i.currentActionEntities)("currentFolderPath",i.currentFolderPath),e.xp6(2),e.Q6J("entities",i.currentActionEntities)("currentFolderPath",i.currentFolderPath),e.xp6(2),e.Q6J("entity",i.currentActionEntities[0]))},dependencies:[Po.L,f.O5,Vi,Oo.B,qs,yr,Mr.P,xi,st,O,Rr,Jr,ao,ha,wo,_a],styles:["app-upload-recent-files[_ngcontent-%COMP%]{display:none}.upload-header[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem;margin-bottom:1rem}@media (min-width: 500px){.upload-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}}@media (min-width: 768px){.upload-header[_ngcontent-%COMP%]{margin-bottom:2rem}}@media (min-width: 960px){app-upload-recent-files[_ngcontent-%COMP%]{display:block}.upload-header[_ngcontent-%COMP%]{gap:1.5rem}}@media (min-width: 1100px) and (max-width: 1499.98px){.upload-header[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.upload-header[_ngcontent-%COMP%]   app-uploader[_ngcontent-%COMP%]{grid-column:span 2}}@media (min-width: 1500px){.upload-header[_ngcontent-%COMP%]{grid-template-columns:calc(38% - 1rem) calc(28% - 1rem) calc(34% - 1rem)}.upload-header[_ngcontent-%COMP%]   app-uploader[_ngcontent-%COMP%]{grid-column:initial;min-height:250px}}"]}),n})();var wa=_(529),Aa=_(3746);let Pa=(()=>{var s;class n{}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[f.ez]}),n})();var Oa=_(1679);let Sn=(()=>{var s;class n{}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[f.ez]}),n})();var Ni=_(7271);Ni.defaults.touchAction="",Ni.defaults.cssProps.userSelect="",k.b1&&(Ni.defaults.cssProps.userSelect="none");let Ea=(()=>{var s;class n{}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Aa.P,Pa,f.ez,es,ne.C,Tn.mZ,U.XC,ce.Cl,Oa.Y,Ft.forChild(),Sn]}),n})(),Sa=(()=>{var s;class n{}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[_e.b,f.ez,D.u5,Fe.q,Ze.z,U.XC]}),n})();var Ua=_(469),Ia=_(5063);const Da=[{path:"",component:Ma}];let Fa=(()=>{var s;class n{constructor(t){this.timeagoIntl=t,this.timeagoIntl.strings=W,this.timeagoIntl.changes.next()}}return(s=n).\u0275fac=function(t){return new(t||s)(e.LFG(qe))},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[_e.b,b.r,w.w,De.Iq,f.ez,ne.C,D.u5,fe,Ht,he.O,Fe.q,Vi,Ze.z,U._A,U.lQ,U.XC,P.Bz.forChild(Da),Ft.forRoot({intl:{provide:qe},formatter:{provide:Oe,useClass:oi},clock:{provide:se,useClass:Q}}),wa.M,Ea,Sn,Sa,Ia.g,Ua.n]}),n})()},7271:(pt,Te,_)=>{var _e;!function(b,w,De,f){"use strict";var I,ne=["","webkit","Moz","MS","ms","o"],D=w.createElement("div"),e="function",fe=Math.round,he=Math.abs,Fe=Date.now;function Ze(l,c,p){return setTimeout(ye(l,p),c)}function U(l,c,p){return!!Array.isArray(l)&&(P(l,p[c],p),!0)}function P(l,c,p){var u;if(l)if(l.forEach)l.forEach(c,p);else if(l.length!==f)for(u=0;u<l.length;)c.call(p,l[u],u,l),u++;else for(u in l)l.hasOwnProperty(u)&&c.call(p,l[u],u,l)}function W(l,c,p){var u="DEPRECATED METHOD: "+c+"\n"+p+" AT \n";return function(){var m=new Error("get-stack-trace"),x=m&&m.stack?m.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",O=b.console&&(b.console.warn||b.console.log);return O&&O.call(b.console,u,x),l.apply(this,arguments)}}I="function"!=typeof Object.assign?function(c){if(c===f||null===c)throw new TypeError("Cannot convert undefined or null to object");for(var p=Object(c),u=1;u<arguments.length;u++){var m=arguments[u];if(m!==f&&null!==m)for(var x in m)m.hasOwnProperty(x)&&(p[x]=m[x])}return p}:Object.assign;var q=W(function(c,p,u){for(var m=Object.keys(p),x=0;x<m.length;)(!u||u&&c[m[x]]===f)&&(c[m[x]]=p[m[x]]),x++;return c},"extend","Use `assign`."),K=W(function(c,p){return q(c,p,!0)},"merge","Use `assign`.");function J(l,c,p){var m,u=c.prototype;(m=l.prototype=Object.create(u)).constructor=l,m._super=u,p&&I(m,p)}function ye(l,c){return function(){return l.apply(c,arguments)}}function Me(l,c){return typeof l==e?l.apply(c&&c[0]||f,c):l}function ve(l,c){return l===f?c:l}function E(l,c,p){P(Xe(c),function(u){l.addEventListener(u,p,!1)})}function we(l,c,p){P(Xe(c),function(u){l.removeEventListener(u,p,!1)})}function Ot(l,c){for(;l;){if(l==c)return!0;l=l.parentNode}return!1}function Ae(l,c){return l.indexOf(c)>-1}function Xe(l){return l.trim().split(/\s+/g)}function oe(l,c,p){if(l.indexOf&&!p)return l.indexOf(c);for(var u=0;u<l.length;){if(p&&l[u][p]==c||!p&&l[u]===c)return u;u++}return-1}function Ce(l){return Array.prototype.slice.call(l,0)}function Pe(l,c,p){for(var u=[],m=[],x=0;x<l.length;){var O=c?l[x][c]:l[x];oe(m,O)<0&&u.push(l[x]),m[x]=O,x++}return p&&(u=c?u.sort(function(H,B){return H[c]>B[c]}):u.sort()),u}function He(l,c){for(var p,u,m=c[0].toUpperCase()+c.slice(1),x=0;x<ne.length;){if((u=(p=ne[x])?p+m:c)in l)return u;x++}return f}var Et=1;function qe(l){var c=l.ownerDocument||l;return c.defaultView||c.parentWindow||b}var Oe="ontouchstart"in b,It=He(b,"PointerEvent")!==f,oi=Oe&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),se="touch",et="mouse",Ft=25,Q=1,T=4,v=8,F=1,Le=2,Je=4,X=8,Qe=16,Z=Le|Je,$=X|Qe,Zt=Z|$,ke=["x","y"],ue=["clientX","clientY"];function j(l,c){var p=this;this.manager=l,this.callback=c,this.element=l.element,this.target=l.options.inputTarget,this.domHandler=function(u){Me(l.options.enable,[l])&&p.handler(u)},this.init()}function ri(l,c,p){var u=p.pointers.length,m=p.changedPointers.length,x=c&Q&&u-m==0,O=c&(T|v)&&u-m==0;p.isFirst=!!x,p.isFinal=!!O,x&&(l.session={}),p.eventType=c,function ai(l,c){var p=l.session,u=c.pointers,m=u.length;p.firstInput||(p.firstInput=Be(c)),m>1&&!p.firstMultiple?p.firstMultiple=Be(c):1===m&&(p.firstMultiple=!1);var x=p.firstInput,O=p.firstMultiple,R=O?O.center:x.center,H=c.center=Lt(u);c.timeStamp=Fe(),c.deltaTime=c.timeStamp-x.timeStamp,c.angle=ht(R,H),c.distance=Ge(R,H),function li(l,c){var p=c.center,u=l.offsetDelta||{},m=l.prevDelta||{},x=l.prevInput||{};(c.eventType===Q||x.eventType===T)&&(m=l.prevDelta={x:x.deltaX||0,y:x.deltaY||0},u=l.offsetDelta={x:p.x,y:p.y}),c.deltaX=m.x+(p.x-u.x),c.deltaY=m.y+(p.y-u.y)}(p,c),c.offsetDirection=kt(c.deltaX,c.deltaY);var B=Ve(c.deltaTime,c.deltaX,c.deltaY);c.overallVelocityX=B.x,c.overallVelocityY=B.y,c.overallVelocity=he(B.x)>he(B.y)?B.x:B.y,c.scale=O?function it(l,c){return Ge(c[0],c[1],ue)/Ge(l[0],l[1],ue)}(O.pointers,u):1,c.rotation=O?function tt(l,c){return ht(c[1],c[0],ue)+ht(l[1],l[0],ue)}(O.pointers,u):0,c.maxPointers=p.prevInput?c.pointers.length>p.prevInput.maxPointers?c.pointers.length:p.prevInput.maxPointers:c.pointers.length,function ci(l,c){var m,x,O,R,p=l.lastInterval||c,u=c.timeStamp-p.timeStamp;if(c.eventType!=v&&(u>Ft||p.velocity===f)){var H=c.deltaX-p.deltaX,B=c.deltaY-p.deltaY,le=Ve(u,H,B);x=le.x,O=le.y,m=he(le.x)>he(le.y)?le.x:le.y,R=kt(H,B),l.lastInterval=c}else m=p.velocity,x=p.velocityX,O=p.velocityY,R=p.direction;c.velocity=m,c.velocityX=x,c.velocityY=O,c.direction=R}(p,c);var le=l.element;Ot(c.srcEvent.target,le)&&(le=c.srcEvent.target),c.target=le}(l,p),l.emit("hammer.input",p),l.recognize(p),l.session.prevInput=p}function Be(l){for(var c=[],p=0;p<l.pointers.length;)c[p]={clientX:fe(l.pointers[p].clientX),clientY:fe(l.pointers[p].clientY)},p++;return{timeStamp:Fe(),pointers:c,center:Lt(c),deltaX:l.deltaX,deltaY:l.deltaY}}function Lt(l){var c=l.length;if(1===c)return{x:fe(l[0].clientX),y:fe(l[0].clientY)};for(var p=0,u=0,m=0;m<c;)p+=l[m].clientX,u+=l[m].clientY,m++;return{x:fe(p/c),y:fe(u/c)}}function Ve(l,c,p){return{x:c/l||0,y:p/l||0}}function kt(l,c){return l===c?F:he(l)>=he(c)?l<0?Le:Je:c<0?X:Qe}function Ge(l,c,p){p||(p=ke);var u=c[p[0]]-l[p[0]],m=c[p[1]]-l[p[1]];return Math.sqrt(u*u+m*m)}function ht(l,c,p){return p||(p=ke),180*Math.atan2(c[p[1]]-l[p[1]],c[p[0]]-l[p[0]])/Math.PI}j.prototype={handler:function(){},init:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(qe(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&we(this.element,this.evEl,this.domHandler),this.evTarget&&we(this.target,this.evTarget,this.domHandler),this.evWin&&we(qe(this.element),this.evWin,this.domHandler)}};var di={mousedown:Q,mousemove:2,mouseup:T},G="mousedown",pi="mousemove mouseup";function Ye(){this.evEl=G,this.evWin=pi,this.pressed=!1,j.apply(this,arguments)}J(Ye,j,{handler:function(c){var p=di[c.type];p&Q&&0===c.button&&(this.pressed=!0),2&p&&1!==c.which&&(p=T),this.pressed&&(p&T&&(this.pressed=!1),this.callback(this.manager,p,{pointers:[c],changedPointers:[c],pointerType:et,srcEvent:c}))}});var hi={pointerdown:Q,pointermove:2,pointerup:T,pointercancel:v,pointerout:v},ui={2:se,3:"pen",4:et,5:"kinect"},Rt="pointerdown",Nt="pointermove pointerup pointercancel";function ut(){this.evEl=Rt,this.evWin=Nt,j.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}b.MSPointerEvent&&!b.PointerEvent&&(Rt="MSPointerDown",Nt="MSPointerMove MSPointerUp MSPointerCancel"),J(ut,j,{handler:function(c){var p=this.store,u=!1,m=c.type.toLowerCase().replace("ms",""),x=hi[m],O=ui[c.pointerType]||c.pointerType,R=O==se,H=oe(p,c.pointerId,"pointerId");x&Q&&(0===c.button||R)?H<0&&(p.push(c),H=p.length-1):x&(T|v)&&(u=!0),!(H<0)&&(p[H]=c,this.callback(this.manager,x,{pointers:p,changedPointers:[c],pointerType:O,srcEvent:c}),u&&p.splice(H,1))}});var gi={touchstart:Q,touchmove:2,touchend:T,touchcancel:v};function zt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,j.apply(this,arguments)}function Ht(l,c){var p=Ce(l.touches),u=Ce(l.changedTouches);return c&(T|v)&&(p=Pe(p.concat(u),"identifier",!0)),[p,u]}J(zt,j,{handler:function(c){var p=gi[c.type];if(p===Q&&(this.started=!0),this.started){var u=Ht.call(this,c,p);p&(T|v)&&u[0].length-u[1].length==0&&(this.started=!1),this.callback(this.manager,p,{pointers:u[0],changedPointers:u[1],pointerType:se,srcEvent:c})}}});var Qi={touchstart:Q,touchmove:2,touchend:T,touchcancel:v},qt="touchstart touchmove touchend touchcancel";function re(){this.evTarget=qt,this.targetIds={},j.apply(this,arguments)}function We(l,c){var p=Ce(l.touches),u=this.targetIds;if(c&(2|Q)&&1===p.length)return u[p[0].identifier]=!0,[p,p];var m,x,O=Ce(l.changedTouches),R=[],H=this.target;if(x=p.filter(function(B){return Ot(B.target,H)}),c===Q)for(m=0;m<x.length;)u[x[m].identifier]=!0,m++;for(m=0;m<O.length;)u[O[m].identifier]&&R.push(O[m]),c&(T|v)&&delete u[O[m].identifier],m++;return R.length?[Pe(x.concat(R),"identifier",!0),R]:void 0}J(re,j,{handler:function(c){var p=Qi[c.type],u=We.call(this,c,p);u&&this.callback(this.manager,p,{pointers:u[0],changedPointers:u[1],pointerType:se,srcEvent:c})}});var Re=2500;function gt(){j.apply(this,arguments);var l=ye(this.handler,this);this.touch=new re(this.manager,l),this.mouse=new Ye(this.manager,l),this.primaryTouch=null,this.lastTouches=[]}function fi(l,c){l&Q?(this.primaryTouch=c.changedPointers[0].identifier,Qt.call(this,c)):l&(T|v)&&Qt.call(this,c)}function Qt(l){var c=l.changedPointers[0];if(c.identifier===this.primaryTouch){var p={x:c.clientX,y:c.clientY};this.lastTouches.push(p);var u=this.lastTouches;setTimeout(function(){var x=u.indexOf(p);x>-1&&u.splice(x,1)},Re)}}function vi(l){for(var c=l.srcEvent.clientX,p=l.srcEvent.clientY,u=0;u<this.lastTouches.length;u++){var m=this.lastTouches[u],x=Math.abs(c-m.x),O=Math.abs(p-m.y);if(x<=25&&O<=25)return!0}return!1}J(gt,j,{handler:function(c,p,u){var x=u.pointerType==et;if(!(x&&u.sourceCapabilities&&u.sourceCapabilities.firesTouchEvents)){if(u.pointerType==se)fi.call(this,p,u);else if(x&&vi.call(this,u))return;this.callback(c,p,u)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ee=He(D.style,"touchAction"),Bt=ee!==f,Vt="compute",_t="manipulation",Ee="none",Ke="pan-x",$e="pan-y",nt=function xi(){if(!Bt)return!1;var l={},c=b.CSS&&b.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(p){l[p]=!c||b.CSS.supports("touch-action",p)}),l}();function ft(l,c){this.manager=l,this.set(c)}ft.prototype={set:function(l){l==Vt&&(l=this.compute()),Bt&&this.manager.element.style&&nt[l]&&(this.manager.element.style[ee]=l),this.actions=l.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var l=[];return P(this.manager.recognizers,function(c){Me(c.options.enable,[c])&&(l=l.concat(c.getTouchAction()))}),function Ci(l){if(Ae(l,Ee))return Ee;var c=Ae(l,Ke),p=Ae(l,$e);return c&&p?Ee:c||p?c?Ke:$e:Ae(l,_t)?_t:"auto"}(l.join(" "))},preventDefaults:function(l){var c=l.srcEvent,p=l.offsetDirection;if(!this.manager.session.prevented){var u=this.actions,m=Ae(u,Ee)&&!nt[Ee],x=Ae(u,$e)&&!nt[$e],O=Ae(u,Ke)&&!nt[Ke];if(m&&1===l.pointers.length&&l.distance<2&&l.deltaTime<250)return;return O&&x||!(m||x&&p&Z||O&&p&$)?void 0:this.preventSrc(c)}c.preventDefault()},preventSrc:function(l){this.manager.session.prevented=!0,l.preventDefault()}};var Se=1;function me(l){this.options=I({},this.defaults,l||{}),this.id=function St(){return Et++}(),this.manager=null,this.options.enable=ve(this.options.enable,!0),this.state=Se,this.simultaneous={},this.requireFail=[]}function Gt(l){return 16&l?"cancel":8&l?"end":4&l?"move":2&l?"start":""}function Yt(l){return l==Qe?"down":l==X?"up":l==Le?"left":l==Je?"right":""}function ot(l,c){var p=c.manager;return p?p.get(l):l}function ie(){me.apply(this,arguments)}function st(){ie.apply(this,arguments),this.pX=null,this.pY=null}function k(){ie.apply(this,arguments)}function vt(){me.apply(this,arguments),this._timer=null,this._input=null}function rt(){ie.apply(this,arguments)}function Ct(){ie.apply(this,arguments)}function at(){me.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ue(l,c){return(c=c||{}).recognizers=ve(c.recognizers,Ue.defaults.preset),new bt(l,c)}function bt(l,c){this.options=I({},Ue.defaults,c||{}),this.options.inputTarget=this.options.inputTarget||l,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=l,this.input=function si(l){return new(l.options.inputClass||(It?ut:oi?re:Oe?gt:Ye))(l,ri)}(this),this.touchAction=new ft(this,this.options.touchAction),Wt(this,!0),P(this.options.recognizers,function(p){var u=this.add(new p[0](p[1]));p[2]&&u.recognizeWith(p[2]),p[3]&&u.requireFailure(p[3])},this)}function Wt(l,c){var u,p=l.element;p.style&&(P(l.options.cssProps,function(m,x){u=He(p.style,x),c?(l.oldCssProps[u]=p.style[u],p.style[u]=m):p.style[u]=l.oldCssProps[u]||""}),c||(l.oldCssProps={}))}me.prototype={defaults:{},set:function(l){return I(this.options,l),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(l){if(U(l,"recognizeWith",this))return this;var c=this.simultaneous;return c[(l=ot(l,this)).id]||(c[l.id]=l,l.recognizeWith(this)),this},dropRecognizeWith:function(l){return U(l,"dropRecognizeWith",this)||(l=ot(l,this),delete this.simultaneous[l.id]),this},requireFailure:function(l){if(U(l,"requireFailure",this))return this;var c=this.requireFail;return-1===oe(c,l=ot(l,this))&&(c.push(l),l.requireFailure(this)),this},dropRequireFailure:function(l){if(U(l,"dropRequireFailure",this))return this;l=ot(l,this);var c=oe(this.requireFail,l);return c>-1&&this.requireFail.splice(c,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(l){return!!this.simultaneous[l.id]},emit:function(l){var c=this,p=this.state;function u(m){c.manager.emit(m,l)}p<8&&u(c.options.event+Gt(p)),u(c.options.event),l.additionalEvent&&u(l.additionalEvent),p>=8&&u(c.options.event+Gt(p))},tryEmit:function(l){if(this.canEmit())return this.emit(l);this.state=32},canEmit:function(){for(var l=0;l<this.requireFail.length;){if(!(this.requireFail[l].state&(32|Se)))return!1;l++}return!0},recognize:function(l){var c=I({},l);if(!Me(this.options.enable,[this,c]))return this.reset(),void(this.state=32);56&this.state&&(this.state=Se),this.state=this.process(c),30&this.state&&this.tryEmit(c)},process:function(l){},getTouchAction:function(){},reset:function(){}},J(ie,me,{defaults:{pointers:1},attrTest:function(l){var c=this.options.pointers;return 0===c||l.pointers.length===c},process:function(l){var c=this.state,p=l.eventType,u=6&c,m=this.attrTest(l);return u&&(p&v||!m)?16|c:u||m?p&T?8|c:2&c?4|c:2:32}}),J(st,ie,{defaults:{event:"pan",threshold:10,pointers:1,direction:Zt},getTouchAction:function(){var l=this.options.direction,c=[];return l&Z&&c.push($e),l&$&&c.push(Ke),c},directionTest:function(l){var c=this.options,p=!0,u=l.distance,m=l.direction,x=l.deltaX,O=l.deltaY;return m&c.direction||(c.direction&Z?(m=0===x?F:x<0?Le:Je,p=x!=this.pX,u=Math.abs(l.deltaX)):(m=0===O?F:O<0?X:Qe,p=O!=this.pY,u=Math.abs(l.deltaY))),l.direction=m,p&&u>c.threshold&&m&c.direction},attrTest:function(l){return ie.prototype.attrTest.call(this,l)&&(2&this.state||!(2&this.state)&&this.directionTest(l))},emit:function(l){this.pX=l.deltaX,this.pY=l.deltaY;var c=Yt(l.direction);c&&(l.additionalEvent=this.options.event+c),this._super.emit.call(this,l)}}),J(k,ie,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ee]},attrTest:function(l){return this._super.attrTest.call(this,l)&&(Math.abs(l.scale-1)>this.options.threshold||2&this.state)},emit:function(l){1!==l.scale&&(l.additionalEvent=this.options.event+(l.scale<1?"in":"out")),this._super.emit.call(this,l)}}),J(vt,me,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(l){var c=this.options,p=l.pointers.length===c.pointers,u=l.distance<c.threshold,m=l.deltaTime>c.time;if(this._input=l,!u||!p||l.eventType&(T|v)&&!m)this.reset();else if(l.eventType&Q)this.reset(),this._timer=Ze(function(){this.state=8,this.tryEmit()},c.time,this);else if(l.eventType&T)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(l){8===this.state&&(l&&l.eventType&T?this.manager.emit(this.options.event+"up",l):(this._input.timeStamp=Fe(),this.manager.emit(this.options.event,this._input)))}}),J(rt,ie,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ee]},attrTest:function(l){return this._super.attrTest.call(this,l)&&(Math.abs(l.rotation)>this.options.threshold||2&this.state)}}),J(Ct,ie,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Z|$,pointers:1},getTouchAction:function(){return st.prototype.getTouchAction.call(this)},attrTest:function(l){var p,c=this.options.direction;return c&(Z|$)?p=l.overallVelocity:c&Z?p=l.overallVelocityX:c&$&&(p=l.overallVelocityY),this._super.attrTest.call(this,l)&&c&l.offsetDirection&&l.distance>this.options.threshold&&l.maxPointers==this.options.pointers&&he(p)>this.options.velocity&&l.eventType&T},emit:function(l){var c=Yt(l.offsetDirection);c&&this.manager.emit(this.options.event+c,l),this.manager.emit(this.options.event,l)}}),J(at,me,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[_t]},process:function(l){var c=this.options,p=l.pointers.length===c.pointers,u=l.distance<c.threshold,m=l.deltaTime<c.time;if(this.reset(),l.eventType&Q&&0===this.count)return this.failTimeout();if(u&&m&&p){if(l.eventType!=T)return this.failTimeout();var x=!this.pTime||l.timeStamp-this.pTime<c.interval,O=!this.pCenter||Ge(this.pCenter,l.center)<c.posThreshold;if(this.pTime=l.timeStamp,this.pCenter=l.center,O&&x?this.count+=1:this.count=1,this._input=l,0==this.count%c.taps)return this.hasRequireFailures()?(this._timer=Ze(function(){this.state=8,this.tryEmit()},c.interval,this),2):8}return 32},failTimeout:function(){return this._timer=Ze(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ue.VERSION="2.0.7",Ue.defaults={domEvents:!1,touchAction:Vt,enable:!0,inputTarget:null,inputClass:null,preset:[[rt,{enable:!1}],[k,{enable:!1},["rotate"]],[Ct,{direction:Z}],[st,{direction:Z},["swipe"]],[at],[at,{event:"doubletap",taps:2},["tap"]],[vt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},bt.prototype={set:function(l){return I(this.options,l),l.touchAction&&this.touchAction.update(),l.inputTarget&&(this.input.destroy(),this.input.target=l.inputTarget,this.input.init()),this},stop:function(l){this.session.stopped=l?2:1},recognize:function(l){var c=this.session;if(!c.stopped){this.touchAction.preventDefaults(l);var p,u=this.recognizers,m=c.curRecognizer;(!m||m&&8&m.state)&&(m=c.curRecognizer=null);for(var x=0;x<u.length;)p=u[x],2===c.stopped||m&&p!=m&&!p.canRecognizeWith(m)?p.reset():p.recognize(l),!m&&14&p.state&&(m=c.curRecognizer=p),x++}},get:function(l){if(l instanceof me)return l;for(var c=this.recognizers,p=0;p<c.length;p++)if(c[p].options.event==l)return c[p];return null},add:function(l){if(U(l,"add",this))return this;var c=this.get(l.options.event);return c&&this.remove(c),this.recognizers.push(l),l.manager=this,this.touchAction.update(),l},remove:function(l){if(U(l,"remove",this))return this;if(l=this.get(l)){var c=this.recognizers,p=oe(c,l);-1!==p&&(c.splice(p,1),this.touchAction.update())}return this},on:function(l,c){if(l!==f&&c!==f){var p=this.handlers;return P(Xe(l),function(u){p[u]=p[u]||[],p[u].push(c)}),this}},off:function(l,c){if(l!==f){var p=this.handlers;return P(Xe(l),function(u){c?p[u]&&p[u].splice(oe(p[u],c),1):delete p[u]}),this}},emit:function(l,c){this.options.domEvents&&function Ti(l,c){var p=w.createEvent("Event");p.initEvent(l,!0,!0),p.gesture=c,c.target.dispatchEvent(p)}(l,c);var p=this.handlers[l]&&this.handlers[l].slice();if(p&&p.length){c.type=l,c.preventDefault=function(){c.srcEvent.preventDefault()};for(var u=0;u<p.length;)p[u](c),u++}},destroy:function(){this.element&&Wt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},I(Ue,{INPUT_START:Q,INPUT_MOVE:2,INPUT_END:T,INPUT_CANCEL:v,STATE_POSSIBLE:Se,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:F,DIRECTION_LEFT:Le,DIRECTION_RIGHT:Je,DIRECTION_UP:X,DIRECTION_DOWN:Qe,DIRECTION_HORIZONTAL:Z,DIRECTION_VERTICAL:$,DIRECTION_ALL:Zt,Manager:bt,Input:j,TouchAction:ft,TouchInput:re,MouseInput:Ye,PointerEventInput:ut,TouchMouseInput:gt,SingleTouchInput:zt,Recognizer:me,AttrRecognizer:ie,Tap:at,Pan:st,Swipe:Ct,Pinch:k,Rotate:rt,Press:vt,on:E,off:we,each:P,merge:K,extend:q,assign:I,inherit:J,bindFn:ye,prefixed:He}),(typeof b<"u"?b:typeof self<"u"?self:{}).Hammer=Ue,(_e=function(){return Ue}.call(Te,_,Te,pt))!==f&&(pt.exports=_e)}(window,document)}}]);