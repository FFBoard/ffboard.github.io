(self.webpackChunkboard=self.webpackChunkboard||[]).push([[969],{9969:(N,j,i)=>{"use strict";i.d(j,{R:()=>p});class p{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(e){Object.keys(e).filter(O=>O in this).forEach(O=>this[O]=e[O]),this.validateOptions()}setOptionsFromChanges(e){Object.keys(e).filter(O=>O in this).forEach(O=>this[O]=e[O].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}},2020:(N,j,i)=>{"use strict";i.d(j,{y:()=>a});var p=i(5861);var w=i(4650);let a=(()=>{class b{constructor(){this.autoRotateSupported=function e(){return new Promise(b=>{const I=new Image;I.onload=()=>{b(1===I.width&&2===I.height)},I.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(o,E){return new Promise((s,y)=>{const c=new FileReader;c.onload=d=>{this.loadImage(d.target.result,o.type,E).then(s).catch(y)},c.readAsDataURL(o)})}loadImage(o,E,s){return this.isValidImageType(E)?this.loadBase64Image(o,s):Promise.reject(new Error("Invalid image type"))}isValidImageType(o){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(o)}loadImageFromURL(o,E){return new Promise((s,y)=>{const c=new Image;c.onerror=()=>y,c.onload=()=>{const d=document.createElement("canvas"),C=d.getContext("2d");d.width=c.width,d.height=c.height,C?.drawImage(c,0,0),this.loadBase64Image(d.toDataURL(),E).then(s)},c.crossOrigin="anonymous",c.src=o})}loadBase64Image(o,E){return new Promise((s,y)=>{const c=new Image;c.onload=()=>s({originalImage:c,originalBase64:o}),c.onerror=y,c.src=o}).then(s=>this.transformImageBase64(s,E))}transformImageBase64(o,E){var s=this;return(0,p.Z)(function*(){const y=yield s.autoRotateSupported,c=yield function O(b){switch("string"==typeof b&&(b=function T(b){const I=new DataView(function l(b){b=b.replace(/^data\:([^\;]+)\;base64,/gim,"");const I=atob(b),o=I.length,E=new Uint8Array(o);for(let s=0;s<o;s++)E[s]=I.charCodeAt(s);return E.buffer}(b));if(65496!==I.getUint16(0,!1))return-2;const o=I.byteLength;let E=2;for(;E<o;){if(I.getUint16(E+2,!1)<=8)return-1;const s=I.getUint16(E,!1);if(E+=2,65505==s){if(1165519206!==I.getUint32(E+=2,!1))return-1;const y=18761==I.getUint16(E+=6,!1);E+=I.getUint32(E+4,y);const c=I.getUint16(E,y);E+=2;for(let d=0;d<c;d++)if(274==I.getUint16(E+12*d,y))return I.getUint16(E+12*d+8,y)}else{if(65280!=(65280&s))break;E+=I.getUint16(E,!1)}}return-1}(b)),b){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(y?-1:o.originalBase64);return o.originalImage&&o.originalImage.complete?s.transformLoadedImage({original:{base64:o.originalBase64,image:o.originalImage,size:{width:o.originalImage.naturalWidth,height:o.originalImage.naturalHeight}},exifTransform:c},E):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(o,E){var s=this;return(0,p.Z)(function*(){const y=E.canvasRotation+o.exifTransform.rotate,c={width:o.original.image.naturalWidth,height:o.original.image.naturalHeight};if(0===y&&!o.exifTransform.flip&&!E.containWithinAspectRatio)return{original:{base64:o.original.base64,image:o.original.image,size:{...c}},transformed:{base64:o.original.base64,image:o.original.image,size:{...c}},exifTransform:o.exifTransform};const d=s.getTransformedSize(c,o.exifTransform,E),C=document.createElement("canvas");C.width=d.width,C.height=d.height;const D=C.getContext("2d");D?.setTransform(o.exifTransform.flip?-1:1,0,0,1,C.width/2,C.height/2),D?.rotate(Math.PI*(y/2)),D?.drawImage(o.original.image,-c.width/2,-c.height/2);const f=C.toDataURL(),h=yield s.loadImageFromBase64(f);return{original:{base64:o.original.base64,image:o.original.image,size:{...c}},transformed:{base64:f,image:h,size:{width:h.width,height:h.height}},exifTransform:o.exifTransform}})()}loadImageFromBase64(o){return new Promise((E,s)=>{const y=new Image;y.onload=()=>E(y),y.onerror=s,y.src=o})}getTransformedSize(o,E,s){const y=s.canvasRotation+E.rotate;if(s.containWithinAspectRatio){if(y%2){const d=o.height/s.aspectRatio;return{width:Math.max(o.height,o.width*s.aspectRatio),height:Math.max(o.width,d)}}{const d=o.width/s.aspectRatio;return{width:Math.max(o.width,o.height*s.aspectRatio),height:Math.max(o.height,d)}}}return y%2?{height:o.width,width:o.height}:{width:o.width,height:o.height}}}return b.\u0275fac=function(o){return new(o||b)},b.\u0275prov=w.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})()},8896:(N,j,i)=>{"use strict";function p(M){const e=M.split(","),O=e[0].replace("data:","").replace(";base64",""),T=atob(e[1]),l=new ArrayBuffer(T.length),w=new Uint8Array(l);for(let a=0;a<T.length;a+=1)w[a]=T.charCodeAt(a);return new Blob([l],{type:O})}i.d(j,{L:()=>p})},575:(N,j,i)=>{"use strict";i.d(j,{In:()=>p,Ky:()=>T,VC:()=>M,c5:()=>O,gG:()=>e});var p=(()=>{return(l=p||(p={})).FILE_SHOW_LINKS="fileLinks",l.FILE_EDIT="fileEdit",l.DELETE="delete",l.RENAME="rename",l.MOVE="move",p;var l})(),M=(()=>{return(l=M||(M={})).FILE="file",l.FOLDER="folder",M;var l})(),e=(()=>{return(l=e||(e={})).FILENAME="filename",l.SIZE="size",l.TIME="time",l.EXTENSION="ext",e;var l})(),O=(()=>{return(l=O||(O={})).GRID="grid",l.LIST="list",O;var l})(),T=(()=>{return(l=T||(T={})).W_768_I_1="(max-width: 767.98px)",l.W_933_I_2="(min-width: 768px) and (max-width: 933.98px)",l.W_960_I_3="(min-width: 934px) and (max-width: 959.98px)",l.W_1226_I_2="(min-width: 960px) and (max-width: 1225.98px)",l.W_1540_I_3="(min-width: 1226px) and (max-width: 1539.98px)",l.W_1854_I_4="(min-width: 1540px) and (max-width: 1853.98px)",l.W_2168_I_5="(min-width: 1854px) and (max-width: 2167.98px)",l.W_2482_I_6="(min-width: 2168px) and (max-width: 2481.98px)",l.W_2796_I_7="(min-width: 2482px) and (max-width: 2795.98px)",l.W_3110_I_8="(min-width: 2796px) and (max-width: 3109.98px)",l.W_3424_I_9="(min-width: 3110px) and (max-width: 3423.98px)",l.W_3738_I_10="(min-width: 3424px)",T;var l})()},6986:(N,j,i)=>{"use strict";i.d(j,{C7:()=>O,Mi:()=>T,O8:()=>M,er:()=>l,p0:()=>e,xt:()=>w});var p=i(575);const M=[{ext:["png","apng"],maxSize:15},{ext:["jpeg","jpg","jpe"],maxSize:10},{ext:["gif"],maxSize:15},{ext:["bmp"],maxSize:10},{ext:["webp","webm"],maxSize:10},{ext:["psd","xcf"],maxSize:150},{ext:["svg"],maxSize:30}].map(a=>(a.maxSize*=1048576,a)),e={lastPath:[],layout:{asc:!0,orderBy:p.gG.FILENAME,type:p.c5.GRID},uploader:{checkImage:{time:0,active:!0},showLinkModal:!1}},O="https://upload.forumfree.net/api/",T=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-.\s])*$/,l=/^(?:(?![\t\r\n])[a-zA-Z0-9_\-\s])*$/,w={invalidLength:!1,alreadyUsed:!1,invalidStartOrEnd:!1,invalidCharacter:!1}},8375:(N,j,i)=>{"use strict";i.d(j,{B:()=>q});var p=i(5861),M=i(1309),e=i(4650),O=i(4968),T=i(3905),l=i(3848),w=i(6986),a=i(575),b=i(7320),I=i(146),o=i(3612),E=i(6378),s=i(6895),y=i(433),c=i(4029),d=i(8279),C=i(3450);const D=["fileInput"];function f(L,u){1&L&&(e.O4$(),e.TgZ(0,"svg",24),e._UZ(1,"path",25)(2,"path",26),e.qZA())}const h=function(){return["text-primary"]};function x(L,u){1&L&&e._UZ(0,"app-logo",27),2&L&&e.Q6J("svgClass",e.DdM(2,h))("responsive",!1)}const Q=function(){return{bottom:0,left:0}};function g(L,u){if(1&L){const t=e.EpF();e.TgZ(0,"a",28),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.openInfoModal.emit())}),e._uU(1,"Informazioni"),e.qZA()}2&L&&e.Q6J("ngStyle",e.DdM(1,Q))}function m(L,u){if(1&L){const t=e.EpF();e.TgZ(0,"div",29),e.NdJ("click",function(){e.CHM(t),e.oxw(2);const n=e.MAs(7);return e.KtG(n.open())}),e._uU(1,"settings"),e.qZA()}}const U=function(L,u){return{"cursor-pointer":L,"pb-3":u}},_=function(L){return{"fw-bold fs-lg":L}},k=function(L){return{"my-2":L}};function H(L,u){if(1&L){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",15,16),e.NdJ("dragenter",function(){e.CHM(t);const n=e.MAs(2),v=e.oxw();return e.KtG(v.setDragOverEvent(n))})("drop",function(n){e.CHM(t);const v=e.oxw();return e.KtG(v.handleDropEvent(n))})("click",function(){e.CHM(t),e.oxw();const n=e.MAs(2);return e.KtG(n.click())}),e.YNc(3,f,3,0,"svg",17),e.YNc(4,x,1,3,"ng-template",null,18,e.W1O),e._UZ(6,"div",19),e.TgZ(7,"div",20),e._uU(8,"I file verranno caricati nella cartella "),e._UZ(9,"em",21),e.qZA()(),e.YNc(10,g,2,2,"a",22),e.YNc(11,m,2,0,"div",23),e.BQk()}if(2&L){const t=e.MAs(5),r=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(9,U,!r.loading,r.isWidget)),e.xp6(2),e.Q6J("ngIf",!r.isWidget)("ngIfElse",t),e.xp6(3),e.Q6J("ngClass",e.VKq(12,_,!r.isWidget))("innerText","Trascina i file da caricare oppure clicca per scegliere da memoria"),e.xp6(1),e.Q6J("ngClass",e.VKq(14,k,!r.isWidget)),e.xp6(2),e.Q6J("innerText",r.currentFolderPath.length?r.currentFolderPath.join("/"):"root"),e.xp6(1),e.Q6J("ngIf",!r.isWidget),e.xp6(1),e.Q6J("ngIf",!r.isWidget)}}function Z(L,u){if(1&L&&(e.TgZ(0,"div",30),e.O4$(),e.TgZ(1,"svg",31),e._UZ(2,"path",32),e.qZA(),e.kcU(),e._UZ(3,"app-loader",33),e.TgZ(4,"div",34),e._uU(5,"Attendi il completamento dell'upload per caricare altre immagini."),e.qZA()()),2&L){const t=e.oxw();e.xp6(3),e.Q6J("onlyMessage",!0)("message",t.loadingMessage)}}const V=function(L,u){return{uploading:L,widget:u}};let q=(()=>{class L{constructor(t,r,n,v,A,R){this.uploadService=t,this.uploadObservablesService=r,this.uploaderService=n,this.toastService=v,this.renderer=A,this.ngZone=R,this.loading=!0,this.currentFolderPath=[],this.isWidget=!1,this.fileUploadedEvent=new e.vpe,this.openInfoModal=new e.vpe,this.isUploading=!1,this.loadingMessage="Controllo dei file in corso",this.dragOverEvent=!1,this.options=this.uploaderService.uploaderOptions;const B=this.uploadService.preferences.uploader;B.checkImage.active||(this.options.compress=!1),B.showLinkModal&&(this.options.openLinkModalAfterUpload=!0)}ngOnInit(){this.handleClipboardPasteEvent(),this.handleExternalUpload()}handleClipboardPasteEvent(){var t=this;this.clipboardPasteEventSubscription=(0,O.R)(document.body,"paste").subscribe(function(){var r=(0,p.Z)(function*(n){if(!t.canUpload)return;const v=Array.from((n.clipboardData||n.originalEvent.clipboardData).items);let A=[];for(const R of v)if(0===R.type.indexOf("image")){const B=R.getAsFile();B&&A.push(B)}A.length>0?yield t.preUpload(A):t.reset()});return function(n){return r.apply(this,arguments)}}())}handleExternalUpload(){var t=this;this.startExternalUploadSubscription=this.uploadObservablesService.startUploadObservable.subscribe(function(){var r=(0,p.Z)(function*(n){if(n)return t.canUpload?void(yield t.preUpload([n.file],n.options)):void t.reset();t.fileInputRef.nativeElement.click()});return function(n){return r.apply(this,arguments)}}())}handleSelectionEvent(t){var r=this;return(0,p.Z)(function*(){if(!r.canUpload)return;const n=t.target;if(n.files&&n.files.length){const v=Array.from(n.files);return n.value="",r.preUpload(v)}r.reset()})()}handleDropEvent(t){var r=this;return(0,p.Z)(function*(){if(!r.canUpload)return;t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();const n=t.dataTransfer?.files?Array.from(t.dataTransfer.files):[];if(n.length)return r.preUpload(n);r.reset()})()}saveOptions(){this.uploaderService.uploaderOptions=this.options,this.savePreferences()}savePreferences(){this.uploadService.preferences.uploader={checkImage:{active:this.options.compress,time:Date.now()},showLinkModal:this.options.openLinkModalAfterUpload}}setDragOverEvent(t){this.dragOverEvent||(this.dragOverEvent=!0,this.ngZone.runOutsideAngular(()=>{this.renderer.listen(t,"dragover",r=>{r.preventDefault()})}))}get canUpload(){return!this.loading&&!this.isUploading&&(this.isUploading=!0,!0)}reset(){this.isUploading=!1,this.loadingMessage="Controllo dei file da caricare",this.options.allowOverwrite=!1}preUpload(t,r){var n=this;return(0,p.Z)(function*(){const v=[...n.currentFolderPath];let A=[],R=[],B=[],F=[];r?r.allowOverwrite=r.allowOverwrite||!1:(r=n.options).allowOverwrite=!1;for(let S=0;S<t.length;S++){let z=r.compress?yield n.uploaderService.compressFileIfNeeded(t[S],r.imageDimensions):t[S];if(z=yield n.uploaderService.orientFileIfNeeded(z),z){const $=(0,l.Tb)(z.name),P=w.O8.find(X=>-1!==X.ext.indexOf($.ext));if(!P){B.push(z);continue}if(z.size>P.maxSize){F.push(z);continue}A.push({file:{name:z.name,size:z.size,time:0,url:"",ext:$.ext,filename:$.filename,isImage:(0,l.Or)($.ext),embedUrl:""},progress:0,completed:!1}),R.push(z)}}if((B.length||F.length)&&n.toastService.show({content:n.createToastMessage(B,F),level:M.m.ERROR}),0===R.length)return void n.reset();const W=`Caricamento file {{fileNumber}} di ${R.length} in corso`;n.uploadObservablesService.pushUploadingFileQueue(A);for(let S=0;S<R.length;++S){n.loadingMessage="Creazione del pacchetto da inviare";const z=yield n.uploadService.getHostToken(v,R[S].name);A[S].progress+=20,n.loadingMessage=W.replace("{{fileNumber}}",`${S+1}`),yield(0,T.z)(n.uploaderService.upload(R[S],A[S],z,r.allowOverwrite))}n.uploadObservablesService.pushUploadingFileQueue([]);const K=A.filter(S=>!S.error).map(S=>S.file);K.length>0&&(n.fileUploadedEvent.emit({fileList:K,rewrite:r.allowOverwrite,paths:v}),r.openLinkModalAfterUpload&&n.uploadObservablesService.pushAction({name:a.In.FILE_SHOW_LINKS,payload:{entities:(0,l.jL)(K)}})),n.reset()})()}createToastMessage(t,r){let n=[];return t.length&&n.push(t.length>1?`I file <strong>${t.map(v=>v.name).join(", ")}</strong> hanno un formato non supportato!`:`Il file <strong>${t[0].name}</strong> ha un formato non supportato!`),r.length&&n.push(r.length>1?`I file <strong>${r.map(v=>v.name).join(", ")}</strong> sono troppo pesanti!`:`Il file <strong>${r[0].name}</strong> \xe8 troppo pesante!`),n.join("<br><br>")}ngOnDestroy(){this.startExternalUploadSubscription?.unsubscribe(),this.clipboardPasteEventSubscription.unsubscribe(),this.uploaderService.clearPendingRequests()}}return L.\u0275fac=function(t){return new(t||L)(e.Y36(b.C),e.Y36(I.r),e.Y36(o.q),e.Y36(E.k),e.Y36(e.Qsj),e.Y36(e.R0b))},L.\u0275cmp=e.Xpm({type:L,selectors:[["app-uploader"]],viewQuery:function(t,r){if(1&t&&e.Gf(D,5),2&t){let n;e.iGM(n=e.CRH())&&(r.fileInputRef=n.first)}},inputs:{loading:"loading",currentFolderPath:"currentFolderPath",isWidget:"isWidget"},outputs:{fileUploadedEvent:"fileUploadedEvent",openInfoModal:"openInfoModal"},decls:30,vars:10,consts:[[1,"uploader","rounded","h-100","position-relative",3,"ngClass"],["type","file",1,"d-none",3,"multiple","disabled","change"],["fileInput",""],[4,"ngIf","ngIfElse"],["uploading",""],["title","Opzioni di caricamento"],["optionsModal",""],[1,"mb-1"],[1,"mb-3"],[1,"mb-1","list-unstyled"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","speed-upload",1,"form-check-input",3,"ngModel","ngModelChange"],["for","speed-upload",1,"form-check-label","me-auto"],["type","checkbox","role","switch","id","show-link-modal",1,"form-check-input",3,"ngModel","ngModelChange"],["for","show-link-modal",1,"form-check-label","me-auto"],[1,"p-4","rounded","upload-area",3,"ngClass","dragenter","drop","click"],["uploadArea",""],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16",4,"ngIf","ngIfElse"],["appLogo",""],[1,"description","text-center",3,"ngClass","innerText"],[1,"small","text-center",3,"ngClass"],[1,"text-break",3,"innerText"],["class","fs-xs fst-italic d-block px-2 py-1 text-reset cursor-pointer position-absolute",3,"ngStyle","click",4,"ngIf"],["class","material-icons-outlined d-block cursor-pointer fs-xl position-absolute options-icon",3,"click",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","fill","currentColor","viewBox","0 0 16 16"],["fill-rule","evenodd","d","M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"],["d","M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"],["svgSize","xl","subtext","Upload",1,"d-block","mb-3","py-1",3,"svgClass","responsive"],[1,"fs-xs","fst-italic","d-block","px-2","py-1","text-reset","cursor-pointer","position-absolute",3,"ngStyle","click"],[1,"material-icons-outlined","d-block","cursor-pointer","fs-xl","position-absolute","options-icon",3,"click"],[1,"p-4","rounded"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","viewBox","0 0 16 16",1,"overflow-visible"],["d","M 4.406 3.342 A 5.53 5.53 0 0 1 8 2 c 2.69 0 4.923 2 5.166 4.579 C 14.758 6.804 16 8.137 16 9.773 C 16 11.569 14.502 13 12.687 13 H 3.781 C 1.708 13 0 11.366 0 9.318 c 0 -1.763 1.266 -3.223 2.942 -3.593 c 0.143 -0.863 0.698 -1.723 1.464 -2.383 z",1,"cloud"],[3,"onlyMessage","message"],[1,"small","text-center"]],template:function(t,r){if(1&t&&(e.TgZ(0,"div",0)(1,"input",1,2),e.NdJ("change",function(v){return r.handleSelectionEvent(v)}),e.qZA(),e.YNc(3,H,12,16,"ng-container",3),e.YNc(4,Z,6,2,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(6,"app-modal",5,6)(8,"p",7),e._uU(9,"Tramite questo modal \xe8 possibile gestire le opzioni di caricamento al momento disponibili:"),e.qZA(),e.TgZ(10,"ul",8)(11,"li")(12,"em"),e._uU(13,"caricamento veloce"),e.qZA(),e._uU(14,": abilitando questa opzione, l'immagine da caricare verr\xe0 adattata per terminare l'operazione di upload nel minor tempo possibile. "),e.qZA(),e.TgZ(15,"li")(16,"em"),e._uU(17,"mostra link dopo l'upload"),e.qZA(),e._uU(18,": abilitando questa opzione, una volta terminato il caricamento verr\xe0 aperto il modal contenente i link utili dei file caricati. "),e.qZA()(),e.TgZ(19,"ul",9)(20,"li")(21,"div",10)(22,"input",11),e.NdJ("ngModelChange",function(v){return r.options.compress=v})("ngModelChange",function(){return r.saveOptions()}),e.qZA(),e.TgZ(23,"label",12),e._uU(24,"Caricamento veloce"),e.qZA()()(),e.TgZ(25,"li")(26,"div",10)(27,"input",13),e.NdJ("ngModelChange",function(v){return r.options.openLinkModalAfterUpload=v})("ngModelChange",function(){return r.saveOptions()}),e.qZA(),e.TgZ(28,"label",14),e._uU(29,"Mostra link dopo l'upload"),e.qZA()()()()()),2&t){const n=e.MAs(5);e.Q6J("ngClass",e.WLB(7,V,r.isUploading,r.isWidget)),e.xp6(1),e.Q6J("multiple",!0)("disabled",r.loading||r.isUploading),e.xp6(2),e.Q6J("ngIf",!r.isUploading)("ngIfElse",n),e.xp6(19),e.Q6J("ngModel",r.options.compress),e.xp6(5),e.Q6J("ngModel",r.options.openLinkModalAfterUpload)}},dependencies:[s.mk,s.O5,s.PC,y.Wl,y.JJ,y.On,c.R,d.R,C.z],styles:[".uploader[_ngcontent-%COMP%]{margin:0 1rem}.uploader[_ngcontent-%COMP%]:not(.widget){border:2px dashed #4864FE;box-shadow:0 .125rem .25rem #00000013;color:#2036ad}.uploader[_ngcontent-%COMP%]:not(.widget):not(.uploading)   svg[_ngcontent-%COMP%]{animation:bubble 4s linear infinite}.uploader[_ngcontent-%COMP%]:not(.widget)   .description[_ngcontent-%COMP%]{max-width:400px}.uploader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.options-icon){height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.uploader.uploading[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path.cloud[_ngcontent-%COMP%]{fill:none;stroke:#2036ad;stroke-linecap:round;stroke-dasharray:50;stroke-dashoffset:100;animation:draw 3.5s linear infinite}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]{top:5px;right:5px;opacity:.7;transition:opacity .2s}.uploader[_ngcontent-%COMP%]   .options-icon[_ngcontent-%COMP%]:hover{opacity:1}.upload-area[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(app-logo){pointer-events:none}@media (min-width: 768px){.uploader[_ngcontent-%COMP%]{margin:initial}}@keyframes bubble{6%{transform:scale(1.3,.8)}9%{transform:scale(.8,1.3) translateY(-.5rem)}12%{transform:scale(1)}}@keyframes draw{0%{stroke-dashoffset:100}to{stroke-dashoffset:0}}"]}),L})()},1740:(N,j,i)=>{"use strict";i.d(j,{M:()=>w});var p=i(6895),M=i(433),e=i(6818),O=i(1043),T=i(582),l=i(4650);let w=(()=>{class a{}return a.\u0275fac=function(I){return new(I||a)},a.\u0275mod=l.oAB({type:a}),a.\u0275inj=l.cJS({imports:[p.ez,M.u5,e.q,O.h,T.z]}),a})()},2381:(N,j,i)=>{"use strict";i.d(j,{y:()=>T});var p=i(5044),M=i(4650),e=i(5700),O=i(5123);let T=(()=>{class l{constructor(a,b){this.cookieConsentService=a,this.localStorageService=b,this.storage=null}getItem(a){return null===this.storage&&(this.storage=this.data),this.storage[a]}get data(){const a=this.localStorageService.getItem(p.dR.PREFERENCES);if(!a)return{};try{return JSON.parse(a)}catch{return{}}}setItem(a,b){null===this.storage&&(this.storage=this.data),b?this.storage[a]=b:delete this.storage[a],this.cookieConsentService.choice?.preferences&&this.localStorageService.setItem(p.dR.PREFERENCES,JSON.stringify(this.storage))}resetItemsOnProfileChange(){const a=this.getItem(p.Ye.UPLOAD);a&&(a.lastPath=[],this.setItem(p.Ye.UPLOAD,a))}}return l.\u0275fac=function(a){return new(a||l)(M.LFG(e.C),M.LFG(O.n))},l.\u0275prov=M.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},146:(N,j,i)=>{"use strict";i.d(j,{r:()=>T});var p=i(7579),M=i(1135),e=i(4650),O=i(8745);let T=(()=>{class l{constructor(a){this.uploadPreferencesService=a,this.selectedFileListArray=[],this.actionSubject=new p.x,this.uploadingFileQueueSubject=new p.x,this.uploadingFileErrorSubject=new p.x,this.currentFolderPathSubject=new p.x,this.layoutOptionsSubject=new p.x,this.renameFileSubject=new p.x,this.entityPendingSubject=new p.x,this.deleteFileSubject=new p.x,this.uploadedFileSubject=new p.x,this.draggedFileListSubject=new p.x,this.startUploadSubject=new p.x,this.selectedFileListSubject=new M.X(this.selectedFileListArray)}get actionObservable(){return this.actionSubject.asObservable()}pushAction(a){this.actionSubject.next(a)}get layoutOptionsObservable(){return this.layoutOptionsSubject.asObservable()}pushLayoutOptions(a){this.uploadPreferencesService.layoutOptions=a,this.layoutOptionsSubject.next(a)}get currentFolderPathObservable(){return this.currentFolderPathSubject.asObservable()}pushCurrentFolderPath(a){this.uploadPreferencesService.lastFolderPath=a,this.currentFolderPathSubject.next(a)}get uploadingFileQueueObservable(){return this.uploadingFileQueueSubject.asObservable()}pushUploadingFileQueue(a){this.uploadingFileQueueSubject.next(a)}get uploadingFileErrorObservable(){return this.uploadingFileErrorSubject.asObservable()}pushUploadingFileError(a){this.uploadingFileErrorSubject.next(a)}get renameFileObservable(){return this.renameFileSubject.asObservable()}pushRenameFile(a){this.renameFileSubject.next(a)}get entityPendingObservable(){return this.entityPendingSubject.asObservable()}pushEntityPending(a){this.entityPendingSubject.next(a)}get deleteFileObservable(){return this.deleteFileSubject.asObservable()}pushDeleteFile(a){this.deleteFileSubject.next(a)}get uploadedFileObservable(){return this.uploadedFileSubject.asObservable()}pushUploadedFile(a){this.uploadedFileSubject.next(a)}get draggedFileListObservable(){return this.draggedFileListSubject.asObservable()}pushDraggedFileList(a){this.draggedFileListSubject.next(a)}get startUploadObservable(){return this.startUploadSubject.asObservable()}pushStartUpload(a){this.startUploadSubject.next(a)}get selectedFileListObservable(){return this.selectedFileListSubject.asObservable()}pushSelectedFile(a){if(Array.isArray(a)||(a=[a]),0===a.length)return void(this.selectedFileListArray.length>0&&(this.selectedFileListArray=[],this.selectedFileListSubject.next(this.selectedFileListArray)));let b=!1;for(const I of a){const o=this.selectedFileListArray.findIndex(E=>E.name===I.name);I.selected?-1===o&&(this.selectedFileListArray.push({name:I.name}),b=!0):o>-1&&(this.selectedFileListArray.splice(o,1),b=!0)}b&&this.selectedFileListSubject.next(this.selectedFileListArray)}}return l.\u0275fac=function(a){return new(a||l)(e.LFG(O.p))},l.\u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},8745:(N,j,i)=>{"use strict";i.d(j,{p:()=>T});var p=i(5044),M=i(6986),e=i(4650),O=i(2381);let T=(()=>{class l{constructor(a){this.preferencesService=a}get preferences(){return this.preferencesService.getItem(p.Ye.UPLOAD)||M.p0}set preferences(a){this.preferencesService.setItem(p.Ye.UPLOAD,a)}get lastFolderPath(){return this.preferences.lastPath||M.p0.lastPath}set lastFolderPath(a){const b=this.preferences;b.lastPath=a,this.preferences=b}get layoutOptions(){const a=M.p0.layout,b=this.preferences.layout;return b&&0===Object.keys(a).filter(I=>!b.hasOwnProperty(I)).length?b:a}set layoutOptions(a){const b=this.preferences;b.layout=a,this.preferences=b}get uploader(){const a=this.preferences.uploader||M.p0.uploader;return!a.checkImage.active&&Date.now()-a.checkImage.time>6048e5&&(a.checkImage.active=!0,this.uploader=a),a.hasOwnProperty("showLinkModal")||(a.showLinkModal=!1),a}set uploader(a){const b=this.preferences;b.uploader=a,this.preferences=b}}return l.\u0275fac=function(a){return new(a||l)(e.LFG(O.y))},l.\u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},7320:(N,j,i)=>{"use strict";i.d(j,{C:()=>h});var p=i(5861),M=i(7824),e=i(3905),O=i(3848),o=i(6986),E=i(1042),s=i(4650),y=i(5395),c=i(575),d=i(3138);let C=(()=>{class x{constructor(g){this.globalsService=g,this.ffuid="",this.cache={},this.profileSubscription=this.globalsService.profileObservable.subscribe(m=>{this.ffuid=m?m.user.ffuid:""})}getItem(g){const m=this.createKey(g);if(this.cache.hasOwnProperty(m))return this.cache[m]}setItem(g,m){this.cache[this.createKey(g)]=m}removeItem(g){const m=this.createKey(g);if(this.cache.hasOwnProperty(m)){if(this.cache[m].folders.length)for(const U of this.cache[m].folders)this.removeItem([...g,U.name]);return delete this.cache[m],!0}return!1}addEntities(g,m,U=c.VC.FILE){const _=this.createKey(g);return!!this.cache.hasOwnProperty(_)&&(Array.isArray(m)||(m=[m]),U===c.VC.FILE?this.cache[_].files.unshift(...m):this.cache[_].folders.unshift(...m),!0)}removeEntities(g,m,U=c.VC.FILE){const _=this.createKey(g);if(!this.cache.hasOwnProperty(_))return!1;const k=U===c.VC.FILE?"files":"folders";Array.isArray(m)||(m=[m]);let H=!1;for(const Z of m){const V=this.cache[_][k].findIndex(q=>q.name===Z);V>-1&&(this.cache[_][k].splice(V,1),H=!0)}return H}refactorFolderContent(g,m){const U=this.createKey(g);if(!this.cache.hasOwnProperty(U))return!1;m.endsWith("/")||(m+="/");for(const _ of this.cache[U].folders)_.url=m+_.name;for(const _ of this.cache[U].files)_.url=_.embedUrl=m+_.name,_.time=Date.now();return!0}createKey(g){return`${this.ffuid}/${g.join("/")}`}ngOnDestroy(){this.profileSubscription.unsubscribe()}}return x.\u0275fac=function(g){return new(g||x)(s.LFG(d.d))},x.\u0275prov=s.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"}),x})();var D=i(8745),f=i(529);let h=(()=>{class x{constructor(g,m,U,_){this.graphqlService=g,this.uploadCacheService=m,this.uploadPreferencesService=U,this.http=_}get cache(){return this.uploadCacheService}get preferences(){return this.uploadPreferencesService}setGqlIdHeader(){this.graphqlService.safeSetGlobalHeader(M._.HeaderKeys.UUID,(0,E.Z)())}removeGqlIdHeader(){this.graphqlService.removeGlobalHeader(M._.HeaderKeys.UUID)}getGqlIdHeader(){return this.graphqlService.getGlobalHeader(M._.HeaderKeys.UUID)||""}getFileList(g,m){var U=this;return(0,p.Z)(function*(){const _=U.uploadCacheService.getItem(g);if(_)return _;const k=(yield U.graphqlService.query({query:"\nquery UploadEntitiesListToken($scope: String, $target: String!) {\n    uploadEntitiesListToken(scope: $scope, target: $target)\n}",variables:{scope:m,target:g.join("/")}})).data.uploadEntitiesListToken,H=yield U.sendRequest(k),V={files:H.files.map(q=>{const L=(0,O.Tb)(q.url);return{...q,time:1e3*q.time,filename:L.filename,ext:L.ext,isImage:(0,O.Or)(L.ext),embedUrl:`${q.url}?t=${q.time}`}}),folders:H.folders};return U.uploadCacheService.setItem(g,V),V})()}createDirectory(g,m){var U=this;return(0,p.Z)(function*(){const _=(yield U.graphqlService.mutate({mutation:"\nquery UploadEntitiesCreateDirectoryToken($scope: String, $target: String!) {\n    uploadEntitiesCreateDirectoryToken(scope: $scope, target: $target)\n}",variables:{scope:m,target:g.join("/")}})).data.uploadEntitiesCreateDirectoryToken;return yield U.sendRequest(_)})()}moveRenameEntity(g,m,U,_,k){var H=this;return(0,p.Z)(function*(){_||(_=U);const Z=(yield H.graphqlService.mutate({mutation:"\nquery UploadEntitiesMoveToken($scope: String, $source: String!, $target: String!) {\n    uploadEntitiesMoveToken(scope: $scope, source: $source, target: $target)\n}",variables:{scope:k,source:(g.length?`${g.join("/")}/`:"")+U,target:(m.length?`${m.join("/")}/`:"")+_}})).data.uploadEntitiesMoveToken;return yield H.sendRequest(Z)})()}deleteEntity(g,m,U){var _=this;return(0,p.Z)(function*(){const k=(yield _.graphqlService.mutate({mutation:"\nquery UploadEntitiesDeleteToken($scope: String, $target: String!) {\n    uploadEntitiesDeleteToken(scope: $scope, target: $target)\n}",variables:{scope:U,target:(g.length?`${g.join("/")}/`:"")+m}})).data.uploadEntitiesDeleteToken;return yield _.sendRequest(k),!0})()}getHostToken(g,m,U){var _=this;return(0,p.Z)(function*(){return(yield _.graphqlService.query({query:"\nquery UploadEntitiesHostToken($scope: String, $target: String!) {\n    uploadEntitiesHostToken(scope: $scope, target: $target)\n}",variables:{scope:U,target:(g.length?`${g.join("/")}/`:"")+m}})).data.uploadEntitiesHostToken})()}sendRequest(g){return(0,p.Z)(function*(){const U=yield(yield fetch(o.C7,{method:"POST",referrer:document.URL+"-google",referrerPolicy:"unsafe-url",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:g})})).json();if(U.error&&0!==U.error.trim().length)throw new Error(U.error);return U.success})()}subscribeForChanges(g,m){var U=this;return(0,p.Z)(function*(){return yield U.graphqlService.subscribe({query:"\nsubscription UploadEntities($scope: String) {\n    uploadEntities(scope: $scope) {\n        eventMessage\n        eventType\n        user {\n            avatar\n            host\n            id\n            nickname\n        }\n    }\n}",variables:{scope:m}},_=>{if(!_.data?.uploadEntities)return;const k=JSON.parse(_.data.uploadEntities.eventMessage);if(!k.payload.customHeaders||!k.payload.customHeaders.hasOwnProperty(M._.HeaderKeys.UUID)||k.payload.customHeaders[M._.HeaderKeys.UUID]===U.getGqlIdHeader())return;const H=(k.payload.content.source||"").split("/"),Z=(k.payload.content.target||"").split("/"),V=Z[Z.length-1].indexOf(".")>-1;let q;try{q=JSON.parse(k.output).success||""}catch{return}g({type:_.data.uploadEntities.eventType,sourceName:H[H.length-1],sourcePaths:H.slice(0,-1),targetName:Z[Z.length-1],targetPaths:Z.slice(0,-1),isFile:V,output:q})})})()}getBlobFromUrl(g){var m=this;return(0,p.Z)(function*(){return yield(0,e.z)(m.http.get(g,{responseType:"blob"})).catch(()=>{})})()}}return x.\u0275fac=function(g){return new(g||x)(s.LFG(y.J),s.LFG(C),s.LFG(D.p),s.LFG(f.eN))},x.\u0275prov=s.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"}),x})()},3848:(N,j,i)=>{"use strict";i.d(j,{$H:()=>s,JN:()=>b,Lv:()=>l,Or:()=>E,Tb:()=>O,jL:()=>o,rc:()=>y,sT:()=>w,zO:()=>T});var p=i(5861),M=i(575),e=i(6986);function O(c){let d=c;if(c.indexOf("/")>-1){const h=c.split("/");d=h[h.length-1]}const C=d.split("."),D=C[C.length-1].toLowerCase(),f=decodeURIComponent(C.slice(0,-1).join("."));return{ext:D,filename:f,name:`${f}.${D}`}}function T(c){const d=O(c),C=Date.now();return{name:d.name,size:0,time:C,url:c,ext:d.ext,filename:d.filename,isImage:E(d.ext),embedUrl:`${c}?t=${C}`}}function l(c){let d=c;d.endsWith("/")&&(d=d.slice(0,-1));const C=d.split("/");return{name:decodeURIComponent(C[C.length-1])}}function w(c){return a.apply(this,arguments)}function a(){return(a=(0,p.Z)(function*(c){const d=new FileReader,C=new Promise(D=>d.addEventListener("load",()=>D(d.result)));return d.readAsDataURL(c),C})).apply(this,arguments)}function b(c){return I.apply(this,arguments)}function I(){return(I=(0,p.Z)(function*(c){const d=new DataView(yield c.arrayBuffer());if(2303741511===d.getUint32(0)&&218765834===d.getUint32(4)){if(-1===[4,6].indexOf(d.getUint8(25)))return!1;const D=Object.assign(new Image,{src:yield w(c)});yield new Promise(x=>D.addEventListener("load",()=>x(!0)));const f=Object.assign(document.createElement("canvas"),{width:D.width,height:D.height}).getContext("2d");if(!f)return!1;f.imageSmoothingEnabled=!1,f.drawImage(D,0,0);const h=f?.getImageData(0,0,D.width,D.height);if(h)for(let x=0;x<h.data.length;x+=4)if(h.data[x+3]<255)return!0}return!1})).apply(this,arguments)}function o(c){return c.map(d=>({name:d.name,ext:d.ext,type:M.VC.FILE,url:d.url,embedUrl:d.embedUrl,isImage:d.isImage}))}function E(c,d=[]){return["png","apng","jpeg","jpg","jpe","gif","svg","webp"].includes(c)&&!d.includes(c)}function s(c){return E(c,["gif","svg"])}function y(c,d,C,D=[],f=""){let h={...e.xt};const x=c.trim();h.invalidLength=0===x.length;const Q=(x+f).replace(/\s{2,}/g," ");return h.alreadyUsed=d!==x&&D.includes(Q),h.invalidStartOrEnd=/(^(\s|\.))|((\s|\.)$)/.test(c),h.invalidCharacter=!(C===M.VC.FILE?e.Mi.test(c):e.er.test(c)),h}},3612:(N,j,i)=>{"use strict";i.d(j,{q:()=>d});var p=i(5861),M=i(8896),e=i(6730),O=i.n(e),T=i(9969),l=i(3848),w=i(529),a=i(7579),b=i(7445),I=i(2722),o=i(6986);class E{static findApp1Marker(D){const f=new DataView(D),h=new Set([65498,65497,65476,65474,65472,65499,65501]);for(let x=0;x<D.byteLength-2;x+=2){const Q=f.getUint16(x);if(65505===Q)return{offset:x,size:f.getUint16(x+2),little:18761==f.getUint16(x+8,!1)};if(h.has(Q))break}}static stripAndReturnExif(D){return(0,p.Z)(function*(){const f=yield D.arrayBuffer(),h=E.findApp1Marker(f);return h?{file:new File([f.slice(0,h.offset),f.slice(h.offset+h.size+2)],D.name,{type:D.type,lastModified:D.lastModified}),exif:f.slice(h.offset,h.offset+h.size)}:{file:D}})()}static checkImageOrientation(D){const f=new DataView(D);if(1165519206!=f.getUint32(4,!1))return-1;const h=18761==f.getUint16(10,!1);let x=10;x+=f.getUint32(x+4,h);const Q=f.getUint16(x,h);x+=2;for(let g=0;g<Q;g++)if(274==f.getUint16(x+12*g,h))return f.getUint16(x+12*g+8,h);return-1}}var s=i(4650),y=i(146),c=i(2020);let d=(()=>{class C{constructor(f,h,x){this.http=f,this.uploadObservablesService=h,this.loadImageService=x,this.requestSubscriptions=[],this.uploaderOptionsObject={compress:!0,openLinkModalAfterUpload:!1}}get uploaderOptions(){return{...this.uploaderOptionsObject}}set uploaderOptions(f){this.uploaderOptionsObject={...f}}compressFileIfNeeded(f,h){return(0,p.Z)(function*(){let x=["image/png","image/jpeg"],Q={strict:!0,checkOrientation:!0,quality:.8,convertSize:1};h&&(x.push("image/webp"),Q.width=h.width,Q.height=h.height,Q.resize="cover",Q.strict=!1);const g=f.type.toLowerCase();return f.size<=4e6&&void 0===h||-1===x.indexOf(f.type.toLowerCase())?f:("image/png"===g&&(yield(0,l.JN)(f))&&(Q.convertSize=1/0),new Promise((m,U)=>{new(O())(f,{...Q,success:_=>{const k=_ instanceof Blob?new File([_],f.name,{type:f.type,lastModified:f.lastModified}):f;m(k)},error:U})}))})()}orientFileIfNeeded(f){var h=this;return(0,p.Z)(function*(){if(-1===["image/jpeg"].indexOf(f.type.toLowerCase()))return f;const Q=yield E.stripAndReturnExif(f);if(f=Q.file,Q.exif){const g=E.checkImageOrientation(Q.exif);if(1!==g){let m=0;switch(g){case 3:case 4:m=180;break;case 5:case 6:m=90;break;case 7:case 8:m=270}const U=yield(0,l.sT)(f),_=yield new Promise((H,Z)=>{const V=new Image;V.onload=()=>H({originalImage:V,originalBase64:U}),V.onerror=Z,V.src=U}),k=yield h.loadImageService.transformLoadedImage({original:{base64:_.originalBase64,image:_.originalImage,size:{width:_.originalImage.naturalWidth,height:_.originalImage.naturalHeight}},exifTransform:{flip:[2,4,5,7].includes(g),rotate:m/90}},new T.R);f=new File([(0,M.L)(k.transformed.base64)],f.name,{type:f.type,lastModified:Date.now()})}}return f})()}upload(f,h,x,Q=!1){const g=new a.x,m=new FormData;m.append("payload",x),m.append("upload",f,f.name),Q&&m.append("allowOverwrite","1");const U=this.http.request(new w.aW("POST",o.C7,m,{reportProgress:!0,responseType:"json"}));return this.requestSubscriptions.push(U.subscribe({next:_=>{if(_.type===w.dt.UploadProgress){if(!_.total||(h.progress=Math.round(50*_.loaded/_.total)+20,h.progress<70))return;(0,b.F)(1e3).pipe((0,I.R)(g.asObservable())).subscribe(()=>{if(h.progress<95){const k=Math.round(8*Math.random()+8);h.progress+k>95?h.progress=95:h.progress+=k}})}else if(_ instanceof w.Zn){if(h.progress=100,h.completed=!0,_.body?.error||!_.body?.success)h.error=!0,this.uploadObservablesService.pushUploadingFileError(h);else{h.file.url=_.body.success.url,h.file.time=Date.now(),h.file.embedUrl=`${h.file.url}?t=${h.file.time}`;const k=(0,l.Tb)(h.file.url);h.file.name=k.name,h.file.filename=k.filename}g.next(),g.complete()}},error:()=>{h.error=!0,this.uploadObservablesService.pushUploadingFileError(h),g.next(),g.complete()}})),g.asObservable()}clearPendingRequests(){for(const f of this.requestSubscriptions)f.unsubscribe();this.requestSubscriptions=[]}}return C.\u0275fac=function(f){return new(f||C)(s.LFG(w.eN),s.LFG(y.r),s.LFG(c.y))},C.\u0275prov=s.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},6730:function(N){N.exports=function(){"use strict";function j(u,t){var r=Object.keys(u);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(u);t&&(n=n.filter(function(v){return Object.getOwnPropertyDescriptor(u,v).enumerable})),r.push.apply(r,n)}return r}function i(u){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach(function(n){O(u,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach(function(n){Object.defineProperty(u,n,Object.getOwnPropertyDescriptor(r,n))})}return u}function M(u,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(u,n.key,n)}}function O(u,t,r){return t in u?Object.defineProperty(u,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):u[t]=r,u}function T(){return T=Object.assign||function(u){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(u[n]=r[n])}return u},T.apply(this,arguments)}var u,t,r,n,v,A,R,B,l={exports:{}};u=l,typeof window>"u"||(t=window,r=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,n=t.Blob&&function(){try{return Boolean(new Blob)}catch{return!1}}(),v=n&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch{return!1}}(),A=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,R=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,B=(n||A)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(F){var W,K,S,z,$,P,X,G,ee;if(!(W=F.match(R)))throw new Error("invalid data URI");for(K=W[2]?W[1]:"text/plain"+(W[3]||";charset=US-ASCII"),S=!!W[4],z=F.slice(W[0].length),$=S?atob(z):decodeURIComponent(z),P=new ArrayBuffer($.length),X=new Uint8Array(P),G=0;G<$.length;G+=1)X[G]=$.charCodeAt(G);return n?new Blob([v?X:P],{type:K}):((ee=new A).append(P),ee.getBlob(K))},t.HTMLCanvasElement&&!r.toBlob&&(r.mozGetAsFile?r.toBlob=function(F,W,K){var S=this;setTimeout(function(){F(K&&r.toDataURL&&B?B(S.toDataURL(W,K)):S.mozGetAsFile("blob",W))})}:r.toDataURL&&B&&(r.toBlob=r.msToBlob?function(F,W,K){var S=this;setTimeout(function(){F((W&&"image/png"!==W||K)&&r.toDataURL&&B?B(S.toDataURL(W,K)):S.msToBlob(W))})}:function(F,W,K){var S=this;setTimeout(function(){F(B(S.toDataURL(W,K)))})})),u.exports?u.exports=B:t.dataURLtoBlob=B);var w=l.exports,b={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},o=typeof window<"u"&&typeof window.document<"u"?window:{},E=function(t){return t>0&&t<1/0},s=Array.prototype.slice;function y(u){return Array.from?Array.from(u):s.call(u)}var c=/^image\/.+$/;function d(u){return c.test(u)}var D=String.fromCharCode;var h=o.btoa;function Q(u){var r,t=new DataView(u);try{var n,v,A;if(255===t.getUint8(0)&&216===t.getUint8(1))for(var R=t.byteLength,B=2;B+1<R;){if(255===t.getUint8(B)&&225===t.getUint8(B+1)){v=B;break}B+=1}if(v){var W=v+10;if("Exif"===function f(u,t,r){var v,n="";for(r+=t,v=t;v<r;v+=1)n+=D(u.getUint8(v));return n}(t,v+4,4)){var K=t.getUint16(W);if(((n=18761===K)||19789===K)&&42===t.getUint16(W+2,n)){var S=t.getUint32(W+4,n);S>=8&&(A=W+S)}}}if(A){var $,P,z=t.getUint16(A,n);for(P=0;P<z;P+=1)if(274===t.getUint16($=A+12*P+2,n)){r=t.getUint16($+=8,n),t.setUint16($,1,n);break}}}catch{r=1}return r}var m=/\.\d*(?:0|9){12}\d*$/;function U(u){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return m.test(u)?Math.round(u*t)/t:u}function _(u){var t=u.aspectRatio,r=u.height,n=u.width,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",A=E(n),R=E(r);if(A&&R){var B=r*t;("contain"===v||"none"===v)&&B>n||"cover"===v&&B<n?r=n/t:n=r*t}else A?r=n/t:R&&(n=r*t);return{width:n,height:r}}var k=o.ArrayBuffer,H=o.FileReader,Z=o.URL||o.webkitURL,V=/\.\w+$/,q=o.Compressor;return function(){function u(t,r){(function p(u,t){if(!(u instanceof t))throw new TypeError("Cannot call a class as a function")})(this,u),this.file=t,this.image=new Image,this.options=i(i({},b),r),this.aborted=!1,this.result=null,this.init()}return function e(u,t,r){return t&&M(u.prototype,t),r&&M(u,r),u}(u,[{key:"init",value:function(){var r=this,n=this.file,v=this.options;if(function(t){return!(typeof Blob>"u")&&(t instanceof Blob||"[object Blob]"===Object.prototype.toString.call(t))}(n)){var A=n.type;if(d(A))if(Z&&H)if(k||(v.checkOrientation=!1),Z&&!v.checkOrientation)this.load({url:Z.createObjectURL(n)});else{var R=new H,B=v.checkOrientation&&"image/jpeg"===A;this.reader=R,R.onload=function(F){var K=F.target.result,S={};if(B){var z=Q(K);z>1||!Z?(S.url=function x(u,t){for(var r=[],v=new Uint8Array(u);v.length>0;)r.push(D.apply(null,y(v.subarray(0,8192)))),v=v.subarray(8192);return"data:".concat(t,";base64,").concat(h(r.join("")))}(K,A),z>1&&T(S,function g(u){var t=0,r=1,n=1;switch(u){case 2:r=-1;break;case 3:t=-180;break;case 4:n=-1;break;case 5:t=90,n=-1;break;case 6:t=90;break;case 7:t=90,r=-1;break;case 8:t=-90}return{rotate:t,scaleX:r,scaleY:n}}(z))):S.url=Z.createObjectURL(n)}else S.url=K;r.load(S)},R.onabort=function(){r.fail(new Error("Aborted to read the image with FileReader."))},R.onerror=function(){r.fail(new Error("Failed to read the image with FileReader."))},R.onloadend=function(){r.reader=null},B?R.readAsArrayBuffer(n):R.readAsDataURL(n)}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(r){var n=this,v=this.file,A=this.image;A.onload=function(){n.draw(i(i({},r),{},{naturalWidth:A.naturalWidth,naturalHeight:A.naturalHeight}))},A.onabort=function(){n.fail(new Error("Aborted to load the image."))},A.onerror=function(){n.fail(new Error("Failed to load the image."))},o.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(o.navigator.userAgent)&&(A.crossOrigin="anonymous"),A.alt=v.name,A.src=r.url}},{key:"draw",value:function(r){var n=this,v=r.naturalWidth,A=r.naturalHeight,R=r.rotate,B=void 0===R?0:R,F=r.scaleX,W=void 0===F?1:F,K=r.scaleY,S=void 0===K?1:K,z=this.file,$=this.image,P=this.options,X=document.createElement("canvas"),G=X.getContext("2d"),ee=Math.abs(B)%180==90,oe=("contain"===P.resize||"cover"===P.resize)&&E(P.width)&&E(P.height),re=Math.max(P.maxWidth,0)||1/0,ne=Math.max(P.maxHeight,0)||1/0,ie=Math.max(P.minWidth,0)||0,ae=Math.max(P.minHeight,0)||0,te=v/A,J=P.width,Y=P.height;if(ee){var ue=[ne,re];re=ue[0],ne=ue[1];var de=[ae,ie];ie=de[0],ae=de[1];var pe=[Y,J];J=pe[0],Y=pe[1]}oe&&(te=J/Y);var he=_({aspectRatio:te,width:re,height:ne},"contain");re=he.width,ne=he.height;var fe=_({aspectRatio:te,width:ie,height:ae},"cover");if(ie=fe.width,ae=fe.height,oe){var ge=_({aspectRatio:te,width:J,height:Y},P.resize);J=ge.width,Y=ge.height}else{var me=_({aspectRatio:te,width:J,height:Y}),ve=me.width;J=void 0===ve?v:ve;var _e=me.height;Y=void 0===_e?A:_e}var Ue=-(J=Math.floor(U(Math.min(Math.max(J,ie),re))))/2,we=-(Y=Math.floor(U(Math.min(Math.max(Y,ae),ne))))/2,Me=J,Ie=Y,se=[];if(oe){var le,ce,Ae=_({aspectRatio:te,width:v,height:A},{contain:"cover",cover:"contain"}[P.resize]);se.push((v-(le=Ae.width))/2,(A-(ce=Ae.height))/2,le,ce)}if(se.push(Ue,we,Me,Ie),ee){var ye=[Y,J];J=ye[0],Y=ye[1]}X.width=J,X.height=Y,d(P.mimeType)||(P.mimeType=z.type);var xe="transparent";if(z.size>P.convertSize&&P.convertTypes.indexOf(P.mimeType)>=0&&(P.mimeType="image/jpeg"),"image/jpeg"===P.mimeType&&(xe="#fff"),G.fillStyle=xe,G.fillRect(0,0,J,Y),P.beforeDraw&&P.beforeDraw.call(this,G,X),!this.aborted&&(G.save(),G.translate(J/2,Y/2),G.rotate(B*Math.PI/180),G.scale(W,S),G.drawImage.apply(G,[$].concat(se)),G.restore(),P.drew&&P.drew.call(this,G,X),!this.aborted)){var Oe=function(Ce){n.aborted||n.done({naturalWidth:v,naturalHeight:A,result:Ce})};X.toBlob?X.toBlob(Oe,P.mimeType,P.quality):Oe(w(X.toDataURL(P.mimeType,P.quality)))}}},{key:"done",value:function(r){var n=r.naturalWidth,v=r.naturalHeight,A=r.result,R=this.file,F=this.options;if(Z&&!F.checkOrientation&&Z.revokeObjectURL(this.image.src),A)if(F.strict&&A.size>R.size&&F.mimeType===R.type&&!(F.width>n||F.height>v||F.minWidth>n||F.minHeight>v||F.maxWidth<n||F.maxHeight<v))A=R;else{var W=new Date;A.lastModified=W.getTime(),A.lastModifiedDate=W,A.name=R.name,A.name&&A.type!==R.type&&(A.name=A.name.replace(V,function C(u){var t=d(u)?u.substr(6):"";return"jpeg"===t&&(t="jpg"),".".concat(t)}(A.type)))}else A=R;this.result=A,F.success&&F.success.call(this,A)}},{key:"fail",value:function(r){var n=this.options;if(!n.error)throw r;n.error.call(this,r)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=q,u}},{key:"setDefaults",value:function(r){T(b,r)}}]),u}()}()},7445:(N,j,i)=>{"use strict";i.d(j,{F:()=>e});var p=i(4986),M=i(5963);function e(O=0,T=p.z){return O<0&&(O=0),(0,M.H)(O,O,T)}},1042:(N,j,i)=>{"use strict";i.d(j,{Z:()=>E});var p,M=new Uint8Array(16);function e(){if(!p&&!(p=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(M)}const O=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,l=function T(s){return"string"==typeof s&&O.test(s)};for(var w=[],a=0;a<256;++a)w.push((a+256).toString(16).substr(1));const E=function o(s,y,c){var d=(s=s||{}).random||(s.rng||e)();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,y){c=c||0;for(var C=0;C<16;++C)y[c+C]=d[C];return y}return function b(s){var y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=(w[s[y+0]]+w[s[y+1]]+w[s[y+2]]+w[s[y+3]]+"-"+w[s[y+4]]+w[s[y+5]]+"-"+w[s[y+6]]+w[s[y+7]]+"-"+w[s[y+8]]+w[s[y+9]]+"-"+w[s[y+10]]+w[s[y+11]]+w[s[y+12]]+w[s[y+13]]+w[s[y+14]]+w[s[y+15]]).toLowerCase();if(!l(c))throw TypeError("Stringified UUID is invalid");return c}(d)}}}]);